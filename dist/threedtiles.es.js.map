{"version":3,"file":"threedtiles.es.js","sources":["../src/tileset/OcclusionCullingService.js","../src/geometry/obb.js","../src/utils/LinkedHashMap.js","../src/decoder/FeatureTable.js","../node_modules/.pnpm/three@0.174.0/node_modules/three/examples/jsm/utils/BufferGeometryUtils.js","../src/decoder/B3DMDecoder.js","../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm-browser/stringify.js","../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm-browser/rng.js","../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm-browser/native.js","../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm-browser/v4.js","../src/decoder/SplatsDecoder.js","../node_modules/.pnpm/three@0.174.0/node_modules/three/examples/jsm/loaders/GLTFLoader.js","../node_modules/.pnpm/three@0.174.0/node_modules/three/examples/jsm/loaders/DRACOLoader.js","../node_modules/.pnpm/three@0.174.0/node_modules/three/examples/jsm/utils/WorkerPool.js","../node_modules/.pnpm/three@0.174.0/node_modules/three/examples/jsm/libs/ktx-parse.module.js","../node_modules/.pnpm/three@0.174.0/node_modules/three/examples/jsm/libs/zstddec.module.js","../node_modules/.pnpm/three@0.174.0/node_modules/three/examples/jsm/loaders/KTX2Loader.js","../node_modules/.pnpm/three@0.174.0/node_modules/three/examples/jsm/math/ColorSpaces.js","../src/tileset/implicit/SubtreeDecoder.js","../src/tileset/implicit/ImplicitTileResolver.js","../node_modules/.pnpm/meshoptimizer@0.22.0/node_modules/meshoptimizer/meshopt_encoder.module.js","../node_modules/.pnpm/meshoptimizer@0.22.0/node_modules/meshoptimizer/meshopt_decoder.module.js","../node_modules/.pnpm/meshoptimizer@0.22.0/node_modules/meshoptimizer/meshopt_simplifier.module.js","../node_modules/.pnpm/meshoptimizer@0.22.0/node_modules/meshoptimizer/meshopt_clusterizer.module.js","../src/tileset/TileLoader.js","../node_modules/.pnpm/data-structure-typed@2.0.3/node_modules/data-structure-typed/dist/esm/common/index.js","../node_modules/.pnpm/path-browserify@1.0.1/node_modules/path-browserify/index.js","../node_modules/.pnpm/data-structure-typed@2.0.3/node_modules/data-structure-typed/dist/esm/data-structures/base/iterable-element-base.js","../node_modules/.pnpm/data-structure-typed@2.0.3/node_modules/data-structure-typed/dist/esm/data-structures/heap/heap.js","../node_modules/.pnpm/data-structure-typed@2.0.3/node_modules/data-structure-typed/dist/esm/data-structures/priority-queue/priority-queue.js","../node_modules/.pnpm/data-structure-typed@2.0.3/node_modules/data-structure-typed/dist/esm/data-structures/priority-queue/min-priority-queue.js","../src/splats/SplatsColider.js","../src/splats/SplatsMesh.js","../src/tileset/OGC3DTile.js","../src/tileset/instanced/InstancedTile.js","../src/tileset/instanced/InstancedOGC3DTile.js","../src/tileset/instanced/MeshTile.js","../src/tileset/instanced/JsonTile.js","../src/tileset/instanced/InstancedTileLoader.js"],"sourcesContent":["import * as THREE from 'three';\r\n\r\n\r\n/**\r\n * An occlusion culling service that helps to only refine tiles that are visible.\r\n * This occlusion culling has a cost but allows downloading much less data.\r\n * For models that have a lot of geometry that is often hidden from the camera by walls, this can improve the frame-rate.\r\n * @class\r\n */\r\nclass OcclusionCullingService {\r\n\r\n    /**\r\n     * Creates an Occlusion Culling service to be passed to {@link OGC3DTile} Tilesets\r\n     */\r\n    constructor() {\r\n        this.cullMap = [];\r\n        this.cullMaterial = new THREE.MeshBasicMaterial({ vertexColors: true });\r\n        this.cullMaterial.side = THREE.FrontSide;\r\n        this.cullTarget = this._createCullTarget();\r\n        this.cullPixels = new Uint8Array(4 * this.cullTarget.width * this.cullTarget.height);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {Integer} side use THREE.FrontSide, THREE.BackSide or THREE.DoubleSide (FrontSide default)\r\n     */\r\n    setSide(side){\r\n        this.cullMaterial.side = side;\r\n    }\r\n\r\n    _createCullTarget() {\r\n        const target = new THREE.WebGLRenderTarget(Math.floor(window.innerWidth * 0.05), Math.floor(window.innerHeight * 0.05));\r\n        target.texture.format = THREE.RGBAFormat;\r\n        target.texture.colorSpace = THREE.LinearSRGBColorSpace;\r\n        target.texture.minFilter = THREE.NearestFilter;\r\n        target.texture.magFilter = THREE.NearestFilter;\r\n        target.texture.generateMipmaps = false;\r\n        target.stencilBuffer = false;\r\n        target.depthBuffer = true;\r\n        target.depthTexture = new THREE.DepthTexture();\r\n        target.depthTexture.format = THREE.DepthFormat;\r\n        target.depthTexture.type = THREE.UnsignedShortType;\r\n        return target;\r\n    }\r\n\r\n    /**\r\n     * Update function to be called on every frame in the render loop.\r\n     * @param {THREE.scene} scene \r\n     * @param {THREE.Renderer} renderer \r\n     * @param {THREE.camera} camera \r\n     */\r\n    update(scene, renderer, camera) {\r\n        let tempRenderTarget = renderer.getRenderTarget();\r\n        let tempOverrideMaterial = scene.overrideMaterial;\r\n\r\n        scene.overrideMaterial = this.cullMaterial;\r\n        renderer.setRenderTarget(this.cullTarget);\r\n        renderer.render(scene, camera);\r\n\r\n        scene.overrideMaterial = tempOverrideMaterial;\r\n        renderer.setRenderTarget(tempRenderTarget);\r\n\r\n        renderer.readRenderTargetPixels(this.cullTarget, 0, 0, this.cullTarget.width, this.cullTarget.height, this.cullPixels);\r\n        this.cullMap = [];\r\n        \r\n        for (let i = 0; i < this.cullPixels.length; i += 4) {\r\n            const c = THREE.MathUtils.clamp(this.cullPixels[i], 0, 255) << 16 ^ THREE.MathUtils.clamp(this.cullPixels[i + 1], 0, 255) << 8 ^ THREE.MathUtils.clamp(this.cullPixels[i + 2], 0, 255) << 0;\r\n            this.cullMap[c] = true;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * check if the given tile ID was visible in the last rendered frame.\r\n     * @param {string|Number} id \r\n     * @returns true if tile is visible\r\n     */\r\n    hasID(id) {\r\n        return this.cullMap[id];\r\n    }\r\n}\r\nexport { OcclusionCullingService };","\r\n\r\nimport { Matrix3, Matrix4, Ray, Sphere, Vector3, Box3, BufferGeometry, LineSegments, LineBasicMaterial } from \"three\";\r\nimport { OBB as threeOBB } from 'three/addons/math/OBB.js';\r\n\r\nconst tempMatrix = new Matrix3();\r\nconst tempVector3 = new Vector3();\r\nconst size = new Vector3();\r\nconst aabb = new Box3();\r\nconst matrix = new Matrix4();\r\nconst inverse = new Matrix4();\r\nconst localRay = new Ray();\r\n\r\nclass OBB {\r\n    constructor(values) {\r\n        this.center = new Vector3(values[0], values[1], values[2]);\r\n        this.e1 = new Vector3(values[3], values[4], values[5]);\r\n        this.e2 = new Vector3(values[6], values[7], values[8]);\r\n        this.e3 = new Vector3(values[9], values[10], values[11]);\r\n\r\n        this.halfSize = new Vector3(this.e1.length(), this.e2.length(), this.e3.length());\r\n\r\n\r\n        this.e1.normalize();\r\n        this.e2.normalize();\r\n        this.e3.normalize();\r\n\r\n        this.rotationMatrix = new Matrix3();\r\n        this.rotationMatrix.set(\r\n            this.e1.x, this.e2.x, this.e3.x,\r\n            this.e1.y, this.e2.y, this.e3.y,\r\n            this.e1.z, this.e2.z, this.e3.z);\r\n    }\r\n\r\n    copy(aObb) {\r\n        this.center.copy(aObb.center);\r\n        this.rotationMatrix.copy(aObb.rotationMatrix);\r\n        this.halfSize.copy(aObb.halfSize);\r\n        this.e1.copy(aObb.e1);\r\n        this.e2.copy(aObb.e2);\r\n        this.e3.copy(aObb.e3);\r\n    }\r\n\r\n    getSize(result) {\r\n\r\n        return result.copy(this.halfSize).multiplyScalar(2);\r\n\r\n    }\r\n\r\n    applyMatrix4(matrix) {\r\n        const e = matrix.elements;\r\n\r\n        let sx = tempVector3.set(e[0], e[1], e[2]).length();\r\n        const sy = tempVector3.set(e[4], e[5], e[6]).length();\r\n        const sz = tempVector3.set(e[8], e[9], e[10]).length();\r\n\r\n        const det = matrix.determinant();\r\n        if (det < 0) sx = - sx;\r\n\r\n        tempMatrix.setFromMatrix4(matrix);\r\n\r\n        const invSX = 1 / sx;\r\n        const invSY = 1 / sy;\r\n        const invSZ = 1 / sz;\r\n\r\n        tempMatrix.elements[0] *= invSX;\r\n        tempMatrix.elements[1] *= invSX;\r\n        tempMatrix.elements[2] *= invSX;\r\n\r\n        tempMatrix.elements[3] *= invSY;\r\n        tempMatrix.elements[4] *= invSY;\r\n        tempMatrix.elements[5] *= invSY;\r\n\r\n        tempMatrix.elements[6] *= invSZ;\r\n        tempMatrix.elements[7] *= invSZ;\r\n        tempMatrix.elements[8] *= invSZ;\r\n\r\n        this.rotationMatrix.premultiply(tempMatrix);\r\n\r\n        this.halfSize.x *= sx;\r\n        this.halfSize.y *= sy;\r\n        this.halfSize.z *= sz;\r\n\r\n        //tempVector3.setFromMatrixPosition(matrix);\r\n        this.center.applyMatrix4(matrix);\r\n        //console.log(this.e1);\r\n        this.rotationMatrix.extractBasis(this.e1, this.e2, this.e3);\r\n        //console.log(this.e1)\r\n        return this;\r\n\r\n    }\r\n\r\n    intersectRay(ray, result) {\r\n\r\n        // the idea is to perform the intersection test in the local space\r\n        // of the OBB.\r\n\r\n        this.getSize(size);\r\n        aabb.setFromCenterAndSize(tempVector3.set(0, 0, 0), size);\r\n\r\n        // create a 4x4 transformation matrix\r\n\r\n        matrix.setFromMatrix3(this.rotationMatrix);\r\n        matrix.setPosition(this.center);\r\n\r\n        // transform ray to the local space of the OBB\r\n\r\n        inverse.copy(matrix).invert();\r\n        localRay.copy(ray).applyMatrix4(inverse);\r\n\r\n        // perform ray <-> AABB intersection test\r\n\r\n        if (localRay.intersectBox(aabb, result)) {\r\n\r\n            // transform the intersection point back to world space\r\n\r\n            return result.applyMatrix4(matrix);\r\n\r\n        } else {\r\n\r\n            return null;\r\n\r\n        }\r\n\r\n    }\r\n\r\n    intersectsRay(ray) {\r\n\r\n        return this.intersectRay(ray, tempVector3) !== null;\r\n\r\n    }\r\n\r\n    insidePlane(plane) {\r\n        // compute the projection interval radius of this OBB onto L(t) = this->center + t * p.normal;\r\n\r\n        plane.normal.normalize();\r\n        const r = this.halfSize.x * Math.abs(plane.normal.dot(this.e1)) +\r\n            this.halfSize.y * Math.abs(plane.normal.dot(this.e2)) +\r\n            this.halfSize.z * Math.abs(plane.normal.dot(this.e3));\r\n\r\n        // compute distance of the OBB's center from the plane\r\n\r\n        const d = plane.distanceToPoint(this.center);\r\n\r\n        // Intersection occurs when distance d falls within [-r,+r] interval\r\n\r\n        return d > -r;\r\n\r\n    }\r\n\r\n    inFrustum(frustum) {\r\n\r\n        //this.rotationMatrix.extractBasis(this.e1, this.e2, this.e3);\r\n\r\n        for (let i = 0; i < 6; i++) {\r\n            const plane = frustum.planes[i];\r\n            const planeIntersection = this.insidePlane(plane);\r\n\r\n            if (!planeIntersection) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    distanceToPoint(point) {\r\n\r\n        tempVector3.copy(point);\r\n        tempVector3.sub(this.center);\r\n        tempVector3.applyMatrix3(this.rotationMatrix);\r\n\r\n        //// point to bounds \r\n        let dx = Math.max(0, Math.max(-this.halfSize.x - tempVector3.x, tempVector3.x - this.halfSize.x));\r\n        let dy = Math.max(0, Math.max(-this.halfSize.y - tempVector3.y, tempVector3.y - this.halfSize.y));\r\n        let dz = Math.max(0, Math.max(-this.halfSize.z - tempVector3.z, tempVector3.z - this.halfSize.z));\r\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\r\n    }\r\n\r\n    helper() {\r\n        const hs = this.halfSize;\r\n        const c = this.center;\r\n        const e1 = this.e1;\r\n        const e2 = this.e2;\r\n        const e3 = this.e3;\r\n    \r\n        // Calculate all 8 corners\r\n        const corners = [\r\n            new Vector3().copy(c)\r\n                .add(e1.clone().multiplyScalar(hs.x))\r\n                .add(e2.clone().multiplyScalar(hs.y))\r\n                .add(e3.clone().multiplyScalar(hs.z)),\r\n            new Vector3().copy(c)\r\n                .add(e1.clone().multiplyScalar(-hs.x))\r\n                .add(e2.clone().multiplyScalar(hs.y))\r\n                .add(e3.clone().multiplyScalar(hs.z)),\r\n            new Vector3().copy(c)\r\n                .add(e1.clone().multiplyScalar(-hs.x))\r\n                .add(e2.clone().multiplyScalar(-hs.y))\r\n                .add(e3.clone().multiplyScalar(hs.z)),\r\n            new Vector3().copy(c)\r\n                .add(e1.clone().multiplyScalar(hs.x))\r\n                .add(e2.clone().multiplyScalar(-hs.y))\r\n                .add(e3.clone().multiplyScalar(hs.z)),\r\n            new Vector3().copy(c)\r\n                .add(e1.clone().multiplyScalar(hs.x))\r\n                .add(e2.clone().multiplyScalar(hs.y))\r\n                .add(e3.clone().multiplyScalar(-hs.z)),\r\n            new Vector3().copy(c)\r\n                .add(e1.clone().multiplyScalar(-hs.x))\r\n                .add(e2.clone().multiplyScalar(hs.y))\r\n                .add(e3.clone().multiplyScalar(-hs.z)),\r\n            new Vector3().copy(c)\r\n                .add(e1.clone().multiplyScalar(-hs.x))\r\n                .add(e2.clone().multiplyScalar(-hs.y))\r\n                .add(e3.clone().multiplyScalar(-hs.z)),\r\n            new Vector3().copy(c)\r\n                .add(e1.clone().multiplyScalar(hs.x))\r\n                .add(e2.clone().multiplyScalar(-hs.y))\r\n                .add(e3.clone().multiplyScalar(-hs.z)),\r\n        ];\r\n    \r\n        // Define the edges by connecting the corners\r\n        const edges = [\r\n            0, 1, 1, 2, 2, 3, 3, 0, // Top face\r\n            4, 5, 5, 6, 6, 7, 7, 4, // Bottom face\r\n            0, 4, 1, 5, 2, 6, 3, 7  // Side edges\r\n        ];\r\n    \r\n        // Create geometry and add line segments\r\n        const geometry = new BufferGeometry().setFromPoints(corners);\r\n        geometry.setIndex(edges);\r\n        geometry.computeBoundingSphere();\r\n    \r\n        // Create line material\r\n        const material = new LineBasicMaterial({ color: 0xff0000 });\r\n    \r\n        // Create the wireframe mesh\r\n        const wireframe = new LineSegments(geometry, material);\r\n    \r\n        wireframe.dispose = ()=>{\r\n            material.dispose();\r\n            geometry.dispose();\r\n        }\r\n        return wireframe;\r\n    }\r\n\r\n}\r\n\r\nexport { OBB };","/**\r\n * @copyright 2021 Aaron Zhao <yujianzhao2013@gmail.com>\r\n * @license MIT\r\n * Linked hash map data structure\r\n * @class LinkedHashMap\r\n */\r\nclass LinkedHashMap {\r\n    /**\r\n    * Creates a linked hash map instance\r\n    * @public\r\n    */\r\n    constructor() {\r\n        this._data = new Map();\r\n        this._link = new Map();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n    }\r\n\r\n    /**\r\n    * Add or update an item to the list\r\n    * @public\r\n    * @param {any} key\r\n    * @param {any} item\r\n    * @param {boolean} head add to the head if true; tail otherwise\r\n    */\r\n    put(key, item, head = false) {\r\n        if (this.has(key)) {\r\n            this._data.set(key, item);\r\n            return;\r\n        }\r\n        this._data.set(key, item);\r\n        this._link.set(key, {\r\n            previous: undefined,\r\n            next: undefined\r\n        });\r\n        if (this._head == null) {\r\n            this._head = key;\r\n            this._tail = key;\r\n        } else if (head) {\r\n            this._link.get(this._head).previous = key;\r\n            this._link.get(key).next = this._head;\r\n            this._head = key;\r\n        } else {\r\n            this._link.get(this._tail).next = key;\r\n            this._link.get(key).previous = this._tail;\r\n            this._tail = key;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the head key and item\r\n     * @public\r\n     * @returns {any} key, item, next(), previous()\r\n     */\r\n    head() {\r\n        return ({\r\n            key: this._head, value: this.get(this._head), next: () => this.next(this._head), previous: () => null\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Returns the tail key and item\r\n     * @public\r\n     * @returns {any} key, item, next(), previous()\r\n     */\r\n    tail() {\r\n        return ({\r\n            key: this._tail, value: this.get(this._tail), next: () => null, previous: () => this.previous(this._tail)\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Returns an item from the map by key\r\n     * @public\r\n     * @param {any} key\r\n     * @returns {any} item\r\n     */\r\n    get(key) {\r\n        return this._data.get(key);\r\n    }\r\n\r\n    /**\r\n     * Returns previous key item of the key\r\n     * @public\r\n     * @param {any} key\r\n     * @returns {any} key\r\n     */\r\n    previousKey(key) {\r\n        const link = this._link.get(key);\r\n        return link != null ? link.previous : undefined;\r\n    }\r\n\r\n    /**\r\n     * Returns previous item of the key\r\n     * @public\r\n     * @param {any} key\r\n     * @returns {any} item\r\n     */\r\n    previousValue(key) {\r\n        return this.get(this.previousKey(key));\r\n    }\r\n\r\n    /**\r\n     * Returns previous key, item of the key\r\n     * @public\r\n     * @param {any} key\r\n     * @returns {any} key, item, next(), previous()\r\n     */\r\n    previous(key) {\r\n        const prevKey = this.previousKey(key);\r\n        return ({\r\n            key: prevKey,\r\n            value: this.get(prevKey),\r\n            next: () => this.next(prevKey),\r\n            previous: () => this.previous(prevKey)\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Returns next key of the key\r\n     * @public\r\n     * @param {any} key\r\n     * @returns {any} key\r\n     */\r\n    nextKey(key) {\r\n        const link = this._link.get(key);\r\n        return link != null ? link.next : undefined;\r\n    }\r\n\r\n    /**\r\n     * Returns next item of the key\r\n     * @public\r\n     * @param {any} key\r\n     * @returns {any} item\r\n     */\r\n    nextValue(key) {\r\n        return this.get(this.nextKey(key));\r\n    }\r\n\r\n    /**\r\n     * Returns next key, item of the key\r\n     * @public\r\n     * @param {any} key\r\n     * @returns {any} key, item, next(), previous()\r\n     */\r\n    next(key) {\r\n        const nextKey = this.nextKey(key);\r\n        return ({\r\n            key: nextKey,\r\n            value: this.get(nextKey),\r\n            next: () => this.next(nextKey),\r\n            previous: () => this.previous(nextKey)\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Removes and returns an item from the map\r\n     * @public\r\n     * @param {any} key\r\n     * @returns {any} item\r\n     */\r\n    remove(key) {\r\n        const item = this._data.get(key);\r\n        if (item != null) {\r\n            if (this.size() === 1) {\r\n                this.reset();\r\n            } else {\r\n                if (key === this._head) {\r\n                    const headLink = this._link.get(this._head);\r\n                    this._link.get(headLink.next).previous = null;\r\n                    this._head = headLink.next;\r\n                } else if (key === this._tail) {\r\n                    const tailLink = this._link.get(this._tail);\r\n                    this._link.get(tailLink.previous).next = null;\r\n                    this._tail = tailLink.previous;\r\n                } else {\r\n                    const cur = this._link.get(key);\r\n                    const prev = this._link.get(cur.previous);\r\n                    const nex = this._link.get(cur.next);\r\n                    prev.next = cur.next;\r\n                    nex.previous = cur.previous;\r\n                }\r\n                this._link.delete(key);\r\n                this._data.delete(key);\r\n            }\r\n        }\r\n        return item;\r\n    }\r\n\r\n    /**\r\n     * Return if the key exists in the map\r\n     * @public\r\n     * @param {any} key;\r\n     * @returns {boolean}\r\n     */\r\n    has(key) {\r\n        return this._data.has(key);\r\n    }\r\n\r\n    /**\r\n     * Returns the size of the map\r\n     * @public\r\n     * @returns {number}\r\n     */\r\n    size() {\r\n        return this._data.size;\r\n    }\r\n\r\n    /**\r\n     * Empties the map\r\n     * @public\r\n     */\r\n    reset() {\r\n        this._data.clear();\r\n        this._link.clear();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n    }\r\n\r\n    /**\r\n     * Returns an iterator of keys\r\n     * @public\r\n     * @returns {Iterator[key]}\r\n     */\r\n    keys() {\r\n        return this._data.keys();\r\n    }\r\n\r\n    /**\r\n     * Returns an iterator of values\r\n     * @public\r\n     * @returns {Iterator[value]}\r\n     */\r\n    values() {\r\n        return this._data.values();\r\n    }\r\n\r\n    /**\r\n     * Returns an iterator of keys and values\r\n     * @public\r\n     * @returns {Iterator[key, value]}\r\n     */\r\n    entries() {\r\n        return this._data.entries();\r\n    }\r\n\r\n    /**\r\n     * Returns array representation of the map values\r\n     * @public\r\n     * @param {'orderByInsert' | 'orderByLink'} order return by inserting order (default) or link order\r\n     * @returns {Array<{key: any, value: any}>}\r\n     */\r\n    toArray(order = 'orderByInsert') {\r\n        if (order !== 'orderByInsert') {\r\n            const linkOrderArr = [];\r\n            let next = this._head;\r\n            while (next != null) {\r\n                linkOrderArr.push({ key: next, value: this.get(next) });\r\n                next = this.nextKey(next);\r\n            }\r\n            return linkOrderArr;\r\n        }\r\n        return Array.from(this.keys()).map((k) => ({ key: k, value: this.get(k) }));\r\n    }\r\n}\r\n\r\nexport { LinkedHashMap };\r\n","//\r\n// This class is taken straight from NASA-AMMOS library.\r\n// https://github.com/NASA-AMMOS/3DTilesRendererJS/blob/master/src/utilities/FeatureTable.js\r\n//\r\n\r\nconst utf8decoder = new TextDecoder();\r\nexport class FeatureTable {\r\n\r\n    constructor(buffer, start, headerLength, binLength) {\r\n\r\n        this.buffer = buffer;\r\n        this.binOffset = start + headerLength;\r\n        this.binLength = binLength;\r\n\r\n        let header = null;\r\n        if (headerLength !== 0) {\r\n\r\n            try {\r\n                const headerData = new Uint8Array(buffer, start, headerLength);\r\n                header = JSON.parse(utf8decoder.decode(headerData));\r\n              } catch (e) {\r\n                header = {};\r\n               }\r\n\r\n        } else {\r\n\r\n            header = {};\r\n\r\n        }\r\n        this.header = header;\r\n\r\n    }\r\n\r\n    getKeys() {\r\n\r\n        return Object.keys(this.header);\r\n\r\n    }\r\n\r\n    getData(key, count, defaultComponentType = null, defaultType = null) {\r\n\r\n        const header = this.header;\r\n\r\n        if (!(key in header)) {\r\n\r\n            return null;\r\n\r\n        }\r\n\r\n        const feature = header[key];\r\n        if (!(feature instanceof Object)) {\r\n\r\n            return feature;\r\n\r\n        } else if (Array.isArray(feature)) {\r\n\r\n            return feature;\r\n\r\n        } else {\r\n\r\n            const { buffer, binOffset, binLength } = this;\r\n            const byteOffset = feature.byteOffset || 0;\r\n            const featureType = feature.type || defaultType;\r\n            const featureComponentType = feature.componentType || defaultComponentType;\r\n\r\n            if ('type' in feature && defaultType && feature.type !== defaultType) {\r\n\r\n                throw new Error('FeatureTable: Specified type does not match expected type.');\r\n\r\n            }\r\n\r\n            let stride;\r\n            switch (featureType) {\r\n\r\n                case 'SCALAR':\r\n                    stride = 1;\r\n                    break;\r\n\r\n                case 'VEC2':\r\n                    stride = 2;\r\n                    break;\r\n\r\n                case 'VEC3':\r\n                    stride = 3;\r\n                    break;\r\n\r\n                case 'VEC4':\r\n                    stride = 4;\r\n                    break;\r\n\r\n                default:\r\n                    throw new Error(`FeatureTable : Feature type not provided for \"${key}\".`);\r\n\r\n            }\r\n\r\n            let data;\r\n            const arrayStart = binOffset + byteOffset;\r\n            const arrayLength = count * stride;\r\n\r\n            switch (featureComponentType) {\r\n\r\n                case 'BYTE':\r\n                    data = new Int8Array(buffer, arrayStart, arrayLength);\r\n                    break;\r\n\r\n                case 'UNSIGNED_BYTE':\r\n                    data = new Uint8Array(buffer, arrayStart, arrayLength);\r\n                    break;\r\n\r\n                case 'SHORT':\r\n                    data = new Int16Array(buffer, arrayStart, arrayLength);\r\n                    break;\r\n\r\n                case 'UNSIGNED_SHORT':\r\n                    data = new Uint16Array(buffer, arrayStart, arrayLength);\r\n                    break;\r\n\r\n                case 'INT':\r\n                    data = new Int32Array(buffer, arrayStart, arrayLength);\r\n                    break;\r\n\r\n                case 'UNSIGNED_INT':\r\n                    data = new Uint32Array(buffer, arrayStart, arrayLength);\r\n                    break;\r\n\r\n                case 'FLOAT':\r\n                    data = new Float32Array(buffer, arrayStart, arrayLength);\r\n                    break;\r\n\r\n                case 'DOUBLE':\r\n                    data = new Float64Array(buffer, arrayStart, arrayLength);\r\n                    break;\r\n\r\n                default:\r\n                    throw new Error(`FeatureTable : Feature component type not provided for \"${key}\".`);\r\n\r\n            }\r\n\r\n            const dataEnd = arrayStart + arrayLength * data.BYTES_PER_ELEMENT;\r\n            if (dataEnd > binOffset + binLength) {\r\n\r\n                throw new Error('FeatureTable: Feature data read outside binary body length.');\r\n\r\n            }\r\n\r\n            return data;\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport class BatchTable extends FeatureTable {\r\n\r\n    constructor(buffer, batchSize, start, headerLength, binLength) {\r\n\r\n        super(buffer, start, headerLength, binLength);\r\n        this.batchSize = batchSize;\r\n\r\n    }\r\n\r\n    getData(key, componentType = null, type = null) {\r\n\r\n        return super.getData(key, this.batchSize, componentType, type);\r\n\r\n    }\r\n\r\n}\r\n","import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tFloat32BufferAttribute,\n\tInstancedBufferAttribute,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tTrianglesDrawMode,\n\tVector3,\n} from 'three';\n\nfunction computeMikkTSpaceTangents( geometry, MikkTSpace, negateSign = true ) {\n\n\tif ( ! MikkTSpace || ! MikkTSpace.isReady ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Initialized MikkTSpace library required.' );\n\n\t}\n\n\tif ( ! geometry.hasAttribute( 'position' ) || ! geometry.hasAttribute( 'normal' ) || ! geometry.hasAttribute( 'uv' ) ) {\n\n\t\tthrow new Error( 'BufferGeometryUtils: Tangents require \"position\", \"normal\", and \"uv\" attributes.' );\n\n\t}\n\n\tfunction getAttributeArray( attribute ) {\n\n\t\tif ( attribute.normalized || attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst dstArray = new Float32Array( attribute.count * attribute.itemSize );\n\n\t\t\tfor ( let i = 0, j = 0; i < attribute.count; i ++ ) {\n\n\t\t\t\tdstArray[ j ++ ] = attribute.getX( i );\n\t\t\t\tdstArray[ j ++ ] = attribute.getY( i );\n\n\t\t\t\tif ( attribute.itemSize > 2 ) {\n\n\t\t\t\t\tdstArray[ j ++ ] = attribute.getZ( i );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn dstArray;\n\n\t\t}\n\n\t\tif ( attribute.array instanceof Float32Array ) {\n\n\t\t\treturn attribute.array;\n\n\t\t}\n\n\t\treturn new Float32Array( attribute.array );\n\n\t}\n\n\t// MikkTSpace algorithm requires non-indexed input.\n\n\tconst _geometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\n\t// Compute vertex tangents.\n\n\tconst tangents = MikkTSpace.generateTangents(\n\n\t\tgetAttributeArray( _geometry.attributes.position ),\n\t\tgetAttributeArray( _geometry.attributes.normal ),\n\t\tgetAttributeArray( _geometry.attributes.uv )\n\n\t);\n\n\t// Texture coordinate convention of glTF differs from the apparent\n\t// default of the MikkTSpace library; .w component must be flipped.\n\n\tif ( negateSign ) {\n\n\t\tfor ( let i = 3; i < tangents.length; i += 4 ) {\n\n\t\t\ttangents[ i ] *= - 1;\n\n\t\t}\n\n\t}\n\n\t//\n\n\t_geometry.setAttribute( 'tangent', new BufferAttribute( tangents, 4 ) );\n\n\tif ( geometry !== _geometry ) {\n\n\t\tgeometry.copy( _geometry );\n\n\t}\n\n\treturn geometry;\n\n}\n\n/**\n * @param  {Array<BufferGeometry>} geometries\n * @param  {boolean} useGroups\n * @return {BufferGeometry}\n */\nfunction mergeGeometries( geometries, useGroups = false ) {\n\n\tconst isIndexed = geometries[ 0 ].index !== null;\n\n\tconst attributesUsed = new Set( Object.keys( geometries[ 0 ].attributes ) );\n\tconst morphAttributesUsed = new Set( Object.keys( geometries[ 0 ].morphAttributes ) );\n\n\tconst attributes = {};\n\tconst morphAttributes = {};\n\n\tconst morphTargetsRelative = geometries[ 0 ].morphTargetsRelative;\n\n\tconst mergedGeometry = new BufferGeometry();\n\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\tconst geometry = geometries[ i ];\n\t\tlet attributesCount = 0;\n\n\t\t// ensure that all geometries are indexed, or none\n\n\t\tif ( isIndexed !== ( geometry.index !== null ) ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather attributes, exit early if they're different\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tif ( ! attributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. All geometries must have compatible attributes; make sure \"' + name + '\" attribute exists among all geometries, or in none of them.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( attributes[ name ] === undefined ) attributes[ name ] = [];\n\n\t\t\tattributes[ name ].push( geometry.attributes[ name ] );\n\n\t\t\tattributesCount ++;\n\n\t\t}\n\n\t\t// ensure geometries have the same number of attributes\n\n\t\tif ( attributesCount !== attributesUsed.size ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. Make sure all geometries have the same number of attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\t// gather morph attributes, exit early if they're different\n\n\t\tif ( morphTargetsRelative !== geometry.morphTargetsRelative ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. .morphTargetsRelative must be consistent throughout all geometries.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tfor ( const name in geometry.morphAttributes ) {\n\n\t\t\tif ( ! morphAttributesUsed.has( name ) ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '.  .morphAttributes must be consistent throughout all geometries.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tif ( morphAttributes[ name ] === undefined ) morphAttributes[ name ] = [];\n\n\t\t\tmorphAttributes[ name ].push( geometry.morphAttributes[ name ] );\n\n\t\t}\n\n\t\tif ( useGroups ) {\n\n\t\t\tlet count;\n\n\t\t\tif ( isIndexed ) {\n\n\t\t\t\tcount = geometry.index.count;\n\n\t\t\t} else if ( geometry.attributes.position !== undefined ) {\n\n\t\t\t\tcount = geometry.attributes.position.count;\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index ' + i + '. The geometry must have either an index or a position attribute' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.addGroup( offset, count, i );\n\n\t\t\toffset += count;\n\n\t\t}\n\n\t}\n\n\t// merge indices\n\n\tif ( isIndexed ) {\n\n\t\tlet indexOffset = 0;\n\t\tconst mergedIndex = [];\n\n\t\tfor ( let i = 0; i < geometries.length; ++ i ) {\n\n\t\t\tconst index = geometries[ i ].index;\n\n\t\t\tfor ( let j = 0; j < index.count; ++ j ) {\n\n\t\t\t\tmergedIndex.push( index.getX( j ) + indexOffset );\n\n\t\t\t}\n\n\t\t\tindexOffset += geometries[ i ].attributes.position.count;\n\n\t\t}\n\n\t\tmergedGeometry.setIndex( mergedIndex );\n\n\t}\n\n\t// merge attributes\n\n\tfor ( const name in attributes ) {\n\n\t\tconst mergedAttribute = mergeAttributes( attributes[ name ] );\n\n\t\tif ( ! mergedAttribute ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' attribute.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tmergedGeometry.setAttribute( name, mergedAttribute );\n\n\t}\n\n\t// merge morph attributes\n\n\tfor ( const name in morphAttributes ) {\n\n\t\tconst numMorphTargets = morphAttributes[ name ][ 0 ].length;\n\n\t\tif ( numMorphTargets === 0 ) break;\n\n\t\tmergedGeometry.morphAttributes = mergedGeometry.morphAttributes || {};\n\t\tmergedGeometry.morphAttributes[ name ] = [];\n\n\t\tfor ( let i = 0; i < numMorphTargets; ++ i ) {\n\n\t\t\tconst morphAttributesToMerge = [];\n\n\t\t\tfor ( let j = 0; j < morphAttributes[ name ].length; ++ j ) {\n\n\t\t\t\tmorphAttributesToMerge.push( morphAttributes[ name ][ j ][ i ] );\n\n\t\t\t}\n\n\t\t\tconst mergedMorphAttribute = mergeAttributes( morphAttributesToMerge );\n\n\t\t\tif ( ! mergedMorphAttribute ) {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the ' + name + ' morphAttribute.' );\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t\tmergedGeometry.morphAttributes[ name ].push( mergedMorphAttribute );\n\n\t\t}\n\n\t}\n\n\treturn mergedGeometry;\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {BufferAttribute}\n */\nfunction mergeAttributes( attributes ) {\n\n\tlet TypedArray;\n\tlet itemSize;\n\tlet normalized;\n\tlet gpuType = - 1;\n\tlet arrayLength = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( itemSize === undefined ) itemSize = attribute.itemSize;\n\t\tif ( itemSize !== attribute.itemSize ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( normalized === undefined ) normalized = attribute.normalized;\n\t\tif ( normalized !== attribute.normalized ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tif ( gpuType === - 1 ) gpuType = attribute.gpuType;\n\t\tif ( gpuType !== attribute.gpuType ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes.' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.count * itemSize;\n\n\t}\n\n\tconst array = new TypedArray( arrayLength );\n\tconst result = new BufferAttribute( array, itemSize, normalized );\n\tlet offset = 0;\n\n\tfor ( let i = 0; i < attributes.length; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\t\tif ( attribute.isInterleavedBufferAttribute ) {\n\n\t\t\tconst tupleOffset = offset / itemSize;\n\t\t\tfor ( let j = 0, l = attribute.count; j < l; j ++ ) {\n\n\t\t\t\tfor ( let c = 0; c < itemSize; c ++ ) {\n\n\t\t\t\t\tconst value = attribute.getComponent( j, c );\n\t\t\t\t\tresult.setComponent( j + tupleOffset, c, value );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tarray.set( attribute.array, offset );\n\n\t\t}\n\n\t\toffset += attribute.count * itemSize;\n\n\t}\n\n\tif ( gpuType !== undefined ) {\n\n\t\tresult.gpuType = gpuType;\n\n\t}\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferAttribute} attribute\n * @return {BufferAttribute}\n */\nexport function deepCloneAttribute( attribute ) {\n\n\tif ( attribute.isInstancedInterleavedBufferAttribute || attribute.isInterleavedBufferAttribute ) {\n\n\t\treturn deinterleaveAttribute( attribute );\n\n\t}\n\n\tif ( attribute.isInstancedBufferAttribute ) {\n\n\t\treturn new InstancedBufferAttribute().copy( attribute );\n\n\t}\n\n\treturn new BufferAttribute().copy( attribute );\n\n}\n\n/**\n * @param {Array<BufferAttribute>} attributes\n * @return {Array<InterleavedBufferAttribute>}\n */\nfunction interleaveAttributes( attributes ) {\n\n\t// Interleaves the provided attributes into an InterleavedBuffer and returns\n\t// a set of InterleavedBufferAttributes for each attribute\n\tlet TypedArray;\n\tlet arrayLength = 0;\n\tlet stride = 0;\n\n\t// calculate the length and type of the interleavedBuffer\n\tfor ( let i = 0, l = attributes.length; i < l; ++ i ) {\n\n\t\tconst attribute = attributes[ i ];\n\n\t\tif ( TypedArray === undefined ) TypedArray = attribute.array.constructor;\n\t\tif ( TypedArray !== attribute.array.constructor ) {\n\n\t\t\tconsole.error( 'AttributeBuffers of different types cannot be interleaved' );\n\t\t\treturn null;\n\n\t\t}\n\n\t\tarrayLength += attribute.array.length;\n\t\tstride += attribute.itemSize;\n\n\t}\n\n\t// Create the set of buffer attributes\n\tconst interleavedBuffer = new InterleavedBuffer( new TypedArray( arrayLength ), stride );\n\tlet offset = 0;\n\tconst res = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\tfor ( let j = 0, l = attributes.length; j < l; j ++ ) {\n\n\t\tconst attribute = attributes[ j ];\n\t\tconst itemSize = attribute.itemSize;\n\t\tconst count = attribute.count;\n\t\tconst iba = new InterleavedBufferAttribute( interleavedBuffer, itemSize, offset, attribute.normalized );\n\t\tres.push( iba );\n\n\t\toffset += itemSize;\n\n\t\t// Move the data for each attribute into the new interleavedBuffer\n\t\t// at the appropriate offset\n\t\tfor ( let c = 0; c < count; c ++ ) {\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\tiba[ setters[ k ] ]( c, attribute[ getters[ k ] ]( c ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\treturn res;\n\n}\n\n// returns a new, non-interleaved version of the provided attribute\nexport function deinterleaveAttribute( attribute ) {\n\n\tconst cons = attribute.data.array.constructor;\n\tconst count = attribute.count;\n\tconst itemSize = attribute.itemSize;\n\tconst normalized = attribute.normalized;\n\n\tconst array = new cons( count * itemSize );\n\tlet newAttribute;\n\tif ( attribute.isInstancedInterleavedBufferAttribute ) {\n\n\t\tnewAttribute = new InstancedBufferAttribute( array, itemSize, normalized, attribute.meshPerAttribute );\n\n\t} else {\n\n\t\tnewAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t}\n\n\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\tnewAttribute.setX( i, attribute.getX( i ) );\n\n\t\tif ( itemSize >= 2 ) {\n\n\t\t\tnewAttribute.setY( i, attribute.getY( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 3 ) {\n\n\t\t\tnewAttribute.setZ( i, attribute.getZ( i ) );\n\n\t\t}\n\n\t\tif ( itemSize >= 4 ) {\n\n\t\t\tnewAttribute.setW( i, attribute.getW( i ) );\n\n\t\t}\n\n\t}\n\n\treturn newAttribute;\n\n}\n\n// deinterleaves all attributes on the geometry\nexport function deinterleaveGeometry( geometry ) {\n\n\tconst attributes = geometry.attributes;\n\tconst morphTargets = geometry.morphTargets;\n\tconst attrMap = new Map();\n\n\tfor ( const key in attributes ) {\n\n\t\tconst attr = attributes[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tattributes[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n\tfor ( const key in morphTargets ) {\n\n\t\tconst attr = morphTargets[ key ];\n\t\tif ( attr.isInterleavedBufferAttribute ) {\n\n\t\t\tif ( ! attrMap.has( attr ) ) {\n\n\t\t\t\tattrMap.set( attr, deinterleaveAttribute( attr ) );\n\n\t\t\t}\n\n\t\t\tmorphTargets[ key ] = attrMap.get( attr );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @return {number}\n */\nfunction estimateBytesUsed( geometry ) {\n\n\t// Return the estimated memory used by this geometry in bytes\n\t// Calculate using itemSize, count, and BYTES_PER_ELEMENT to account\n\t// for InterleavedBufferAttributes.\n\tlet mem = 0;\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst attr = geometry.getAttribute( name );\n\t\tmem += attr.count * attr.itemSize * attr.array.BYTES_PER_ELEMENT;\n\n\t}\n\n\tconst indices = geometry.getIndex();\n\tmem += indices ? indices.count * indices.itemSize * indices.array.BYTES_PER_ELEMENT : 0;\n\treturn mem;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} tolerance\n * @return {BufferGeometry}\n */\nfunction mergeVertices( geometry, tolerance = 1e-4 ) {\n\n\ttolerance = Math.max( tolerance, Number.EPSILON );\n\n\t// Generate an index buffer if the geometry doesn't have one, or optimize it\n\t// if it's already available.\n\tconst hashToIndex = {};\n\tconst indices = geometry.getIndex();\n\tconst positions = geometry.getAttribute( 'position' );\n\tconst vertexCount = indices ? indices.count : positions.count;\n\n\t// next value for triangle indices\n\tlet nextIndex = 0;\n\n\t// attributes and new attribute arrays\n\tconst attributeNames = Object.keys( geometry.attributes );\n\tconst tmpAttributes = {};\n\tconst tmpMorphAttributes = {};\n\tconst newIndices = [];\n\tconst getters = [ 'getX', 'getY', 'getZ', 'getW' ];\n\tconst setters = [ 'setX', 'setY', 'setZ', 'setW' ];\n\n\t// Initialize the arrays, allocating space conservatively. Extra\n\t// space will be trimmed in the last step.\n\tfor ( let i = 0, l = attributeNames.length; i < l; i ++ ) {\n\n\t\tconst name = attributeNames[ i ];\n\t\tconst attr = geometry.attributes[ name ];\n\n\t\ttmpAttributes[ name ] = new attr.constructor(\n\t\t\tnew attr.array.constructor( attr.count * attr.itemSize ),\n\t\t\tattr.itemSize,\n\t\t\tattr.normalized\n\t\t);\n\n\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\tif ( morphAttributes ) {\n\n\t\t\tif ( ! tmpMorphAttributes[ name ] ) tmpMorphAttributes[ name ] = [];\n\t\t\tmorphAttributes.forEach( ( morphAttr, i ) => {\n\n\t\t\t\tconst array = new morphAttr.array.constructor( morphAttr.count * morphAttr.itemSize );\n\t\t\t\ttmpMorphAttributes[ name ][ i ] = new morphAttr.constructor( array, morphAttr.itemSize, morphAttr.normalized );\n\n\t\t\t} );\n\n\t\t}\n\n\t}\n\n\t// convert the error tolerance to an amount of decimal places to truncate to\n\tconst halfTolerance = tolerance * 0.5;\n\tconst exponent = Math.log10( 1 / tolerance );\n\tconst hashMultiplier = Math.pow( 10, exponent );\n\tconst hashAdditive = halfTolerance * hashMultiplier;\n\tfor ( let i = 0; i < vertexCount; i ++ ) {\n\n\t\tconst index = indices ? indices.getX( i ) : i;\n\n\t\t// Generate a hash for the vertex attributes at the current index 'i'\n\t\tlet hash = '';\n\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\tconst name = attributeNames[ j ];\n\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\tconst itemSize = attribute.itemSize;\n\n\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t// double tilde truncates the decimal value\n\t\t\t\thash += `${ ~ ~ ( attribute[ getters[ k ] ]( index ) * hashMultiplier + hashAdditive ) },`;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Add another reference to the vertex if it's already\n\t\t// used by another index\n\t\tif ( hash in hashToIndex ) {\n\n\t\t\tnewIndices.push( hashToIndex[ hash ] );\n\n\t\t} else {\n\n\t\t\t// copy data to the new index in the temporary attributes\n\t\t\tfor ( let j = 0, l = attributeNames.length; j < l; j ++ ) {\n\n\t\t\t\tconst name = attributeNames[ j ];\n\t\t\t\tconst attribute = geometry.getAttribute( name );\n\t\t\t\tconst morphAttributes = geometry.morphAttributes[ name ];\n\t\t\t\tconst itemSize = attribute.itemSize;\n\t\t\t\tconst newArray = tmpAttributes[ name ];\n\t\t\t\tconst newMorphArrays = tmpMorphAttributes[ name ];\n\n\t\t\t\tfor ( let k = 0; k < itemSize; k ++ ) {\n\n\t\t\t\t\tconst getterFunc = getters[ k ];\n\t\t\t\t\tconst setterFunc = setters[ k ];\n\t\t\t\t\tnewArray[ setterFunc ]( nextIndex, attribute[ getterFunc ]( index ) );\n\n\t\t\t\t\tif ( morphAttributes ) {\n\n\t\t\t\t\t\tfor ( let m = 0, ml = morphAttributes.length; m < ml; m ++ ) {\n\n\t\t\t\t\t\t\tnewMorphArrays[ m ][ setterFunc ]( nextIndex, morphAttributes[ m ][ getterFunc ]( index ) );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\thashToIndex[ hash ] = nextIndex;\n\t\t\tnewIndices.push( nextIndex );\n\t\t\tnextIndex ++;\n\n\t\t}\n\n\t}\n\n\t// generate result BufferGeometry\n\tconst result = geometry.clone();\n\tfor ( const name in geometry.attributes ) {\n\n\t\tconst tmpAttribute = tmpAttributes[ name ];\n\n\t\tresult.setAttribute( name, new tmpAttribute.constructor(\n\t\t\ttmpAttribute.array.slice( 0, nextIndex * tmpAttribute.itemSize ),\n\t\t\ttmpAttribute.itemSize,\n\t\t\ttmpAttribute.normalized,\n\t\t) );\n\n\t\tif ( ! ( name in tmpMorphAttributes ) ) continue;\n\n\t\tfor ( let j = 0; j < tmpMorphAttributes[ name ].length; j ++ ) {\n\n\t\t\tconst tmpMorphAttribute = tmpMorphAttributes[ name ][ j ];\n\n\t\t\tresult.morphAttributes[ name ][ j ] = new tmpMorphAttribute.constructor(\n\t\t\t\ttmpMorphAttribute.array.slice( 0, nextIndex * tmpMorphAttribute.itemSize ),\n\t\t\t\ttmpMorphAttribute.itemSize,\n\t\t\t\ttmpMorphAttribute.normalized,\n\t\t\t);\n\n\t\t}\n\n\t}\n\n\t// indices\n\n\tresult.setIndex( newIndices );\n\n\treturn result;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tif ( drawMode === TrianglesDrawMode ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles.' );\n\t\treturn geometry;\n\n\t}\n\n\tif ( drawMode === TriangleFanDrawMode || drawMode === TriangleStripDrawMode ) {\n\n\t\tlet index = geometry.getIndex();\n\n\t\t// generate index if not present\n\n\t\tif ( index === null ) {\n\n\t\t\tconst indices = [];\n\n\t\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\t\tif ( position !== undefined ) {\n\n\t\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\t\tindices.push( i );\n\n\t\t\t\t}\n\n\t\t\t\tgeometry.setIndex( indices );\n\t\t\t\tindex = geometry.getIndex();\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\t\treturn geometry;\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tconst numberOfTriangles = index.count - 2;\n\t\tconst newIndices = [];\n\n\t\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t\t// gl.TRIANGLE_FAN\n\n\t\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// gl.TRIANGLE_STRIP\n\n\t\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t\t}\n\n\t\t// build final geometry\n\n\t\tconst newGeometry = geometry.clone();\n\t\tnewGeometry.setIndex( newIndices );\n\t\tnewGeometry.clearGroups();\n\n\t\treturn newGeometry;\n\n\t} else {\n\n\t\tconsole.error( 'THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:', drawMode );\n\t\treturn geometry;\n\n\t}\n\n}\n\n/**\n * Calculates the morphed attributes of a morphed/skinned BufferGeometry.\n * Helpful for Raytracing or Decals.\n * @param {Mesh | Line | Points} object An instance of Mesh, Line or Points.\n * @return {Object} An Object with original position/normal attributes and morphed ones.\n */\nfunction computeMorphedAttributes( object ) {\n\n\tconst _vA = new Vector3();\n\tconst _vB = new Vector3();\n\tconst _vC = new Vector3();\n\n\tconst _tempA = new Vector3();\n\tconst _tempB = new Vector3();\n\tconst _tempC = new Vector3();\n\n\tconst _morphA = new Vector3();\n\tconst _morphB = new Vector3();\n\tconst _morphC = new Vector3();\n\n\tfunction _calculateMorphedAttributeData(\n\t\tobject,\n\t\tattribute,\n\t\tmorphAttribute,\n\t\tmorphTargetsRelative,\n\t\ta,\n\t\tb,\n\t\tc,\n\t\tmodifiedAttributeArray\n\t) {\n\n\t\t_vA.fromBufferAttribute( attribute, a );\n\t\t_vB.fromBufferAttribute( attribute, b );\n\t\t_vC.fromBufferAttribute( attribute, c );\n\n\t\tconst morphInfluences = object.morphTargetInfluences;\n\n\t\tif ( morphAttribute && morphInfluences ) {\n\n\t\t\t_morphA.set( 0, 0, 0 );\n\t\t\t_morphB.set( 0, 0, 0 );\n\t\t\t_morphC.set( 0, 0, 0 );\n\n\t\t\tfor ( let i = 0, il = morphAttribute.length; i < il; i ++ ) {\n\n\t\t\t\tconst influence = morphInfluences[ i ];\n\t\t\t\tconst morph = morphAttribute[ i ];\n\n\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t_tempA.fromBufferAttribute( morph, a );\n\t\t\t\t_tempB.fromBufferAttribute( morph, b );\n\t\t\t\t_tempC.fromBufferAttribute( morph, c );\n\n\t\t\t\tif ( morphTargetsRelative ) {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA, influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB, influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC, influence );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t_morphA.addScaledVector( _tempA.sub( _vA ), influence );\n\t\t\t\t\t_morphB.addScaledVector( _tempB.sub( _vB ), influence );\n\t\t\t\t\t_morphC.addScaledVector( _tempC.sub( _vC ), influence );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t_vA.add( _morphA );\n\t\t\t_vB.add( _morphB );\n\t\t\t_vC.add( _morphC );\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tobject.applyBoneTransform( a, _vA );\n\t\t\tobject.applyBoneTransform( b, _vB );\n\t\t\tobject.applyBoneTransform( c, _vC );\n\n\t\t}\n\n\t\tmodifiedAttributeArray[ a * 3 + 0 ] = _vA.x;\n\t\tmodifiedAttributeArray[ a * 3 + 1 ] = _vA.y;\n\t\tmodifiedAttributeArray[ a * 3 + 2 ] = _vA.z;\n\t\tmodifiedAttributeArray[ b * 3 + 0 ] = _vB.x;\n\t\tmodifiedAttributeArray[ b * 3 + 1 ] = _vB.y;\n\t\tmodifiedAttributeArray[ b * 3 + 2 ] = _vB.z;\n\t\tmodifiedAttributeArray[ c * 3 + 0 ] = _vC.x;\n\t\tmodifiedAttributeArray[ c * 3 + 1 ] = _vC.y;\n\t\tmodifiedAttributeArray[ c * 3 + 2 ] = _vC.z;\n\n\t}\n\n\tconst geometry = object.geometry;\n\tconst material = object.material;\n\n\tlet a, b, c;\n\tconst index = geometry.index;\n\tconst positionAttribute = geometry.attributes.position;\n\tconst morphPosition = geometry.morphAttributes.position;\n\tconst morphTargetsRelative = geometry.morphTargetsRelative;\n\tconst normalAttribute = geometry.attributes.normal;\n\tconst morphNormal = geometry.morphAttributes.position;\n\n\tconst groups = geometry.groups;\n\tconst drawRange = geometry.drawRange;\n\tlet i, j, il, jl;\n\tlet group;\n\tlet start, end;\n\n\tconst modifiedPosition = new Float32Array( positionAttribute.count * positionAttribute.itemSize );\n\tconst modifiedNormal = new Float32Array( normalAttribute.count * normalAttribute.itemSize );\n\n\tif ( index !== null ) {\n\n\t\t// indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = index.getX( j );\n\t\t\t\t\tb = index.getX( j + 1 );\n\t\t\t\t\tc = index.getX( j + 2 );\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( index.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = index.getX( i );\n\t\t\t\tb = index.getX( i + 1 );\n\t\t\t\tc = index.getX( i + 2 );\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t} else {\n\n\t\t// non-indexed buffer geometry\n\n\t\tif ( Array.isArray( material ) ) {\n\n\t\t\tfor ( i = 0, il = groups.length; i < il; i ++ ) {\n\n\t\t\t\tgroup = groups[ i ];\n\n\t\t\t\tstart = Math.max( group.start, drawRange.start );\n\t\t\t\tend = Math.min( ( group.start + group.count ), ( drawRange.start + drawRange.count ) );\n\n\t\t\t\tfor ( j = start, jl = end; j < jl; j += 3 ) {\n\n\t\t\t\t\ta = j;\n\t\t\t\t\tb = j + 1;\n\t\t\t\t\tc = j + 2;\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tpositionAttribute,\n\t\t\t\t\t\tmorphPosition,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedPosition\n\t\t\t\t\t);\n\n\t\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\t\tobject,\n\t\t\t\t\t\tnormalAttribute,\n\t\t\t\t\t\tmorphNormal,\n\t\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\t\ta, b, c,\n\t\t\t\t\t\tmodifiedNormal\n\t\t\t\t\t);\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tstart = Math.max( 0, drawRange.start );\n\t\t\tend = Math.min( positionAttribute.count, ( drawRange.start + drawRange.count ) );\n\n\t\t\tfor ( i = start, il = end; i < il; i += 3 ) {\n\n\t\t\t\ta = i;\n\t\t\t\tb = i + 1;\n\t\t\t\tc = i + 2;\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tpositionAttribute,\n\t\t\t\t\tmorphPosition,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedPosition\n\t\t\t\t);\n\n\t\t\t\t_calculateMorphedAttributeData(\n\t\t\t\t\tobject,\n\t\t\t\t\tnormalAttribute,\n\t\t\t\t\tmorphNormal,\n\t\t\t\t\tmorphTargetsRelative,\n\t\t\t\t\ta, b, c,\n\t\t\t\t\tmodifiedNormal\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tconst morphedPositionAttribute = new Float32BufferAttribute( modifiedPosition, 3 );\n\tconst morphedNormalAttribute = new Float32BufferAttribute( modifiedNormal, 3 );\n\n\treturn {\n\n\t\tpositionAttribute: positionAttribute,\n\t\tnormalAttribute: normalAttribute,\n\t\tmorphedPositionAttribute: morphedPositionAttribute,\n\t\tmorphedNormalAttribute: morphedNormalAttribute\n\n\t};\n\n}\n\nfunction mergeGroups( geometry ) {\n\n\tif ( geometry.groups.length === 0 ) {\n\n\t\tconsole.warn( 'THREE.BufferGeometryUtils.mergeGroups(): No groups are defined. Nothing to merge.' );\n\t\treturn geometry;\n\n\t}\n\n\tlet groups = geometry.groups;\n\n\t// sort groups by material index\n\n\tgroups = groups.sort( ( a, b ) => {\n\n\t\tif ( a.materialIndex !== b.materialIndex ) return a.materialIndex - b.materialIndex;\n\n\t\treturn a.start - b.start;\n\n\t} );\n\n\t// create index for non-indexed geometries\n\n\tif ( geometry.getIndex() === null ) {\n\n\t\tconst positionAttribute = geometry.getAttribute( 'position' );\n\t\tconst indices = [];\n\n\t\tfor ( let i = 0; i < positionAttribute.count; i += 3 ) {\n\n\t\t\tindices.push( i, i + 1, i + 2 );\n\n\t\t}\n\n\t\tgeometry.setIndex( indices );\n\n\t}\n\n\t// sort index\n\n\tconst index = geometry.getIndex();\n\n\tconst newIndices = [];\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tconst groupStart = group.start;\n\t\tconst groupLength = groupStart + group.count;\n\n\t\tfor ( let j = groupStart; j < groupLength; j ++ ) {\n\n\t\t\tnewIndices.push( index.getX( j ) );\n\n\t\t}\n\n\t}\n\n\tgeometry.dispose(); // Required to force buffer recreation\n\tgeometry.setIndex( newIndices );\n\n\t// update groups indices\n\n\tlet start = 0;\n\n\tfor ( let i = 0; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tgroup.start = start;\n\t\tstart += group.count;\n\n\t}\n\n\t// merge groups\n\n\tlet currentGroup = groups[ 0 ];\n\n\tgeometry.groups = [ currentGroup ];\n\n\tfor ( let i = 1; i < groups.length; i ++ ) {\n\n\t\tconst group = groups[ i ];\n\n\t\tif ( currentGroup.materialIndex === group.materialIndex ) {\n\n\t\t\tcurrentGroup.count += group.count;\n\n\t\t} else {\n\n\t\t\tcurrentGroup = group;\n\t\t\tgeometry.groups.push( currentGroup );\n\n\t\t}\n\n\t}\n\n\treturn geometry;\n\n}\n\n\n/**\n * Modifies the supplied geometry if it is non-indexed, otherwise creates a new,\n * non-indexed geometry. Returns the geometry with smooth normals everywhere except\n * faces that meet at an angle greater than the crease angle.\n *\n * @param {BufferGeometry} geometry\n * @param {number} [creaseAngle]\n * @return {BufferGeometry}\n */\nfunction toCreasedNormals( geometry, creaseAngle = Math.PI / 3 /* 60 degrees */ ) {\n\n\tconst creaseDot = Math.cos( creaseAngle );\n\tconst hashMultiplier = ( 1 + 1e-10 ) * 1e2;\n\n\t// reusable vectors\n\tconst verts = [ new Vector3(), new Vector3(), new Vector3() ];\n\tconst tempVec1 = new Vector3();\n\tconst tempVec2 = new Vector3();\n\tconst tempNorm = new Vector3();\n\tconst tempNorm2 = new Vector3();\n\n\t// hashes a vector\n\tfunction hashVertex( v ) {\n\n\t\tconst x = ~ ~ ( v.x * hashMultiplier );\n\t\tconst y = ~ ~ ( v.y * hashMultiplier );\n\t\tconst z = ~ ~ ( v.z * hashMultiplier );\n\t\treturn `${x},${y},${z}`;\n\n\t}\n\n\t// BufferGeometry.toNonIndexed() warns if the geometry is non-indexed\n\t// and returns the original geometry\n\tconst resultGeometry = geometry.index ? geometry.toNonIndexed() : geometry;\n\tconst posAttr = resultGeometry.attributes.position;\n\tconst vertexMap = {};\n\n\t// find all the normals shared by commonly located vertices\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\t// add the normal to the map for all vertices\n\t\tconst normal = new Vector3().crossVectors( tempVec1, tempVec2 ).normalize();\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tif ( ! ( hash in vertexMap ) ) {\n\n\t\t\t\tvertexMap[ hash ] = [];\n\n\t\t\t}\n\n\t\t\tvertexMap[ hash ].push( normal );\n\n\t\t}\n\n\t}\n\n\t// average normals from all vertices that share a common location if they are within the\n\t// provided crease threshold\n\tconst normalArray = new Float32Array( posAttr.count * 3 );\n\tconst normAttr = new BufferAttribute( normalArray, 3, false );\n\tfor ( let i = 0, l = posAttr.count / 3; i < l; i ++ ) {\n\n\t\t// get the face normal for this vertex\n\t\tconst i3 = 3 * i;\n\t\tconst a = verts[ 0 ].fromBufferAttribute( posAttr, i3 + 0 );\n\t\tconst b = verts[ 1 ].fromBufferAttribute( posAttr, i3 + 1 );\n\t\tconst c = verts[ 2 ].fromBufferAttribute( posAttr, i3 + 2 );\n\n\t\ttempVec1.subVectors( c, b );\n\t\ttempVec2.subVectors( a, b );\n\n\t\ttempNorm.crossVectors( tempVec1, tempVec2 ).normalize();\n\n\t\t// average all normals that meet the threshold and set the normal value\n\t\tfor ( let n = 0; n < 3; n ++ ) {\n\n\t\t\tconst vert = verts[ n ];\n\t\t\tconst hash = hashVertex( vert );\n\t\t\tconst otherNormals = vertexMap[ hash ];\n\t\t\ttempNorm2.set( 0, 0, 0 );\n\n\t\t\tfor ( let k = 0, lk = otherNormals.length; k < lk; k ++ ) {\n\n\t\t\t\tconst otherNorm = otherNormals[ k ];\n\t\t\t\tif ( tempNorm.dot( otherNorm ) > creaseDot ) {\n\n\t\t\t\t\ttempNorm2.add( otherNorm );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\ttempNorm2.normalize();\n\t\t\tnormAttr.setXYZ( i3 + n, tempNorm2.x, tempNorm2.y, tempNorm2.z );\n\n\t\t}\n\n\t}\n\n\tresultGeometry.setAttribute( 'normal', normAttr );\n\treturn resultGeometry;\n\n}\n\nexport {\n\tcomputeMikkTSpaceTangents,\n\tmergeGeometries,\n\tmergeAttributes,\n\tinterleaveAttributes,\n\testimateBytesUsed,\n\tmergeVertices,\n\ttoTrianglesDrawMode,\n\tcomputeMorphedAttributes,\n\tmergeGroups,\n\ttoCreasedNormals\n};\n","import * as THREE from 'three';\r\nimport { FeatureTable, BatchTable } from './FeatureTable';\r\nimport * as BufferGeometryUtils from 'three/addons/utils/BufferGeometryUtils.js';\r\n\r\n\r\n\r\n\r\nclass B3DMDecoder {\r\n\tconstructor(aGltfLoader) {\r\n\t\tthis.gltfLoader = aGltfLoader;\r\n\t\tthis.tempMatrix = new THREE.Matrix4();\r\n\r\n\t\tthis.zUpToYUpMatrix = new THREE.Matrix4();\r\n\t\tthis.zUpToYUpMatrix.set(\r\n\t\t\t1, 0, 0, 0,\r\n\t\t\t0, 0, -1, 0,\r\n\t\t\t0, 1, 0, 0,\r\n\t\t\t0, 0, 0, 1);\r\n\r\n\t}\r\n\r\n\tparseB3DM(arrayBuffer, meshCallback, sceneZupToYUp, meshZUpToYUp) {\r\n\t\tconst self = this;\r\n\t\tconst dataView = new DataView(arrayBuffer);\r\n\r\n\t\tconst magic =\r\n\t\t\tString.fromCharCode(dataView.getUint8(0)) +\r\n\t\t\tString.fromCharCode(dataView.getUint8(1)) +\r\n\t\t\tString.fromCharCode(dataView.getUint8(2)) +\r\n\t\t\tString.fromCharCode(dataView.getUint8(3));\r\n\t\tconsole.assert(magic === 'b3dm');\r\n\r\n\t\tconst byteLength = dataView.getUint32(8, true);\r\n\t\tconsole.assert(byteLength === arrayBuffer.byteLength);\r\n\r\n\t\tconst featureTableJSONByteLength = dataView.getUint32(12, true);\r\n\t\tconst featureTableBinaryByteLength = dataView.getUint32(16, true);\r\n\t\tconst batchTableJSONByteLength = dataView.getUint32(20, true);\r\n\t\tconst batchTableBinaryByteLength = dataView.getUint32(24, true);\r\n\r\n\t\tconst featureTableStart = 28;\r\n\t\tconst featureTable = new FeatureTable(arrayBuffer, featureTableStart, featureTableJSONByteLength, featureTableBinaryByteLength);\r\n\r\n\t\tconst batchTableStart = featureTableStart + featureTableJSONByteLength + featureTableBinaryByteLength;\r\n\t\tconst batchTable = new BatchTable(arrayBuffer, featureTable.getData('BATCH_LENGTH'), batchTableStart, batchTableJSONByteLength, batchTableBinaryByteLength);\r\n\r\n\t\tconst glbStart = batchTableStart + batchTableJSONByteLength + batchTableBinaryByteLength;\r\n\t\tconst glbBytes = new Uint8Array(arrayBuffer, glbStart, byteLength - glbStart);\r\n\r\n\r\n\t\tconst gltfBuffer = glbBytes.slice().buffer;\r\n\r\n\r\n\t\treturn new Promise(async (resolve, reject) => {\r\n\t\t\tawait this.checkLoaderInitialized();\r\n\t\t\tthis.gltfLoader.parse(gltfBuffer, null, model => {\r\n\t\t\t\tconst rtcCenter = featureTable.getData('RTC_CENTER');\r\n\t\t\t\tif (rtcCenter) {\r\n\t\t\t\t\tthis.tempMatrix.makeTranslation(rtcCenter[0], rtcCenter[1], rtcCenter[2])\r\n\t\t\t\t\tmodel.scene.applyMatrix4(this.tempMatrix);\r\n\t\t\t\t} else if (!!model.userData.gltfExtensions && !!model.userData.gltfExtensions.CESIUM_RTC) {\r\n\t\t\t\t\tthis.tempMatrix.makeTranslation(model.userData.gltfExtensions.CESIUM_RTC.center[0], model.userData.gltfExtensions.CESIUM_RTC.center[1], model.userData.gltfExtensions.CESIUM_RTC.center[2])\r\n\t\t\t\t\tmodel.scene.applyMatrix4(this.tempMatrix);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (sceneZupToYUp) {\r\n\t\t\t\t\tmodel.scene.applyMatrix4(self.zUpToYUpMatrix);\r\n\t\t\t\t}\r\n\t\t\t\tmodel.scene.asset = model.asset;\r\n\t\t\t\tmodel.scene.traverse((o) => {\r\n\r\n\t\t\t\t\tif (o.isMesh) {\r\n\t\t\t\t\t\tif (meshZUpToYUp) {\r\n\t\t\t\t\t\t\to.applyMatrix4(self.zUpToYUpMatrix);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!!meshCallback) {\r\n\t\t\t\t\t\t\tmeshCallback(o);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tresolve(model.scene);\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tcheckLoaderInitialized = async () => {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tconst interval = setInterval(() => {\r\n\t\t\t\tif ((!this.gltfLoader.hasDracoLoader || this.gltfLoader.dracoLoader) && (!this.gltfLoader.hasKTX2Loader || this.gltfLoader.ktx2Loader)) {\r\n\t\t\t\t\tclearInterval(interval);\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t}, 10); // check every 100ms\r\n\t\t});\r\n\t};\r\n\tparseB3DMInstanced(arrayBuffer, meshCallback, maxCount, sceneZupToYUp, meshZupToYup) { // expects GLTF with one node level\r\n\r\n\t\treturn this.parseB3DM(arrayBuffer, meshCallback, sceneZupToYUp, meshZupToYup).then(mesh => {\r\n\t\t\t// todo several meshes in a single gltf\r\n\t\t\tlet instancedMesh;\r\n\t\t\tlet geometries = [];\r\n\t\t\tlet materials = [];\r\n\t\t\tmesh.updateWorldMatrix(false, true)\r\n\t\t\tmesh.traverse(child => {\r\n\t\t\t\tif (child.isMesh) {\r\n\t\t\t\t\tchild.geometry.applyMatrix4(child.matrixWorld);\r\n\t\t\t\t\tgeometries.push(child.geometry);\r\n\t\t\t\t\tmaterials.push(child.material);\r\n\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tlet mergedGeometry = normalizeAndMergeGeometries(geometries);\r\n\t\t\tinstancedMesh = new THREE.InstancedMesh(mergedGeometry, materials, maxCount);\r\n\t\t\tinstancedMesh.baseMatrix = new THREE.Matrix4().identity();\r\n\t\t\treturn instancedMesh;\r\n\t\t});\r\n\r\n\t}\r\n}\r\nexport { B3DMDecoder }\r\n\r\nfunction normalizeAndMergeGeometries(geometries) {\r\n\t// Identify all unique attributes across all geometries.\r\n\tlet allAttributes = new Set();\r\n\tgeometries.forEach(geometry => {\r\n\t\tfor (let attribute in geometry.attributes) {\r\n\t\t\tallAttributes.add(attribute);\r\n\t\t}\r\n\t});\r\n\r\n\t// Ensure every geometry has every attribute, adding default filled ones if necessary.\r\n\tgeometries.forEach(geometry => {\r\n\t\tallAttributes.forEach(attribute => {\r\n\t\t\tif (!geometry.attributes[attribute]) {\r\n\t\t\t\tconst attributeSize = getAttributeSize(attribute);\r\n\t\t\t\tconst buffer = new Float32Array(attributeSize * geometry.getAttribute('position').count).fill(0);\r\n\t\t\t\tgeometry.setAttribute(attribute, new THREE.BufferAttribute(buffer, attributeSize));\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t// Now merge the geometries.\r\n\tlet mergedGeometry = BufferGeometryUtils.mergeGeometries(geometries, true);\r\n\treturn mergedGeometry;\r\n}\r\n\r\nfunction getAttributeSize(attribute) {\r\n\tswitch (attribute) {\r\n\t\tcase 'position':\r\n\t\tcase 'normal':\r\n\t\tcase 'color':\r\n\t\t\treturn 3;\r\n\t\tcase 'uv':\r\n\t\tcase 'uv2':\r\n\t\t\treturn 2;\r\n\t\t// Add other attribute cases as needed.\r\n\t\tdefault:\r\n\t\t\tthrow new Error(`Unknown attribute ${attribute}`);\r\n\t}\r\n}\r\n\r\n","import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n","let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n","const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nexport default v4;\n","import * as THREE from 'three';\r\nimport { v4 as uuidv4 } from \"uuid\";\r\n\r\nconst workers = [];\r\nlet workerCounter = 0;\r\nclass SplatsDecoder {\r\n\r\n\tconstructor(gltfLoader, renderer) {\r\n\t\tconst self = this;\r\n\t\tself.renderer = renderer;\r\n\t\tself.gltfLoader = gltfLoader;\r\n\t}\r\n\r\n\tparseSplats(arrayBuffer, sceneZupToYUp, meshZUpToYUp, splatsMesh) {\r\n\t\tconst self = this;\r\n\t\treturn new Promise(async (resolve, reject) => {\r\n\t\t\tawait self.checkLoaderInitialized();\r\n\t\t\tself.gltfLoader.parse(arrayBuffer, null, model => {\r\n\t\t\t\tconst scene = model.scene;\r\n\t\t\t\tconst decoded = model.scene.children[0];\r\n\t\t\t\tconst positions = decoded.geometry.attributes.position;\r\n\t\t\t\tconst colors = decoded.geometry.attributes.color;\r\n\t\t\t\tconst cov0 = decoded.geometry.attributes.cov_0;\r\n\t\t\t\tconst cov1 = decoded.geometry.attributes.cov_1;\r\n\t\t\t\tconst splatTile = splatsMesh.addSplatsTile(positions, colors, cov0, cov1);\r\n\t\t\t\tmodel.scene.traverse(o=>{\r\n\t\t\t\t\tif(o.dispose) o.dispose();\r\n\t\t\t\t})\r\n\t\t\t\tresolve(splatTile);\r\n\t\t\t\t\r\n\t\t\t}, error => {\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tcheckLoaderInitialized = async () => {\r\n\t\tconst self = this;\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tconst interval = setInterval(() => {\r\n\t\t\t\tif ((!self.gltfLoader.hasDracoLoader || self.gltfLoader.dracoLoader) && (!self.gltfLoader.hasKTX2Loader || self.gltfLoader.ktx2Loader)) {\r\n\t\t\t\t\tclearInterval(interval);\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}\r\n\t\t\t}, 10); \r\n\t\t});\r\n\t};\r\n} export { SplatsDecoder };\r\n\r\n","import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tColorManagement,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInstancedMesh,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLinearSRGBColorSpace,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tSRGBColorSpace,\n\tInstancedBufferAttribute\n} from 'three';\nimport { toTrianglesDrawMode } from '../utils/BufferGeometryUtils.js';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsDispersionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureAVIFExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSheenExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsVolumeExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIorExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsEmissiveStrengthExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSpecularExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIridescenceExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsAnisotropyExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsBumpExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshGpuInstancing( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\t// If a base path is set, resources will be relative paths from that plus the relative path of the gltf file\n\t\t\t// Example  path = 'https://my-cnd-server.com/', url = 'assets/models/model.gltf'\n\t\t\t// resourcePath = 'https://my-cnd-server.com/assets/models/'\n\t\t\t// referenced resource 'model.bin' will be loaded from 'https://my-cnd-server.com/assets/models/model.bin'\n\t\t\t// referenced resource '../textures/texture.png' will be loaded from 'https://my-cnd-server.com/assets/textures/texture.png'\n\t\t\tconst relativeUrl = LoaderUtils.extractUrlBase( url );\n\t\t\tresourcePath = LoaderUtils.resolveURL( relativeUrl, this.path );\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet json;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tjson = JSON.parse( data );\n\n\t\t} else if ( data instanceof ArrayBuffer ) {\n\n\t\t\tconst magic = textDecoder.decode( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tjson = JSON.parse( extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content );\n\n\t\t\t} else {\n\n\t\t\t\tjson = JSON.parse( textDecoder.decode( data ) );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tjson = data;\n\n\t\t}\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\n\t\t\tif ( ! plugin.name ) console.error( 'THREE.GLTFLoader: Invalid plugin found: missing name' );\n\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n\tparseAsync( data, path ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.parse( data, path, resolve, reject );\n\n\t\t} );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_DISPERSION: 'KHR_materials_dispersion',\n\tKHR_MATERIALS_IOR: 'KHR_materials_ior',\n\tKHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n\tKHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_IRIDESCENCE: 'KHR_materials_iridescence',\n\tKHR_MATERIALS_ANISOTROPY: 'KHR_materials_anisotropy',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tKHR_MATERIALS_EMISSIVE_STRENGTH: 'KHR_materials_emissive_strength',\n\tEXT_MATERIALS_BUMP: 'EXT_materials_bump',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_TEXTURE_AVIF: 'EXT_texture_avif',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression',\n\tEXT_MESH_GPU_INSTANCING: 'EXT_mesh_gpu_instancing'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.setRGB( lightDef.color[ 0 ], lightDef.color[ 1 ], lightDef.color[ 2 ], LinearSRGBColorSpace );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tassignExtrasToUserData( lightNode, lightDef );\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tgetDependency( type, index ) {\n\n\t\tif ( type !== 'light' ) return;\n\n\t\treturn this._loadLight( index );\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Emissive Strength Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/blob/5768b3ce0ef32bc39cdf1bef10b948586635ead3/extensions/2.0/Khronos/KHR_materials_emissive_strength/README.md\n */\nclass GLTFMaterialsEmissiveStrengthExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_EMISSIVE_STRENGTH;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst emissiveStrength = materialDef.extensions[ this.name ].emissiveStrength;\n\n\t\tif ( emissiveStrength !== undefined ) {\n\n\t\t\tmaterialParams.emissiveIntensity = emissiveStrength;\n\n\t\t}\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials dispersion Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_dispersion\n */\nclass GLTFMaterialsDispersionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_DISPERSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.dispersion = extension.dispersion !== undefined ? extension.dispersion : 0;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Iridescence Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_iridescence\n */\nclass GLTFMaterialsIridescenceExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IRIDESCENCE;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.iridescenceFactor !== undefined ) {\n\n\t\t\tmaterialParams.iridescence = extension.iridescenceFactor;\n\n\t\t}\n\n\t\tif ( extension.iridescenceTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceMap', extension.iridescenceTexture ) );\n\n\t\t}\n\n\t\tif ( extension.iridescenceIor !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceIOR = extension.iridescenceIor;\n\n\t\t}\n\n\t\tif ( materialParams.iridescenceThicknessRange === undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange = [ 100, 400 ];\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMinimum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 0 ] = extension.iridescenceThicknessMinimum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessMaximum !== undefined ) {\n\n\t\t\tmaterialParams.iridescenceThicknessRange[ 1 ] = extension.iridescenceThicknessMaximum;\n\n\t\t}\n\n\t\tif ( extension.iridescenceThicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'iridescenceThicknessMap', extension.iridescenceThicknessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.sheenColor = new Color( 0, 0, 0 );\n\t\tmaterialParams.sheenRoughness = 0;\n\t\tmaterialParams.sheen = 1;\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.sheenColorFactor !== undefined ) {\n\n\t\t\tconst colorFactor = extension.sheenColorFactor;\n\t\t\tmaterialParams.sheenColor.setRGB( colorFactor[ 0 ], colorFactor[ 1 ], colorFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenRoughness = extension.sheenRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.sheenColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenColorMap', extension.sheenColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.thickness = extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n\t\tif ( extension.thicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'thicknessMap', extension.thicknessTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.attenuationDistance = extension.attenuationDistance || Infinity;\n\n\t\tconst colorArray = extension.attenuationColor || [ 1, 1, 1 ];\n\t\tmaterialParams.attenuationColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IOR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.specularIntensity = extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n\t\tif ( extension.specularTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularIntensityMap', extension.specularTexture ) );\n\n\t\t}\n\n\t\tconst colorArray = extension.specularColorFactor || [ 1, 1, 1 ];\n\t\tmaterialParams.specularColor = new Color().setRGB( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ], LinearSRGBColorSpace );\n\n\t\tif ( extension.specularColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularColorMap', extension.specularColorTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n\n/**\n * Materials bump Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/EXT_materials_bump\n */\nclass GLTFMaterialsBumpExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_MATERIALS_BUMP;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.bumpScale = extension.bumpFactor !== undefined ? extension.bumpFactor : 1.0;\n\n\t\tif ( extension.bumpTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'bumpMap', extension.bumpTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials anisotropy Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_anisotropy\n */\nclass GLTFMaterialsAnisotropyExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_ANISOTROPY;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.anisotropyStrength !== undefined ) {\n\n\t\t\tmaterialParams.anisotropy = extension.anisotropyStrength;\n\n\t\t}\n\n\t\tif ( extension.anisotropyRotation !== undefined ) {\n\n\t\t\tmaterialParams.anisotropyRotation = extension.anisotropyRotation;\n\n\t\t}\n\n\t\tif ( extension.anisotropyTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'anisotropyMap', extension.anisotropyTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * AVIF Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_avif\n */\nclass GLTFTextureAVIFExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_AVIF;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, extension.source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: AVIF required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image.\n\t\t\t\timage.src = 'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=';\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn buffer.then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst source = new Uint8Array( res, byteOffset, byteLength );\n\n\t\t\t\tif ( decoder.decodeGltfBufferAsync ) {\n\n\t\t\t\t\treturn decoder.decodeGltfBufferAsync( count, stride, source, extensionDef.mode, extensionDef.filter ).then( function ( res ) {\n\n\t\t\t\t\t\treturn res.buffer;\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Support for MeshoptDecoder 0.18 or earlier, without decodeGltfBufferAsync\n\t\t\t\t\treturn decoder.ready.then( function () {\n\n\t\t\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\t\t\treturn result;\n\n\t\t\t\t\t} );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * GPU Instancing Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_mesh_gpu_instancing\n *\n */\nclass GLTFMeshGpuInstancing {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESH_GPU_INSTANCING;\n\t\tthis.parser = parser;\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( ! nodeDef.extensions || ! nodeDef.extensions[ this.name ] ||\n\t\t\tnodeDef.mesh === undefined ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst meshDef = json.meshes[ nodeDef.mesh ];\n\n\t\t// No Points or Lines + Instancing support yet\n\n\t\tfor ( const primitive of meshDef.primitives ) {\n\n\t\t\tif ( primitive.mode !== WEBGL_CONSTANTS.TRIANGLES &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_STRIP &&\n\t\t\t\t primitive.mode !== WEBGL_CONSTANTS.TRIANGLE_FAN &&\n\t\t\t\t primitive.mode !== undefined ) {\n\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst extensionDef = nodeDef.extensions[ this.name ];\n\t\tconst attributesDef = extensionDef.attributes;\n\n\t\t// @TODO: Can we support InstancedMesh + SkinnedMesh?\n\n\t\tconst pending = [];\n\t\tconst attributes = {};\n\n\t\tfor ( const key in attributesDef ) {\n\n\t\t\tpending.push( this.parser.getDependency( 'accessor', attributesDef[ key ] ).then( accessor => {\n\n\t\t\t\tattributes[ key ] = accessor;\n\t\t\t\treturn attributes[ key ];\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tif ( pending.length < 1 ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tpending.push( this.parser.createNodeMesh( nodeIndex ) );\n\n\t\treturn Promise.all( pending ).then( results => {\n\n\t\t\tconst nodeObject = results.pop();\n\t\t\tconst meshes = nodeObject.isGroup ? nodeObject.children : [ nodeObject ];\n\t\t\tconst count = results[ 0 ].count; // All attribute counts should be same\n\t\t\tconst instancedMeshes = [];\n\n\t\t\tfor ( const mesh of meshes ) {\n\n\t\t\t\t// Temporal variables\n\t\t\t\tconst m = new Matrix4();\n\t\t\t\tconst p = new Vector3();\n\t\t\t\tconst q = new Quaternion();\n\t\t\t\tconst s = new Vector3( 1, 1, 1 );\n\n\t\t\t\tconst instancedMesh = new InstancedMesh( mesh.geometry, mesh.material, count );\n\n\t\t\t\tfor ( let i = 0; i < count; i ++ ) {\n\n\t\t\t\t\tif ( attributes.TRANSLATION ) {\n\n\t\t\t\t\t\tp.fromBufferAttribute( attributes.TRANSLATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.ROTATION ) {\n\n\t\t\t\t\t\tq.fromBufferAttribute( attributes.ROTATION, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.SCALE ) {\n\n\t\t\t\t\t\ts.fromBufferAttribute( attributes.SCALE, i );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tinstancedMesh.setMatrixAt( i, m.compose( p, q, s ) );\n\n\t\t\t\t}\n\n\t\t\t\t// Add instance attributes to the geometry, excluding TRS.\n\t\t\t\tfor ( const attributeName in attributes ) {\n\n\t\t\t\t\tif ( attributeName === '_COLOR_0' ) {\n\n\t\t\t\t\t\tconst attr = attributes[ attributeName ];\n\t\t\t\t\t\tinstancedMesh.instanceColor = new InstancedBufferAttribute( attr.array, attr.itemSize, attr.normalized );\n\n\t\t\t\t\t} else if ( attributeName !== 'TRANSLATION' &&\n\t\t\t\t\t\t attributeName !== 'ROTATION' &&\n\t\t\t\t\t\t attributeName !== 'SCALE' ) {\n\n\t\t\t\t\t\tmesh.geometry.setAttribute( attributeName, attributes[ attributeName ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t// Just in case\n\t\t\t\tObject3D.prototype.copy.call( instancedMesh, mesh );\n\n\t\t\t\tthis.parser.assignFinalMaterial( instancedMesh );\n\n\t\t\t\tinstancedMeshes.push( instancedMesh );\n\n\t\t\t}\n\n\t\t\tif ( nodeObject.isGroup ) {\n\n\t\t\t\tnodeObject.clear();\n\n\t\t\t\tnodeObject.add( ... instancedMeshes );\n\n\t\t\t\treturn nodeObject;\n\n\t\t\t}\n\n\t\t\treturn instancedMeshes[ 0 ];\n\n\t\t} );\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tconst textDecoder = new TextDecoder();\n\n\t\tthis.header = {\n\t\t\tmagic: textDecoder.decode( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = textDecoder.decode( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType.name;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap, LinearSRGBColorSpace, reject );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( ( transform.texCoord === undefined || transform.texCoord === texture.channel )\n\t\t\t&& transform.offset === undefined\n\t\t\t&& transform.rotation === undefined\n\t\t\t&& transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\ttexture.channel = transform.texCoord;\n\n\t\t}\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = this.resultBuffer;\n\t\tconst values = this.sampleValues;\n\t\tconst stride = this.valueSize;\n\n\t\tconst stride2 = stride * 2;\n\t\tconst stride3 = stride * 3;\n\n\t\tconst td = t1 - t0;\n\n\t\tconst p = ( t - t0 ) / td;\n\t\tconst pp = p * p;\n\t\tconst ppp = pp * p;\n\n\t\tconst offset1 = i1 * stride3;\n\t\tconst offset0 = offset1 - stride3;\n\n\t\tconst s2 = - 2 * ppp + 3 * pp;\n\t\tconst s3 = ppp - pp;\n\t\tconst s0 = 1 - s2;\n\t\tconst s1 = s3 - pp + p;\n\n\t\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\t\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = super.interpolate_( i1, t0, t, t1 );\n\n\t\t_q.fromArray( result ).normalize().toArray( result );\n\n\t\treturn result;\n\n\t}\n\n}\n\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv1',\n\tTEXCOORD_2: 'uv2',\n\tTEXCOORD_3: 'uv3',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n *\n * @param {Object<string, Material>} cache\n * @return {Material}\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\tlet hasMorphColor = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\t\tif ( target.COLOR_0 !== undefined ) hasMorphColor = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal && hasMorphColor ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal && ! hasMorphColor ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\tconst pendingColorAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphColor ) {\n\n\t\t\tconst pendingAccessor = target.COLOR_0 !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.COLOR_0 )\n\t\t\t\t: geometry.attributes.color;\n\n\t\t\tpendingColorAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors ),\n\t\tPromise.all( pendingColorAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\t\tconst morphColors = accessors[ 2 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tif ( hasMorphColor ) geometry.morphAttributes.color = morphColors;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tlet geometryKey;\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\tif ( primitiveDef.targets !== undefined ) {\n\n\t\tfor ( let i = 0, il = primitiveDef.targets.length; i < il; i ++ ) {\n\n\t\t\tgeometryKey += ':' + createAttributesKey( primitiveDef.targets[ i ] );\n\n\t\t}\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\nfunction getImageURIMimeType( uri ) {\n\n\tif ( uri.search( /\\.jpe?g($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/jpeg/ ) === 0 ) return 'image/jpeg';\n\tif ( uri.search( /\\.webp($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/webp/ ) === 0 ) return 'image/webp';\n\tif ( uri.search( /\\.ktx2($|\\?)/i ) > 0 || uri.search( /^data\\:image\\/ktx2/ ) === 0 ) return 'image/ktx2';\n\n\treturn 'image/png';\n\n}\n\nconst _identityMatrix = new Matrix4();\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Node cache\n\t\tthis.nodeCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.sourceCache = {};\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\n\t\tlet isSafari = false;\n\t\tlet safariVersion = - 1;\n\t\tlet isFirefox = false;\n\t\tlet firefoxVersion = - 1;\n\n\t\tif ( typeof navigator !== 'undefined' ) {\n\n\t\t\tconst userAgent = navigator.userAgent;\n\n\t\t\tisSafari = /^((?!chrome|android).)*safari/i.test( userAgent ) === true;\n\t\t\tconst safariMatch = userAgent.match( /Version\\/(\\d+)/ );\n\t\t\tsafariVersion = isSafari && safariMatch ? parseInt( safariMatch[ 1 ], 10 ) : - 1;\n\n\t\t\tisFirefox = userAgent.indexOf( 'Firefox' ) > - 1;\n\t\t\tfirefoxVersion = isFirefox ? userAgent.match( /Firefox\\/([0-9]+)\\./ )[ 1 ] : - 1;\n\n\t\t}\n\n\t\tif ( typeof createImageBitmap === 'undefined' || ( isSafari && safariVersion < 17 ) || ( isFirefox && firefoxVersion < 98 ) ) {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\t\tthis.nodeCache = {};\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\treturn Promise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tfor ( const scene of result.scenes ) {\n\n\t\t\t\t\tscene.updateMatrixWorld();\n\n\t\t\t\t}\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t *\n\t * @param {Object} cache\n\t * @param {Object3D} index\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/**\n\t * Returns a reference to a shared resource, cloning it if necessary.\n\t *\n\t * @param {Object} cache\n\t * @param {number} index\n\t * @param {Object} object\n\t * @return {Object}\n\t */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\t// Propagates mappings to the cloned object, prevents mappings on the\n\t\t// original object from being lost.\n\t\tconst updateMappings = ( original, clone ) => {\n\n\t\t\tconst mappings = this.associations.get( original );\n\t\t\tif ( mappings != null ) {\n\n\t\t\t\tthis.associations.set( clone, mappings );\n\n\t\t\t}\n\n\t\t\tfor ( const [ i, child ] of original.children.entries() ) {\n\n\t\t\t\tupdateMappings( child, clone.children[ i ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tupdateMappings( object, ref );\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadNode && ext.loadNode( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadAnimation && ext.loadAnimation( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext != this && ext.getDependency && ext.getDependency( type, index );\n\n\t\t\t\t\t} );\n\n\t\t\t\t\tif ( ! dependency ) {\n\n\t\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( LoaderUtils.resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\t\t\tconst normalized = accessorDef.normalized === true;\n\n\t\t\tconst array = new TypedArray( accessorDef.count * itemSize );\n\t\t\treturn Promise.resolve( new BufferAttribute( array, itemSize, normalized ) );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\t// Ignore normalized since we copy from sparse\n\t\t\t\tbufferAttribute.normalized = false;\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute.normalized = normalized;\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture|null>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceIndex = textureDef.source;\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( sourceDef.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( sourceDef.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, sourceIndex, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst cacheKey = ( sourceDef.uri || sourceDef.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\n\t\tconst promise = this.loadImageSource( sourceIndex, loader ).then( function ( texture ) {\n\n\t\t\ttexture.flipY = false;\n\n\t\t\ttexture.name = textureDef.name || sourceDef.name || '';\n\n\t\t\tif ( texture.name === '' && typeof sourceDef.uri === 'string' && sourceDef.uri.startsWith( 'data:image/' ) === false ) {\n\n\t\t\t\ttexture.name = sourceDef.uri;\n\n\t\t\t}\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\t\t\ttexture.generateMipmaps = ! texture.isCompressedTexture && texture.minFilter !== NearestFilter && texture.minFilter !== LinearFilter;\n\n\t\t\tparser.associations.set( texture, { textures: textureIndex } );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\tloadImageSource( sourceIndex, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tif ( this.sourceCache[ sourceIndex ] !== undefined ) {\n\n\t\t\treturn this.sourceCache[ sourceIndex ].then( ( texture ) => texture.clone() );\n\n\t\t}\n\n\t\tconst sourceDef = json.images[ sourceIndex ];\n\n\t\tconst URL = self.URL || self.webkitURL;\n\n\t\tlet sourceURI = sourceDef.uri || '';\n\t\tlet isObjectURL = false;\n\n\t\tif ( sourceDef.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', sourceDef.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: sourceDef.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( sourceDef.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + sourceIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( LoaderUtils.resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( texture, sourceDef );\n\n\t\t\ttexture.userData.mimeType = sourceDef.mimeType || getImageURIMimeType( sourceDef.uri );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function ( error ) {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\tthrow error;\n\n\t\t} );\n\n\t\tthis.sourceCache[ sourceIndex ] = promise;\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t *\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @param {string} colorSpace\n\t * @return {Promise<Texture>}\n\t */\n\tassignTexture( materialParams, mapName, mapDef, colorSpace ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\tif ( ! texture ) return null;\n\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord > 0 ) {\n\n\t\t\t\ttexture = texture.clone();\n\t\t\t\ttexture.channel = mapDef.texCoord;\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( colorSpace !== undefined ) {\n\n\t\t\t\ttexture.colorSpace = colorSpace;\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useDerivativeTangents = geometry.attributes.tangent === undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\t\t\t\tlineMaterial.map = material.map;\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useDerivativeTangents || useVertexColors || useFlatShading ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( useDerivativeTangents ) cacheKey += 'derivative-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\n\t\t\t\tif ( useDerivativeTangents ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.setRGB( array[ 0 ], array[ 1 ], array[ 2 ], LinearSRGBColorSpace );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture, SRGBColorSpace ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = materialDef.normalTexture.scale;\n\n\t\t\t\tmaterialParams.normalScale.set( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tconst emissiveFactor = materialDef.emissiveFactor;\n\t\t\tmaterialParams.emissive = new Color().setRGB( emissiveFactor[ 0 ], emissiveFactor[ 1 ], emissiveFactor[ 2 ], LinearSRGBColorSpace );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture, SRGBColorSpace ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tconst material = new materialType( materialParams );\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { materials: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * When Object3D instances are targeted by animation, they need unique names.\n\t *\n\t * @param {string} originalName\n\t * @return {string}\n\t */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tif ( sanitizedName in this.nodeNamesUsed ) {\n\n\t\t\treturn sanitizedName + '_' + ( ++ this.nodeNamesUsed[ sanitizedName ] );\n\n\t\t} else {\n\n\t\t\tthis.nodeNamesUsed[ sanitizedName ] = 0;\n\n\t\t\treturn sanitizedName;\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true ) {\n\n\t\t\t\t\t\t// normalize skin weights to fix malformed assets (see #15319)\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tparser.associations.set( meshes[ i ], {\n\t\t\t\t\tmeshes: meshIndex,\n\t\t\t\t\tprimitives: i\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, meshes[ 0 ], meshDef );\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tif ( meshDef.extensions ) addUnknownExtensionsToUserData( extensions, group, meshDef );\n\n\t\t\tparser.associations.set( group, { meshes: meshIndex } );\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Skeleton>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = skinDef.joints.length; i < il; i ++ ) {\n\n\t\t\tpending.push( this._loadNodeShallow( skinDef.joints[ i ] ) );\n\n\t\t}\n\n\t\tif ( skinDef.inverseBindMatrices !== undefined ) {\n\n\t\t\tpending.push( this.getDependency( 'accessor', skinDef.inverseBindMatrices ) );\n\n\t\t} else {\n\n\t\t\tpending.push( null );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst inverseBindMatrices = results.pop();\n\t\t\tconst jointNodes = results;\n\n\t\t\t// Note that bones (joint nodes) may or may not be in the\n\t\t\t// scene graph at this time.\n\n\t\t\tconst bones = [];\n\t\t\tconst boneInverses = [];\n\n\t\t\tfor ( let i = 0, il = jointNodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst jointNode = jointNodes[ i ];\n\n\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\tif ( inverseBindMatrices !== null ) {\n\n\t\t\t\t\t\tmat.fromArray( inverseBindMatrices.array, i * 16 );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinDef.joints[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new Skeleton( bones, boneInverses );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\t\tconst animationName = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node;\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tif ( target.node === undefined ) continue;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tif ( node.updateMatrix ) {\n\n\t\t\t\t\tnode.updateMatrix();\n\n\t\t\t\t}\n\n\t\t\t\tconst createdTracks = parser._createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target );\n\n\t\t\t\tif ( createdTracks ) {\n\n\t\t\t\t\tfor ( let k = 0; k < createdTracks.length; k ++ ) {\n\n\t\t\t\t\t\ttracks.push( createdTracks[ k ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn new AnimationClip( animationName, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tconst nodePending = parser._loadNodeShallow( nodeIndex );\n\n\t\tconst childPending = [];\n\t\tconst childrenDef = nodeDef.children || [];\n\n\t\tfor ( let i = 0, il = childrenDef.length; i < il; i ++ ) {\n\n\t\t\tchildPending.push( parser.getDependency( 'node', childrenDef[ i ] ) );\n\n\t\t}\n\n\t\tconst skeletonPending = nodeDef.skin === undefined\n\t\t\t? Promise.resolve( null )\n\t\t\t: parser.getDependency( 'skin', nodeDef.skin );\n\n\t\treturn Promise.all( [\n\t\t\tnodePending,\n\t\t\tPromise.all( childPending ),\n\t\t\tskeletonPending\n\t\t] ).then( function ( results ) {\n\n\t\t\tconst node = results[ 0 ];\n\t\t\tconst children = results[ 1 ];\n\t\t\tconst skeleton = results[ 2 ];\n\n\t\t\tif ( skeleton !== null ) {\n\n\t\t\t\t// This full traverse should be fine because\n\t\t\t\t// child glTF nodes have not been added to this node yet.\n\t\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\t\tif ( ! mesh.isSkinnedMesh ) return;\n\n\t\t\t\t\tmesh.bind( skeleton, _identityMatrix );\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tnode.add( children[ i ] );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t// ._loadNodeShallow() parses a single node.\n\t// skin and child nodes are created and added in .loadNode() (no '_' prefix).\n\t_loadNodeShallow( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\t// This method is called from .loadNode() and .loadSkin().\n\t\t// Cache a node to avoid duplication.\n\n\t\tif ( this.nodeCache[ nodeIndex ] !== undefined ) {\n\n\t\t\treturn this.nodeCache[ nodeIndex ];\n\n\t\t}\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\tconst pending = [];\n\n\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t} );\n\n\t\tif ( meshPromise ) {\n\n\t\t\tpending.push( meshPromise );\n\n\t\t}\n\n\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t} ).forEach( function ( promise ) {\n\n\t\t\tpending.push( promise );\n\n\t\t} );\n\n\t\tthis.nodeCache[ nodeIndex ] = Promise.all( pending ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! parser.associations.has( node ) ) {\n\n\t\t\t\tparser.associations.set( node, {} );\n\n\t\t\t}\n\n\t\t\tparser.associations.get( node ).nodes = nodeIndex;\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t\treturn this.nodeCache[ nodeIndex ];\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( parser.getDependency( 'node', nodeIds[ i ] ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function ( nodes ) {\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tscene.add( nodes[ i ] );\n\n\t\t\t}\n\n\t\t\t// Removes dangling associations, associations that reference a node that\n\t\t\t// didn't make it into the scene.\n\t\t\tconst reduceAssociations = ( node ) => {\n\n\t\t\t\tconst reducedAssociations = new Map();\n\n\t\t\t\tfor ( const [ key, value ] of parser.associations ) {\n\n\t\t\t\t\tif ( key instanceof Material || key instanceof Texture ) {\n\n\t\t\t\t\t\treducedAssociations.set( key, value );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnode.traverse( ( node ) => {\n\n\t\t\t\t\tconst mappings = parser.associations.get( node );\n\n\t\t\t\t\tif ( mappings != null ) {\n\n\t\t\t\t\t\treducedAssociations.set( node, mappings );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn reducedAssociations;\n\n\t\t\t};\n\n\t\t\tparser.associations = reduceAssociations( scene );\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n\t_createAnimationTracks( node, inputAccessor, outputAccessor, sampler, target ) {\n\n\t\tconst tracks = [];\n\n\t\tconst targetName = node.name ? node.name : node.uuid;\n\t\tconst targetNames = [];\n\n\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\ttargetNames.push( targetName );\n\n\t\t}\n\n\t\tlet TypedKeyframeTrack;\n\n\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tcase PATH_PROPERTIES.position:\n\t\t\tcase PATH_PROPERTIES.scale:\n\n\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\n\t\t\t\tswitch ( outputAccessor.itemSize ) {\n\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\tcase 3:\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t}\n\n\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\n\t\tconst outputArray = this._getArrayFromAccessor( outputAccessor );\n\n\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\tinputAccessor.array,\n\t\t\t\toutputArray,\n\t\t\t\tinterpolation\n\t\t\t);\n\n\t\t\t// Override interpolation with custom factory method.\n\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\tthis._createCubicSplineTrackInterpolant( track );\n\n\t\t\t}\n\n\t\t\ttracks.push( track );\n\n\t\t}\n\n\t\treturn tracks;\n\n\t}\n\n\t_getArrayFromAccessor( accessor ) {\n\n\t\tlet outputArray = accessor.array;\n\n\t\tif ( accessor.normalized ) {\n\n\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t}\n\n\t\t\toutputArray = scaled;\n\n\t\t}\n\n\t\treturn outputArray;\n\n\t}\n\n\t_createCubicSplineTrackInterpolant( track ) {\n\n\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\tconst interpolantType = ( this instanceof QuaternionKeyframeTrack ) ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant;\n\n\t\t\treturn new interpolantType( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t};\n\n\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t}\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tif ( ColorManagement.workingColorSpace !== LinearSRGBColorSpace && 'COLOR_0' in attributes ) {\n\n\t\tconsole.warn( `THREE.GLTFLoader: Converting vertex colors from \"srgb-linear\" to \"${ColorManagement.workingColorSpace}\" not supported.` );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\nexport { GLTFLoader };\n","import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tColor,\n\tColorManagement,\n\tFileLoader,\n\tLoader,\n\tLinearSRGBColorSpace,\n\tSRGBColorSpace\n} from 'three';\n\nconst _taskCache = new WeakMap();\n\nclass DRACOLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.decoderPath = '';\n\t\tthis.decoderConfig = {};\n\t\tthis.decoderBinary = null;\n\t\tthis.decoderPending = null;\n\n\t\tthis.workerLimit = 4;\n\t\tthis.workerPool = [];\n\t\tthis.workerNextTaskID = 1;\n\t\tthis.workerSourceURL = '';\n\n\t\tthis.defaultAttributeIDs = {\n\t\t\tposition: 'POSITION',\n\t\t\tnormal: 'NORMAL',\n\t\t\tcolor: 'COLOR',\n\t\t\tuv: 'TEX_COORD'\n\t\t};\n\t\tthis.defaultAttributeTypes = {\n\t\t\tposition: 'Float32Array',\n\t\t\tnormal: 'Float32Array',\n\t\t\tcolor: 'Float32Array',\n\t\t\tuv: 'Float32Array'\n\t\t};\n\n\t}\n\n\tsetDecoderPath( path ) {\n\n\t\tthis.decoderPath = path;\n\n\t\treturn this;\n\n\t}\n\n\tsetDecoderConfig( config ) {\n\n\t\tthis.decoderConfig = config;\n\n\t\treturn this;\n\n\t}\n\n\tsetWorkerLimit( workerLimit ) {\n\n\t\tthis.workerLimit = workerLimit;\n\n\t\treturn this;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, ( buffer ) => {\n\n\t\t\tthis.parse( buffer, onLoad, onError );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\n\tparse( buffer, onLoad, onError = ()=>{} ) {\n\n\t\tthis.decodeDracoFile( buffer, onLoad, null, null, SRGBColorSpace, onError ).catch( onError );\n\n\t}\n\n\tdecodeDracoFile( buffer, callback, attributeIDs, attributeTypes, vertexColorSpace = LinearSRGBColorSpace, onError = () => {} ) {\n\n\t\tconst taskConfig = {\n\t\t\tattributeIDs: attributeIDs || this.defaultAttributeIDs,\n\t\t\tattributeTypes: attributeTypes || this.defaultAttributeTypes,\n\t\t\tuseUniqueIDs: !! attributeIDs,\n\t\t\tvertexColorSpace: vertexColorSpace,\n\t\t};\n\n\t\treturn this.decodeGeometry( buffer, taskConfig ).then( callback ).catch( onError );\n\n\t}\n\n\tdecodeGeometry( buffer, taskConfig ) {\n\n\t\tconst taskKey = JSON.stringify( taskConfig );\n\n\t\t// Check for an existing task using this buffer. A transferred buffer cannot be transferred\n\t\t// again from this thread.\n\t\tif ( _taskCache.has( buffer ) ) {\n\n\t\t\tconst cachedTask = _taskCache.get( buffer );\n\n\t\t\tif ( cachedTask.key === taskKey ) {\n\n\t\t\t\treturn cachedTask.promise;\n\n\t\t\t} else if ( buffer.byteLength === 0 ) {\n\n\t\t\t\t// Technically, it would be possible to wait for the previous task to complete,\n\t\t\t\t// transfer the buffer back, and decode again with the second configuration. That\n\t\t\t\t// is complex, and I don't know of any reason to decode a Draco buffer twice in\n\t\t\t\t// different ways, so this is left unimplemented.\n\t\t\t\tthrow new Error(\n\n\t\t\t\t\t'THREE.DRACOLoader: Unable to re-decode a buffer with different ' +\n\t\t\t\t\t'settings. Buffer has already been transferred.'\n\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t}\n\n\t\t//\n\n\t\tlet worker;\n\t\tconst taskID = this.workerNextTaskID ++;\n\t\tconst taskCost = buffer.byteLength;\n\n\t\t// Obtain a worker and assign a task, and construct a geometry instance\n\t\t// when the task completes.\n\t\tconst geometryPending = this._getWorker( taskID, taskCost )\n\t\t\t.then( ( _worker ) => {\n\n\t\t\t\tworker = _worker;\n\n\t\t\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\t\t\tworker._callbacks[ taskID ] = { resolve, reject };\n\n\t\t\t\t\tworker.postMessage( { type: 'decode', id: taskID, taskConfig, buffer }, [ buffer ] );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t} );\n\n\t\t\t} )\n\t\t\t.then( ( message ) => this._createGeometry( message.geometry ) );\n\n\t\t// Remove task from the task list.\n\t\t// Note: replaced '.finally()' with '.catch().then()' block - iOS 11 support (#19416)\n\t\tgeometryPending\n\t\t\t.catch( () => true )\n\t\t\t.then( () => {\n\n\t\t\t\tif ( worker && taskID ) {\n\n\t\t\t\t\tthis._releaseTask( worker, taskID );\n\n\t\t\t\t\t// this.debug();\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t// Cache the task result.\n\t\t_taskCache.set( buffer, {\n\n\t\t\tkey: taskKey,\n\t\t\tpromise: geometryPending\n\n\t\t} );\n\n\t\treturn geometryPending;\n\n\t}\n\n\t_createGeometry( geometryData ) {\n\n\t\tconst geometry = new BufferGeometry();\n\n\t\tif ( geometryData.index ) {\n\n\t\t\tgeometry.setIndex( new BufferAttribute( geometryData.index.array, 1 ) );\n\n\t\t}\n\n\t\tfor ( let i = 0; i < geometryData.attributes.length; i ++ ) {\n\n\t\t\tconst result = geometryData.attributes[ i ];\n\t\t\tconst name = result.name;\n\t\t\tconst array = result.array;\n\t\t\tconst itemSize = result.itemSize;\n\n\t\t\tconst attribute = new BufferAttribute( array, itemSize );\n\n\t\t\tif ( name === 'color' ) {\n\n\t\t\t\tthis._assignVertexColorSpace( attribute, result.vertexColorSpace );\n\n\t\t\t\tattribute.normalized = ( array instanceof Float32Array ) === false;\n\n\t\t\t}\n\n\t\t\tgeometry.setAttribute( name, attribute );\n\n\t\t}\n\n\t\treturn geometry;\n\n\t}\n\n\t_assignVertexColorSpace( attribute, inputColorSpace ) {\n\n\t\t// While .drc files do not specify colorspace, the only 'official' tooling\n\t\t// is PLY and OBJ converters, which use sRGB. We'll assume sRGB when a .drc\n\t\t// file is passed into .load() or .parse(). GLTFLoader uses internal APIs\n\t\t// to decode geometry, and vertex colors are already Linear-sRGB in there.\n\n\t\tif ( inputColorSpace !== SRGBColorSpace ) return;\n\n\t\tconst _color = new Color();\n\n\t\tfor ( let i = 0, il = attribute.count; i < il; i ++ ) {\n\n\t\t\t_color.fromBufferAttribute( attribute, i );\n\t\t\tColorManagement.toWorkingColorSpace( _color, SRGBColorSpace );\n\t\t\tattribute.setXYZ( i, _color.r, _color.g, _color.b );\n\n\t\t}\n\n\t}\n\n\t_loadLibrary( url, responseType ) {\n\n\t\tconst loader = new FileLoader( this.manager );\n\t\tloader.setPath( this.decoderPath );\n\t\tloader.setResponseType( responseType );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\treturn new Promise( ( resolve, reject ) => {\n\n\t\t\tloader.load( url, resolve, undefined, reject );\n\n\t\t} );\n\n\t}\n\n\tpreload() {\n\n\t\tthis._initDecoder();\n\n\t\treturn this;\n\n\t}\n\n\t_initDecoder() {\n\n\t\tif ( this.decoderPending ) return this.decoderPending;\n\n\t\tconst useJS = typeof WebAssembly !== 'object' || this.decoderConfig.type === 'js';\n\t\tconst librariesPending = [];\n\n\t\tif ( useJS ) {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.js', 'text' ) );\n\n\t\t} else {\n\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_wasm_wrapper.js', 'text' ) );\n\t\t\tlibrariesPending.push( this._loadLibrary( 'draco_decoder.wasm', 'arraybuffer' ) );\n\n\t\t}\n\n\t\tthis.decoderPending = Promise.all( librariesPending )\n\t\t\t.then( ( libraries ) => {\n\n\t\t\t\tconst jsContent = libraries[ 0 ];\n\n\t\t\t\tif ( ! useJS ) {\n\n\t\t\t\t\tthis.decoderConfig.wasmBinary = libraries[ 1 ];\n\n\t\t\t\t}\n\n\t\t\t\tconst fn = DRACOWorker.toString();\n\n\t\t\t\tconst body = [\n\t\t\t\t\t'/* draco decoder */',\n\t\t\t\t\tjsContent,\n\t\t\t\t\t'',\n\t\t\t\t\t'/* worker */',\n\t\t\t\t\tfn.substring( fn.indexOf( '{' ) + 1, fn.lastIndexOf( '}' ) )\n\t\t\t\t].join( '\\n' );\n\n\t\t\t\tthis.workerSourceURL = URL.createObjectURL( new Blob( [ body ] ) );\n\n\t\t\t} );\n\n\t\treturn this.decoderPending;\n\n\t}\n\n\t_getWorker( taskID, taskCost ) {\n\n\t\treturn this._initDecoder().then( () => {\n\n\t\t\tif ( this.workerPool.length < this.workerLimit ) {\n\n\t\t\t\tconst worker = new Worker( this.workerSourceURL );\n\n\t\t\t\tworker._callbacks = {};\n\t\t\t\tworker._taskCosts = {};\n\t\t\t\tworker._taskLoad = 0;\n\n\t\t\t\tworker.postMessage( { type: 'init', decoderConfig: this.decoderConfig } );\n\n\t\t\t\tworker.onmessage = function ( e ) {\n\n\t\t\t\t\tconst message = e.data;\n\n\t\t\t\t\tswitch ( message.type ) {\n\n\t\t\t\t\t\tcase 'decode':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].resolve( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'error':\n\t\t\t\t\t\t\tworker._callbacks[ message.id ].reject( message );\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tconsole.error( 'THREE.DRACOLoader: Unexpected message, \"' + message.type + '\"' );\n\n\t\t\t\t\t}\n\n\t\t\t\t};\n\n\t\t\t\tthis.workerPool.push( worker );\n\n\t\t\t} else {\n\n\t\t\t\tthis.workerPool.sort( function ( a, b ) {\n\n\t\t\t\t\treturn a._taskLoad > b._taskLoad ? - 1 : 1;\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tconst worker = this.workerPool[ this.workerPool.length - 1 ];\n\t\t\tworker._taskCosts[ taskID ] = taskCost;\n\t\t\tworker._taskLoad += taskCost;\n\t\t\treturn worker;\n\n\t\t} );\n\n\t}\n\n\t_releaseTask( worker, taskID ) {\n\n\t\tworker._taskLoad -= worker._taskCosts[ taskID ];\n\t\tdelete worker._callbacks[ taskID ];\n\t\tdelete worker._taskCosts[ taskID ];\n\n\t}\n\n\tdebug() {\n\n\t\tconsole.log( 'Task load: ', this.workerPool.map( ( worker ) => worker._taskLoad ) );\n\n\t}\n\n\tdispose() {\n\n\t\tfor ( let i = 0; i < this.workerPool.length; ++ i ) {\n\n\t\t\tthis.workerPool[ i ].terminate();\n\n\t\t}\n\n\t\tthis.workerPool.length = 0;\n\n\t\tif ( this.workerSourceURL !== '' ) {\n\n\t\t\tURL.revokeObjectURL( this.workerSourceURL );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n}\n\n/* WEB WORKER */\n\nfunction DRACOWorker() {\n\n\tlet decoderConfig;\n\tlet decoderPending;\n\n\tonmessage = function ( e ) {\n\n\t\tconst message = e.data;\n\n\t\tswitch ( message.type ) {\n\n\t\t\tcase 'init':\n\t\t\t\tdecoderConfig = message.decoderConfig;\n\t\t\t\tdecoderPending = new Promise( function ( resolve/*, reject*/ ) {\n\n\t\t\t\t\tdecoderConfig.onModuleLoaded = function ( draco ) {\n\n\t\t\t\t\t\t// Module is Promise-like. Wrap before resolving to avoid loop.\n\t\t\t\t\t\tresolve( { draco: draco } );\n\n\t\t\t\t\t};\n\n\t\t\t\t\tDracoDecoderModule( decoderConfig ); // eslint-disable-line no-undef\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t\tcase 'decode':\n\t\t\t\tconst buffer = message.buffer;\n\t\t\t\tconst taskConfig = message.taskConfig;\n\t\t\t\tdecoderPending.then( ( module ) => {\n\n\t\t\t\t\tconst draco = module.draco;\n\t\t\t\t\tconst decoder = new draco.Decoder();\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tconst geometry = decodeGeometry( draco, decoder, new Int8Array( buffer ), taskConfig );\n\n\t\t\t\t\t\tconst buffers = geometry.attributes.map( ( attr ) => attr.array.buffer );\n\n\t\t\t\t\t\tif ( geometry.index ) buffers.push( geometry.index.array.buffer );\n\n\t\t\t\t\t\tself.postMessage( { type: 'decode', id: message.id, geometry }, buffers );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tconsole.error( error );\n\n\t\t\t\t\t\tself.postMessage( { type: 'error', id: message.id, error: error.message } );\n\n\t\t\t\t\t} finally {\n\n\t\t\t\t\t\tdraco.destroy( decoder );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t};\n\n\tfunction decodeGeometry( draco, decoder, array, taskConfig ) {\n\n\t\tconst attributeIDs = taskConfig.attributeIDs;\n\t\tconst attributeTypes = taskConfig.attributeTypes;\n\n\t\tlet dracoGeometry;\n\t\tlet decodingStatus;\n\n\t\tconst geometryType = decoder.GetEncodedGeometryType( array );\n\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tdracoGeometry = new draco.Mesh();\n\t\t\tdecodingStatus = decoder.DecodeArrayToMesh( array, array.byteLength, dracoGeometry );\n\n\t\t} else if ( geometryType === draco.POINT_CLOUD ) {\n\n\t\t\tdracoGeometry = new draco.PointCloud();\n\t\t\tdecodingStatus = decoder.DecodeArrayToPointCloud( array, array.byteLength, dracoGeometry );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Unexpected geometry type.' );\n\n\t\t}\n\n\t\tif ( ! decodingStatus.ok() || dracoGeometry.ptr === 0 ) {\n\n\t\t\tthrow new Error( 'THREE.DRACOLoader: Decoding failed: ' + decodingStatus.error_msg() );\n\n\t\t}\n\n\t\tconst geometry = { index: null, attributes: [] };\n\n\t\t// Gather all vertex attributes.\n\t\tfor ( const attributeName in attributeIDs ) {\n\n\t\t\tconst attributeType = self[ attributeTypes[ attributeName ] ];\n\n\t\t\tlet attribute;\n\t\t\tlet attributeID;\n\n\t\t\t// A Draco file may be created with default vertex attributes, whose attribute IDs\n\t\t\t// are mapped 1:1 from their semantic name (POSITION, NORMAL, ...). Alternatively,\n\t\t\t// a Draco file may contain a custom set of attributes, identified by known unique\n\t\t\t// IDs. glTF files always do the latter, and `.drc` files typically do the former.\n\t\t\tif ( taskConfig.useUniqueIDs ) {\n\n\t\t\t\tattributeID = attributeIDs[ attributeName ];\n\t\t\t\tattribute = decoder.GetAttributeByUniqueId( dracoGeometry, attributeID );\n\n\t\t\t} else {\n\n\t\t\t\tattributeID = decoder.GetAttributeId( dracoGeometry, draco[ attributeIDs[ attributeName ] ] );\n\n\t\t\t\tif ( attributeID === - 1 ) continue;\n\n\t\t\t\tattribute = decoder.GetAttribute( dracoGeometry, attributeID );\n\n\t\t\t}\n\n\t\t\tconst attributeResult = decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute );\n\n\t\t\tif ( attributeName === 'color' ) {\n\n\t\t\t\tattributeResult.vertexColorSpace = taskConfig.vertexColorSpace;\n\n\t\t\t}\n\n\t\t\tgeometry.attributes.push( attributeResult );\n\n\t\t}\n\n\t\t// Add index.\n\t\tif ( geometryType === draco.TRIANGULAR_MESH ) {\n\n\t\t\tgeometry.index = decodeIndex( draco, decoder, dracoGeometry );\n\n\t\t}\n\n\t\tdraco.destroy( dracoGeometry );\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction decodeIndex( draco, decoder, dracoGeometry ) {\n\n\t\tconst numFaces = dracoGeometry.num_faces();\n\t\tconst numIndices = numFaces * 3;\n\t\tconst byteLength = numIndices * 4;\n\n\t\tconst ptr = draco._malloc( byteLength );\n\t\tdecoder.GetTrianglesUInt32Array( dracoGeometry, byteLength, ptr );\n\t\tconst index = new Uint32Array( draco.HEAPF32.buffer, ptr, numIndices ).slice();\n\t\tdraco._free( ptr );\n\n\t\treturn { array: index, itemSize: 1 };\n\n\t}\n\n\tfunction decodeAttribute( draco, decoder, dracoGeometry, attributeName, attributeType, attribute ) {\n\n\t\tconst numComponents = attribute.num_components();\n\t\tconst numPoints = dracoGeometry.num_points();\n\t\tconst numValues = numPoints * numComponents;\n\t\tconst byteLength = numValues * attributeType.BYTES_PER_ELEMENT;\n\t\tconst dataType = getDracoDataType( draco, attributeType );\n\n\t\tconst ptr = draco._malloc( byteLength );\n\t\tdecoder.GetAttributeDataArrayForAllPoints( dracoGeometry, attribute, dataType, byteLength, ptr );\n\t\tconst array = new attributeType( draco.HEAPF32.buffer, ptr, numValues ).slice();\n\t\tdraco._free( ptr );\n\n\t\treturn {\n\t\t\tname: attributeName,\n\t\t\tarray: array,\n\t\t\titemSize: numComponents\n\t\t};\n\n\t}\n\n\tfunction getDracoDataType( draco, attributeType ) {\n\n\t\tswitch ( attributeType ) {\n\n\t\t\tcase Float32Array: return draco.DT_FLOAT32;\n\t\t\tcase Int8Array: return draco.DT_INT8;\n\t\t\tcase Int16Array: return draco.DT_INT16;\n\t\t\tcase Int32Array: return draco.DT_INT32;\n\t\t\tcase Uint8Array: return draco.DT_UINT8;\n\t\t\tcase Uint16Array: return draco.DT_UINT16;\n\t\t\tcase Uint32Array: return draco.DT_UINT32;\n\n\t\t}\n\n\t}\n\n}\n\nexport { DRACOLoader };\n","/**\n * @author Deepkolos / https://github.com/deepkolos\n */\n\nexport class WorkerPool {\n\n\tconstructor( pool = 4 ) {\n\n\t\tthis.pool = pool;\n\t\tthis.queue = [];\n\t\tthis.workers = [];\n\t\tthis.workersResolve = [];\n\t\tthis.workerStatus = 0;\n\n\t}\n\n\t_initWorker( workerId ) {\n\n\t\tif ( ! this.workers[ workerId ] ) {\n\n\t\t\tconst worker = this.workerCreator();\n\t\t\tworker.addEventListener( 'message', this._onMessage.bind( this, workerId ) );\n\t\t\tthis.workers[ workerId ] = worker;\n\n\t\t}\n\n\t}\n\n\t_getIdleWorker() {\n\n\t\tfor ( let i = 0; i < this.pool; i ++ )\n\t\t\tif ( ! ( this.workerStatus & ( 1 << i ) ) ) return i;\n\n\t\treturn - 1;\n\n\t}\n\n\t_onMessage( workerId, msg ) {\n\n\t\tconst resolve = this.workersResolve[ workerId ];\n\t\tresolve && resolve( msg );\n\n\t\tif ( this.queue.length ) {\n\n\t\t\tconst { resolve, msg, transfer } = this.queue.shift();\n\t\t\tthis.workersResolve[ workerId ] = resolve;\n\t\t\tthis.workers[ workerId ].postMessage( msg, transfer );\n\n\t\t} else {\n\n\t\t\tthis.workerStatus ^= 1 << workerId;\n\n\t\t}\n\n\t}\n\n\tsetWorkerCreator( workerCreator ) {\n\n\t\tthis.workerCreator = workerCreator;\n\n\t}\n\n\tsetWorkerLimit( pool ) {\n\n\t\tthis.pool = pool;\n\n\t}\n\n\tpostMessage( msg, transfer ) {\n\n\t\treturn new Promise( ( resolve ) => {\n\n\t\t\tconst workerId = this._getIdleWorker();\n\n\t\t\tif ( workerId !== - 1 ) {\n\n\t\t\t\tthis._initWorker( workerId );\n\t\t\t\tthis.workerStatus |= 1 << workerId;\n\t\t\t\tthis.workersResolve[ workerId ] = resolve;\n\t\t\t\tthis.workers[ workerId ].postMessage( msg, transfer );\n\n\t\t\t} else {\n\n\t\t\t\tthis.queue.push( { resolve, msg, transfer } );\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tdispose() {\n\n\t\tthis.workers.forEach( ( worker ) => worker.terminate() );\n\t\tthis.workersResolve.length = 0;\n\t\tthis.workers.length = 0;\n\t\tthis.queue.length = 0;\n\t\tthis.workerStatus = 0;\n\n\t}\n\n}\n","const t=0,e=1,n=2,i=3,s=0,a=0,r=2,o=0,l=1,f=160,h=161,U=162,c=163,_=166,p=0,g=1,y=0,x=1,u=2,b=3,d=4,w=5,m=6,D=7,B=8,L=9,v=10,A=11,k=12,V=13,I=14,S=15,F=16,O=17,E=18,T=0,C=1,M=2,P=3,z=4,W=5,H=6,N=7,K=8,X=9,R=10,Y=11,j=0,q=1,G=2,J=13,Q=14,Z=15,$=128,tt=64,et=32,nt=16,it=0,st=1,at=2,rt=3,ot=4,lt=5,ft=6,ht=7,Ut=8,ct=9,_t=10,pt=13,gt=14,yt=15,xt=16,ut=17,bt=20,dt=21,wt=22,mt=23,Dt=24,Bt=27,Lt=28,vt=29,At=30,kt=31,Vt=34,It=35,St=36,Ft=37,Ot=38,Et=41,Tt=42,Ct=43,Mt=44,Pt=45,zt=48,Wt=49,Ht=50,Nt=58,Kt=59,Xt=62,Rt=63,Yt=64,jt=65,qt=68,Gt=69,Jt=70,Qt=71,Zt=74,$t=75,te=76,ee=77,ne=78,ie=81,se=82,ae=83,re=84,oe=85,le=88,fe=89,he=90,Ue=91,ce=92,_e=95,pe=96,ge=97,ye=98,xe=99,ue=100,be=101,de=102,we=103,me=104,De=105,Be=106,Le=107,ve=108,Ae=109,ke=110,Ve=111,Ie=112,Se=113,Fe=114,Oe=115,Ee=116,Te=117,Ce=118,Me=119,Pe=120,ze=121,We=122,He=123,Ne=124,Ke=125,Xe=126,Re=127,Ye=128,je=129,qe=130,Ge=131,Je=132,Qe=133,Ze=134,$e=135,tn=136,en=137,nn=138,sn=139,an=140,rn=141,on=142,ln=143,fn=144,hn=145,Un=146,cn=147,_n=148,pn=149,gn=150,yn=151,xn=152,un=153,bn=154,dn=155,wn=156,mn=157,Dn=158,Bn=159,Ln=160,vn=161,An=162,kn=163,Vn=164,In=165,Sn=166,Fn=167,On=168,En=169,Tn=170,Cn=171,Mn=172,Pn=173,zn=174,Wn=175,Hn=176,Nn=177,Kn=178,Xn=179,Rn=180,Yn=181,jn=182,qn=183,Gn=184,Jn=1000156007,Qn=1000156008,Zn=1000156009,$n=1000156010,ti=1000156011,ei=1000156017,ni=1000156018,ii=1000156019,si=1000156020,ai=1000156021,ri=1000054e3,oi=1000054001,li=1000054002,fi=1000054003,hi=1000054004,Ui=1000054005,ci=1000054006,_i=1000054007,pi=1000066e3,gi=1000066001,yi=1000066002,xi=1000066003,ui=1000066004,bi=1000066005,di=1000066006,wi=1000066007,mi=1000066008,Di=1000066009,Bi=1000066010,Li=1000066011,vi=1000066012,Ai=1000066013,ki=100034e4,Vi=1000340001;class Ii{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}}class Si{constructor(t,e,n,i){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(t.buffer,t.byteOffset+e,n),this._littleEndian=i,this._offset=0}_nextUint8(){const t=this._dataView.getUint8(this._offset);return this._offset+=1,t}_nextUint16(){const t=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,t}_nextUint32(){const t=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,t}_nextUint64(){const t=this._dataView.getUint32(this._offset,this._littleEndian)+2**32*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,t}_nextInt32(){const t=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,t}_nextUint8Array(t){const e=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,t);return this._offset+=t,e}_skip(t){return this._offset+=t,this}_scan(t,e){void 0===e&&(e=0);const n=this._offset;let i=0;for(;this._dataView.getUint8(this._offset)!==e&&i<t;)i++,this._offset++;return i<t&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+n,i)}}const Fi=new Uint8Array([0]),Oi=[171,75,84,88,32,50,48,187,13,10,26,10];function Ei(t){return(new TextEncoder).encode(t)}function Ti(t){return(new TextDecoder).decode(t)}function Ci(t){let e=0;for(const n of t)e+=n.byteLength;const n=new Uint8Array(e);let i=0;for(const e of t)n.set(new Uint8Array(e),i),i+=e.byteLength;return n}function Mi(t,e){return void 0===e&&(e=4),Math.ceil(t/e)*e-t}function Pi(t){const e=new Uint8Array(t.buffer,t.byteOffset,Oi.length);if(e[0]!==Oi[0]||e[1]!==Oi[1]||e[2]!==Oi[2]||e[3]!==Oi[3]||e[4]!==Oi[4]||e[5]!==Oi[5]||e[6]!==Oi[6]||e[7]!==Oi[7]||e[8]!==Oi[8]||e[9]!==Oi[9]||e[10]!==Oi[10]||e[11]!==Oi[11])throw new Error(\"Missing KTX 2.0 identifier.\");const n=new Ii,i=17*Uint32Array.BYTES_PER_ELEMENT,s=new Si(t,Oi.length,i,!0);n.vkFormat=s._nextUint32(),n.typeSize=s._nextUint32(),n.pixelWidth=s._nextUint32(),n.pixelHeight=s._nextUint32(),n.pixelDepth=s._nextUint32(),n.layerCount=s._nextUint32(),n.faceCount=s._nextUint32();const a=s._nextUint32();n.supercompressionScheme=s._nextUint32();const r=s._nextUint32(),o=s._nextUint32(),l=s._nextUint32(),f=s._nextUint32(),h=s._nextUint64(),U=s._nextUint64(),c=new Si(t,Oi.length+i,3*a*8,!0);for(let e=0;e<a;e++)n.levels.push({levelData:new Uint8Array(t.buffer,t.byteOffset+c._nextUint64(),c._nextUint64()),uncompressedByteLength:c._nextUint64()});const _=new Si(t,r,o,!0),p={vendorId:_._skip(4)._nextUint16(),descriptorType:_._nextUint16(),versionNumber:_._nextUint16(),descriptorBlockSize:_._nextUint16(),colorModel:_._nextUint8(),colorPrimaries:_._nextUint8(),transferFunction:_._nextUint8(),flags:_._nextUint8(),texelBlockDimension:[_._nextUint8(),_._nextUint8(),_._nextUint8(),_._nextUint8()],bytesPlane:[_._nextUint8(),_._nextUint8(),_._nextUint8(),_._nextUint8(),_._nextUint8(),_._nextUint8(),_._nextUint8(),_._nextUint8()],samples:[]},g=(p.descriptorBlockSize/4-6)/4;for(let t=0;t<g;t++){const e={bitOffset:_._nextUint16(),bitLength:_._nextUint8(),channelType:_._nextUint8(),samplePosition:[_._nextUint8(),_._nextUint8(),_._nextUint8(),_._nextUint8()],sampleLower:-Infinity,sampleUpper:Infinity};64&e.channelType?(e.sampleLower=_._nextInt32(),e.sampleUpper=_._nextInt32()):(e.sampleLower=_._nextUint32(),e.sampleUpper=_._nextUint32()),p.samples[t]=e}n.dataFormatDescriptor.length=0,n.dataFormatDescriptor.push(p);const y=new Si(t,l,f,!0);for(;y._offset<f;){const t=y._nextUint32(),e=y._scan(t),i=Ti(e);if(n.keyValue[i]=y._nextUint8Array(t-e.byteLength-1),i.match(/^ktx/i)){const t=Ti(n.keyValue[i]);n.keyValue[i]=t.substring(0,t.lastIndexOf(\"\\0\"))}y._skip(t%4?4-t%4:0)}if(U<=0)return n;const x=new Si(t,h,U,!0),u=x._nextUint16(),b=x._nextUint16(),d=x._nextUint32(),w=x._nextUint32(),m=x._nextUint32(),D=x._nextUint32(),B=[];for(let t=0;t<a;t++)B.push({imageFlags:x._nextUint32(),rgbSliceByteOffset:x._nextUint32(),rgbSliceByteLength:x._nextUint32(),alphaSliceByteOffset:x._nextUint32(),alphaSliceByteLength:x._nextUint32()});const L=h+x._offset,v=L+d,A=v+w,k=A+m,V=new Uint8Array(t.buffer,t.byteOffset+L,d),I=new Uint8Array(t.buffer,t.byteOffset+v,w),S=new Uint8Array(t.buffer,t.byteOffset+A,m),F=new Uint8Array(t.buffer,t.byteOffset+k,D);return n.globalData={endpointCount:u,selectorCount:b,imageDescs:B,endpointsData:V,selectorsData:I,tablesData:S,extendedData:F},n}const zi={keepWriter:!1};function Wi(t,e){void 0===e&&(e={}),e={...zi,...e};let n=new ArrayBuffer(0);if(t.globalData){const e=new ArrayBuffer(20+5*t.globalData.imageDescs.length*4),i=new DataView(e);i.setUint16(0,t.globalData.endpointCount,!0),i.setUint16(2,t.globalData.selectorCount,!0),i.setUint32(4,t.globalData.endpointsData.byteLength,!0),i.setUint32(8,t.globalData.selectorsData.byteLength,!0),i.setUint32(12,t.globalData.tablesData.byteLength,!0),i.setUint32(16,t.globalData.extendedData.byteLength,!0);for(let e=0;e<t.globalData.imageDescs.length;e++){const n=t.globalData.imageDescs[e];i.setUint32(20+5*e*4+0,n.imageFlags,!0),i.setUint32(20+5*e*4+4,n.rgbSliceByteOffset,!0),i.setUint32(20+5*e*4+8,n.rgbSliceByteLength,!0),i.setUint32(20+5*e*4+12,n.alphaSliceByteOffset,!0),i.setUint32(20+5*e*4+16,n.alphaSliceByteLength,!0)}n=Ci([e,t.globalData.endpointsData,t.globalData.selectorsData,t.globalData.tablesData,t.globalData.extendedData])}const i=[];let s=t.keyValue;e.keepWriter||(s={...t.keyValue,KTXwriter:\"KTX-Parse v0.7.1\"});for(const t in s){const e=s[t],n=Ei(t),a=\"string\"==typeof e?Ci([Ei(e),Fi]):e,r=n.byteLength+1+a.byteLength,o=Mi(r,4);i.push(Ci([new Uint32Array([r]),n,Fi,a,new Uint8Array(o).fill(0)]))}const a=Ci(i);if(1!==t.dataFormatDescriptor.length||0!==t.dataFormatDescriptor[0].descriptorType)throw new Error(\"Only BASICFORMAT Data Format Descriptor output supported.\");const r=t.dataFormatDescriptor[0],o=new ArrayBuffer(28+16*r.samples.length),l=new DataView(o),f=24+16*r.samples.length;if(l.setUint32(0,o.byteLength,!0),l.setUint16(4,r.vendorId,!0),l.setUint16(6,r.descriptorType,!0),l.setUint16(8,r.versionNumber,!0),l.setUint16(10,f,!0),l.setUint8(12,r.colorModel),l.setUint8(13,r.colorPrimaries),l.setUint8(14,r.transferFunction),l.setUint8(15,r.flags),!Array.isArray(r.texelBlockDimension))throw new Error(\"texelBlockDimension is now an array. For dimensionality `d`, set `d - 1`.\");l.setUint8(16,r.texelBlockDimension[0]),l.setUint8(17,r.texelBlockDimension[1]),l.setUint8(18,r.texelBlockDimension[2]),l.setUint8(19,r.texelBlockDimension[3]);for(let t=0;t<8;t++)l.setUint8(20+t,r.bytesPlane[t]);for(let t=0;t<r.samples.length;t++){const e=r.samples[t],n=28+16*t;if(e.channelID)throw new Error(\"channelID has been renamed to channelType.\");l.setUint16(n+0,e.bitOffset,!0),l.setUint8(n+2,e.bitLength),l.setUint8(n+3,e.channelType),l.setUint8(n+4,e.samplePosition[0]),l.setUint8(n+5,e.samplePosition[1]),l.setUint8(n+6,e.samplePosition[2]),l.setUint8(n+7,e.samplePosition[3]),64&e.channelType?(l.setInt32(n+8,e.sampleLower,!0),l.setInt32(n+12,e.sampleUpper,!0)):(l.setUint32(n+8,e.sampleLower,!0),l.setUint32(n+12,e.sampleUpper,!0))}const h=Oi.length+68+3*t.levels.length*8,U=h+o.byteLength;let c=n.byteLength>0?U+a.byteLength:0;c%8&&(c+=8-c%8);const _=[],p=new DataView(new ArrayBuffer(3*t.levels.length*8)),g=new Uint32Array(t.levels.length);let y=0;0===t.supercompressionScheme&&(y=function(t,e){const n=Math.max(t,4),i=Math.min(t,4);let s=n;for(;s%i!=0;)s+=n;return s}(function(t){return t.levels[0].levelData.byteLength/function(t,e){let n=1;const i=[t.pixelWidth,t.pixelHeight,t.pixelDepth],s=function(t){const[e,n,i]=t.dataFormatDescriptor[0].texelBlockDimension;return[e+1,n+1,i+1]}(t);for(let t=0;t<3;t++)if(i[t]>0){const e=Math.ceil(Math.floor(i[t]*Math.pow(2,-0))/s[t]);n*=Math.max(1,e)}return t.layerCount>0&&(n*=t.layerCount),t.faceCount>0&&(n*=t.faceCount),n}(t)}(t)));let x=(c||U+a.byteLength)+n.byteLength;for(let e=t.levels.length-1;e>=0;e--){if(x%y){const t=Mi(x,y);_.push(new Uint8Array(t)),x+=t}const n=t.levels[e];_.push(n.levelData),g[e]=x,x+=n.levelData.byteLength}for(let e=0;e<t.levels.length;e++){const n=t.levels[e];p.setBigUint64(24*e+0,BigInt(g[e]),!0),p.setBigUint64(24*e+8,BigInt(n.levelData.byteLength),!0),p.setBigUint64(24*e+16,BigInt(n.uncompressedByteLength),!0)}const u=new ArrayBuffer(68),b=new DataView(u);return b.setUint32(0,t.vkFormat,!0),b.setUint32(4,t.typeSize,!0),b.setUint32(8,t.pixelWidth,!0),b.setUint32(12,t.pixelHeight,!0),b.setUint32(16,t.pixelDepth,!0),b.setUint32(20,t.layerCount,!0),b.setUint32(24,t.faceCount,!0),b.setUint32(28,t.levels.length,!0),b.setUint32(32,t.supercompressionScheme,!0),b.setUint32(36,h,!0),b.setUint32(40,o.byteLength,!0),b.setUint32(44,U,!0),b.setUint32(48,a.byteLength,!0),b.setBigUint64(52,BigInt(n.byteLength>0?c:0),!0),b.setBigUint64(60,BigInt(n.byteLength),!0),new Uint8Array(Ci([new Uint8Array(Oi).buffer,u,p.buffer,o,a,c>0?new ArrayBuffer(c-(U+a.byteLength)):new ArrayBuffer(0),n,..._]))}export{Z as KHR_DF_CHANNEL_RGBSDA_ALPHA,G as KHR_DF_CHANNEL_RGBSDA_BLUE,Q as KHR_DF_CHANNEL_RGBSDA_DEPTH,q as KHR_DF_CHANNEL_RGBSDA_GREEN,j as KHR_DF_CHANNEL_RGBSDA_RED,J as KHR_DF_CHANNEL_RGBSDA_STENCIL,g as KHR_DF_FLAG_ALPHA_PREMULTIPLIED,p as KHR_DF_FLAG_ALPHA_STRAIGHT,s as KHR_DF_KHR_DESCRIPTORTYPE_BASICFORMAT,U as KHR_DF_MODEL_ASTC,f as KHR_DF_MODEL_ETC1,c as KHR_DF_MODEL_ETC1S,h as KHR_DF_MODEL_ETC2,l as KHR_DF_MODEL_RGBSDA,_ as KHR_DF_MODEL_UASTC,o as KHR_DF_MODEL_UNSPECIFIED,H as KHR_DF_PRIMARIES_ACES,N as KHR_DF_PRIMARIES_ACESCC,Y as KHR_DF_PRIMARIES_ADOBERGB,z as KHR_DF_PRIMARIES_BT2020,M as KHR_DF_PRIMARIES_BT601_EBU,P as KHR_DF_PRIMARIES_BT601_SMPTE,C as KHR_DF_PRIMARIES_BT709,W as KHR_DF_PRIMARIES_CIEXYZ,R as KHR_DF_PRIMARIES_DISPLAYP3,K as KHR_DF_PRIMARIES_NTSC1953,X as KHR_DF_PRIMARIES_PAL525,T as KHR_DF_PRIMARIES_UNSPECIFIED,et as KHR_DF_SAMPLE_DATATYPE_EXPONENT,$ as KHR_DF_SAMPLE_DATATYPE_FLOAT,nt as KHR_DF_SAMPLE_DATATYPE_LINEAR,tt as KHR_DF_SAMPLE_DATATYPE_SIGNED,F as KHR_DF_TRANSFER_ACESCC,O as KHR_DF_TRANSFER_ACESCCT,E as KHR_DF_TRANSFER_ADOBERGB,D as KHR_DF_TRANSFER_BT1886,k as KHR_DF_TRANSFER_DCIP3,L as KHR_DF_TRANSFER_HLG_EOTF,B as KHR_DF_TRANSFER_HLG_OETF,b as KHR_DF_TRANSFER_ITU,x as KHR_DF_TRANSFER_LINEAR,d as KHR_DF_TRANSFER_NTSC,I as KHR_DF_TRANSFER_PAL625_EOTF,V as KHR_DF_TRANSFER_PAL_OETF,v as KHR_DF_TRANSFER_PQ_EOTF,A as KHR_DF_TRANSFER_PQ_OETF,w as KHR_DF_TRANSFER_SLOG,m as KHR_DF_TRANSFER_SLOG2,u as KHR_DF_TRANSFER_SRGB,S as KHR_DF_TRANSFER_ST240,y as KHR_DF_TRANSFER_UNSPECIFIED,a as KHR_DF_VENDORID_KHRONOS,r as KHR_DF_VERSION,e as KHR_SUPERCOMPRESSION_BASISLZ,t as KHR_SUPERCOMPRESSION_NONE,i as KHR_SUPERCOMPRESSION_ZLIB,n as KHR_SUPERCOMPRESSION_ZSTD,Ii as KTX2Container,Ut as VK_FORMAT_A1R5G5B5_UNORM_PACK16,Gt as VK_FORMAT_A2B10G10R10_SINT_PACK32,jt as VK_FORMAT_A2B10G10R10_SNORM_PACK32,qt as VK_FORMAT_A2B10G10R10_UINT_PACK32,Yt as VK_FORMAT_A2B10G10R10_UNORM_PACK32,Rt as VK_FORMAT_A2R10G10B10_SINT_PACK32,Kt as VK_FORMAT_A2R10G10B10_SNORM_PACK32,Xt as VK_FORMAT_A2R10G10B10_UINT_PACK32,Nt as VK_FORMAT_A2R10G10B10_UNORM_PACK32,Vi as VK_FORMAT_A4B4G4R4_UNORM_PACK16_EXT,ki as VK_FORMAT_A4R4G4B4_UNORM_PACK16_EXT,Li as VK_FORMAT_ASTC_10x10_SFLOAT_BLOCK_EXT,Rn as VK_FORMAT_ASTC_10x10_SRGB_BLOCK,Xn as VK_FORMAT_ASTC_10x10_UNORM_BLOCK,mi as VK_FORMAT_ASTC_10x5_SFLOAT_BLOCK_EXT,zn as VK_FORMAT_ASTC_10x5_SRGB_BLOCK,Pn as VK_FORMAT_ASTC_10x5_UNORM_BLOCK,Di as VK_FORMAT_ASTC_10x6_SFLOAT_BLOCK_EXT,Hn as VK_FORMAT_ASTC_10x6_SRGB_BLOCK,Wn as VK_FORMAT_ASTC_10x6_UNORM_BLOCK,Bi as VK_FORMAT_ASTC_10x8_SFLOAT_BLOCK_EXT,Kn as VK_FORMAT_ASTC_10x8_SRGB_BLOCK,Nn as VK_FORMAT_ASTC_10x8_UNORM_BLOCK,vi as VK_FORMAT_ASTC_12x10_SFLOAT_BLOCK_EXT,jn as VK_FORMAT_ASTC_12x10_SRGB_BLOCK,Yn as VK_FORMAT_ASTC_12x10_UNORM_BLOCK,Ai as VK_FORMAT_ASTC_12x12_SFLOAT_BLOCK_EXT,Gn as VK_FORMAT_ASTC_12x12_SRGB_BLOCK,qn as VK_FORMAT_ASTC_12x12_UNORM_BLOCK,pi as VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT,Dn as VK_FORMAT_ASTC_4x4_SRGB_BLOCK,mn as VK_FORMAT_ASTC_4x4_UNORM_BLOCK,gi as VK_FORMAT_ASTC_5x4_SFLOAT_BLOCK_EXT,Ln as VK_FORMAT_ASTC_5x4_SRGB_BLOCK,Bn as VK_FORMAT_ASTC_5x4_UNORM_BLOCK,yi as VK_FORMAT_ASTC_5x5_SFLOAT_BLOCK_EXT,An as VK_FORMAT_ASTC_5x5_SRGB_BLOCK,vn as VK_FORMAT_ASTC_5x5_UNORM_BLOCK,xi as VK_FORMAT_ASTC_6x5_SFLOAT_BLOCK_EXT,Vn as VK_FORMAT_ASTC_6x5_SRGB_BLOCK,kn as VK_FORMAT_ASTC_6x5_UNORM_BLOCK,ui as VK_FORMAT_ASTC_6x6_SFLOAT_BLOCK_EXT,Sn as VK_FORMAT_ASTC_6x6_SRGB_BLOCK,In as VK_FORMAT_ASTC_6x6_UNORM_BLOCK,bi as VK_FORMAT_ASTC_8x5_SFLOAT_BLOCK_EXT,On as VK_FORMAT_ASTC_8x5_SRGB_BLOCK,Fn as VK_FORMAT_ASTC_8x5_UNORM_BLOCK,di as VK_FORMAT_ASTC_8x6_SFLOAT_BLOCK_EXT,Tn as VK_FORMAT_ASTC_8x6_SRGB_BLOCK,En as VK_FORMAT_ASTC_8x6_UNORM_BLOCK,wi as VK_FORMAT_ASTC_8x8_SFLOAT_BLOCK_EXT,Mn as VK_FORMAT_ASTC_8x8_SRGB_BLOCK,Cn as VK_FORMAT_ASTC_8x8_UNORM_BLOCK,We as VK_FORMAT_B10G11R11_UFLOAT_PACK32,ti as VK_FORMAT_B10X6G10X6R10X6G10X6_422_UNORM_4PACK16,ai as VK_FORMAT_B12X4G12X4R12X4G12X4_422_UNORM_4PACK16,rt as VK_FORMAT_B4G4R4A4_UNORM_PACK16,ht as VK_FORMAT_B5G5R5A1_UNORM_PACK16,lt as VK_FORMAT_B5G6R5_UNORM_PACK16,Wt as VK_FORMAT_B8G8R8A8_SINT,Pt as VK_FORMAT_B8G8R8A8_SNORM,Ht as VK_FORMAT_B8G8R8A8_SRGB,zt as VK_FORMAT_B8G8R8A8_UINT,Mt as VK_FORMAT_B8G8R8A8_UNORM,It as VK_FORMAT_B8G8R8_SINT,kt as VK_FORMAT_B8G8R8_SNORM,St as VK_FORMAT_B8G8R8_SRGB,Vt as VK_FORMAT_B8G8R8_UINT,At as VK_FORMAT_B8G8R8_UNORM,Ze as VK_FORMAT_BC1_RGBA_SRGB_BLOCK,Qe as VK_FORMAT_BC1_RGBA_UNORM_BLOCK,Je as VK_FORMAT_BC1_RGB_SRGB_BLOCK,Ge as VK_FORMAT_BC1_RGB_UNORM_BLOCK,tn as VK_FORMAT_BC2_SRGB_BLOCK,$e as VK_FORMAT_BC2_UNORM_BLOCK,nn as VK_FORMAT_BC3_SRGB_BLOCK,en as VK_FORMAT_BC3_UNORM_BLOCK,an as VK_FORMAT_BC4_SNORM_BLOCK,sn as VK_FORMAT_BC4_UNORM_BLOCK,on as VK_FORMAT_BC5_SNORM_BLOCK,rn as VK_FORMAT_BC5_UNORM_BLOCK,fn as VK_FORMAT_BC6H_SFLOAT_BLOCK,ln as VK_FORMAT_BC6H_UFLOAT_BLOCK,Un as VK_FORMAT_BC7_SRGB_BLOCK,hn as VK_FORMAT_BC7_UNORM_BLOCK,Ne as VK_FORMAT_D16_UNORM,Ye as VK_FORMAT_D16_UNORM_S8_UINT,je as VK_FORMAT_D24_UNORM_S8_UINT,Xe as VK_FORMAT_D32_SFLOAT,qe as VK_FORMAT_D32_SFLOAT_S8_UINT,He as VK_FORMAT_E5B9G9R9_UFLOAT_PACK32,wn as VK_FORMAT_EAC_R11G11_SNORM_BLOCK,dn as VK_FORMAT_EAC_R11G11_UNORM_BLOCK,bn as VK_FORMAT_EAC_R11_SNORM_BLOCK,un as VK_FORMAT_EAC_R11_UNORM_BLOCK,gn as VK_FORMAT_ETC2_R8G8B8A1_SRGB_BLOCK,pn as VK_FORMAT_ETC2_R8G8B8A1_UNORM_BLOCK,xn as VK_FORMAT_ETC2_R8G8B8A8_SRGB_BLOCK,yn as VK_FORMAT_ETC2_R8G8B8A8_UNORM_BLOCK,_n as VK_FORMAT_ETC2_R8G8B8_SRGB_BLOCK,cn as VK_FORMAT_ETC2_R8G8B8_UNORM_BLOCK,$n as VK_FORMAT_G10X6B10X6G10X6R10X6_422_UNORM_4PACK16,si as VK_FORMAT_G12X4B12X4G12X4R12X4_422_UNORM_4PACK16,hi as VK_FORMAT_PVRTC1_2BPP_SRGB_BLOCK_IMG,ri as VK_FORMAT_PVRTC1_2BPP_UNORM_BLOCK_IMG,Ui as VK_FORMAT_PVRTC1_4BPP_SRGB_BLOCK_IMG,oi as VK_FORMAT_PVRTC1_4BPP_UNORM_BLOCK_IMG,ci as VK_FORMAT_PVRTC2_2BPP_SRGB_BLOCK_IMG,li as VK_FORMAT_PVRTC2_2BPP_UNORM_BLOCK_IMG,_i as VK_FORMAT_PVRTC2_4BPP_SRGB_BLOCK_IMG,fi as VK_FORMAT_PVRTC2_4BPP_UNORM_BLOCK_IMG,Zn as VK_FORMAT_R10X6G10X6B10X6A10X6_UNORM_4PACK16,Qn as VK_FORMAT_R10X6G10X6_UNORM_2PACK16,Jn as VK_FORMAT_R10X6_UNORM_PACK16,ii as VK_FORMAT_R12X4G12X4B12X4A12X4_UNORM_4PACK16,ni as VK_FORMAT_R12X4G12X4_UNORM_2PACK16,ei as VK_FORMAT_R12X4_UNORM_PACK16,ge as VK_FORMAT_R16G16B16A16_SFLOAT,pe as VK_FORMAT_R16G16B16A16_SINT,ce as VK_FORMAT_R16G16B16A16_SNORM,_e as VK_FORMAT_R16G16B16A16_UINT,Ue as VK_FORMAT_R16G16B16A16_UNORM,he as VK_FORMAT_R16G16B16_SFLOAT,fe as VK_FORMAT_R16G16B16_SINT,oe as VK_FORMAT_R16G16B16_SNORM,le as VK_FORMAT_R16G16B16_UINT,re as VK_FORMAT_R16G16B16_UNORM,ae as VK_FORMAT_R16G16_SFLOAT,se as VK_FORMAT_R16G16_SINT,ne as VK_FORMAT_R16G16_SNORM,ie as VK_FORMAT_R16G16_UINT,ee as VK_FORMAT_R16G16_UNORM,te as VK_FORMAT_R16_SFLOAT,$t as VK_FORMAT_R16_SINT,Qt as VK_FORMAT_R16_SNORM,Zt as VK_FORMAT_R16_UINT,Jt as VK_FORMAT_R16_UNORM,Ae as VK_FORMAT_R32G32B32A32_SFLOAT,ve as VK_FORMAT_R32G32B32A32_SINT,Le as VK_FORMAT_R32G32B32A32_UINT,Be as VK_FORMAT_R32G32B32_SFLOAT,De as VK_FORMAT_R32G32B32_SINT,me as VK_FORMAT_R32G32B32_UINT,we as VK_FORMAT_R32G32_SFLOAT,de as VK_FORMAT_R32G32_SINT,be as VK_FORMAT_R32G32_UINT,ue as VK_FORMAT_R32_SFLOAT,xe as VK_FORMAT_R32_SINT,ye as VK_FORMAT_R32_UINT,at as VK_FORMAT_R4G4B4A4_UNORM_PACK16,st as VK_FORMAT_R4G4_UNORM_PACK8,ft as VK_FORMAT_R5G5B5A1_UNORM_PACK16,ot as VK_FORMAT_R5G6B5_UNORM_PACK16,ze as VK_FORMAT_R64G64B64A64_SFLOAT,Pe as VK_FORMAT_R64G64B64A64_SINT,Me as VK_FORMAT_R64G64B64A64_UINT,Ce as VK_FORMAT_R64G64B64_SFLOAT,Te as VK_FORMAT_R64G64B64_SINT,Ee as VK_FORMAT_R64G64B64_UINT,Oe as VK_FORMAT_R64G64_SFLOAT,Fe as VK_FORMAT_R64G64_SINT,Se as VK_FORMAT_R64G64_UINT,Ie as VK_FORMAT_R64_SFLOAT,Ve as VK_FORMAT_R64_SINT,ke as VK_FORMAT_R64_UINT,Tt as VK_FORMAT_R8G8B8A8_SINT,Ot as VK_FORMAT_R8G8B8A8_SNORM,Ct as VK_FORMAT_R8G8B8A8_SRGB,Et as VK_FORMAT_R8G8B8A8_UINT,Ft as VK_FORMAT_R8G8B8A8_UNORM,Lt as VK_FORMAT_R8G8B8_SINT,Dt as VK_FORMAT_R8G8B8_SNORM,vt as VK_FORMAT_R8G8B8_SRGB,Bt as VK_FORMAT_R8G8B8_UINT,mt as VK_FORMAT_R8G8B8_UNORM,dt as VK_FORMAT_R8G8_SINT,ut as VK_FORMAT_R8G8_SNORM,wt as VK_FORMAT_R8G8_SRGB,bt as VK_FORMAT_R8G8_UINT,xt as VK_FORMAT_R8G8_UNORM,gt as VK_FORMAT_R8_SINT,_t as VK_FORMAT_R8_SNORM,yt as VK_FORMAT_R8_SRGB,pt as VK_FORMAT_R8_UINT,ct as VK_FORMAT_R8_UNORM,Re as VK_FORMAT_S8_UINT,it as VK_FORMAT_UNDEFINED,Ke as VK_FORMAT_X8_D24_UNORM_PACK32,Pi as read,Wi as write};\n","let A,I,B;const g={env:{emscripten_notify_memory_growth:function(A){B=new Uint8Array(I.exports.memory.buffer)}}};class Q{init(){return A||(A=\"undefined\"!=typeof fetch?fetch(\"data:application/wasm;base64,\"+C).then(A=>A.arrayBuffer()).then(A=>WebAssembly.instantiate(A,g)).then(this._init):WebAssembly.instantiate(Buffer.from(C,\"base64\"),g).then(this._init),A)}_init(A){I=A.instance,g.env.emscripten_notify_memory_growth(0)}decode(A,g=0){if(!I)throw new Error(\"ZSTDDecoder: Await .init() before decoding.\");const Q=A.byteLength,C=I.exports.malloc(Q);B.set(A,C),g=g||Number(I.exports.ZSTD_findDecompressedSize(C,Q));const E=I.exports.malloc(g),i=I.exports.ZSTD_decompress(E,g,C,Q),D=B.slice(E,E+i);return I.exports.free(C),I.exports.free(E),D}}const C=\"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IAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQh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ASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigC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C0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdBKGogACgCBBATQQAhBCAHQeAAaiEMIAdB5ABqIQoDQCAHQShqEARBAksgBCAXTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEJIAcoAkggBygCREEDdGopAgAiH0IgiKchCCAeQiCIISAgHUIgiKchAgJAIB9CEIinQf8BcSIDQQJPBEACQCAGRSADQRlJckUEQCAIIAdBKGogA0EgIAcoAixrIg0gDSADSxsiDRAFIAMgDWsiA3RqIQggB0EoahAEGiADRQ0BIAdBKGogAxAFIAhqIQgMAQsgB0EoaiADEAUgCGohCCAHQShqEAQaCyAHKQJUISEgByAINgJUIAcgITcDWAwBCwJAIANFBEAgAgRAIAcoAlQhCAwDCyAHKAJYIQgMAQsCQAJAIAdBKGpBARAFIAggAkVqaiIDQQNGBEAgBygCVEF/aiIDIANFaiEIDAELIANBAnQgB2ooAlQiCCAIRWohCCADQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAg2AlQLICCnIQMgCQRAIAdBKGogCRAFIANqIQMLIAkgC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgAmohAgsgB0EoahAEGiAHIAcoAmggAmoiCSADajYCaCAKIAwgCCAJSxsoAgAhDSAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogB0EoaiAfQhiIp0H/AXEQCCEOIAdB8ABqIARBBHRqIgsgCSANaiAIazYCDCALIAg2AgggCyADNgIEIAsgAjYCACAHIA4gH6dB//8DcWo2AkQgBEEBaiEEDAELCyAEIBdIDQEgEkFgaiEYIAdB4ABqIRogB0HkAGohGyABIQMDQCAHQShqEARBAksgBCAFTnJFBEAgBygCQCAHKAI8QQN0aikCACIdQhCIp0H/AXEhCyAHKAJQIAcoAkxBA3RqKQIAIh5CEIinQf8BcSEIIAcoAkggBygCREEDdGopAgAiH0IgiKchCSAeQiCIISAgHUIgiKchDAJAIB9CEIinQf8BcSICQQJPBEACQCAGRSACQRlJckUEQCAJIAdBKGogAkEgIAcoAixrIgogCiACSxsiChAFIAIgCmsiAnRqIQkgB0EoahAEGiACRQ0BIAdBKGogAhAFIAlqIQkMAQsgB0EoaiACEAUgCWohCSAHQShqEAQaCyAHKQJUISEgByAJNgJUIAcgITcDWAwBCwJAIAJFBEAgDARAIAcoAlQhCQwDCyAHKAJYIQkMAQsCQAJAIAdBKGpBARAFIAkgDEVqaiICQQNGBEAgBygCVEF/aiICIAJFaiEJDAELIAJBAnQgB2ooAlQiCSAJRWohCSACQQFGDQELIAcgBygCWDYCXAsLIAcgBygCVDYCWCAHIAk2AlQLICCnIRQgCARAIAdBKGogCBAFIBRqIRQLIAggC2pBFE8EQCAHQShqEAQaCyALBEAgB0EoaiALEAUgDGohDAsgB0EoahAEGiAHIAcoAmggDGoiGSAUajYCaCAbIBogCSAZSxsoAgAhHCAHIAdBKGogHUIYiKdB/wFxEAggHadB//8DcWo2AjwgByAHQShqIB5CGIinQf8BcRAIIB6nQf//A3FqNgJMIAdBKGoQBBogByAHQShqIB9CGIinQf8BcRAIIB+nQf//A3FqNgJEIAcgB0HwAGogBEEDcUEEdGoiDSkDCCIdNwPIASAHIA0pAwAiHjcDwAECQAJAAkAgBygCvAEiDiAepyICaiIWIBNLDQAgAyAHKALEASIKIAJqIgtqIBhLDQAgEiADayALQSBqTw0BCyAHIAcpA8gBNwMQIAcgBykDwAE3AwggAyASIAdBCGogB0G8AWogEyAPIBUgERAeIQsMAQsgAiADaiEIIAMgDhAHIAJBEU8EQCADQRBqIQIDQCACIA5BEGoiDhAHIAJBEGoiAiAISQ0ACwsgCCAdpyIOayECIAcgFjYCvAEgDiAIIA9rSwRAIA4gCCAVa0sEQEFsIQsMAgsgESACIA9rIgJqIhYgCmogEU0EQCAIIBYgChAPGgwCCyAIIBZBACACaxAPIQggByACIApqIgo2AsQBIAggAmshCCAPIQILIA5BEE8EQCAIIApqIQoDQCAIIAIQByACQRBqIQIgCEEQaiIIIApJDQALDAELAkAgDkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgDkECdCIKQcAeaigCAGoiAhAXIAIgCkHgHmooAgBrIQIgBygCxAEhCgwBCyAIIAIQDAsgCkEJSQ0AIAggCmohCiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAKSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAKSQ0ACwsgCxADBEAgCyEQDAQFIA0gDDYCACANIBkgHGogCWs2AgwgDSAJNgIIIA0gFDYCBCAEQQFqIQQgAyALaiEDDAILAAsLIAQgBUgNASAEIBdrIQtBACEEA0AgCyAFSARAIAcgB0HwAGogC0EDcUEEdGoiAikDCCIdNwPIASAHIAIpAwAiHjcDwAECQAJAAkAgBygCvAEiDCAepyICaiIKIBNLDQAgAyAHKALEASIJIAJqIhBqIBhLDQAgEiADayAQQSBqTw0BCyAHIAcpA8gBNwMgIAcgBykDwAE3AxggAyASIAdBGGogB0G8AWogEyAPIBUgERAeIRAMAQsgAiADaiEIIAMgDBAHIAJBEU8EQCADQRBqIQIDQCACIAxBEGoiDBAHIAJBEGoiAiAISQ0ACwsgCCAdpyIGayECIAcgCjYCvAEgBiAIIA9rSwRAIAYgCCAVa0sEQEFsIRAMAgsgESACIA9rIgJqIgwgCWogEU0EQCAIIAwgCRAPGgwCCyAIIAxBACACaxAPIQggByACIAlqIgk2AsQBIAggAmshCCAPIQILIAZBEE8EQCAIIAlqIQYDQCAIIAIQByACQRBqIQIgCEEQaiIIIAZJDQALDAELAkAgBkEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgBkECdCIGQcAeaigCAGoiAhAXIAIgBkHgHmooAgBrIQIgBygCxAEhCQwBCyAIIAIQDAsgCUEJSQ0AIAggCWohBiAIQQhqIgggAkEIaiICa0EPTARAA0AgCCACEAwgAkEIaiECIAhBCGoiCCAGSQ0ADAIACwALA0AgCCACEAcgAkEQaiECIAhBEGoiCCAGSQ0ACwsgEBADDQMgC0EBaiELIAMgEGohAwwBCwsDQCAEQQNHBEAgACAEQQJ0IgJqQazQAWogAiAHaigCVDYCACAEQQFqIQQMAQsLIAcoArwBIQgLQbp/IRAgEyAIayIAIBIgA2tLDQAgAwR/IAMgCCAAEAsgAGoFQQALIAFrIRALIAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY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wOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEE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\";export{Q as ZSTDDecoder};\n","/**\n * Loader for KTX 2.0 GPU Texture containers.\n *\n * KTX 2.0 is a container format for various GPU texture formats. The loader\n * supports Basis Universal GPU textures, which can be quickly transcoded to\n * a wide variety of GPU texture compression formats, as well as some\n * uncompressed DataTexture and Data3DTexture formats.\n *\n * References:\n * - KTX: http://github.khronos.org/KTX-Specification/\n * - DFD: https://www.khronos.org/registry/DataFormat/specs/1.3/dataformat.1.3.html#basicdescriptor\n * - BasisU HDR: https://github.com/BinomialLLC/basis_universal/wiki/UASTC-HDR-Texture-Specification-v1.0\n */\n\nimport {\n\tCompressedTexture,\n\tCompressedArrayTexture,\n\tCompressedCubeTexture,\n\tData3DTexture,\n\tDataTexture,\n\tFileLoader,\n\tFloatType,\n\tHalfFloatType,\n\tNoColorSpace,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearSRGBColorSpace,\n\tLoader,\n\tRedFormat,\n\tRGB_BPTC_UNSIGNED_Format,\n\tRGB_ETC1_Format,\n\tRGB_ETC2_Format,\n\tRGB_PVRTC_4BPPV1_Format,\n\tRGBA_ASTC_4x4_Format,\n\tRGBA_ASTC_6x6_Format,\n\tRGBA_BPTC_Format,\n\tRGBA_ETC2_EAC_Format,\n\tRGBA_PVRTC_4BPPV1_Format,\n\tRGBA_S3TC_DXT5_Format,\n\tRGBA_S3TC_DXT1_Format,\n\tRGBAFormat,\n\tRGFormat,\n\tSRGBColorSpace,\n\tUnsignedByteType,\n} from 'three';\nimport { WorkerPool } from '../utils/WorkerPool.js';\nimport {\n\tread,\n\tKHR_DF_FLAG_ALPHA_PREMULTIPLIED,\n\tKHR_DF_TRANSFER_SRGB,\n\tKHR_SUPERCOMPRESSION_NONE,\n\tKHR_SUPERCOMPRESSION_ZSTD,\n\tVK_FORMAT_UNDEFINED,\n\tVK_FORMAT_R16_SFLOAT,\n\tVK_FORMAT_R16G16_SFLOAT,\n\tVK_FORMAT_R16G16B16A16_SFLOAT,\n\tVK_FORMAT_R32_SFLOAT,\n\tVK_FORMAT_R32G32_SFLOAT,\n\tVK_FORMAT_R32G32B32A32_SFLOAT,\n\tVK_FORMAT_R8_SRGB,\n\tVK_FORMAT_R8_UNORM,\n\tVK_FORMAT_R8G8_SRGB,\n\tVK_FORMAT_R8G8_UNORM,\n\tVK_FORMAT_R8G8B8A8_SRGB,\n\tVK_FORMAT_R8G8B8A8_UNORM,\n\tVK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT,\n\tVK_FORMAT_ASTC_6x6_SRGB_BLOCK,\n\tVK_FORMAT_ASTC_6x6_UNORM_BLOCK,\n\tKHR_DF_PRIMARIES_UNSPECIFIED,\n\tKHR_DF_PRIMARIES_BT709,\n\tKHR_DF_PRIMARIES_DISPLAYP3\n} from '../libs/ktx-parse.module.js';\nimport { ZSTDDecoder } from '../libs/zstddec.module.js';\nimport { DisplayP3ColorSpace, LinearDisplayP3ColorSpace } from '../math/ColorSpaces.js';\n\nconst _taskCache = new WeakMap();\n\nlet _activeLoaders = 0;\n\nlet _zstd;\n\nclass KTX2Loader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.transcoderPath = '';\n\t\tthis.transcoderBinary = null;\n\t\tthis.transcoderPending = null;\n\n\t\tthis.workerPool = new WorkerPool();\n\t\tthis.workerSourceURL = '';\n\t\tthis.workerConfig = null;\n\n\t\tif ( typeof MSC_TRANSCODER !== 'undefined' ) {\n\n\t\t\tconsole.warn(\n\n\t\t\t\t'THREE.KTX2Loader: Please update to latest \"basis_transcoder\".'\n\t\t\t\t+ ' \"msc_basis_transcoder\" is no longer supported in three.js r125+.'\n\n\t\t\t);\n\n\t\t}\n\n\t}\n\n\tsetTranscoderPath( path ) {\n\n\t\tthis.transcoderPath = path;\n\n\t\treturn this;\n\n\t}\n\n\tsetWorkerLimit( num ) {\n\n\t\tthis.workerPool.setWorkerLimit( num );\n\n\t\treturn this;\n\n\t}\n\n\tasync detectSupportAsync( renderer ) {\n\n\t\tthis.workerConfig = {\n\t\t\tastcSupported: await renderer.hasFeatureAsync( 'texture-compression-astc' ),\n\t\t\tastcHDRSupported: false, // https://github.com/gpuweb/gpuweb/issues/3856\n\t\t\tetc1Supported: await renderer.hasFeatureAsync( 'texture-compression-etc1' ),\n\t\t\tetc2Supported: await renderer.hasFeatureAsync( 'texture-compression-etc2' ),\n\t\t\tdxtSupported: await renderer.hasFeatureAsync( 'texture-compression-bc' ),\n\t\t\tbptcSupported: await renderer.hasFeatureAsync( 'texture-compression-bptc' ),\n\t\t\tpvrtcSupported: await renderer.hasFeatureAsync( 'texture-compression-pvrtc' )\n\t\t};\n\n\t\treturn this;\n\n\t}\n\n\tdetectSupport( renderer ) {\n\n\t\tif ( renderer.isWebGPURenderer === true ) {\n\n\t\t\tthis.workerConfig = {\n\t\t\t\tastcSupported: renderer.hasFeature( 'texture-compression-astc' ),\n\t\t\t\tastcHDRSupported: false, // https://github.com/gpuweb/gpuweb/issues/3856\n\t\t\t\tetc1Supported: renderer.hasFeature( 'texture-compression-etc1' ),\n\t\t\t\tetc2Supported: renderer.hasFeature( 'texture-compression-etc2' ),\n\t\t\t\tdxtSupported: renderer.hasFeature( 'texture-compression-bc' ),\n\t\t\t\tbptcSupported: renderer.hasFeature( 'texture-compression-bptc' ),\n\t\t\t\tpvrtcSupported: renderer.hasFeature( 'texture-compression-pvrtc' )\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tthis.workerConfig = {\n\t\t\t\tastcSupported: renderer.extensions.has( 'WEBGL_compressed_texture_astc' ),\n\t\t\t\tastcHDRSupported: renderer.extensions.has( 'WEBGL_compressed_texture_astc' )\n\t\t\t\t\t&& renderer.extensions.get( 'WEBGL_compressed_texture_astc' ).getSupportedProfiles().includes( 'hdr' ),\n\t\t\t\tetc1Supported: renderer.extensions.has( 'WEBGL_compressed_texture_etc1' ),\n\t\t\t\tetc2Supported: renderer.extensions.has( 'WEBGL_compressed_texture_etc' ),\n\t\t\t\tdxtSupported: renderer.extensions.has( 'WEBGL_compressed_texture_s3tc' ),\n\t\t\t\tbptcSupported: renderer.extensions.has( 'EXT_texture_compression_bptc' ),\n\t\t\t\tpvrtcSupported: renderer.extensions.has( 'WEBGL_compressed_texture_pvrtc' )\n\t\t\t\t\t|| renderer.extensions.has( 'WEBKIT_WEBGL_compressed_texture_pvrtc' )\n\t\t\t};\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tinit() {\n\n\t\tif ( ! this.transcoderPending ) {\n\n\t\t\t// Load transcoder wrapper.\n\t\t\tconst jsLoader = new FileLoader( this.manager );\n\t\t\tjsLoader.setPath( this.transcoderPath );\n\t\t\tjsLoader.setWithCredentials( this.withCredentials );\n\t\t\tconst jsContent = jsLoader.loadAsync( 'basis_transcoder.js' );\n\n\t\t\t// Load transcoder WASM binary.\n\t\t\tconst binaryLoader = new FileLoader( this.manager );\n\t\t\tbinaryLoader.setPath( this.transcoderPath );\n\t\t\tbinaryLoader.setResponseType( 'arraybuffer' );\n\t\t\tbinaryLoader.setWithCredentials( this.withCredentials );\n\t\t\tconst binaryContent = binaryLoader.loadAsync( 'basis_transcoder.wasm' );\n\n\t\t\tthis.transcoderPending = Promise.all( [ jsContent, binaryContent ] )\n\t\t\t\t.then( ( [ jsContent, binaryContent ] ) => {\n\n\t\t\t\t\tconst fn = KTX2Loader.BasisWorker.toString();\n\n\t\t\t\t\tconst body = [\n\t\t\t\t\t\t'/* constants */',\n\t\t\t\t\t\t'let _EngineFormat = ' + JSON.stringify( KTX2Loader.EngineFormat ),\n\t\t\t\t\t\t'let _EngineType = ' + JSON.stringify( KTX2Loader.EngineType ),\n\t\t\t\t\t\t'let _TranscoderFormat = ' + JSON.stringify( KTX2Loader.TranscoderFormat ),\n\t\t\t\t\t\t'let _BasisFormat = ' + JSON.stringify( KTX2Loader.BasisFormat ),\n\t\t\t\t\t\t'/* basis_transcoder.js */',\n\t\t\t\t\t\tjsContent,\n\t\t\t\t\t\t'/* worker */',\n\t\t\t\t\t\tfn.substring( fn.indexOf( '{' ) + 1, fn.lastIndexOf( '}' ) )\n\t\t\t\t\t].join( '\\n' );\n\n\t\t\t\t\tthis.workerSourceURL = URL.createObjectURL( new Blob( [ body ] ) );\n\t\t\t\t\tthis.transcoderBinary = binaryContent;\n\n\t\t\t\t\tthis.workerPool.setWorkerCreator( () => {\n\n\t\t\t\t\t\tconst worker = new Worker( this.workerSourceURL );\n\t\t\t\t\t\tconst transcoderBinary = this.transcoderBinary.slice( 0 );\n\n\t\t\t\t\t\tworker.postMessage( { type: 'init', config: this.workerConfig, transcoderBinary }, [ transcoderBinary ] );\n\n\t\t\t\t\t\treturn worker;\n\n\t\t\t\t\t} );\n\n\t\t\t\t} );\n\n\t\t\tif ( _activeLoaders > 0 ) {\n\n\t\t\t\t// Each instance loads a transcoder and allocates workers, increasing network and memory cost.\n\n\t\t\t\tconsole.warn(\n\n\t\t\t\t\t'THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues.'\n\t\t\t\t\t+ ' Use a single KTX2Loader instance, or call .dispose() on old instances.'\n\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\t_activeLoaders ++;\n\n\t\t}\n\n\t\treturn this.transcoderPending;\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\n\t\tif ( this.workerConfig === null ) {\n\n\t\t\tthrow new Error( 'THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.' );\n\n\t\t}\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setWithCredentials( this.withCredentials );\n\n\t\tloader.load( url, ( buffer ) => {\n\n\t\t\tthis.parse( buffer, onLoad, onError );\n\n\t\t}, onProgress, onError );\n\n\t}\n\n\tparse( buffer, onLoad, onError ) {\n\n\t\tif ( this.workerConfig === null ) {\n\n\t\t\tthrow new Error( 'THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.' );\n\n\t\t}\n\n\t\t// Check for an existing task using this buffer. A transferred buffer cannot be transferred\n\t\t// again from this thread.\n\t\tif ( _taskCache.has( buffer ) ) {\n\n\t\t\tconst cachedTask = _taskCache.get( buffer );\n\n\t\t\treturn cachedTask.promise.then( onLoad ).catch( onError );\n\n\t\t}\n\n\t\tthis._createTexture( buffer )\n\t\t\t.then( ( texture ) => onLoad ? onLoad( texture ) : null )\n\t\t\t.catch( onError );\n\n\t}\n\n\t_createTextureFrom( transcodeResult, container ) {\n\n\t\tconst { type: messageType, error, data: { faces, width, height, format, type, dfdFlags } } = transcodeResult;\n\n\t\tif ( messageType === 'error' ) return Promise.reject( error );\n\n\t\tlet texture;\n\n\t\tif ( container.faceCount === 6 ) {\n\n\t\t\ttexture = new CompressedCubeTexture( faces, format, type );\n\n\t\t} else {\n\n\t\t\tconst mipmaps = faces[ 0 ].mipmaps;\n\n\t\t\ttexture = container.layerCount > 1\n\t\t\t\t? new CompressedArrayTexture( mipmaps, width, height, container.layerCount, format, type )\n\t\t\t\t: new CompressedTexture( mipmaps, width, height, format, type );\n\n\t\t}\n\n\t\ttexture.minFilter = faces[ 0 ].mipmaps.length === 1 ? LinearFilter : LinearMipmapLinearFilter;\n\t\ttexture.magFilter = LinearFilter;\n\t\ttexture.generateMipmaps = false;\n\n\t\ttexture.needsUpdate = true;\n\t\ttexture.colorSpace = parseColorSpace( container );\n\t\ttexture.premultiplyAlpha = !! ( dfdFlags & KHR_DF_FLAG_ALPHA_PREMULTIPLIED );\n\n\t\treturn texture;\n\n\t}\n\n\t/**\n\t * @param {ArrayBuffer} buffer\n\t * @param {?Object} config\n\t * @return {Promise<CompressedTexture|CompressedArrayTexture|DataTexture|Data3DTexture>}\n\t */\n\tasync _createTexture( buffer, config = {} ) {\n\n\t\tconst container = read( new Uint8Array( buffer ) );\n\n\t\t// Basis UASTC HDR is a subset of ASTC, which can be transcoded efficiently\n\t\t// to BC6H. To detect whether a KTX2 file uses Basis UASTC HDR, or default\n\t\t// ASTC, inspect the DFD color model.\n\t\t//\n\t\t// Source: https://github.com/BinomialLLC/basis_universal/issues/381\n\t\tconst isBasisHDR = container.vkFormat === VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT\n\t\t\t&& container.dataFormatDescriptor[ 0 ].colorModel === 0xA7;\n\n\t\t// If the device supports ASTC, Basis UASTC HDR requires no transcoder.\n\t\tconst needsTranscoder = container.vkFormat === VK_FORMAT_UNDEFINED\n\t\t\t|| isBasisHDR && ! this.workerConfig.astcHDRSupported;\n\n\t\tif ( ! needsTranscoder ) {\n\n\t\t\treturn createRawTexture( container );\n\n\t\t}\n\n\t\t//\n\t\tconst taskConfig = config;\n\t\tconst texturePending = this.init().then( () => {\n\n\t\t\treturn this.workerPool.postMessage( { type: 'transcode', buffer, taskConfig: taskConfig }, [ buffer ] );\n\n\t\t} ).then( ( e ) => this._createTextureFrom( e.data, container ) );\n\n\t\t// Cache the task result.\n\t\t_taskCache.set( buffer, { promise: texturePending } );\n\n\t\treturn texturePending;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.workerPool.dispose();\n\t\tif ( this.workerSourceURL ) URL.revokeObjectURL( this.workerSourceURL );\n\n\t\t_activeLoaders --;\n\n\t\treturn this;\n\n\t}\n\n}\n\n\n/* CONSTANTS */\n\nKTX2Loader.BasisFormat = {\n\tETC1S: 0,\n\tUASTC: 1,\n\tUASTC_HDR: 2,\n};\n\n// Source: https://github.com/BinomialLLC/basis_universal/blob/master/webgl/texture_test/index.html\nKTX2Loader.TranscoderFormat = {\n\tETC1: 0,\n\tETC2: 1,\n\tBC1: 2,\n\tBC3: 3,\n\tBC4: 4,\n\tBC5: 5,\n\tBC7_M6_OPAQUE_ONLY: 6,\n\tBC7_M5: 7,\n\tPVRTC1_4_RGB: 8,\n\tPVRTC1_4_RGBA: 9,\n\tASTC_4x4: 10,\n\tATC_RGB: 11,\n\tATC_RGBA_INTERPOLATED_ALPHA: 12,\n\tRGBA32: 13,\n\tRGB565: 14,\n\tBGR565: 15,\n\tRGBA4444: 16,\n\tBC6H: 22,\n\tRGB_HALF: 24,\n\tRGBA_HALF: 25,\n};\n\nKTX2Loader.EngineFormat = {\n\tRGBAFormat: RGBAFormat,\n\tRGBA_ASTC_4x4_Format: RGBA_ASTC_4x4_Format,\n\tRGB_BPTC_UNSIGNED_Format: RGB_BPTC_UNSIGNED_Format,\n\tRGBA_BPTC_Format: RGBA_BPTC_Format,\n\tRGBA_ETC2_EAC_Format: RGBA_ETC2_EAC_Format,\n\tRGBA_PVRTC_4BPPV1_Format: RGBA_PVRTC_4BPPV1_Format,\n\tRGBA_S3TC_DXT5_Format: RGBA_S3TC_DXT5_Format,\n\tRGB_ETC1_Format: RGB_ETC1_Format,\n\tRGB_ETC2_Format: RGB_ETC2_Format,\n\tRGB_PVRTC_4BPPV1_Format: RGB_PVRTC_4BPPV1_Format,\n\tRGBA_S3TC_DXT1_Format: RGBA_S3TC_DXT1_Format,\n};\n\nKTX2Loader.EngineType = {\n\tUnsignedByteType: UnsignedByteType,\n\tHalfFloatType: HalfFloatType,\n\tFloatType: FloatType,\n};\n\n/* WEB WORKER */\n\nKTX2Loader.BasisWorker = function () {\n\n\tlet config;\n\tlet transcoderPending;\n\tlet BasisModule;\n\n\tconst EngineFormat = _EngineFormat; // eslint-disable-line no-undef\n\tconst EngineType = _EngineType; // eslint-disable-line no-undef\n\tconst TranscoderFormat = _TranscoderFormat; // eslint-disable-line no-undef\n\tconst BasisFormat = _BasisFormat; // eslint-disable-line no-undef\n\n\tself.addEventListener( 'message', function ( e ) {\n\n\t\tconst message = e.data;\n\n\t\tswitch ( message.type ) {\n\n\t\t\tcase 'init':\n\t\t\t\tconfig = message.config;\n\t\t\t\tinit( message.transcoderBinary );\n\t\t\t\tbreak;\n\n\t\t\tcase 'transcode':\n\t\t\t\ttranscoderPending.then( () => {\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tconst { faces, buffers, width, height, hasAlpha, format, type, dfdFlags } = transcode( message.buffer );\n\n\t\t\t\t\t\tself.postMessage( { type: 'transcode', id: message.id, data: { faces, width, height, hasAlpha, format, type, dfdFlags } }, buffers );\n\n\t\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\t\tconsole.error( error );\n\n\t\t\t\t\t\tself.postMessage( { type: 'error', id: message.id, error: error.message } );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\t\t\t\tbreak;\n\n\t\t}\n\n\t} );\n\n\tfunction init( wasmBinary ) {\n\n\t\ttranscoderPending = new Promise( ( resolve ) => {\n\n\t\t\tBasisModule = { wasmBinary, onRuntimeInitialized: resolve };\n\t\t\tBASIS( BasisModule ); // eslint-disable-line no-undef\n\n\t\t} ).then( () => {\n\n\t\t\tBasisModule.initializeBasis();\n\n\t\t\tif ( BasisModule.KTX2File === undefined ) {\n\n\t\t\t\tconsole.warn( 'THREE.KTX2Loader: Please update Basis Universal transcoder.' );\n\n\t\t\t}\n\n\t\t} );\n\n\t}\n\n\tfunction transcode( buffer ) {\n\n\t\tconst ktx2File = new BasisModule.KTX2File( new Uint8Array( buffer ) );\n\n\t\tfunction cleanup() {\n\n\t\t\tktx2File.close();\n\t\t\tktx2File.delete();\n\n\t\t}\n\n\t\tif ( ! ktx2File.isValid() ) {\n\n\t\t\tcleanup();\n\t\t\tthrow new Error( 'THREE.KTX2Loader:\tInvalid or unsupported .ktx2 file' );\n\n\t\t}\n\n\t\tlet basisFormat;\n\n\t\tif ( ktx2File.isUASTC() ) {\n\n\t\t\tbasisFormat = BasisFormat.UASTC;\n\n\t\t} else if ( ktx2File.isETC1S() ) {\n\n\t\t\tbasisFormat = BasisFormat.ETC1S;\n\n\t\t} else if ( ktx2File.isHDR() ) {\n\n\t\t\tbasisFormat = BasisFormat.UASTC_HDR;\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.KTX2Loader: Unknown Basis encoding' );\n\n\t\t}\n\n\t\tconst width = ktx2File.getWidth();\n\t\tconst height = ktx2File.getHeight();\n\t\tconst layerCount = ktx2File.getLayers() || 1;\n\t\tconst levelCount = ktx2File.getLevels();\n\t\tconst faceCount = ktx2File.getFaces();\n\t\tconst hasAlpha = ktx2File.getHasAlpha();\n\t\tconst dfdFlags = ktx2File.getDFDFlags();\n\n\t\tconst { transcoderFormat, engineFormat, engineType } = getTranscoderFormat( basisFormat, width, height, hasAlpha );\n\n\t\tif ( ! width || ! height || ! levelCount ) {\n\n\t\t\tcleanup();\n\t\t\tthrow new Error( 'THREE.KTX2Loader:\tInvalid texture' );\n\n\t\t}\n\n\t\tif ( ! ktx2File.startTranscoding() ) {\n\n\t\t\tcleanup();\n\t\t\tthrow new Error( 'THREE.KTX2Loader: .startTranscoding failed' );\n\n\t\t}\n\n\t\tconst faces = [];\n\t\tconst buffers = [];\n\n\t\tfor ( let face = 0; face < faceCount; face ++ ) {\n\n\t\t\tconst mipmaps = [];\n\n\t\t\tfor ( let mip = 0; mip < levelCount; mip ++ ) {\n\n\t\t\t\tconst layerMips = [];\n\n\t\t\t\tlet mipWidth, mipHeight;\n\n\t\t\t\tfor ( let layer = 0; layer < layerCount; layer ++ ) {\n\n\t\t\t\t\tconst levelInfo = ktx2File.getImageLevelInfo( mip, layer, face );\n\n\t\t\t\t\tif ( face === 0 && mip === 0 && layer === 0 && ( levelInfo.origWidth % 4 !== 0 || levelInfo.origHeight % 4 !== 0 ) ) {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( levelCount > 1 ) {\n\n\t\t\t\t\t\tmipWidth = levelInfo.origWidth;\n\t\t\t\t\t\tmipHeight = levelInfo.origHeight;\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// Handles non-multiple-of-four dimensions in textures without mipmaps. Textures with\n\t\t\t\t\t\t// mipmaps must use multiple-of-four dimensions, for some texture formats and APIs.\n\t\t\t\t\t\t// See mrdoob/three.js#25908.\n\t\t\t\t\t\tmipWidth = levelInfo.width;\n\t\t\t\t\t\tmipHeight = levelInfo.height;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlet dst = new Uint8Array( ktx2File.getImageTranscodedSizeInBytes( mip, layer, 0, transcoderFormat ) );\n\t\t\t\t\tconst status = ktx2File.transcodeImage( dst, mip, layer, face, transcoderFormat, 0, - 1, - 1 );\n\n\t\t\t\t\tif ( engineType === EngineType.HalfFloatType ) {\n\n\t\t\t\t\t\tdst = new Uint16Array( dst.buffer, dst.byteOffset, dst.byteLength / Uint16Array.BYTES_PER_ELEMENT );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( ! status ) {\n\n\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\tthrow new Error( 'THREE.KTX2Loader: .transcodeImage failed.' );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tlayerMips.push( dst );\n\n\t\t\t\t}\n\n\t\t\t\tconst mipData = concat( layerMips );\n\n\t\t\t\tmipmaps.push( { data: mipData, width: mipWidth, height: mipHeight } );\n\t\t\t\tbuffers.push( mipData.buffer );\n\n\t\t\t}\n\n\t\t\tfaces.push( { mipmaps, width, height, format: engineFormat, type: engineType } );\n\n\t\t}\n\n\t\tcleanup();\n\n\t\treturn { faces, buffers, width, height, hasAlpha, dfdFlags, format: engineFormat, type: engineType };\n\n\t}\n\n\t//\n\n\t// Optimal choice of a transcoder target format depends on the Basis format (ETC1S, UASTC, or\n\t// UASTC HDR), device capabilities, and texture dimensions. The list below ranks the formats\n\t// separately for each format. Currently, priority is assigned based on:\n\t//\n\t//   high quality > low quality > uncompressed\n\t//\n\t// Prioritization may be revisited, or exposed for configuration, in the future.\n\t//\n\t// Reference: https://github.com/KhronosGroup/3D-Formats-Guidelines/blob/main/KTXDeveloperGuide.md\n\tconst FORMAT_OPTIONS = [\n\t\t{\n\t\t\tif: 'astcSupported',\n\t\t\tbasisFormat: [ BasisFormat.UASTC ],\n\t\t\ttranscoderFormat: [ TranscoderFormat.ASTC_4x4, TranscoderFormat.ASTC_4x4 ],\n\t\t\tengineFormat: [ EngineFormat.RGBA_ASTC_4x4_Format, EngineFormat.RGBA_ASTC_4x4_Format ],\n\t\t\tengineType: [ EngineType.UnsignedByteType ],\n\t\t\tpriorityETC1S: Infinity,\n\t\t\tpriorityUASTC: 1,\n\t\t\tneedsPowerOfTwo: false,\n\t\t},\n\t\t{\n\t\t\tif: 'bptcSupported',\n\t\t\tbasisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC ],\n\t\t\ttranscoderFormat: [ TranscoderFormat.BC7_M5, TranscoderFormat.BC7_M5 ],\n\t\t\tengineFormat: [ EngineFormat.RGBA_BPTC_Format, EngineFormat.RGBA_BPTC_Format ],\n\t\t\tengineType: [ EngineType.UnsignedByteType ],\n\t\t\tpriorityETC1S: 3,\n\t\t\tpriorityUASTC: 2,\n\t\t\tneedsPowerOfTwo: false,\n\t\t},\n\t\t{\n\t\t\tif: 'dxtSupported',\n\t\t\tbasisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC ],\n\t\t\ttranscoderFormat: [ TranscoderFormat.BC1, TranscoderFormat.BC3 ],\n\t\t\tengineFormat: [ EngineFormat.RGBA_S3TC_DXT1_Format, EngineFormat.RGBA_S3TC_DXT5_Format ],\n\t\t\tengineType: [ EngineType.UnsignedByteType ],\n\t\t\tpriorityETC1S: 4,\n\t\t\tpriorityUASTC: 5,\n\t\t\tneedsPowerOfTwo: false,\n\t\t},\n\t\t{\n\t\t\tif: 'etc2Supported',\n\t\t\tbasisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC ],\n\t\t\ttranscoderFormat: [ TranscoderFormat.ETC1, TranscoderFormat.ETC2 ],\n\t\t\tengineFormat: [ EngineFormat.RGB_ETC2_Format, EngineFormat.RGBA_ETC2_EAC_Format ],\n\t\t\tengineType: [ EngineType.UnsignedByteType ],\n\t\t\tpriorityETC1S: 1,\n\t\t\tpriorityUASTC: 3,\n\t\t\tneedsPowerOfTwo: false,\n\t\t},\n\t\t{\n\t\t\tif: 'etc1Supported',\n\t\t\tbasisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC ],\n\t\t\ttranscoderFormat: [ TranscoderFormat.ETC1 ],\n\t\t\tengineFormat: [ EngineFormat.RGB_ETC1_Format ],\n\t\t\tengineType: [ EngineType.UnsignedByteType ],\n\t\t\tpriorityETC1S: 2,\n\t\t\tpriorityUASTC: 4,\n\t\t\tneedsPowerOfTwo: false,\n\t\t},\n\t\t{\n\t\t\tif: 'pvrtcSupported',\n\t\t\tbasisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC ],\n\t\t\ttranscoderFormat: [ TranscoderFormat.PVRTC1_4_RGB, TranscoderFormat.PVRTC1_4_RGBA ],\n\t\t\tengineFormat: [ EngineFormat.RGB_PVRTC_4BPPV1_Format, EngineFormat.RGBA_PVRTC_4BPPV1_Format ],\n\t\t\tengineType: [ EngineType.UnsignedByteType ],\n\t\t\tpriorityETC1S: 5,\n\t\t\tpriorityUASTC: 6,\n\t\t\tneedsPowerOfTwo: true,\n\t\t},\n\t\t{\n\t\t\tif: 'bptcSupported',\n\t\t\tbasisFormat: [ BasisFormat.UASTC_HDR ],\n\t\t\ttranscoderFormat: [ TranscoderFormat.BC6H ],\n\t\t\tengineFormat: [ EngineFormat.RGB_BPTC_UNSIGNED_Format ],\n\t\t\tengineType: [ EngineType.HalfFloatType ],\n\t\t\tpriorityHDR: 1,\n\t\t\tneedsPowerOfTwo: false,\n\t\t},\n\n\t\t// Uncompressed fallbacks.\n\n\t\t{\n\t\t\tbasisFormat: [ BasisFormat.ETC1S, BasisFormat.UASTC ],\n\t\t\ttranscoderFormat: [ TranscoderFormat.RGBA32, TranscoderFormat.RGBA32 ],\n\t\t\tengineFormat: [ EngineFormat.RGBAFormat, EngineFormat.RGBAFormat ],\n\t\t\tengineType: [ EngineType.UnsignedByteType, EngineType.UnsignedByteType ],\n\t\t\tpriorityETC1S: 100,\n\t\t\tpriorityUASTC: 100,\n\t\t\tneedsPowerOfTwo: false,\n\t\t},\n\t\t{\n\t\t\tbasisFormat: [ BasisFormat.UASTC_HDR ],\n\t\t\ttranscoderFormat: [ TranscoderFormat.RGBA_HALF ],\n\t\t\tengineFormat: [ EngineFormat.RGBAFormat ],\n\t\t\tengineType: [ EngineType.HalfFloatType ],\n\t\t\tpriorityHDR: 100,\n\t\t\tneedsPowerOfTwo: false,\n\t\t}\n\t];\n\n\tconst OPTIONS = {\n\t\t// TODO: For ETC1S we intentionally sort by _UASTC_ priority, preserving\n\t\t// a historical accident shown to avoid performance pitfalls for Linux with\n\t\t// Firefox & AMD GPU (RadeonSI). Further work needed.\n\t\t// See https://github.com/mrdoob/three.js/pull/29730.\n\t\t[ BasisFormat.ETC1S ]: FORMAT_OPTIONS\n\t\t\t.filter( ( opt ) => opt.basisFormat.includes( BasisFormat.ETC1S ) )\n\t\t\t.sort( ( a, b ) => a.priorityUASTC - b.priorityUASTC ),\n\n\t\t[ BasisFormat.UASTC ]: FORMAT_OPTIONS\n\t\t\t.filter( ( opt ) => opt.basisFormat.includes( BasisFormat.UASTC ) )\n\t\t\t.sort( ( a, b ) => a.priorityUASTC - b.priorityUASTC ),\n\n\t\t[ BasisFormat.UASTC_HDR ]: FORMAT_OPTIONS\n\t\t\t.filter( ( opt ) => opt.basisFormat.includes( BasisFormat.UASTC_HDR ) )\n\t\t\t.sort( ( a, b ) => a.priorityHDR - b.priorityHDR ),\n\t};\n\n\tfunction getTranscoderFormat( basisFormat, width, height, hasAlpha ) {\n\n\t\tconst options = OPTIONS[ basisFormat ];\n\n\t\tfor ( let i = 0; i < options.length; i ++ ) {\n\n\t\t\tconst opt = options[ i ];\n\n\t\t\tif ( opt.if && ! config[ opt.if ] ) continue;\n\t\t\tif ( ! opt.basisFormat.includes( basisFormat ) ) continue;\n\t\t\tif ( hasAlpha && opt.transcoderFormat.length < 2 ) continue;\n\t\t\tif ( opt.needsPowerOfTwo && ! ( isPowerOfTwo( width ) && isPowerOfTwo( height ) ) ) continue;\n\n\t\t\tconst transcoderFormat = opt.transcoderFormat[ hasAlpha ? 1 : 0 ];\n\t\t\tconst engineFormat = opt.engineFormat[ hasAlpha ? 1 : 0 ];\n\t\t\tconst engineType = opt.engineType[ 0 ];\n\n\t\t\treturn { transcoderFormat, engineFormat, engineType };\n\n\t\t}\n\n\t\tthrow new Error( 'THREE.KTX2Loader: Failed to identify transcoding target.' );\n\n\t}\n\n\tfunction isPowerOfTwo( value ) {\n\n\t\tif ( value <= 2 ) return true;\n\n\t\treturn ( value & ( value - 1 ) ) === 0 && value !== 0;\n\n\t}\n\n\t/**\n\t * Concatenates N byte arrays.\n\t *\n\t * @param {Uint8Array[]} arrays\n\t * @return {Uint8Array}\n\t */\n\tfunction concat( arrays ) {\n\n\t\tif ( arrays.length === 1 ) return arrays[ 0 ];\n\n\t\tlet totalByteLength = 0;\n\n\t\tfor ( let i = 0; i < arrays.length; i ++ ) {\n\n\t\t\tconst array = arrays[ i ];\n\t\t\ttotalByteLength += array.byteLength;\n\n\t\t}\n\n\t\tconst result = new Uint8Array( totalByteLength );\n\n\t\tlet byteOffset = 0;\n\n\t\tfor ( let i = 0; i < arrays.length; i ++ ) {\n\n\t\t\tconst array = arrays[ i ];\n\t\t\tresult.set( array, byteOffset );\n\n\t\t\tbyteOffset += array.byteLength;\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n};\n\n// Parsing for non-Basis textures. These textures may have supercompression\n// like Zstd, but they do not require transcoding.\n\nconst UNCOMPRESSED_FORMATS = new Set( [ RGBAFormat, RGFormat, RedFormat ] );\n\nconst FORMAT_MAP = {\n\n\t[ VK_FORMAT_R32G32B32A32_SFLOAT ]: RGBAFormat,\n\t[ VK_FORMAT_R16G16B16A16_SFLOAT ]: RGBAFormat,\n\t[ VK_FORMAT_R8G8B8A8_UNORM ]: RGBAFormat,\n\t[ VK_FORMAT_R8G8B8A8_SRGB ]: RGBAFormat,\n\n\t[ VK_FORMAT_R32G32_SFLOAT ]: RGFormat,\n\t[ VK_FORMAT_R16G16_SFLOAT ]: RGFormat,\n\t[ VK_FORMAT_R8G8_UNORM ]: RGFormat,\n\t[ VK_FORMAT_R8G8_SRGB ]: RGFormat,\n\n\t[ VK_FORMAT_R32_SFLOAT ]: RedFormat,\n\t[ VK_FORMAT_R16_SFLOAT ]: RedFormat,\n\t[ VK_FORMAT_R8_SRGB ]: RedFormat,\n\t[ VK_FORMAT_R8_UNORM ]: RedFormat,\n\n\t[ VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT ]: RGBA_ASTC_4x4_Format,\n\t[ VK_FORMAT_ASTC_6x6_SRGB_BLOCK ]: RGBA_ASTC_6x6_Format,\n\t[ VK_FORMAT_ASTC_6x6_UNORM_BLOCK ]: RGBA_ASTC_6x6_Format,\n\n};\n\nconst TYPE_MAP = {\n\n\t[ VK_FORMAT_R32G32B32A32_SFLOAT ]: FloatType,\n\t[ VK_FORMAT_R16G16B16A16_SFLOAT ]: HalfFloatType,\n\t[ VK_FORMAT_R8G8B8A8_UNORM ]: UnsignedByteType,\n\t[ VK_FORMAT_R8G8B8A8_SRGB ]: UnsignedByteType,\n\n\t[ VK_FORMAT_R32G32_SFLOAT ]: FloatType,\n\t[ VK_FORMAT_R16G16_SFLOAT ]: HalfFloatType,\n\t[ VK_FORMAT_R8G8_UNORM ]: UnsignedByteType,\n\t[ VK_FORMAT_R8G8_SRGB ]: UnsignedByteType,\n\n\t[ VK_FORMAT_R32_SFLOAT ]: FloatType,\n\t[ VK_FORMAT_R16_SFLOAT ]: HalfFloatType,\n\t[ VK_FORMAT_R8_SRGB ]: UnsignedByteType,\n\t[ VK_FORMAT_R8_UNORM ]: UnsignedByteType,\n\n\t[ VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT ]: HalfFloatType,\n\t[ VK_FORMAT_ASTC_6x6_SRGB_BLOCK ]: UnsignedByteType,\n\t[ VK_FORMAT_ASTC_6x6_UNORM_BLOCK ]: UnsignedByteType,\n\n};\n\nasync function createRawTexture( container ) {\n\n\tconst { vkFormat } = container;\n\n\tif ( FORMAT_MAP[ vkFormat ] === undefined ) {\n\n\t\tthrow new Error( 'THREE.KTX2Loader: Unsupported vkFormat.' );\n\n\t}\n\n\t//\n\n\tlet zstd;\n\n\tif ( container.supercompressionScheme === KHR_SUPERCOMPRESSION_ZSTD ) {\n\n\t\tif ( ! _zstd ) {\n\n\t\t\t_zstd = new Promise( async ( resolve ) => {\n\n\t\t\t\tconst zstd = new ZSTDDecoder();\n\t\t\t\tawait zstd.init();\n\t\t\t\tresolve( zstd );\n\n\t\t\t} );\n\n\t\t}\n\n\t\tzstd = await _zstd;\n\n\t}\n\n\t//\n\n\tconst mipmaps = [];\n\n\n\tfor ( let levelIndex = 0; levelIndex < container.levels.length; levelIndex ++ ) {\n\n\t\tconst levelWidth = Math.max( 1, container.pixelWidth >> levelIndex );\n\t\tconst levelHeight = Math.max( 1, container.pixelHeight >> levelIndex );\n\t\tconst levelDepth = container.pixelDepth ? Math.max( 1, container.pixelDepth >> levelIndex ) : 0;\n\n\t\tconst level = container.levels[ levelIndex ];\n\n\t\tlet levelData;\n\n\t\tif ( container.supercompressionScheme === KHR_SUPERCOMPRESSION_NONE ) {\n\n\t\t\tlevelData = level.levelData;\n\n\t\t} else if ( container.supercompressionScheme === KHR_SUPERCOMPRESSION_ZSTD ) {\n\n\t\t\tlevelData = zstd.decode( level.levelData, level.uncompressedByteLength );\n\n\t\t} else {\n\n\t\t\tthrow new Error( 'THREE.KTX2Loader: Unsupported supercompressionScheme.' );\n\n\t\t}\n\n\t\tlet data;\n\n\t\tif ( TYPE_MAP[ vkFormat ] === FloatType ) {\n\n\t\t\tdata = new Float32Array(\n\n\t\t\t\tlevelData.buffer,\n\t\t\t\tlevelData.byteOffset,\n\t\t\t\tlevelData.byteLength / Float32Array.BYTES_PER_ELEMENT\n\n\t\t\t);\n\n\t\t} else if ( TYPE_MAP[ vkFormat ] === HalfFloatType ) {\n\n\t\t\tdata = new Uint16Array(\n\n\t\t\t\tlevelData.buffer,\n\t\t\t\tlevelData.byteOffset,\n\t\t\t\tlevelData.byteLength / Uint16Array.BYTES_PER_ELEMENT\n\n\t\t\t);\n\n\t\t} else {\n\n\t\t\tdata = levelData;\n\n\t\t}\n\n\t\tmipmaps.push( {\n\n\t\t\tdata: data,\n\t\t\twidth: levelWidth,\n\t\t\theight: levelHeight,\n\t\t\tdepth: levelDepth,\n\n\t\t} );\n\n\t}\n\n\tlet texture;\n\n\tif ( UNCOMPRESSED_FORMATS.has( FORMAT_MAP[ vkFormat ] ) ) {\n\n\t\ttexture = container.pixelDepth === 0\n\t\t\t? new DataTexture( mipmaps[ 0 ].data, container.pixelWidth, container.pixelHeight )\n\t\t\t: new Data3DTexture( mipmaps[ 0 ].data, container.pixelWidth, container.pixelHeight, container.pixelDepth );\n\n\t} else {\n\n\t\tif ( container.pixelDepth > 0 ) throw new Error( 'THREE.KTX2Loader: Unsupported pixelDepth.' );\n\n\t\ttexture = new CompressedTexture( mipmaps, container.pixelWidth, container.pixelHeight );\n\n\t\ttexture.minFilter = mipmaps.length === 1 ? LinearFilter : LinearMipmapLinearFilter;\n\t\ttexture.magFilter = LinearFilter;\n\n\t}\n\n\ttexture.mipmaps = mipmaps;\n\n\ttexture.type = TYPE_MAP[ vkFormat ];\n\ttexture.format = FORMAT_MAP[ vkFormat ];\n\ttexture.colorSpace = parseColorSpace( container );\n\ttexture.needsUpdate = true;\n\n\t//\n\n\treturn Promise.resolve( texture );\n\n}\n\nfunction parseColorSpace( container ) {\n\n\tconst dfd = container.dataFormatDescriptor[ 0 ];\n\n\tif ( dfd.colorPrimaries === KHR_DF_PRIMARIES_BT709 ) {\n\n\t\treturn dfd.transferFunction === KHR_DF_TRANSFER_SRGB ? SRGBColorSpace : LinearSRGBColorSpace;\n\n\t} else if ( dfd.colorPrimaries === KHR_DF_PRIMARIES_DISPLAYP3 ) {\n\n\t\treturn dfd.transferFunction === KHR_DF_TRANSFER_SRGB ? DisplayP3ColorSpace : LinearDisplayP3ColorSpace;\n\n\t} else if ( dfd.colorPrimaries === KHR_DF_PRIMARIES_UNSPECIFIED ) {\n\n\t\treturn NoColorSpace;\n\n\t} else {\n\n\t\tconsole.warn( `THREE.KTX2Loader: Unsupported color primaries, \"${ dfd.colorPrimaries }\"` );\n\t\treturn NoColorSpace;\n\n\t}\n\n}\n\nexport { KTX2Loader };\n","import { LinearTransfer, Matrix3, SRGBTransfer } from 'three';\n\n// Reference: http://www.russellcottrell.com/photo/matrixCalculator.htm\n\nconst P3_PRIMARIES = [ 0.680, 0.320, 0.265, 0.690, 0.150, 0.060 ];\nconst P3_LUMINANCE_COEFFICIENTS = [ 0.2289, 0.6917, 0.0793 ];\nconst REC2020_PRIMARIES = [ 0.708, 0.292, 0.170, 0.797, 0.131, 0.046 ];\nconst REC2020_LUMINANCE_COEFFICIENTS = [ 0.2627, 0.6780, 0.0593 ];\nconst D65 = [ 0.3127, 0.3290 ];\n\n/******************************************************************************\n * Display P3 definitions\n */\n\nconst LINEAR_DISPLAY_P3_TO_XYZ = /*@__PURE__*/ new Matrix3().set(\n\t0.4865709, 0.2656677, 0.1982173,\n\t0.2289746, 0.6917385, 0.0792869,\n\t0.0000000, 0.0451134, 1.0439444\n);\n\nconst XYZ_TO_LINEAR_DISPLAY_P3 = /*@__PURE__*/ new Matrix3().set(\n\t2.4934969, - 0.9313836, - 0.4027108,\n\t- 0.8294890, 1.7626641, 0.0236247,\n\t0.0358458, - 0.0761724, 0.9568845\n);\n\nexport const DisplayP3ColorSpace = 'display-p3';\nexport const LinearDisplayP3ColorSpace = 'display-p3-linear';\n\nexport const DisplayP3ColorSpaceImpl = {\n\tprimaries: P3_PRIMARIES,\n\twhitePoint: D65,\n\ttransfer: SRGBTransfer,\n\ttoXYZ: LINEAR_DISPLAY_P3_TO_XYZ,\n\tfromXYZ: XYZ_TO_LINEAR_DISPLAY_P3,\n\tluminanceCoefficients: P3_LUMINANCE_COEFFICIENTS,\n\toutputColorSpaceConfig: { drawingBufferColorSpace: DisplayP3ColorSpace }\n};\n\nexport const LinearDisplayP3ColorSpaceImpl = {\n\tprimaries: P3_PRIMARIES,\n\twhitePoint: D65,\n\ttransfer: LinearTransfer,\n\ttoXYZ: LINEAR_DISPLAY_P3_TO_XYZ,\n\tfromXYZ: XYZ_TO_LINEAR_DISPLAY_P3,\n\tluminanceCoefficients: P3_LUMINANCE_COEFFICIENTS,\n\tworkingColorSpaceConfig: { unpackColorSpace: DisplayP3ColorSpace },\n\toutputColorSpaceConfig: { drawingBufferColorSpace: DisplayP3ColorSpace }\n};\n\n/******************************************************************************\n * Rec. 2020 definitions\n */\n\nconst LINEAR_REC2020_TO_XYZ = /*@__PURE__*/ new Matrix3().set(\n\t0.6369580, 0.1446169, 0.1688810,\n\t0.2627002, 0.6779981, 0.0593017,\n\t0.0000000, 0.0280727, 1.0609851\n);\n\nconst XYZ_TO_LINEAR_REC2020 = /*@__PURE__*/ new Matrix3().set(\n\t1.7166512, - 0.3556708, - 0.2533663,\n\t- 0.6666844, 1.6164812, 0.0157685,\n\t0.0176399, - 0.0427706, 0.9421031\n);\n\nexport const LinearRec2020ColorSpace = 'rec2020-linear';\n\nexport const LinearRec2020ColorSpaceImpl = {\n\tprimaries: REC2020_PRIMARIES,\n\twhitePoint: D65,\n\ttransfer: LinearTransfer,\n\ttoXYZ: LINEAR_REC2020_TO_XYZ,\n\tfromXYZ: XYZ_TO_LINEAR_REC2020,\n\tluminanceCoefficients: REC2020_LUMINANCE_COEFFICIENTS,\n};\n","async function fetchAndDecodeSubtree(url) {\r\n    const cleanUrl = url.split('?')[0]; // Remove URL parameters\r\n    const extension = cleanUrl.split('.').pop(); // Get the file extension\r\n\r\n    const response = await fetch(url);\r\n    if (!response.ok) {\r\n        throw new Error(`Failed to fetch ${url}: ${response.statusText}`);\r\n    }\r\n\r\n    if (extension === \"json\") {\r\n        // Handle .json file\r\n        const json = await response.json();\r\n        return handleJSONSubtree(json, getDirectoryUrl(url));\r\n    }\r\n    if (extension === \"subtree\") {\r\n        // Handle binary .subtree file\r\n        const buffer = await response.arrayBuffer();\r\n        return decodeSubtreeBinary(buffer, getDirectoryUrl(url));\r\n    } else {\r\n        throw new Error(`Unsupported file extension: ${extension}`);\r\n    }\r\n}\r\nfunction getDirectoryUrl(url) {\r\n    const cleanUrl = url.split('?')[0]; // Removes query parameters\r\n    return cleanUrl.substring(0, cleanUrl.lastIndexOf('/') + 1);\r\n};\r\n\r\nasync function decodeSubtreeJSON(json, baseURL) {\r\n    if (!json.buffers) {\r\n        throw new Error(`subtree has no buffers`);\r\n    }\r\n\r\n    const bufferFetchPromises = json.buffers.map(async (buffer) => {\r\n        if (!buffer.uri) {\r\n            throw new Error(`bad subtree definition. subtrees in json format do not contain internal buffers`);\r\n        }\r\n        const binaryUrl = new URL(buffer.uri, baseURL).href; // Fixed to buffer.uri instead of externalBuffer.uri\r\n        const response = await fetch(binaryUrl);\r\n        if (!response.ok) {\r\n            throw new Error(`Failed to fetch binary file ${binaryUrl}: ${response.statusText}`);\r\n        }\r\n        return response.arrayBuffer();\r\n    });\r\n\r\n    const buffers = await Promise.all(bufferFetchPromises);\r\n\r\n    return decodeSubtree(json, buffers);\r\n}\r\n// Decode binary .subtree file\r\nasync function decodeSubtreeBinary(buffer, baseURL) {\r\n    const dataView = new DataView(buffer);\r\n    const jsonByteLength = dataView.getBigUint64(8, true); // JSON byte length\r\n    const binaryByteLength = dataView.getBigUint64(16, true); // Binary byte length\r\n\r\n    const jsonStart = 24;\r\n    const jsonEnd = jsonStart + Number(jsonByteLength);\r\n    const binaryStart = jsonEnd + (8 - (jsonEnd % 8)) % 8; // Align to 8-byte boundary\r\n    const binaryEnd = binaryStart + Number(binaryByteLength);\r\n\r\n    const jsonBuffer = buffer.slice(jsonStart, jsonEnd);\r\n    const jsonString = new TextDecoder().decode(jsonBuffer).trim();\r\n    const json = JSON.parse(jsonString);\r\n\r\n    if (!json.buffers) {\r\n        throw new Error(`subtree has no buffers`);\r\n    }\r\n\r\n    const bufferFetchPromises = json.buffers.map(async (b) => {\r\n        if (b.uri) {\r\n            const binaryUrl = new URL(b.uri, baseURL).href;\r\n            const response = await fetch(binaryUrl);\r\n            if (!response.ok) {\r\n                throw new Error(`Failed to fetch binary file ${binaryUrl}: ${response.statusText}`);\r\n            }\r\n            return new Uint8Array(await response.arrayBuffer());\r\n        } else {\r\n            // Assuming you meant to directly use the buffer for non-URI cases,\r\n            // which is already available in the function scope.\r\n            return new Uint8Array(buffer.slice(binaryStart, binaryEnd));\r\n        }\r\n    });\r\n\r\n    const buffers = await Promise.all(bufferFetchPromises);\r\n\r\n    return decodeSubtree(json, buffers);\r\n}\r\n\r\nfunction decodeSubtree(json, buffers){\r\n    function isAvailable(availability, index) {\r\n        if (!availability) {\r\n            throw new Error(`incomplete json subtree`);\r\n        }\r\n        if (!!availability.constant) {\r\n            if (availability.constant == 0) {\r\n                return false;\r\n            }\r\n            if (availability.constant == 1) {\r\n                return true;\r\n            }\r\n        }\r\n        if (availability.bitstream == undefined) {\r\n            throw new Error(`json subtree \"tileAvailability\" does not specify a bitstream`);\r\n        }\r\n        if (!json.bufferViews || !json.bufferViews[availability.bitstream]) {\r\n            throw new Error(`json subtree \"bufferViews\" does not specify a bitstream`);\r\n        }\r\n        const bufferView = json.bufferViews[availability.bitstream];\r\n\r\n        return isAvailable2(buffers[bufferView.buffer], bufferView.byteOffset, index);\r\n    }\r\n\r\n    function isAvailable2(buffer, byteOffset, index) {\r\n        const byteIndex = byteOffset + Math.floor(index / 8);\r\n        const bitIndex = index % 8;\r\n        return (buffer[byteIndex] >> bitIndex) & 1 == 1;\r\n    }\r\n\r\n    function isTileAvailable(address) {\r\n\r\n        let index = 0;\r\n        if (address.z==undefined) {\r\n            index = computeQuadtreeIndex(address.x, address.y, address.level);\r\n        } else {\r\n            index = computeOctreeIndex(address.x, address.y, address.z, address.level);\r\n        }\r\n        return isAvailable(json.tileAvailability, index);\r\n    }\r\n    function isContentAvailable(address) {\r\n        let index = 0;\r\n        if (address.z==undefined) {\r\n            index = computeQuadtreeIndex(address.x, address.y, address.level);\r\n        } else {\r\n            index = computeOctreeIndex(address.x, address.y, address.z, address.level);\r\n        }\r\n        const contentAvailability = [];\r\n        json.contentAvailability.forEach(availability=>{\r\n            contentAvailability.push(isAvailable(availability, index));\r\n        })\r\n        return contentAvailability;\r\n    }\r\n    function isChildSubtreeAvailable(address) {\r\n        let index = 0;\r\n        if (address.z==undefined) {\r\n            index = computeQuadtreeIndex(address.x, address.y);\r\n        } else {\r\n            index = computeOctreeIndex(address.x, address.y, address.z);\r\n        }\r\n        return isAvailable(json.childSubtreeAvailability, index);\r\n    }\r\n\r\n\r\n    return { isTileAvailable: isTileAvailable, isContentAvailable: isContentAvailable, isChildSubtreeAvailable: isChildSubtreeAvailable };\r\n}\r\n\r\n// Handle JSON subtree, fetching external binary file if necessary\r\n\r\n\r\nfunction part1By1(n) {\r\n    n &= 0x0000ffff;                  // n = ------------------------fedcba9876543210\r\n    n = (n ^ (n << 8)) & 0x00ff00ff;  // n = ----------------fedcba98--------76543210\r\n    n = (n ^ (n << 4)) & 0x0f0f0f0f;  // n = ------------fedc--------ba98--------7654--------3210\r\n    n = (n ^ (n << 2)) & 0x33333333;  // n = --------fedc----ba98----7654----3210\r\n    n = (n ^ (n << 1)) & 0x55555555;  // n = ----f--e--d--c----b--a--9--8----7--6--5--4----3--2--1--0\r\n    return n;\r\n}\r\n\r\nfunction computeQuadtreeIndex(x, y, level) {\r\n    let offset = 0;\r\n    if (level) {\r\n        offset = (Math.pow(4, level) - 1) / 3;\r\n    }\r\n    return offset + (part1By1(x) | (part1By1(y) << 1));\r\n}\r\n\r\nfunction part1By2(n) {\r\n    n &= 0x000003ff;                  // n = ------------------9876543210\r\n    n = (n ^ (n << 16)) & 0xff0000ff; // n = ----9876--------5432--------10--------------------\r\n    n = (n ^ (n << 8)) & 0x0300f00f;  // n = ----9--8--7--6--------5--4--3--2--------------------\r\n    n = (n ^ (n << 4)) & 0x030c30c3;  // n = ----9-----8--7-----6--------5-----4--3-----2--------\r\n    n = (n ^ (n << 2)) & 0x09249249;  // n = ----9--------8--------7--------6--------5--------4--------3--------2--------\r\n    return n;\r\n}\r\n\r\nfunction computeOctreeIndex(x, y, z, level) {\r\n    let offset = 0;\r\n    if (level) {\r\n        offset = (Math.pow(8, level) - 1) / 7;\r\n    }\r\n    return offset + (part1By2(x) | (part1By2(y) << 1) | (part1By2(z) << 2));\r\n}\r\nexport{\r\n    fetchAndDecodeSubtree\r\n};","import { fetchAndDecodeSubtree } from './SubtreeDecoder.js';\r\nconst subtreeMap = new Map();\r\n\r\n\r\nasync function resolveImplicite(rootTile, url) {\r\n    if (!rootTile.root || !rootTile.root.implicitTiling) {\r\n        return rootTile;\r\n    }\r\n\r\n    if (!rootTile.root.content && !rootTile.root.contents) {\r\n        throw new Error(\"implicit tiling requires a Template URI\");\r\n    }\r\n\r\n    let isQuad = true;\r\n    if (rootTile.root.implicitTiling.subdivisionScheme) {\r\n        isQuad = \"QUADTREE\" === rootTile.root.implicitTiling.subdivisionScheme.toUpperCase()\r\n    }\r\n    let subtreeUriTemplate = \"\";\r\n    if (rootTile.root.implicitTiling.subtrees) {\r\n        if (rootTile.root.implicitTiling.subtrees.uri) {\r\n            subtreeUriTemplate = rootTile.root.implicitTiling.subtrees.uri;\r\n        } else if (rootTile.root.implicitTiling.subtrees.url) {\r\n            subtreeUriTemplate = rootTile.root.implicitTiling.subtrees.url;\r\n        }\r\n    }\r\n\r\n    let contentURITemplates = [];\r\n    if (rootTile.root.content) {\r\n        if (rootTile.root.content.uri) {\r\n            contentURITemplates.push(rootTile.root.content.uri);\r\n        } else if (rootTile.root.content.url) {\r\n            contentURITemplates.push(rootTile.root.content.url);\r\n        }\r\n    } else if (rootTile.root.contents) {\r\n        rootTile.root.contents.forEach(content => {\r\n            if (content.uri) {\r\n                contentURITemplates.push(content.uri);\r\n            } else if (content.url) {\r\n                contentURITemplates.push(content.url);\r\n            }\r\n        })\r\n    }\r\n\r\n    const rootURL = getDirectoryUrl(url);\r\n\r\n    let subtreeUri;\r\n    if (isQuad) {\r\n        subtreeUri = subtreeUriTemplate\r\n            .replace(\"{level}\", 0)\r\n            .replace(\"{x}\", 0)\r\n            .replace(\"{y}\", 0);\r\n    }\r\n    if (!isQuad) {\r\n        subtreeUri = subtreeUriTemplate\r\n            .replace(\"{level}\", 0)\r\n            .replace(\"{x}\", 0)\r\n            .replace(\"{y}\", 0)\r\n            .replace(\"{z}\", 0);\r\n    }\r\n\r\n    const globalAddress = { level: 0, x: 0, y: 0 };\r\n    const localAddress = { level: 0, x: 0, y: 0 };\r\n    if (!isQuad) {\r\n        globalAddress.z = 0;\r\n        localAddress.z = 0;\r\n    }\r\n\r\n    subtreeMap.set(subtreeUri, await fetchAndDecodeSubtree(rootURL + subtreeUri))\r\n    const subtree = subtreeMap.get(subtreeUri);\r\n    const contents = [];\r\n    if (subtree.isContentAvailable(localAddress)) {\r\n        contentURITemplates.forEach(contentURI => {\r\n            let uri;\r\n            if (isQuad) {\r\n                uri = contentURI\r\n                    .replace(\"{level}\", globalAddress.level)\r\n                    .replace(\"{x}\", globalAddress.x)\r\n                    .replace(\"{y}\", globalAddress.y);\r\n            }\r\n            if (!isQuad) {\r\n                uri = contentURI\r\n                    .replace(\"{level}\", globalAddress.level)\r\n                    .replace(\"{x}\", globalAddress.x)\r\n                    .replace(\"{y}\", globalAddress.y)\r\n                    .replace(\"{z}\", globalAddress.z);\r\n            }\r\n            contents.push({ uri: uri });\r\n        });\r\n    }\r\n    const explicitTileset = {\r\n        geometricError: rootTile.root.geometricError,\r\n        boundingVolume: rootTile.root.boundingVolume,\r\n        refine: rootTile.root.refine,\r\n        globalAddress: globalAddress,\r\n        localAddress: localAddress,\r\n        subtree: subtree,\r\n        contents: contents,\r\n        getChildren: async () => {\r\n            return buildChildren(explicitTileset)\r\n        }\r\n    }\r\n    return {\r\n        root: explicitTileset\r\n\r\n    }\r\n\r\n\r\n    async function buildChildren(parent) {\r\n        const children = [];\r\n        if (parent.localAddress.level == rootTile.root.implicitTiling.availableLevels - 1) return children;\r\n\r\n        if ((parent.localAddress.level + 1) % rootTile.root.implicitTiling.subtreeLevels == 0) { // end of subtree \r\n\r\n            const localAddresses = getChildrenAddresses(parent.localAddress);\r\n            const globalAddresses = getChildrenAddresses(parent.globalAddress);\r\n            const boundingVolumes = computeBoundingVolumes(isQuad, rootTile.root.boundingVolume, globalAddresses);\r\n\r\n            for (let i = 0; i < localAddresses.length; i++) {\r\n                const childLocalAddress = localAddresses[i];\r\n                const childGlobalAddress = globalAddresses[i];\r\n                if (parent.subtree.isChildSubtreeAvailable(childLocalAddress)) {\r\n                    let subtreeUri;\r\n                    if (isQuad) {\r\n                        subtreeUri = subtreeUriTemplate\r\n                            .replace(\"{level}\", childGlobalAddress.level)\r\n                            .replace(\"{x}\", childGlobalAddress.x)\r\n                            .replace(\"{y}\", childGlobalAddress.y);\r\n                    }\r\n                    if (!isQuad) {\r\n                        subtreeUri = subtreeUriTemplate\r\n                            .replace(\"{level}\", childGlobalAddress.level)\r\n                            .replace(\"{x}\", childGlobalAddress.x)\r\n                            .replace(\"{y}\", childGlobalAddress.y)\r\n                            .replace(\"{z}\", childGlobalAddress.z);\r\n                    }\r\n                }\r\n                if (!subtreeMap.has(subtreeUri)) {\r\n                    subtreeMap.set(subtreeUri, await fetchAndDecodeSubtree(rootURL + subtreeUri))\r\n                }\r\n                const newSubtree = subtreeMap.get(subtreeUri)\r\n                const newLocalAddress = { level: 0, x: 0, y: 0 };\r\n                if (!isQuad) newLocalAddress.z = 0;\r\n\r\n                const contents = [];\r\n                if (newSubtree.isContentAvailable(newLocalAddress)) {\r\n                    contentURITemplates.forEach(contentURI => {\r\n                        let uri;\r\n                        if (isQuad) {\r\n                            uri = contentURI\r\n                                .replace(\"{level}\", childGlobalAddress.level)\r\n                                .replace(\"{x}\", childGlobalAddress.x)\r\n                                .replace(\"{y}\", childGlobalAddress.y);\r\n                        }\r\n                        if (!isQuad) {\r\n                            //let rootZ = Math.floor(z / factor);\r\n                            uri = contentURI\r\n                                .replace(\"{level}\", childGlobalAddress.level)\r\n                                .replace(\"{x}\", childGlobalAddress.x)\r\n                                .replace(\"{y}\", childGlobalAddress.y)\r\n                                .replace(\"{z}\", childGlobalAddress.z);\r\n                        }\r\n                        contents.push({ uri: uri });\r\n                    });\r\n                }\r\n                const child = {\r\n                    geometricError: parent.geometricError / 2,\r\n                    boundingVolume: boundingVolumes[i],\r\n                    refine: rootTile.root.refine,\r\n                    globalAddress: childGlobalAddress,\r\n                    localAddress: newLocalAddress,\r\n                    subtree: newSubtree,\r\n                    contents: contents,\r\n                    getChildren: async () => {\r\n                        return buildChildren(child);\r\n                    }\r\n                }\r\n                children.push(child);\r\n            }\r\n        } else { // not the end of the subtree\r\n            const localAddresses = getChildrenAddresses(parent.localAddress);\r\n            const globalAddresses = getChildrenAddresses(parent.globalAddress);\r\n            const boundingVolumes = computeBoundingVolumes(isQuad, rootTile.root.boundingVolume, globalAddresses);\r\n\r\n            for (let i = 0; i < localAddresses.length; i++) {\r\n                const childLocalAddress = localAddresses[i];\r\n                const childGlobalAddress = globalAddresses[i];\r\n                if (!parent.subtree.isTileAvailable(childLocalAddress)) {\r\n                    continue;\r\n                }\r\n                const contents = [];\r\n                const contentAvailability = parent.subtree.isContentAvailable(childLocalAddress);\r\n                for (let i = 0; i < contentURITemplates.length; i++) {\r\n                    if (!contentAvailability[i]) continue;\r\n                    const contentURITemplate = contentURITemplates[i];\r\n                    let uri;\r\n                    if (isQuad) {\r\n                        uri = contentURITemplate\r\n                            .replace(\"{level}\", childGlobalAddress.level)\r\n                            .replace(\"{x}\", childGlobalAddress.x)\r\n                            .replace(\"{y}\", childGlobalAddress.y);\r\n                    }\r\n                    if (!isQuad) {\r\n                        uri = contentURITemplate\r\n                            .replace(\"{level}\", childGlobalAddress.level)\r\n                            .replace(\"{x}\", childGlobalAddress.x)\r\n                            .replace(\"{y}\", childGlobalAddress.y)\r\n                            .replace(\"{z}\", childGlobalAddress.z);\r\n                    }\r\n                    contents.push({ uri: uri });\r\n                }\r\n\r\n\r\n                const child = {\r\n                    geometricError: parent.geometricError / 2,\r\n                    boundingVolume: boundingVolumes[i],\r\n                    refine: rootTile.root.refine,\r\n                    globalAddress: childGlobalAddress,\r\n                    localAddress: childLocalAddress,\r\n                    subtree: parent.subtree,\r\n                    contents: contents,\r\n                    getChildren: async () => {\r\n                        return buildChildren(child);\r\n                    }\r\n                }\r\n                children.push(child)\r\n            }\r\n        }\r\n\r\n        return children.length>0?children:undefined;\r\n    }\r\n\r\n}\r\n\r\nfunction getChildrenAddresses(tileAddress) {\r\n    const { level, x, y, z } = tileAddress;\r\n    const nextLevel = level + 1;\r\n    let children = [];\r\n\r\n    if (z === undefined) {\r\n        // Quadtree\r\n        children = [\r\n            { level: nextLevel, x: x * 2, y: y * 2 }, // Bottom left\r\n            { level: nextLevel, x: x * 2 + 1, y: y * 2 }, // Bottom right\r\n            { level: nextLevel, x: x * 2, y: y * 2 + 1 }, // Top left\r\n            { level: nextLevel, x: x * 2 + 1, y: y * 2 + 1 }  // Top right\r\n        ];\r\n    } else {\r\n        // Octree\r\n        children = [\r\n            { level: nextLevel, x: x * 2, y: y * 2, z: z * 2 },     // Bottom front left\r\n            { level: nextLevel, x: x * 2 + 1, y: y * 2, z: z * 2 },     // Bottom front right\r\n            { level: nextLevel, x: x * 2, y: y * 2 + 1, z: z * 2 },     // Bottom back left\r\n            { level: nextLevel, x: x * 2 + 1, y: y * 2 + 1, z: z * 2 },     // Bottom back right\r\n            { level: nextLevel, x: x * 2, y: y * 2, z: z * 2 + 1 }, // Top front left\r\n            { level: nextLevel, x: x * 2 + 1, y: y * 2, z: z * 2 + 1 }, // Top front right\r\n            { level: nextLevel, x: x * 2, y: y * 2 + 1, z: z * 2 + 1 }, // Top back left\r\n            { level: nextLevel, x: x * 2 + 1, y: y * 2 + 1, z: z * 2 + 1 }  // Top back right\r\n        ];\r\n    }\r\n\r\n    return children;\r\n}\r\n\r\nfunction getDirectoryUrl(url) {\r\n    const cleanUrl = url.split('?')[0]; // Removes query parameters\r\n    return cleanUrl.substring(0, cleanUrl.lastIndexOf('/') + 1);\r\n};\r\n\r\nfunction computeBoundingVolumes(isQuad, rootBoundingVolume, addresses) {\r\n    const boundingVolumes = [];\r\n    for (let i = 0; i < addresses.length; i++) {\r\n        boundingVolumes.push(computeBoundingVolume(isQuad, rootBoundingVolume, addresses[i]))\r\n    }\r\n    return boundingVolumes;\r\n}\r\n\r\nfunction computeBoundingVolume(isQuad, rootBoundingVolume, address) {\r\n    if (rootBoundingVolume.region) {\r\n        return splitRegion(isQuad, rootBoundingVolume.region, address);\r\n    } else if (rootBoundingVolume.box) {\r\n        return splitBox(isQuad, rootBoundingVolume.box, address);\r\n    } else {\r\n        throw new Error('Unsupported bounding volume type');\r\n    }\r\n}\r\n\r\nfunction splitRegion(isQuad, rootRegion, address) {\r\n    // Destructure the rootRegion for clarity\r\n    const [west, south, east, north, minHeight, maxHeight] = rootRegion;\r\n  \r\n    // Calculate the size of each division step based on the tile's level\r\n    const xStep = (east - west) / (2 ** address.level);\r\n    const yStep = (north - south) / (2 ** address.level);\r\n    const zStep = isQuad ? 0 : (maxHeight - minHeight) / (2 ** address.level);\r\n  \r\n    // Calculate the new bounds for the tile\r\n    const newWest = west + (xStep * address.x);\r\n    const newSouth = south + (yStep * address.y);\r\n    const newEast = newWest + xStep;\r\n    const newNorth = newSouth + yStep;\r\n    \r\n    // For quadtrees, the z dimension remains unchanged. For octrees, calculate new heights.\r\n    const newMinHeight = isQuad ? minHeight : minHeight + (zStep * address.z);\r\n    const newMaxHeight = isQuad ? maxHeight : newMinHeight + zStep;\r\n  \r\n    return {region:[newWest, newSouth, newEast, newNorth, newMinHeight, newMaxHeight]};\r\n  }\r\n\r\n  function splitBox(isQuad, box, address) {\r\n    // Extract center and half-length vectors from the box\r\n    const center = box.slice(0, 3);\r\n    const vectors = [\r\n      box.slice(3, 6),  // First half-length vector\r\n      box.slice(6, 9),  // Second half-length vector\r\n      box.slice(9, 12)  // Third half-length vector\r\n    ];\r\n  \r\n    // Determine scale factors for each axis\r\n    const s = 1/Math.pow(2,address.level);\r\n    const scaleFactors = [s, s, isQuad ? 1 : s];\r\n  \r\n    // Adjust the half-length vectors according to the scale factor\r\n    const newVectors = vectors.map((vector, index) => vector.map(component => component * scaleFactors[index]));\r\n  \r\n    const origin = [center[0]-vectors[0][0]-vectors[1][0]-vectors[2][0], center[1]-vectors[0][1]-vectors[1][1]-vectors[2][1], center[2]-vectors[0][2]-vectors[1][2]-vectors[2][2]]\r\n    // Calculate new center based on the child address\r\n    const newCenter = [\r\n        origin[0] + (address.x*2+1)*(newVectors[0][0]+newVectors[1][0]+newVectors[2][0]),\r\n        origin[1] + (address.y*2+1)*(newVectors[0][1]+newVectors[1][1]+newVectors[2][1]),\r\n        isQuad?center[2]:origin[2] + (address.z*2+1)*(newVectors[0][2]+newVectors[1][2]+newVectors[2][2]),\r\n    ];\r\n  \r\n    // Construct the new box with the updated center and scaled half-length vectors\r\n    const newBox = newCenter.concat(...newVectors);\r\n  \r\n    return {box:newBox};\r\n  }\r\n  \r\n\r\n\r\nexport {\r\n    resolveImplicite\r\n}\r\n","// This file is part of meshoptimizer library and is distributed under the terms of MIT License.\n// Copyright (C) 2016-2024, by Arseny Kapoulkine (arseny.kapoulkine@gmail.com)\nvar MeshoptEncoder = (function () {\n\t// Built with clang version 18.1.2\n\t// Built from meshoptimizer 0.22\n\tvar wasm =\n\t\t'b9H79TebbbeJq9Geueu9Geub9Gbb9Gvuuuuueu9Gduueu9Gluuuueu9Gvuuuuub9Gouuuuuub9Gluuuub9GiuuueuiKLdilevlevlooroowwvwbDDbelve9Weiiviebeoweuec:G:Qdkr;RiOo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949c919M9MWVbe8F9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949c919M9MWV9c9V919U9KbdE9TW79O9V9Wt9FW9U9J9V9KW9wWVtW949wWV79P9V9UbiY9TW79O9V9Wt9FW9U9J9V9KW69U9KW949c919M9MWVbl8E9TW79O9V9Wt9FW9U9J9V9KW69U9KW949c919M9MWV9c9V919U9Kbv8A9TW79O9V9Wt9FW9U9J9V9KW69U9KW949wWV79P9V9UboE9TW79O9V9Wt9FW9U9J9V9KW69U9KW949tWG91W9U9JWbra9TW79O9V9Wt9FW9U9J9V9KW69U9KW949tWG91W9U9JW9c9V919U9KbwL9TW79O9V9Wt9FW9U9J9V9KWS9P2tWV9p9JtbDK9TW79O9V9Wt9FW9U9J9V9KWS9P2tWV9r919HtbqL9TW79O9V9Wt9FW9U9J9V9KWS9P2tWVT949WbkE9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94J9H9J9OWbPa9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94J9H9J9OW9ttV9P9Wbsa9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94SWt9J9O9sW9T9H9WbzK9TW79O9V9Wt9F79W9Ht9P9H29t9VVt9sW9T9H9WbHl79IV9RbODwebcekdQXq;A9pLdbk;QqeKu8Jjjjjbcjo9Rgv8Kjjjjbcbhodnalcefae0mbabcbRbN:kjjbc:GeV86bbavcjdfcbcjdzNjjjb8AdnaiTmbavcjdfadalz:tjjjb8Akabaefhrabcefhwavalfcbcbcjdal9RalcFe0EzNjjjb8Aavavcjdfalz:tjjjbhDcj;abal9Uc;WFbGgecjdaecjd6Ehqcbhkindndnaiak9nmbaDcjlfcbcjdzNjjjb8Aaqaiak9Rakaqfai6Egxcsfgecl4cifcd4hmadakal2fhPdndndnaec9WGgsTmbcbhzaPhHawhOxekdnaxmbalheinaraw9Ram6miawcbamzNjjjbamfhwaecufgembxvkkcbhAaPhOinaDaAfRbbhCaDcjlfheaOhoaxhXinaeaoRbbgQaC9RgCcetaCcKtcK91cr4786bbaoalfhoaecefheaQhCaXcufgXmbkaraw9Ram6mdaOcefhOawcbamzNjjjbamfhwaAcefgAal9hmbxlkkindnaxTmbaDazfRbbhCaDcjlfheaHhoaxhXinaeaoRbbgQaC9RgCcetaCcKtcK91cr4786bbaoalfhoaecefheaQhCaXcufgXmbkkaraO9Ram6mearaOcbamzNjjjbgLamfgw9RcK6mecbhKaDcjlfhOinaDcjlfaKfhYcwhAczhQceheindndnaegXce9hmbcuhoaYRbbmecbhodninaogecsSmeaecefhoaOaefcefRbbTmbkkcucbaecs6EhoxekaXcethocuaXtc;:bGcFb7hCcbheinaoaCaOaefRbb9nfhoaecefgecz9hmbkkaoaQaoaQ6geEhQaXaAaeEhAaXcetheaXcl6mbkdndndndnaAcufPdiebkaLaKco4fgeaeRbbcdciaAclSEaKci4coGtV86bbaAcw9hmeawaY8Pbb83bbawcwfaYcwf8Pbb83bbawczfhwxdkaLaKco4fgeaeRbbceaKci4coGtV86bbkdncwaA9Tg8Ambinawcb86bbawcefhwxbkkcuaAtcu7hYcbhEaOh3ina3hea8AhCcbhoinaeRbbgQaYcFeGgXaQaX6EaoaAtVhoaecefheaCcufgCmbkawao86bba3a8Afh3awcefhwaEa8AfgEcz6mbkcbheindnaOaefRbbgoaX6mbawao86bbawcefhwkaecefgecz9hmbkkdnaKczfgKas9pmbaOczfhOaraw9RcL0mekkaKas6meawTmeaHcefhHawhOazcefgzalSmixbkkcbhoxikcbhoaraw9Ralcaalca0E6mddnalc8F0mbawcbcaal9RgezNjjjbaefhwkawaDcjdfalz:tjjjbalfab9RhoxdkaDaPaxcufal2falz:tjjjb8Aaxakfhkawmbkcbhokavcjof8Kjjjjbaok9heeuaecaaeca0Eabcj;abae9Uc;WFbGgdcjdadcjd6Egdfcufad9Uae2adcl4cifcd4adV2fcefkmbcbabBdN:kjjbk:zse5u8Jjjjjbc;ae9Rgl8Kjjjjbcbhvdnaici9UgocHfae0mbabcbyd:e:kjjbgrc;GeV86bbalc;abfcFecjezNjjjb8AalcUfgw9cu83ibalc8WfgD9cu83ibalcyfgq9cu83ibalcafgk9cu83ibalcKfgx9cu83ibalczfgm9cu83ibal9cu83iwal9cu83ibabaefc9WfhPabcefgsaofhednaiTmbcmcsarcb9kgzEhHcbhOcbhAcbhCcbhXcbhQindnaeaP9nmbcbhvxikaQcufhvadaCcdtfgLydbhKaLcwfydbhYaLclfydbh8AcbhEdndndninalc;abfavcsGcitfgoydlh3dndndnaoydbgoaK9hmba3a8ASmekdnaoa8A9hmba3aY9hmbaEcefhExekaoaY9hmea3aK9hmeaEcdfhEkaEc870mdaXcufhvaLaEciGcx2goc:y1jjbfydbcdtfydbh3aLaocN1jjbfydbcdtfydbh8AaLaoc:q1jjbfydbcdtfydbhKcbhodnindnalavcsGcdtfydba39hmbaohYxdkcuhYavcufhvaocefgocz9hmbkkaOa3aOSgvaYce9iaYaH9oVgoGfhOdndndncbcsavEaYaoEgvcs9hmbarce9imba3a3aAa3cefaASgvEgAcefSmecmcsavEhvkasavaEcdtc;WeGV86bbavcs9hmea3aA9Rgvcetavc8F917hvinaeavcFb0crtavcFbGV86bbaecefheavcje6hoavcr4hvaoTmbka3hAxvkcPhvasaEcdtcPV86bba3hAkavTmiavaH9omicdhocehEaQhYxlkavcufhvaEclfgEc;ab9hmbkkdnaLceaYaOSceta8AaOSEcx2gvc:q1jjbfydbcdtfydbgKTaLavcN1jjbfydbcdtfydbg8AceSGaLavc:y1jjbfydbcdtfydbg3cdSGaOcb9hGazGg5ce9hmbaw9cu83ibaD9cu83ibaq9cu83ibak9cu83ibax9cu83ibam9cu83ibal9cu83iwal9cu83ibcbhOkcbhEaXcufgvhodnindnalaocsGcdtfydba8A9hmbaEhYxdkcuhYaocufhoaEcefgEcz9hmbkkcbhodnindnalavcsGcdtfydba39hmbaohExdkcuhEavcufhvaocefgocz9hmbkkaOaKaOSg8EfhLdndnaYcm0mbaYcefhYxekcbcsa8AaLSgvEhYaLavfhLkdndnaEcm0mbaEcefhExekcbcsa3aLSgvEhEaLavfhLkc9:cua8EEh8FcbhvaEaYcltVgacFeGhodndndninavcj1jjbfRbbaoSmeavcefgvcz9hmbxdkka5aKaO9havcm0VVmbasavc;WeV86bbxekasa8F86bbaeaa86bbaecefhekdna8EmbaKaA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombkaKhAkdnaYcs9hmba8AaA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombka8AhAkdnaEcs9hmba3aA9Rgvcetavc8F917hvinaeavcFb0gocrtavcFbGV86bbavcr4hvaecefheaombka3hAkalaXcdtfaKBdbaXcefcsGhvdndnaYPzbeeeeeeeeeeeeeebekalavcdtfa8ABdbaXcdfcsGhvkdndnaEPzbeeeeeeeeeeeeeebekalavcdtfa3BdbavcefcsGhvkcihoalc;abfaQcitfgEaKBdlaEa8ABdbaQcefcsGhYcdhEavhXaLhOxekcdhoalaXcdtfa3BdbcehEaXcefcsGhXaQhYkalc;abfaYcitfgva8ABdlava3Bdbalc;abfaQaEfcsGcitfgva3BdlavaKBdbascefhsaQaofcsGhQaCcifgCai6mbkkcbhvaeaP0mbcbhvinaeavfavcj1jjbfRbb86bbavcefgvcz9hmbkaeab9Ravfhvkalc;aef8KjjjjbavkZeeucbhddninadcefgdc8F0meceadtae6mbkkadcrfcFeGcr9Uci2cdfabci9U2cHfkmbcbabBd:e:kjjbk:ydewu8Jjjjjbcz9Rhlcbhvdnaicvfae0mbcbhvabcbRb:e:kjjbc;qeV86bbal9cb83iwabcefhoabaefc98fhrdnaiTmbcbhwcbhDindnaoar6mbcbskadaDcdtfydbgqalcwfawaqav9Rgvavc8F91gv7av9Rc507gwcdtfgkydb9Rgvc8E91c9:Gavcdt7awVhvinaoavcFb0gecrtavcFbGV86bbavcr4hvaocefhoaembkakaqBdbaqhvaDcefgDai9hmbkkcbhvaoar0mbaocbBbbaoab9RclfhvkavkBeeucbhddninadcefgdc8F0meceadtae6mbkkadcwfcFeGcr9Uab2cvfk:bvli99dui99ludnaeTmbcuadcetcuftcu7:Yhvdndncuaicuftcu7:YgoJbbbZMgr:lJbbb9p9DTmbar:Ohwxekcjjjj94hwkcbhicbhDinalclfIdbgrJbbbbJbbjZalIdbgq:lar:lMalcwfIdbgk:lMgr:varJbbbb9BEgrNhxaqarNhrdndnakJbbbb9GTmbaxhqxekJbbjZar:l:tgqaq:maxJbbbb9GEhqJbbjZax:l:tgxax:marJbbbb9GEhrkdndnalcxfIdbgxJbbj:;axJbbj:;9GEgkJbbjZakJbbjZ9FEavNJbbbZJbbb:;axJbbbb9GEMgx:lJbbb9p9DTmbax:Ohmxekcjjjj94hmkdndnaqJbbj:;aqJbbj:;9GEgxJbbjZaxJbbjZ9FEaoNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:OhPxekcjjjj94hPkdndnarJbbj:;arJbbj:;9GEgqJbbjZaqJbbjZ9FEaoNJbbbZJbbb:;arJbbbb9GEMgr:lJbbb9p9DTmbar:Ohsxekcjjjj94hskdndnadcl9hmbabaifgzas86bbazcifam86bbazcdfaw86bbazcefaP86bbxekabaDfgzas87ebazcofam87ebazclfaw87ebazcdfaP87ebkalczfhlaiclfhiaDcwfhDaecufgembkkk;hlld99eud99eudnaeTmbdndncuaicuftcu7:YgvJbbbZMgo:lJbbb9p9DTmbao:Ohixekcjjjj94hikaic;8FiGhrinabcofcicdalclfIdb:lalIdb:l9EgialcwfIdb:lalaicdtfIdb:l9EEgialcxfIdb:lalaicdtfIdb:l9EEgiarV87ebdndnJbbj:;JbbjZalaicdtfIdbJbbbb9DEgoalaicd7cdtfIdbJ;Zl:1ZNNgwJbbj:;awJbbj:;9GEgDJbbjZaDJbbjZ9FEavNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohqxekcjjjj94hqkabcdfaq87ebdndnalaicefciGcdtfIdbJ;Zl:1ZNaoNgwJbbj:;awJbbj:;9GEgDJbbjZaDJbbjZ9FEavNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohqxekcjjjj94hqkabaq87ebdndnaoalaicufciGcdtfIdbJ;Zl:1ZNNgoJbbj:;aoJbbj:;9GEgwJbbjZawJbbjZ9FEavNJbbbZJbbb:;aoJbbbb9GEMgo:lJbbb9p9DTmbao:Ohixekcjjjj94hikabclfai87ebabcwfhbalczfhlaecufgembkkk;3viDue99eu8Jjjjjbcjd9Rgo8Kjjjjbadcd4hrdndndndnavcd9hmbadcl6meaohwarhDinawc:CuBdbawclfhwaDcufgDmbkaeTmiadcl6mdarcdthqalhkcbhxinaohwakhDarhminawawydbgPcbaDIdbgs:8cL4cFeGc:cufasJbbbb9BEgzaPaz9kEBdbaDclfhDawclfhwamcufgmmbkakaqfhkaxcefgxaeSmixbkkaeTmdxekaeTmekarcdthkavce9hhqadcl6hdcbhxindndndnaqmbadmdc:CuhDalhwarhminaDcbawIdbgs:8cL4cFeGc:cufasJbbbb9BEgPaDaP9kEhDawclfhwamcufgmmbxdkkc:CuhDdndnavPleddbdkadmdaohwalhmarhPinawcbamIdbgs:8cL4cFeGgzc;:bazc;:b9kEc:cufasJbbbb9BEBdbamclfhmawclfhwaPcufgPmbxdkkadmecbhwarhminaoawfcbalawfIdbgs:8cL4cFeGgPc8AaPc8A9kEc:cufasJbbbb9BEBdbawclfhwamcufgmmbkkadmbcbhwarhPinaDhmdnavceSmbaoawfydbhmkdndnalawfIdbgscjjj;8iamai9RcefgmcLt9R::NJbbbZJbbb:;asJbbbb9GEMgs:lJbbb9p9DTmbas:Ohzxekcjjjj94hzkabawfazcFFFrGamcKtVBdbawclfhwaPcufgPmbkkabakfhbalakfhlaxcefgxae9hmbkkaocjdf8Kjjjjbk;HqdCui998Jjjjjbc:qd9Rgv8Kjjjjbavc:Sefcbc;KbzNjjjb8AcbhodnadTmbcbhoaiTmbdnabae9hmbavcuadcdtgradcFFFFi0Ecbyd:m:kjjbHjjjjbbgeBd:SeavceBd:mdaeabarz:tjjjb8Akavc:GefcwfcbBdbav9cb83i:Geavc:Gefaeadaiavc:Sefz:njjjbavyd:Gehwadci9UgDcbyd:m:kjjbHjjjjbbhravc:Sefavyd:mdgqcdtfarBdbavaqcefgkBd:mdarcbaDzNjjjbhxavc:SefakcdtfcuaicdtaicFFFFi0Ecbyd:m:kjjbHjjjjbbgmBdbavaqcdfgPBd:mdawhramhkinakalIdbalarydbgscwascw6Ecdtfc;ebfIdbMUdbarclfhrakclfhkaicufgimbkavc:SefaPcdtfcuaDcdtadcFFFF970Ecbyd:m:kjjbHjjjjbbgPBdbdnadci6mbaehraPhkaDhiinakamarydbcdtfIdbamarclfydbcdtfIdbMamarcwfydbcdtfIdbMUdbarcxfhrakclfhkaicufgimbkkaqcifhoavc;qbfhzavhravyd:KehHavyd:OehOcbhscbhkcbhAcehCinarhXcihQaeakci2gLcdtfgrydbhdarclfydbhqabaAcx2fgicwfarcwfydbgKBdbaiclfaqBdbaiadBdbaxakfce86bbazaKBdwazaqBdlazadBdbaPakcdtfcbBdbdnasTmbcihQaXhiinazaQcdtfaiydbgrBdbaQaraK9harad9haraq9hGGfhQaiclfhiascufgsmbkkaAcefhAcbhsinaOaHaeasaLfcdtfydbcdtgifydbcdtfgKhrawaifgqydbgdhidnadTmbdninarydbakSmearclfhraicufgiTmdxbkkaraKadcdtfc98fydbBdbaqaqydbcufBdbkascefgsci9hmbkdndnaQTmbcuhkJbbbbhYcbhqavyd:KehKavyd:OehLindndnawazaqcdtfydbcdtgsfydbgrmbaqcefhqxekaqcs0hiamasfgdIdbh8AadalcbaqcefgqaiEcdtfIdbalarcwarcw6Ecdtfc;ebfIdbMgEUdbaEa8A:thEarcdthiaLaKasfydbcdtfhrinaParydbgscdtfgdaEadIdbMg8AUdba8AaYaYa8A9DgdEhYasakadEhkarclfhraic98fgimbkkaqaQ9hmbkakcu9hmekaCaD9pmdindnaxaCfRbbmbaChkxdkaDaCcefgC9hmbxikkaQczaQcz6EhsazhraXhzakcu9hmbkkaocdtavc:Seffc98fhrdninaoTmearydbcbyd1:kjjbH:bjjjbbarc98fhraocufhoxbkkavc:qdf8Kjjjjbk;IlevucuaicdtgvaicFFFFi0Egocbyd:m:kjjbHjjjjbbhralalyd9GgwcdtfarBdbalawcefBd9GabarBdbaocbyd:m:kjjbHjjjjbbhralalyd9GgocdtfarBdbalaocefBd9GabarBdlcuadcdtadcFFFFi0Ecbyd:m:kjjbHjjjjbbhralalyd9GgocdtfarBdbalaocefBd9GabarBdwabydbcbavzNjjjb8Aadci9UhDdnadTmbabydbhoaehladhrinaoalydbcdtfgvavydbcefBdbalclfhlarcufgrmbkkdnaiTmbabydbhlabydlhrcbhvaihoinaravBdbarclfhralydbavfhvalclfhlaocufgombkkdnadci6mbabydlhrabydwhvcbhlinaecwfydbhoaeclfydbhdaraeydbcdtfgwawydbgwcefBdbavawcdtfalBdbaradcdtfgdadydbgdcefBdbavadcdtfalBdbaraocdtfgoaoydbgocefBdbavaocdtfalBdbaecxfheaDalcefgl9hmbkkdnaiTmbabydlheabydbhlinaeaeydbalydb9RBdbalclfhlaeclfheaicufgimbkkkQbabaeadaic:01jjbz:mjjjbkQbabaeadaic:C:jjjbz:mjjjbk9DeeuabcFeaicdtzNjjjbhlcbhbdnadTmbindnalaeydbcdtfgiydbcu9hmbaiabBdbabcefhbkaeclfheadcufgdmbkkabk;Wkivuo99lu8Jjjjjbc;W;Gb9Rgl8Kjjjjbcbhvalcj;Gbfcbc;KbzNjjjb8AalcuadcdtadcFFFFi0Egocbyd:m:kjjbHjjjjbbgrBdj9GalceBd;G9GalcFFF;7rBdwal9cFFF;7;3FF:;Fb83dbalcFFF97Bd;S9Gal9cFFF;7FFF:;u83d;K9Gaicd4hwdndnadmbJFFuFhDJFFuuhqJFFuuhkJFFuFhxJFFuuhmJFFuFhPxekawcdthsaehzincbhiinalaifgHazaifIdbgDaHIdbgxaxaD9EEUdbalc;K;GbfaifgHaDaHIdbgxaxaD9DEUdbaiclfgicx9hmbkazasfhzavcefgvad9hmbkalIdwhqalId;S9GhDalIdlhkalId;O9GhxalIdbhmalId;K9GhPkdndnadTmbJbbbbJbbjZJbbbbaPam:tgPaPJbbbb9DEgPaxak:tgxaxaP9DEgxaDaq:tgDaDax9DEgD:vaDJbbbb9BEhDawcdthsarhHadhzindndnaDaeIdbam:tNJb;au9eNJbbbZMgx:lJbbb9p9DTmbax:Ohixekcjjjj94hikaicztaicwtcj;GiGVaicsGVc:p;G:dKGcH2c;d;H:WKGcv2c;j:KM;jbGhvdndnaDaeclfIdbak:tNJb;au9eNJbbbZMgx:lJbbb9p9DTmbax:Ohixekcjjjj94hikaicztaicwtcj;GiGVaicsGVc:p;G:dKGcH2c;d;H:WKGcq2cM;j:KMeGavVhvdndnaDaecwfIdbaq:tNJb;au9eNJbbbZMgx:lJbbb9p9DTmbax:Ohixekcjjjj94hikaHavaicztaicwtcj;GiGVaicsGVc:p;G:dKGcH2c;d;H:WKGcC2c:KM;j:KdGVBdbaeasfheaHclfhHazcufgzmbkalcbcj;GbzNjjjbhiarhHadheinaiaHydbgzcFrGcx2fgvavydbcefBdbaiazcq4cFrGcx2fgvavydlcefBdlaiazcC4cFrGcx2fgzazydwcefBdwaHclfhHaecufgembxdkkalcbcj;GbzNjjjb8AkcbhHcbhzcbhecbhvinalaHfgiydbhsaiazBdbaicwfgwydbhOawavBdbaiclfgiydbhwaiaeBdbasazfhzaOavfhvawaefheaHcxfgHcj;Gb9hmbkcbhHalaocbyd:m:kjjbHjjjjbbgiBd:e9GdnadTmbabhzinazaHBdbazclfhzadaHcefgH9hmbkabhHadhzinalaraHydbgecdtfydbcFrGcx2fgvavydbgvcefBdbaiavcdtfaeBdbaHclfhHazcufgzmbkaihHadhzinalaraHydbgecdtfydbcq4cFrGcx2fgvavydlgvcefBdlabavcdtfaeBdbaHclfhHazcufgzmbkabhHadhzinalaraHydbgecdtfydbcC4cFrGcx2fgvavydwgvcefBdwaiavcdtfaeBdbaHclfhHazcufgzmbkcbhHinabaiydbcdtfaHBdbaiclfhiadaHcefgH9hmbkkclhidninaic98Smealcj;Gbfaifydbcbyd1:kjjbH:bjjjbbaic98fhixbkkalc;W;Gbf8Kjjjjbk9teiucbcbyd:q:kjjbgeabcifc98GfgbBd:q:kjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd:q:kjjbgeabcrfc94GfgbBd:q:kjjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd:q:kjjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd:q:kjjbfgdBd:q:kjjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akkk:Iddbcjwk:edb4:h9w9N94:P:gW:j9O:ye9Pbbbbbbebbbdbbbebbbdbbbbbbbdbbbbbbbebbbbbbb:l29hZ;69:9kZ;N;76Z;rg97Z;z;o9xZ8J;B85Z;:;u9yZ;b;k9HZ:2;Z9DZ9e:l9mZ59A8KZ:r;T3Z:A:zYZ79OHZ;j4::8::Y:D9V8:bbbb9s:49:Z8R:hBZ9M9M;M8:L;z;o8:;8:PG89q;x:J878R:hQ8::M:B;e87bbbbbbjZbbjZbbjZ:E;V;N8::Y:DsZ9i;H;68:xd;R8:;h0838:;W:NoZbbbb:WV9O8:uf888:9i;H;68:9c9G;L89;n;m9m89;D8Ko8:bbbbf:8tZ9m836ZS:2AZL;zPZZ818EZ9e:lxZ;U98F8:819E;68:bc:eqkzebbbebbbdbbba:vbb'; // embed! wasm\n\n\tvar wasmpack = new Uint8Array([\n\t\t32, 0, 65, 2, 1, 106, 34, 33, 3, 128, 11, 4, 13, 64, 6, 253, 10, 7, 15, 116, 127, 5, 8, 12, 40, 16, 19, 54, 20, 9, 27, 255, 113, 17, 42, 67,\n\t\t24, 23, 146, 148, 18, 14, 22, 45, 70, 69, 56, 114, 101, 21, 25, 63, 75, 136, 108, 28, 118, 29, 73, 115,\n\t]);\n\n\tif (typeof WebAssembly !== 'object') {\n\t\treturn {\n\t\t\tsupported: false,\n\t\t};\n\t}\n\n\tvar instance;\n\n\tvar ready = WebAssembly.instantiate(unpack(wasm), {}).then(function (result) {\n\t\tinstance = result.instance;\n\t\tinstance.exports.__wasm_call_ctors();\n\t\tinstance.exports.meshopt_encodeVertexVersion(0);\n\t\tinstance.exports.meshopt_encodeIndexVersion(1);\n\t});\n\n\tfunction unpack(data) {\n\t\tvar result = new Uint8Array(data.length);\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tvar ch = data.charCodeAt(i);\n\t\t\tresult[i] = ch > 96 ? ch - 97 : ch > 64 ? ch - 39 : ch + 4;\n\t\t}\n\t\tvar write = 0;\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tresult[write++] = result[i] < 60 ? wasmpack[result[i]] : (result[i] - 60) * 64 + result[++i];\n\t\t}\n\t\treturn result.buffer.slice(0, write);\n\t}\n\n\tfunction assert(cond) {\n\t\tif (!cond) {\n\t\t\tthrow new Error('Assertion failed');\n\t\t}\n\t}\n\n\tfunction bytes(view) {\n\t\treturn new Uint8Array(view.buffer, view.byteOffset, view.byteLength);\n\t}\n\n\tfunction reorder(fun, indices, vertices, optf) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar ip = sbrk(indices.length * 4);\n\t\tvar rp = sbrk(vertices * 4);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\tvar indices8 = bytes(indices);\n\t\theap.set(indices8, ip);\n\t\tif (optf) {\n\t\t\toptf(ip, ip, indices.length, vertices);\n\t\t}\n\t\tvar unique = fun(rp, ip, indices.length, vertices);\n\t\t// heap may have grown\n\t\theap = new Uint8Array(instance.exports.memory.buffer);\n\t\tvar remap = new Uint32Array(vertices);\n\t\tnew Uint8Array(remap.buffer).set(heap.subarray(rp, rp + vertices * 4));\n\t\tindices8.set(heap.subarray(ip, ip + indices.length * 4));\n\t\tsbrk(ip - sbrk(0));\n\n\t\tfor (var i = 0; i < indices.length; ++i) indices[i] = remap[indices[i]];\n\n\t\treturn [remap, unique];\n\t}\n\n\tfunction spatialsort(fun, positions, count, stride) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar ip = sbrk(count * 4);\n\t\tvar sp = sbrk(count * stride);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(positions), sp);\n\t\tfun(ip, sp, count, stride);\n\t\t// heap may have grown\n\t\theap = new Uint8Array(instance.exports.memory.buffer);\n\t\tvar remap = new Uint32Array(count);\n\t\tnew Uint8Array(remap.buffer).set(heap.subarray(ip, ip + count * 4));\n\t\tsbrk(ip - sbrk(0));\n\t\treturn remap;\n\t}\n\n\tfunction encode(fun, bound, source, count, size) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar tp = sbrk(bound);\n\t\tvar sp = sbrk(count * size);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(source), sp);\n\t\tvar res = fun(tp, bound, sp, count, size);\n\t\tvar target = new Uint8Array(res);\n\t\ttarget.set(heap.subarray(tp, tp + res));\n\t\tsbrk(tp - sbrk(0));\n\t\treturn target;\n\t}\n\n\tfunction maxindex(source) {\n\t\tvar result = 0;\n\t\tfor (var i = 0; i < source.length; ++i) {\n\t\t\tvar index = source[i];\n\t\t\tresult = result < index ? index : result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction index32(source, size) {\n\t\tassert(size == 2 || size == 4);\n\t\tif (size == 4) {\n\t\t\treturn new Uint32Array(source.buffer, source.byteOffset, source.byteLength / 4);\n\t\t} else {\n\t\t\tvar view = new Uint16Array(source.buffer, source.byteOffset, source.byteLength / 2);\n\t\t\treturn new Uint32Array(view); // copies each element\n\t\t}\n\t}\n\n\tfunction filter(fun, source, count, stride, bits, insize, mode) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar tp = sbrk(count * stride);\n\t\tvar sp = sbrk(count * insize);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(source), sp);\n\t\tfun(tp, count, stride, bits, sp, mode);\n\t\tvar target = new Uint8Array(count * stride);\n\t\ttarget.set(heap.subarray(tp, tp + count * stride));\n\t\tsbrk(tp - sbrk(0));\n\t\treturn target;\n\t}\n\n\treturn {\n\t\tready: ready,\n\t\tsupported: true,\n\t\treorderMesh: function (indices, triangles, optsize) {\n\t\t\tvar optf = triangles\n\t\t\t\t? optsize\n\t\t\t\t\t? instance.exports.meshopt_optimizeVertexCacheStrip\n\t\t\t\t\t: instance.exports.meshopt_optimizeVertexCache\n\t\t\t\t: undefined;\n\t\t\treturn reorder(instance.exports.meshopt_optimizeVertexFetchRemap, indices, maxindex(indices) + 1, optf);\n\t\t},\n\t\treorderPoints: function (positions, positions_stride) {\n\t\t\tassert(positions instanceof Float32Array);\n\t\t\tassert(positions.length % positions_stride == 0);\n\t\t\tassert(positions_stride >= 3);\n\t\t\treturn spatialsort(instance.exports.meshopt_spatialSortRemap, positions, positions.length / positions_stride, positions_stride * 4);\n\t\t},\n\t\tencodeVertexBuffer: function (source, count, size) {\n\t\t\tassert(size > 0 && size <= 256);\n\t\t\tassert(size % 4 == 0);\n\t\t\tvar bound = instance.exports.meshopt_encodeVertexBufferBound(count, size);\n\t\t\treturn encode(instance.exports.meshopt_encodeVertexBuffer, bound, source, count, size);\n\t\t},\n\t\tencodeIndexBuffer: function (source, count, size) {\n\t\t\tassert(size == 2 || size == 4);\n\t\t\tassert(count % 3 == 0);\n\t\t\tvar indices = index32(source, size);\n\t\t\tvar bound = instance.exports.meshopt_encodeIndexBufferBound(count, maxindex(indices) + 1);\n\t\t\treturn encode(instance.exports.meshopt_encodeIndexBuffer, bound, indices, count, 4);\n\t\t},\n\t\tencodeIndexSequence: function (source, count, size) {\n\t\t\tassert(size == 2 || size == 4);\n\t\t\tvar indices = index32(source, size);\n\t\t\tvar bound = instance.exports.meshopt_encodeIndexSequenceBound(count, maxindex(indices) + 1);\n\t\t\treturn encode(instance.exports.meshopt_encodeIndexSequence, bound, indices, count, 4);\n\t\t},\n\t\tencodeGltfBuffer: function (source, count, size, mode) {\n\t\t\tvar table = {\n\t\t\t\tATTRIBUTES: this.encodeVertexBuffer,\n\t\t\t\tTRIANGLES: this.encodeIndexBuffer,\n\t\t\t\tINDICES: this.encodeIndexSequence,\n\t\t\t};\n\t\t\tassert(table[mode]);\n\t\t\treturn table[mode](source, count, size);\n\t\t},\n\t\tencodeFilterOct: function (source, count, stride, bits) {\n\t\t\tassert(stride == 4 || stride == 8);\n\t\t\tassert(bits >= 1 && bits <= 16);\n\t\t\treturn filter(instance.exports.meshopt_encodeFilterOct, source, count, stride, bits, 16);\n\t\t},\n\t\tencodeFilterQuat: function (source, count, stride, bits) {\n\t\t\tassert(stride == 8);\n\t\t\tassert(bits >= 4 && bits <= 16);\n\t\t\treturn filter(instance.exports.meshopt_encodeFilterQuat, source, count, stride, bits, 16);\n\t\t},\n\t\tencodeFilterExp: function (source, count, stride, bits, mode) {\n\t\t\tassert(stride > 0 && stride % 4 == 0);\n\t\t\tassert(bits >= 1 && bits <= 24);\n\t\t\tvar table = {\n\t\t\t\tSeparate: 0,\n\t\t\t\tSharedVector: 1,\n\t\t\t\tSharedComponent: 2,\n\t\t\t\tClamped: 3,\n\t\t\t};\n\t\t\treturn filter(instance.exports.meshopt_encodeFilterExp, source, count, stride, bits, stride, mode ? table[mode] : 1);\n\t\t},\n\t};\n})();\n\nexport { MeshoptEncoder };\n","// This file is part of meshoptimizer library and is distributed under the terms of MIT License.\n// Copyright (C) 2016-2024, by Arseny Kapoulkine (arseny.kapoulkine@gmail.com)\nvar MeshoptDecoder = (function () {\n\t// Built with clang version 18.1.2\n\t// Built from meshoptimizer 0.22\n\tvar wasm_base =\n\t\t'b9H79Tebbbe8Fv9Gbb9Gvuuuuueu9Giuuub9Geueu9Giuuueuikqbeeedddillviebeoweuec:q:Odkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbeY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVbdE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbiL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtblK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbol79IV9Rbrq;w8Wqdbk;esezu8Jjjjjbcj;eb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Radz1jjjbhwcj;abad9Uc;WFbGgocjdaocjd6EhDaicefhocbhqdnindndndnaeaq9nmbaDaeaq9RaqaDfae6Egkcsfglcl4cifcd4hxalc9WGgmTmecbhPawcjdfhsaohzinaraz9Rax6mvarazaxfgo9RcK6mvczhlcbhHinalgic9WfgOawcj;cbffhldndndndndnazaOco4fRbbaHcoG4ciGPlbedibkal9cb83ibalcwf9cb83ibxikalaoRblaoRbbgOco4gAaAciSgAE86bbawcj;cbfaifglcGfaoclfaAfgARbbaOcl4ciGgCaCciSgCE86bbalcVfaAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc7faAaCfgARbbaOciGgOaOciSgOE86bbalctfaAaOfgARbbaoRbegOco4gCaCciSgCE86bbalc91faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc4faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc93faAaCfgARbbaOciGgOaOciSgOE86bbalc94faAaOfgARbbaoRbdgOco4gCaCciSgCE86bbalc95faAaCfgARbbaOcl4ciGgCaCciSgCE86bbalc96faAaCfgARbbaOcd4ciGgCaCciSgCE86bbalc97faAaCfgARbbaOciGgOaOciSgOE86bbalc98faAaOfgORbbaoRbigoco4gAaAciSgAE86bbalc99faOaAfgORbbaocl4ciGgAaAciSgAE86bbalc9:faOaAfgORbbaocd4ciGgAaAciSgAE86bbalcufaOaAfglRbbaociGgoaociSgoE86bbalaofhoxdkalaoRbwaoRbbgOcl4gAaAcsSgAE86bbawcj;cbfaifglcGfaocwfaAfgARbbaOcsGgOaOcsSgOE86bbalcVfaAaOfgORbbaoRbegAcl4gCaCcsSgCE86bbalc7faOaCfgORbbaAcsGgAaAcsSgAE86bbalctfaOaAfgORbbaoRbdgAcl4gCaCcsSgCE86bbalc91faOaCfgORbbaAcsGgAaAcsSgAE86bbalc4faOaAfgORbbaoRbigAcl4gCaCcsSgCE86bbalc93faOaCfgORbbaAcsGgAaAcsSgAE86bbalc94faOaAfgORbbaoRblgAcl4gCaCcsSgCE86bbalc95faOaCfgORbbaAcsGgAaAcsSgAE86bbalc96faOaAfgORbbaoRbvgAcl4gCaCcsSgCE86bbalc97faOaCfgORbbaAcsGgAaAcsSgAE86bbalc98faOaAfgORbbaoRbogAcl4gCaCcsSgCE86bbalc99faOaCfgORbbaAcsGgAaAcsSgAE86bbalc9:faOaAfgORbbaoRbrgocl4gAaAcsSgAE86bbalcufaOaAfglRbbaocsGgoaocsSgoE86bbalaofhoxekalao8Pbb83bbalcwfaocwf8Pbb83bbaoczfhokdnaiam9pmbaHcdfhHaiczfhlarao9RcL0mekkaiam6mvaoTmvdnakTmbawaPfRbbhHawcj;cbfhlashiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkkascefhsaohzaPcefgPad9hmbxikkcbc99arao9Radcaadca0ESEhoxlkaoaxad2fhCdnakmbadhlinaoTmlarao9Rax6mlaoaxfhoalcufglmbkaChoxekcbhmawcjdfhAinarao9Rax6miawamfRbbhHawcj;cbfhlaAhiakhOinaialRbbgzce4cbazceG9R7aHfgH86bbaiadfhialcefhlaOcufgOmbkaAcefhAaoaxfhoamcefgmad9hmbkaChokabaqad2fawcjdfakad2z1jjjb8Aawawcjdfakcufad2fadz1jjjb8Aakaqfhqaombkc9:hoxekc9:hokavcj;ebf8Kjjjjbaok;cseHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecjez:jjjjb8AavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:Lvoeue99dud99eud99dndnadcl9hmbaeTmeindndnabcdfgd8Sbb:Yab8Sbbgi:Ygl:l:tabcefgv8Sbbgo:Ygr:l:tgwJbb;:9cawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai86bbdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad86bbdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad86bbabclfhbaecufgembxdkkaeTmbindndnabclfgd8Ueb:Yab8Uebgi:Ygl:l:tabcdfgv8Uebgo:Ygr:l:tgwJb;:FSawawNJbbbbawawJbbbb9GgDEgq:mgkaqaicb9iEalMgwawNakaqaocb9iEarMgqaqNMM:r:vglNJbbbZJbbb:;aDEMgr:lJbbb9p9DTmbar:Ohixekcjjjj94hikadai87ebdndnaqalNJbbbZJbbb:;aqJbbbb9GEMgq:lJbbb9p9DTmbaq:Ohdxekcjjjj94hdkavad87ebdndnawalNJbbbZJbbb:;awJbbbb9GEMgw:lJbbb9p9DTmbaw:Ohdxekcjjjj94hdkabad87ebabcwfhbaecufgembkkk;oiliui99iue99dnaeTmbcbhiabhlindndnJ;Zl81Zalcof8UebgvciV:Y:vgoal8Ueb:YNgrJb;:FSNJbbbZJbbb:;arJbbbb9GEMgw:lJbbb9p9DTmbaw:OhDxekcjjjj94hDkalclf8Uebhqalcdf8UebhkabaiavcefciGfcetfaD87ebdndnaoak:YNgwJb;:FSNJbbbZJbbb:;awJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavciGfgkcd7cetfaD87ebdndnaoaq:YNgoJb;:FSNJbbbZJbbb:;aoJbbbb9GEMgx:lJbbb9p9DTmbax:OhDxekcjjjj94hDkabaiavcufciGfcetfaD87ebdndnJbbjZararN:tawawN:taoaoN:tgrJbbbbarJbbbb9GE:rJb;:FSNJbbbZMgr:lJbbb9p9DTmbar:Ohvxekcjjjj94hvkabakcetfav87ebalcwfhlaiclfhiaecufgembkkk9mbdnadcd4ae2gdTmbinababydbgecwtcw91:Yaece91cjjj98Gcjjj;8if::NUdbabclfhbadcufgdmbkkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabkkkebcjwklzNbb'; // embed! base\n\tvar wasm_simd =\n\t\t'b9H79TebbbeKl9Gbb9Gvuuuuueu9Giuuub9Geueuikqbbebeedddilve9Weeeviebeoweuec:q:6dkr;leDo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9KW9J9V9KW9wWVtW949c919M9MWVbdY9TW79O9V9Wt9F9KW9J9V9KW69U9KW949c919M9MWVblE9TW79O9V9Wt9F9KW9J9V9KW69U9KW949tWG91W9U9JWbvL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9p9JtboK9TW79O9V9Wt9F9KW9J9V9KWS9P2tWV9r919HtbrL9TW79O9V9Wt9F9KW9J9V9KWS9P2tWVT949Wbwl79IV9RbDq:p9sqlbzik9:evu8Jjjjjbcz9Rhbcbheincbhdcbhiinabcwfadfaicjuaead4ceGglE86bbaialfhiadcefgdcw9hmbkaec:q:yjjbfai86bbaecitc:q1jjbfab8Piw83ibaecefgecjd9hmbkk:N8JlHud97euo978Jjjjjbcj;kb9Rgv8Kjjjjbc9:hodnadcefal0mbcuhoaiRbbc:Ge9hmbavaialfgrad9Rad;8qbbcj;abad9UhlaicefhodnaeTmbadTmbalc;WFbGglcjdalcjd6EhwcbhDinawaeaD9RaDawfae6Egqcsfglc9WGgkci2hxakcethmalcl4cifcd4hPabaDad2fhsakc;ab6hzcbhHincbhOaohAdndninaraA9RaP6meavcj;cbfaOak2fhCaAaPfhocbhidnazmbarao9Rc;Gb6mbcbhlinaCalfhidndndndndnaAalco4fRbbgXciGPlbedibkaipxbbbbbbbbbbbbbbbbpklbxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklbaoczfhokdndndndndnaXcd4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklzxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklzaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklzaoczfhokdndndndndnaXcl4ciGPlbedibkaipxbbbbbbbbbbbbbbbbpklaxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spklaaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaiaopbbbpklaaoczfhokdndndndndnaXco4Plbedibkaipxbbbbbbbbbbbbbbbbpkl8WxikaiaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaoclfaYpQbfaXc:q:yjjbfRbbfhoxdkaiaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibaXc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgXcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkl8WaocwfaYpQbfaXc:q:yjjbfRbbfhoxekaiaopbbbpkl8Waoczfhokalc;abfhialcjefak0meaihlarao9Rc;Fb0mbkkdnaiak9pmbaici4hlinarao9RcK6miaCaifhXdndndndndnaAaico4fRbbalcoG4ciGPlbedibkaXpxbbbbbbbbbbbbbbbbpkbbxikaXaopbblaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLgQcdp:meaQpmbzeHdOiAlCvXoQrLpxiiiiiiiiiiiiiiiip9ogLpxiiiiiiiiiiiiiiiip8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaoclfaYpQbfaKc:q:yjjbfRbbfhoxdkaXaopbbwaopbbbgQclp:meaQpmbzeHdOiAlCvXoQrLpxssssssssssssssssp9ogLpxssssssssssssssssp8JgQp5b9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibaKc:q:yjjbfpbbbgYaYpmbbbbbbbbbbbbbbbbaQp5e9cjF;8;4;W;G;ab9:9cU1:NgKcitc:q1jjbfpbibp9UpmbedilvorzHOACXQLpPaLaQp9spkbbaocwfaYpQbfaKc:q:yjjbfRbbfhoxekaXaopbbbpkbbaoczfhokalcdfhlaiczfgiak6mbkkaoTmeaohAaOcefgOclSmdxbkkc9:hoxlkdnakTmbavcjdfaHfhiavaHfpbdbhYcbhXinaiavcj;cbfaXfglpblbgLcep9TaLpxeeeeeeeeeeeeeeeegQp9op9Hp9rgLalakfpblbg8Acep9Ta8AaQp9op9Hp9rg8ApmbzeHdOiAlCvXoQrLgEalamfpblbg3cep9Ta3aQp9op9Hp9rg3alaxfpblbg5cep9Ta5aQp9op9Hp9rg5pmbzeHdOiAlCvXoQrLg8EpmbezHdiOAlvCXorQLgQaQpmbedibedibedibediaYp9UgYp9AdbbaiadfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaEa8EpmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwKDYq8AkEx3m5P8Es8FgLa3a5pmwKDYq8AkEx3m5P8Es8Fg8ApmbezHdiOAlvCXorQLgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfglaYaLa8ApmwDKYqk8AExm35Ps8E8FgQaQpmbedibedibedibedip9UgYp9AdbbaladfglaYaQaQpmlvorlvorlvorlvorp9UgYp9AdbbaladfglaYaQaQpmwDqkwDqkwDqkwDqkp9UgYp9AdbbaladfglaYaQaQpmxmPsxmPsxmPsxmPsp9UgYp9AdbbaladfhiaXczfgXak6mbkkaHclfgHad6mbkasavcjdfaqad2;8qbbavavcjdfaqcufad2fad;8qbbaqaDfgDae6mbkkcbc99arao9Radcaadca0ESEhokavcj;kbf8Kjjjjbaokwbz:bjjjbk::seHu8Jjjjjbc;ae9Rgv8Kjjjjbc9:hodnaeci9UgrcHfal0mbcuhoaiRbbgwc;WeGc;Ge9hmbawcsGgwce0mbavc;abfcFecje;8kbavcUf9cu83ibavc8Wf9cu83ibavcyf9cu83ibavcaf9cu83ibavcKf9cu83ibavczf9cu83ibav9cu83iwav9cu83ibaialfc9WfhDaicefgqarfhidnaeTmbcmcsawceSEhkcbhxcbhmcbhPcbhwcbhlindnaiaD9nmbc9:hoxikdndnaqRbbgoc;Ve0mbavc;abfalaocu7gscl4fcsGcitfgzydlhrazydbhzdnaocsGgHak9pmbavawasfcsGcdtfydbaxaHEhoaHThsdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkaxasfhxcdhHavawcdtfaoBdbawasfhwcehsalhOxdkdndnaHcsSmbaHc987aHamffcefhoxekaicefhoai8SbbgHcFeGhsdndnaHcu9mmbaohixekaicvfhiascFbGhscrhHdninao8SbbgOcFbGaHtasVhsaOcu9kmeaocefhoaHcrfgHc8J9hmbxdkkaocefhikasce4cbasceG9R7amfhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhHavawcdtfaoBdbcehsawcefhwalhOaohmxekdnaocpe0mbaxcefgHavawaDaocsGfRbbgocl49RcsGcdtfydbaocz6gzEhravawao9RcsGcdtfydbaHazfgAaocsGgHEhoaHThCdndnadcd9hmbabaPcetfgHax87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHaxBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfaxBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgOaxBdlaOarBdbavawazfgwcsGcdtfaoBdbalcefcsGhOawaCfhwaxhzaAaCfhxxekaxcbaiRbbgOEgzaoc;:eSgHfhraOcsGhCaOcl4hAdndnaOcs0mbarcefhoxekarhoavawaA9RcsGcdtfydbhrkdndnaCmbaocefhxxekaohxavawaO9RcsGcdtfydbhokdndnaHTmbaicefhHxekaicdfhHai8SbegscFeGhzdnascu9kmbaicofhXazcFbGhzcrhidninaH8SbbgscFbGaitazVhzascu9kmeaHcefhHaicrfgic8J9hmbkaXhHxekaHcefhHkazce4cbazceG9R7amfgmhzkdndnaAcsSmbaHhsxekaHcefhsaH8SbbgicFeGhrdnaicu9kmbaHcvfhXarcFbGhrcrhidninas8SbbgHcFbGaitarVhraHcu9kmeascefhsaicrfgic8J9hmbkaXhsxekascefhskarce4cbarceG9R7amfgmhrkdndnaCcsSmbashixekascefhias8SbbgocFeGhHdnaocu9kmbascvfhXaHcFbGhHcrhodninai8SbbgscFbGaotaHVhHascu9kmeaicefhiaocrfgoc8J9hmbkaXhixekaicefhikaHce4cbaHceG9R7amfgmhokdndnadcd9hmbabaPcetfgHaz87ebaHclfao87ebaHcdfar87ebxekabaPcdtfgHazBdbaHcwfaoBdbaHclfarBdbkcdhsavawcdtfazBdbavawcefgwcsGcdtfarBdbcihHavc;abfalcitfgXazBdlaXarBdbavawaOcz6aAcsSVfgwcsGcdtfaoBdbawaCTaCcsSVfhwalcefcsGhOkaqcefhqavc;abfaOcitfgOarBdlaOaoBdbavc;abfalasfcsGcitfgraoBdlarazBdbawcsGhwalaHfcsGhlaPcifgPae6mbkkcbc99aiaDSEhokavc;aef8Kjjjjbaok:flevu8Jjjjjbcz9Rhvc9:hodnaecvfal0mbcuhoaiRbbc;:eGc;qe9hmbav9cb83iwaicefhraialfc98fhwdnaeTmbdnadcdSmbcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcdtfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfglBdbaoalBdbaDcefgDae9hmbxdkkcbhDindnaraw6mbc9:skarcefhoar8SbbglcFeGhidndnalcu9mmbaohrxekarcvfhraicFbGhicrhldninao8SbbgdcFbGaltaiVhiadcu9kmeaocefhoalcrfglc8J9hmbxdkkaocefhrkabaDcetfaic8Etc8F91aicd47avcwfaiceGcdtVgoydbfgl87ebaoalBdbaDcefgDae9hmbkkcbc99arawSEhokaok:wPliuo97eue978Jjjjjbca9Rhiaec98Ghldndnadcl9hmbdnalTmbcbhvabhdinadadpbbbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDpxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpkbbadczfhdavclfgval6mbkkalaeSmeaipxbbbbbbbbbbbbbbbbgqpklbaiabalcdtfgdaeciGglcdtgv;8qbbdnalTmbaiaipblbgocKp:RecKp:Sep;6egraocwp:RecKp:Sep;6earp;Geaoczp:RecKp:Sep;6egwp;Gep;Kep;LegDaqp:2egqarpxbbbjbbbjbbbjbbbjgkp9op9rp;Kegrpxbb;:9cbb;:9cbb;:9cbb;:9cararp;MeaDaDp;Meawaqawakp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFbbbFbbbFbbbFbbbp9oaopxbbbFbbbFbbbFbbbFp9op9qarawp;Meaqp;Kecwp:RepxbFbbbFbbbFbbbFbbp9op9qaDawp;Meaqp;Keczp:RepxbbFbbbFbbbFbbbFbp9op9qpklbkadaiav;8qbbskdnalTmbcbhvabhdinadczfgxaxpbbbgopxbbbbbbFFbbbbbbFFgkp9oadpbbbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpkbbadaDakp9oaoarpmbezHdiOAlvCXorQLp9qpkbbadcafhdavclfgval6mbkkalaeSmbaiaeciGgvcitgdfcbcaad9R;8kbaiabalcitfglad;8qbbdnavTmbaiaipblzgopxbbbbbbFFbbbbbbFFgkp9oaipblbgDaopmbediwDqkzHOAKY8AEgwczp:Reczp:Sep;6egraDaopmlvorxmPsCXQL358E8FpxFubbFubbFubbFubbp9op;6eawczp:Sep;6egwp;Gearp;Gep;Kep;Legopxbbbbbbbbbbbbbbbbp:2egqarpxbbbjbbbjbbbjbbbjgmp9op9rp;Kegrpxb;:FSb;:FSb;:FSb;:FSararp;Meaoaop;Meawaqawamp9op9rp;Kegrarp;Mep;Kep;Kep;Jep;Negwp;Mepxbbn0bbn0bbn0bbn0gqp;KepxFFbbFFbbFFbbFFbbp9oaoawp;Meaqp;Keczp:Rep9qgoarawp;Meaqp;KepxFFbbFFbbFFbbFFbbp9ogrpmwDKYqk8AExm35Ps8E8Fp9qpklzaiaDakp9oaoarpmbezHdiOAlvCXorQLp9qpklbkalaiad;8qbbkk;4wllue97euv978Jjjjjbc8W9Rhidnaec98GglTmbcbhvabhoinaiaopbbbgraoczfgwpbbbgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklbaopxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblbpEb:T:j83ibaocwfarp5eaipblbpEe:T:j83ibawaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblbpEd:T:j83ibaocKfakp5eaipblbpEi:T:j83ibaocafhoavclfgval6mbkkdnalaeSmbaiaeciGgvcitgofcbcaao9R;8kbaiabalcitfgwao;8qbbdnavTmbaiaipblbgraipblzgDpmlvorxmPsCXQL358E8Fgqczp:Segkclp:RepklaaipxbbjZbbjZbbjZbbjZpx;Zl81Z;Zl81Z;Zl81Z;Zl81Zakpxibbbibbbibbbibbbp9qp;6ep;NegkaraDpmbediwDqkzHOAKY8AEgrczp:Reczp:Sep;6ep;MegDaDp;Meakarczp:Sep;6ep;Megxaxp;Meakaqczp:Reczp:Sep;6ep;Megqaqp;Mep;Kep;Kep;Lepxbbbbbbbbbbbbbbbbp:4ep;Jepxb;:FSb;:FSb;:FSb;:FSgkp;Mepxbbn0bbn0bbn0bbn0grp;KepxFFbbFFbbFFbbFFbbgmp9oaxakp;Mearp;Keczp:Rep9qgxaDakp;Mearp;Keamp9oaqakp;Mearp;Keczp:Rep9qgkpmbezHdiOAlvCXorQLgrp5baipblapEb:T:j83ibaiarp5eaipblapEe:T:j83iwaiaxakpmwDKYqk8AExm35Ps8E8Fgkp5baipblapEd:T:j83izaiakp5eaipblapEi:T:j83iKkawaiao;8qbbkk:Pddiue978Jjjjjbc;ab9Rhidnadcd4ae2glc98GgvTmbcbheabhdinadadpbbbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepkbbadczfhdaeclfgeav6mbkkdnavalSmbaialciGgecdtgdVcbc;abad9R;8kbaiabavcdtfgvad;8qbbdnaeTmbaiaipblbgocwp:Recwp:Sep;6eaocep:SepxbbjFbbjFbbjFbbjFp9opxbbjZbbjZbbjZbbjZp:Uep;Mepklbkavaiad;8qbbkk9teiucbcbydj1jjbgeabcifc98GfgbBdj1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaikkkebcjwklz:Dbb'; // embed! simd\n\n\tvar detector = new Uint8Array([\n\t\t0, 97, 115, 109, 1, 0, 0, 0, 1, 4, 1, 96, 0, 0, 3, 3, 2, 0, 0, 5, 3, 1, 0, 1, 12, 1, 0, 10, 22, 2, 12, 0, 65, 0, 65, 0, 65, 0, 252, 10, 0, 0,\n\t\t11, 7, 0, 65, 0, 253, 15, 26, 11,\n\t]);\n\tvar wasmpack = new Uint8Array([\n\t\t32, 0, 65, 2, 1, 106, 34, 33, 3, 128, 11, 4, 13, 64, 6, 253, 10, 7, 15, 116, 127, 5, 8, 12, 40, 16, 19, 54, 20, 9, 27, 255, 113, 17, 42, 67,\n\t\t24, 23, 146, 148, 18, 14, 22, 45, 70, 69, 56, 114, 101, 21, 25, 63, 75, 136, 108, 28, 118, 29, 73, 115,\n\t]);\n\n\tif (typeof WebAssembly !== 'object') {\n\t\treturn {\n\t\t\tsupported: false,\n\t\t};\n\t}\n\n\tvar wasm = WebAssembly.validate(detector) ? unpack(wasm_simd) : unpack(wasm_base);\n\n\tvar instance;\n\n\tvar ready = WebAssembly.instantiate(wasm, {}).then(function (result) {\n\t\tinstance = result.instance;\n\t\tinstance.exports.__wasm_call_ctors();\n\t});\n\n\tfunction unpack(data) {\n\t\tvar result = new Uint8Array(data.length);\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tvar ch = data.charCodeAt(i);\n\t\t\tresult[i] = ch > 96 ? ch - 97 : ch > 64 ? ch - 39 : ch + 4;\n\t\t}\n\t\tvar write = 0;\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tresult[write++] = result[i] < 60 ? wasmpack[result[i]] : (result[i] - 60) * 64 + result[++i];\n\t\t}\n\t\treturn result.buffer.slice(0, write);\n\t}\n\n\tfunction decode(instance, fun, target, count, size, source, filter) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar count4 = (count + 3) & ~3;\n\t\tvar tp = sbrk(count4 * size);\n\t\tvar sp = sbrk(source.length);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(source, sp);\n\t\tvar res = fun(tp, count, size, sp, source.length);\n\t\tif (res == 0 && filter) {\n\t\t\tfilter(tp, count4, size);\n\t\t}\n\t\ttarget.set(heap.subarray(tp, tp + count * size));\n\t\tsbrk(tp - sbrk(0));\n\t\tif (res != 0) {\n\t\t\tthrow new Error('Malformed buffer data: ' + res);\n\t\t}\n\t}\n\n\tvar filters = {\n\t\tNONE: '',\n\t\tOCTAHEDRAL: 'meshopt_decodeFilterOct',\n\t\tQUATERNION: 'meshopt_decodeFilterQuat',\n\t\tEXPONENTIAL: 'meshopt_decodeFilterExp',\n\t};\n\n\tvar decoders = {\n\t\tATTRIBUTES: 'meshopt_decodeVertexBuffer',\n\t\tTRIANGLES: 'meshopt_decodeIndexBuffer',\n\t\tINDICES: 'meshopt_decodeIndexSequence',\n\t};\n\n\tvar workers = [];\n\tvar requestId = 0;\n\n\tfunction createWorker(url) {\n\t\tvar worker = {\n\t\t\tobject: new Worker(url),\n\t\t\tpending: 0,\n\t\t\trequests: {},\n\t\t};\n\n\t\tworker.object.onmessage = function (event) {\n\t\t\tvar data = event.data;\n\n\t\t\tworker.pending -= data.count;\n\t\t\tworker.requests[data.id][data.action](data.value);\n\t\t\tdelete worker.requests[data.id];\n\t\t};\n\n\t\treturn worker;\n\t}\n\n\tfunction initWorkers(count) {\n\t\tvar source =\n\t\t\t'self.ready = WebAssembly.instantiate(new Uint8Array([' +\n\t\t\tnew Uint8Array(wasm) +\n\t\t\t']), {})' +\n\t\t\t'.then(function(result) { result.instance.exports.__wasm_call_ctors(); return result.instance; });' +\n\t\t\t'self.onmessage = ' +\n\t\t\tworkerProcess.name +\n\t\t\t';' +\n\t\t\tdecode.toString() +\n\t\t\tworkerProcess.toString();\n\n\t\tvar blob = new Blob([source], { type: 'text/javascript' });\n\t\tvar url = URL.createObjectURL(blob);\n\n\t\tfor (var i = workers.length; i < count; ++i) {\n\t\t\tworkers[i] = createWorker(url);\n\t\t}\n\n\t\tfor (var i = count; i < workers.length; ++i) {\n\t\t\tworkers[i].object.postMessage({});\n\t\t}\n\n\t\tworkers.length = count;\n\n\t\tURL.revokeObjectURL(url);\n\t}\n\n\tfunction decodeWorker(count, size, source, mode, filter) {\n\t\tvar worker = workers[0];\n\n\t\tfor (var i = 1; i < workers.length; ++i) {\n\t\t\tif (workers[i].pending < worker.pending) {\n\t\t\t\tworker = workers[i];\n\t\t\t}\n\t\t}\n\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tvar data = new Uint8Array(source);\n\t\t\tvar id = ++requestId;\n\n\t\t\tworker.pending += count;\n\t\t\tworker.requests[id] = { resolve: resolve, reject: reject };\n\t\t\tworker.object.postMessage({ id: id, count: count, size: size, source: data, mode: mode, filter: filter }, [data.buffer]);\n\t\t});\n\t}\n\n\tfunction workerProcess(event) {\n\t\tvar data = event.data;\n\t\tif (!data.id) {\n\t\t\treturn self.close();\n\t\t}\n\t\tself.ready.then(function (instance) {\n\t\t\ttry {\n\t\t\t\tvar target = new Uint8Array(data.count * data.size);\n\t\t\t\tdecode(instance, instance.exports[data.mode], target, data.count, data.size, data.source, instance.exports[data.filter]);\n\t\t\t\tself.postMessage({ id: data.id, count: data.count, action: 'resolve', value: target }, [target.buffer]);\n\t\t\t} catch (error) {\n\t\t\t\tself.postMessage({ id: data.id, count: data.count, action: 'reject', value: error });\n\t\t\t}\n\t\t});\n\t}\n\n\treturn {\n\t\tready: ready,\n\t\tsupported: true,\n\t\tuseWorkers: function (count) {\n\t\t\tinitWorkers(count);\n\t\t},\n\t\tdecodeVertexBuffer: function (target, count, size, source, filter) {\n\t\t\tdecode(instance, instance.exports.meshopt_decodeVertexBuffer, target, count, size, source, instance.exports[filters[filter]]);\n\t\t},\n\t\tdecodeIndexBuffer: function (target, count, size, source) {\n\t\t\tdecode(instance, instance.exports.meshopt_decodeIndexBuffer, target, count, size, source);\n\t\t},\n\t\tdecodeIndexSequence: function (target, count, size, source) {\n\t\t\tdecode(instance, instance.exports.meshopt_decodeIndexSequence, target, count, size, source);\n\t\t},\n\t\tdecodeGltfBuffer: function (target, count, size, source, mode, filter) {\n\t\t\tdecode(instance, instance.exports[decoders[mode]], target, count, size, source, instance.exports[filters[filter]]);\n\t\t},\n\t\tdecodeGltfBufferAsync: function (count, size, source, mode, filter) {\n\t\t\tif (workers.length > 0) {\n\t\t\t\treturn decodeWorker(count, size, source, decoders[mode], filters[filter]);\n\t\t\t}\n\n\t\t\treturn ready.then(function () {\n\t\t\t\tvar target = new Uint8Array(count * size);\n\t\t\t\tdecode(instance, instance.exports[decoders[mode]], target, count, size, source, instance.exports[filters[filter]]);\n\t\t\t\treturn target;\n\t\t\t});\n\t\t},\n\t};\n})();\n\nexport { MeshoptDecoder };\n","// This file is part of meshoptimizer library and is distributed under the terms of MIT License.\n// Copyright (C) 2016-2024, by Arseny Kapoulkine (arseny.kapoulkine@gmail.com)\nvar MeshoptSimplifier = (function () {\n\t// Built with clang version 18.1.2\n\t// Built from meshoptimizer 0.22\n\tvar wasm =\n\t\t'b9H79Tebbbe9Hk9Geueu9Geub9Gbb9Gsuuuuuuuuuuuu99uueu9Gvuuuuub9Gvuuuuue999Gquuuuuuu99uueu9Gwuuuuuu99ueu9Giuuue999Gluuuueu9GiuuueuizsdilvoirwDbqqbeqlve9Weiiviebeoweuecj:Pdkr:Tewo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bbz9TW79O9V9Wt9F79P9T9W29P9M95bl8E9TW79O9V9Wt9F79P9T9W29P9M959x9Pt9OcttV9P9I91tW7bvQ9TW79O9V9Wt9F79P9T9W29P9M959q9V9P9Ut7boX9TW79O9V9Wt9F79P9T9W29P9M959t9J9H2Wbra9TW79O9V9Wt9F9V9Wt9P9T9P96W9wWVtW94SWt9J9O9sW9T9H9Wbwl79IV9RbDDwebcekdmxq;UMesdbk:kfvKue99euY99Qu8Jjjjjbc;W;qb9Rgs8Kjjjjbcbhzascxfcbc;Kbz:ljjjb8AdnabaeSmbabaeadcdtz:kjjjb8AkdnamcdGTmbalcrfci4gHcbyd;S1jjbHjjjjbbheascxfasyd2gOcdtfaeBdbasaOcefBd2aecbaHz:ljjjbhAcbhlcbhednadTmbcbhlabheadhHinaAaeydbgOci4fgCaCRbbgCceaOcrGgOtV86bbaCcu7aO4ceGalfhlaeclfheaHcufgHmbkcualcdtalcFFFFi0Ehekaecbyd;S1jjbHjjjjbbhzascxfasyd2gecdtfazBdbasaecefBd2alcd4alfhOcehHinaHgecethHaeaO6mbkcbhXcuaecdtgOaecFFFFi0Ecbyd;S1jjbHjjjjbbhHascxfasyd2gCcdtfaHBdbasaCcefBd2aHcFeaOz:ljjjbhQdnadTmbaecufhCcbhLinabaXcdtfgKydbgAc:v;t;h;Ev2hOcbhedndninaQaOaCGgOcdtfgYydbgHcuSmeazaHcdtfydbaASmdaecefgeaOfhOaeaC9nmbxdkkazaLcdtfaABdbaYaLBdbaLhHaLcefhLkaKaHBdbaXcefgXad9hmbkkaQcbyd;O1jjbH:bjjjbbasasyd2cufBd2kcualcefgecdtaecFFFFi0Ecbyd;S1jjbHjjjjbbh8Aascxfasyd2gecdtfa8ABdbasa8ABdlasaecefBd2cuadcitadcFFFFe0Ecbyd;S1jjbHjjjjbbhEascxfasyd2gecdtfaEBdbasaEBdwasaecefBd2asclfabadalcbz:cjjjbcualcdtg3alcFFFFi0Eg5cbyd;S1jjbHjjjjbbhQascxfasyd2gecdtfaQBdbasaecefBd2a5cbyd;S1jjbHjjjjbbh8Eascxfasyd2gecdtfa8EBdbasaecefBd2alcd4alfhOcehHinaHgecethHaeaO6mbkcbhLcuaecdtgOaecFFFFi0Ecbyd;S1jjbHjjjjbbhHascxfasyd2gCcdtfaHBdbasaCcefBd2aHcFeaOz:ljjjbhXdnalTmbavcd4hCaecufhHinaLhednazTmbazaLcdtfydbhekaiaeaC2cdtfgeydlgOcH4aO7c:F:b:DD2aeydbgOcH4aO7c;D;O:B8J27aeydwgecH4ae7c:3F;N8N27aHGheaLcdth8FdndndndndnazTmbaza8FfhKcbhOinaXaecdtfgYydbgAcuSmlaiazaAcdtfydbaC2cdtfaiaKydbaC2cdtfcxz:ojjjbTmiaOcefgOaefaHGheaOaH9nmbxdkkaiaLaC2cdtfhKcbhOinaXaecdtfgYydbgAcuSmiaiaAaC2cdtfaKcxz:ojjjbTmdaOcefgOaefaHGheaOaH9nmbkkcbhYkaYydbgecu9hmekaYaLBdbaLhekaQa8FfaeBdbaLcefgLal9hmbkcbhea8EhHinaHaeBdbaHclfhHalaecefge9hmbkcbheaQhHa8EhOindnaeaHydbgCSmbaOa8EaCcdtfgCydbBdbaCaeBdbkaHclfhHaOclfhOalaecefge9hmbkkcbhaaXcbyd;O1jjbH:bjjjbbasasyd2cufBd2alcbyd;S1jjbHjjjjbbhXascxfasyd2gecdtfaXBdbasaecefBd2a5cbyd;S1jjbHjjjjbbheascxfasyd2gHcdtfaeBdbasaHcefBd2a5cbyd;S1jjbHjjjjbbhHascxfasyd2gOcdtfaHBdbasaOcefBd2aecFea3z:ljjjbhhaHcFea3z:ljjjbhgdnalTmbaEcwfh8Jindna8AaagOcefgacdtfydbgCa8AaOcdtgefydbgHSmbaCaH9Rh8FaEaHcitfh3agaefh8KahaefhLcbhAindndna3aAcitfydbgYaO9hmbaLaOBdba8KaOBdbxekdna8AaYcdtg8LfgeclfydbgHaeydbgeSmbaEaecitgCfydbaOSmeaHae9Rh8Maecu7aHfhKa8JaCfhHcbheinaKaeSmeaecefheaHydbhCaHcwfhHaCaO9hmbkaea8M6mekaga8LfgeaOaYaeydbcuSEBdbaLaYaOaLydbcuSEBdbkaAcefgAa8F9hmbkkaaal9hmbkaQhHa8EhOaghCahhAcbheindndnaeaHydbgY9hmbdnaeaOydbgY9hmbaAydbhYdnaCydbgKcu9hmbaYcu9hmbaXaefcb86bbxikaXaefhLdnaeaKSmbaeaYSmbaLce86bbxikaLcl86bbxdkdnaea8EaYcdtgKfydb9hmbdnaCydbgLcuSmbaeaLSmbaAydbg8FcuSmbaea8FSmbagaKfydbg3cuSmba3aYSmbahaKfydbgKcuSmbaKaYSmbdnaQaLcdtfydbgYaQaKcdtfydb9hmbaYaQa8FcdtfydbgKSmbaKaQa3cdtfydb9hmbaXaefcd86bbxlkaXaefcl86bbxikaXaefcl86bbxdkaXaefcl86bbxekaXaefaXaYfRbb86bbkaHclfhHaOclfhOaCclfhCaAclfhAalaecefge9hmbkdnaqTmbdndnazTmbazheaQhHalhOindnaqaeydbfRbbTmbaXaHydbfcl86bbkaeclfheaHclfhHaOcufgOmbxdkkaQhealhHindnaqRbbTmbaXaeydbfcl86bbkaqcefhqaeclfheaHcufgHmbkkaQhealhOaXhHindnaXaeydbfRbbcl9hmbaHcl86bbkaeclfheaHcefhHaOcufgOmbkkamceGTmbaXhealhHindnaeRbbce9hmbaecl86bbkaecefheaHcufgHmbkkcualcx2alc;v:Q;v:Qe0Ecbyd;S1jjbHjjjjbbhaascxfasyd2gecdtfaaBdbasaecefBd2aaaialavazz:djjjbh8NdndnaDmbcbhycbh8Jxekcbh8JawhecbhHindnaeIdbJbbbb9ETmbasc;Wbfa8JcdtfaHBdba8Jcefh8JkaeclfheaDaHcefgH9hmbkcua8Jal2gecdtaecFFFFi0Ecbyd;S1jjbHjjjjbbhyascxfasyd2gecdtfayBdbasaecefBd2alTmba8JTmbarcd4hLdnazTmba8JcdthicbhYayhKinaoazaYcdtfydbaL2cdtfhAasc;WbfheaKhHa8JhOinaHaAaeydbcdtgCfIdbawaCfIdbNUdbaeclfheaHclfhHaOcufgOmbkaKaifhKaYcefgYal9hmbxdkka8JcdthicbhYayhKinaoaYaL2cdtfhAasc;WbfheaKhHa8JhOinaHaAaeydbcdtgCfIdbawaCfIdbNUdbaeclfheaHclfhHaOcufgOmbkaKaifhKaYcefgYal9hmbkkcualc8S2gHalc;D;O;f8U0EgCcbyd;S1jjbHjjjjbbheascxfasyd2gOcdtfaeBdbasaOcefBd2aecbaHz:ljjjbhqdndndndna8JTmbaCcbyd;S1jjbHjjjjbbhvascxfasyd2gecdtfavBdbcehOasaecefBd2avcbaHz:ljjjb8Acua8Jal2gecltgHaecFFFFb0Ecbyd;S1jjbHjjjjbbhrascxfasyd2gecdtfarBdbasaecefBd2arcbaHz:ljjjb8AadmexikcbhvadTmecbhrkcbhAabhHindnaaaHclfydbgYcx2fgeIdbaaaHydbgKcx2fgOIdbg8P:tgIaaaHcwfydbgLcx2fgCIdlaOIdlg8R:tg8SNaCIdba8P:tgRaeIdla8R:tg8UN:tg8Va8VNa8UaCIdwaOIdwg8W:tg8XNa8SaeIdwa8W:tg8UN:tg8Sa8SNa8UaRNa8XaIN:tgIaINMM:rgRJbbbb9ETmba8VaR:vh8VaIaR:vhIa8SaR:vh8SkaqaQaKcdtfydbc8S2fgea8SaR:rgRa8SNNg8UaeIdbMUdbaeaIaRaINg8YNg8XaeIdlMUdlaea8VaRa8VNg8ZNg80aeIdwMUdwaea8Ya8SNg8YaeIdxMUdxaea8Za8SNg81aeIdzMUdzaea8ZaINg8ZaeIdCMUdCaea8SaRa8Va8WNa8Sa8PNa8RaINMM:mg8RNg8PNg8SaeIdKMUdKaeaIa8PNgIaeId3MUd3aea8Va8PNg8VaeIdaMUdaaea8Pa8RNg8PaeId8KMUd8KaeaRaeIdyMUdyaqaQaYcdtfydbc8S2fgea8UaeIdbMUdbaea8XaeIdlMUdlaea80aeIdwMUdwaea8YaeIdxMUdxaea81aeIdzMUdzaea8ZaeIdCMUdCaea8SaeIdKMUdKaeaIaeId3MUd3aea8VaeIdaMUdaaea8PaeId8KMUd8KaeaRaeIdyMUdyaqaQaLcdtfydbc8S2fgea8UaeIdbMUdbaea8XaeIdlMUdlaea80aeIdwMUdwaea8YaeIdxMUdxaea81aeIdzMUdzaea8ZaeIdCMUdCaea8SaeIdKMUdKaeaIaeId3MUd3aea8VaeIdaMUdaaea8PaeId8KMUd8KaeaRaeIdyMUdyaHcxfhHaAcifgAad6mbkcbhiabhKinabaicdtfhYcbhHinaXaYaHc:G1jjbfydbcdtfydbgOfRbbhedndnaXaKaHfydbgCfRbbgAc99fcFeGcpe0mbaeceSmbaecd9hmekdnaAcufcFeGce0mbahaCcdtfydbaO9hmekdnaecufcFeGce0mbagaOcdtfydbaC9hmekdnaAcv2aefcj1jjbfRbbTmbaQaOcdtfydbaQaCcdtfydb0mekJbbacJbbacJbbjZaeceSEaAceSEh8ZdnaaaYaHc:K1jjbfydbcdtfydbcx2fgeIdwaaaCcx2fgAIdwg8R:tg8VaaaOcx2fgLIdwa8R:tg8Sa8SNaLIdbaAIdbg8W:tgIaINaLIdlaAIdlg8U:tgRaRNMMg8PNa8Va8SNaeIdba8W:tg80aINaRaeIdla8U:tg8YNMMg8Xa8SN:tg8Va8VNa80a8PNa8XaIN:tg8Sa8SNa8Ya8PNa8XaRN:tgIaINMM:rgRJbbbb9ETmba8VaR:vh8VaIaR:vhIa8SaR:vh8SkaqaQaCcdtfydbc8S2fgea8Sa8Za8P:rNgRa8SNNg8XaeIdbMUdbaeaIaRaINg8ZNg80aeIdlMUdlaea8VaRa8VNg8PNg8YaeIdwMUdwaea8Za8SNg8ZaeIdxMUdxaea8Pa8SNg81aeIdzMUdzaea8PaINgBaeIdCMUdCaea8SaRa8Va8RNa8Sa8WNa8UaINMM:mg8RNg8PNg8SaeIdKMUdKaeaIa8PNgIaeId3MUd3aea8Va8PNg8VaeIdaMUdaaea8Pa8RNg8PaeId8KMUd8KaeaRaeIdyMUdyaqaQaOcdtfydbc8S2fgea8XaeIdbMUdbaea80aeIdlMUdlaea8YaeIdwMUdwaea8ZaeIdxMUdxaea81aeIdzMUdzaeaBaeIdCMUdCaea8SaeIdKMUdKaeaIaeId3MUd3aea8VaeIdaMUdaaea8PaeId8KMUd8KaeaRaeIdyMUdykaHclfgHcx9hmbkaKcxfhKaicifgiad6mbkdna8JTmbcbhKinJbbbbh8WaaabaKcdtfgeclfydbgLcx2fgHIdwaaaeydbgicx2fgOIdwg8Y:tgIaINaHIdbaOIdbg81:tg8Va8VNaHIdlaOIdlgB:tgRaRNMMg8Zaaaecwfydbg8Fcx2fgeIdwa8Y:tg8PNaIaIa8PNa8VaeIdba81:tg8RNaRaeIdlaB:tg8UNMMg8SN:tJbbbbJbbjZa8Za8Pa8PNa8Ra8RNa8Ua8UNMMg80Na8Sa8SN:tg8X:va8XJbbbb9BEg8XNh83a80aINa8Pa8SN:ta8XNhUa8Za8UNaRa8SN:ta8XNh85a80aRNa8Ua8SN:ta8XNh86a8Za8RNa8Va8SN:ta8XNh87a80a8VNa8Ra8SN:ta8XNh88a8Va8UNa8RaRN:tg8Sa8SNaRa8PNa8UaIN:tg8Sa8SNaIa8RNa8Pa8VN:tg8Sa8SNMM:rJbbbZNh8Sayaia8J2g3cdtfhHaya8Fa8J2gwcdtfhOayaLa8J2g8LcdtfhCa8Y:mh89aB:mh8:a81:mhZcbhAa8JhYJbbbbh8UJbbbbh8XJbbbbh8ZJbbbbh80Jbbbbh8YJbbbbh81JbbbbhBJbbbbhnJbbbbhcinasc;WbfaAfgecwfa8SaUaCIdbaHIdbg8P:tgRNa83aOIdba8P:tg8RNMgINUdbaeclfa8Sa86aRNa85a8RNMg8VNUdbaea8Sa88aRNa87a8RNMgRNUdbaecxfa8Sa89aINa8:a8VNa8PaZaRNMMMg8PNUdba8SaIa8VNNa80Mh80a8SaIaRNNa8YMh8Ya8Sa8VaRNNa81Mh81a8Sa8Pa8PNNa8WMh8Wa8SaIa8PNNa8UMh8Ua8Sa8Va8PNNa8XMh8Xa8SaRa8PNNa8ZMh8Za8SaIaINNaBMhBa8Sa8Va8VNNanMhna8SaRaRNNacMhcaHclfhHaCclfhCaOclfhOaAczfhAaYcufgYmbkavaic8S2fgeacaeIdbMUdbaeanaeIdlMUdlaeaBaeIdwMUdwaea81aeIdxMUdxaea8YaeIdzMUdzaea80aeIdCMUdCaea8ZaeIdKMUdKaea8XaeId3MUd3aea8UaeIdaMUdaaea8WaeId8KMUd8Kaea8SaeIdyMUdyavaLc8S2fgeacaeIdbMUdbaeanaeIdlMUdlaeaBaeIdwMUdwaea81aeIdxMUdxaea8YaeIdzMUdzaea80aeIdCMUdCaea8ZaeIdKMUdKaea8XaeId3MUd3aea8UaeIdaMUdaaea8WaeId8KMUd8Kaea8SaeIdyMUdyava8Fc8S2fgeacaeIdbMUdbaeanaeIdlMUdlaeaBaeIdwMUdwaea81aeIdxMUdxaea8YaeIdzMUdzaea80aeIdCMUdCaea8ZaeIdKMUdKaea8XaeId3MUd3aea8UaeIdaMUdaaea8WaeId8KMUd8Kaea8SaeIdyMUdyara3cltfhYcbhHa8JhCinaYaHfgeasc;WbfaHfgOIdbaeIdbMUdbaeclfgAaOclfIdbaAIdbMUdbaecwfgAaOcwfIdbaAIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaCcufgCmbkara8LcltfhYcbhHa8JhCinaYaHfgeasc;WbfaHfgOIdbaeIdbMUdbaeclfgAaOclfIdbaAIdbMUdbaecwfgAaOcwfIdbaAIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaCcufgCmbkarawcltfhYcbhHa8JhCinaYaHfgeasc;WbfaHfgOIdbaeIdbMUdbaeclfgAaOclfIdbaAIdbMUdbaecwfgAaOcwfIdbaAIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaCcufgCmbkaKcifgKad6mbkkcbhOxekcehOcbhrkcbh8FdndnamcwGg9cmbJbbbbh8ZcbhJcbhocbhCxekcbhea5cbyd;S1jjbHjjjjbbhCascxfasyd2gHcdtfaCBdbasaHcefBd2dnalTmbaChHinaHaeBdbaHclfhHalaecefge9hmbkkdnaOmbcbhiinabaicdtfhLcbhKinaQaLaKcdtgec:G1jjbfydbcdtfydbcdtfydbhHdnaCaQaLaefydbcdtfydbgOcdtfgAydbgeaOSmbinaAaCaegOcdtfgYydbgeBdbaYhAaOae9hmbkkdnaCaHcdtfgAydbgeaHSmbinaAaCaegHcdtfgYydbgeBdbaYhAaHae9hmbkkdnaOaHSmbaCaOaHaOaH0EcdtfaOaHaOaH6EBdbkaKcefgKci9hmbkaicifgiad6mbkkcbhJdnalTmbcbhYindnaQaYcdtgefydbaY9hmbaYhHdnaCaefgKydbgeaYSmbaKhOinaOaCaegHcdtfgAydbgeBdbaAhOaHae9hmbkkaKaHBdbkaYcefgYal9hmbkcbheaQhOaChHcbhJindndnaeaOydbgA9hmbdnaeaHydbgA9hmbaHaJBdbaJcefhJxdkaHaCaAcdtfydbBdbxekaHaCaAcdtfydbBdbkaOclfhOaHclfhHalaecefge9hmbkkcuaJcltgeaJcjjjjiGEcbyd;S1jjbHjjjjbbhoascxfasyd2gHcdtfaoBdbasaHcefBd2aocbaez:ljjjbhAdnalTmbaChOaahealhYinaecwfIdbh8SaeclfIdbhIaAaOydbcltfgHaeIdbaHIdbMUdbaHclfgKaIaKIdbMUdbaHcwfgKa8SaKIdbMUdbaHcxfgHaHIdbJbbjZMUdbaOclfhOaecxfheaYcufgYmbkkdnaJTmbaAheaJhHinaecxfgOIdbh8SaOcbBdbaeaeIdbJbbbbJbbjZa8S:va8SJbbbb9BEg8SNUdbaeclfgOa8SaOIdbNUdbaecwfgOa8SaOIdbNUdbaeczfheaHcufgHmbkkdnalTmbaChOaahealhYinaAaOydbcltfgHcxfgKaecwfIdbaHcwfIdb:tg8Sa8SNaeIdbaHIdb:tg8Sa8SNaeclfIdbaHclfIdb:tg8Sa8SNMMg8SaKIdbgIaIa8S9DEUdbaOclfhOaecxfheaYcufgYmbkkdnaJmbcbhJJFFuuh8ZxekaAcxfheaAhHaJhOinaHaeIdbUdbaeczfheaHclfhHaOcufgOmbkJFFuuh8ZaAheaJhHinaeIdbg8Sa8Za8Za8S9EEh8ZaeclfheaHcufgHmbkkasydlh9ednalTmba9eclfhea9eydbhAaXhHalhYcbhOincbaeydbgKaA9RaHRbbcpeGEaOfhOaHcefhHaeclfheaKhAaYcufgYmbkaOce4h8Fkcuada8F9RcifgTcx2aTc;v:Q;v:Qe0Ecbyd;S1jjbHjjjjbbhDascxfasyd2gecdtfaDBdbasaecefBd2cuaTcdtaTcFFFFi0Ecbyd;S1jjbHjjjjbbhSascxfasyd2gecdtfaSBdbasaecefBd2a5cbyd;S1jjbHjjjjbbh8Mascxfasyd2gecdtfa8MBdbasaecefBd2alcbyd;S1jjbHjjjjbbh9hascxfasyd2gecdtfa9hBdbasaecefBd2axaxNa8NJbbjZamclGEg83a83N:vhcJbbbbhndnadak9nmbdnaTci6mba8Jclth9iaDcwfh6JbbbbhBJbbbbhninasclfabadalaQz:cjjjbabh8FcbhEcbh5inaba5cdtfh3cbheindnaQa8FaefydbgOcdtgifydbgYaQa3aec:W1jjbfydbcdtfydbgHcdtgwfydbgKSmbaXaHfRbbgLcv2aXaOfRbbgAfc;a1jjbfRbbg8AaAcv2aLfg8Lc;a1jjbfRbbg8KVcFeGTmbdnaKaY9nmba8Lcj1jjbfRbbcFeGmekaAcufhYdnaAaL9hmbaYcFeGce0mbahaifydbaH9hmekdndnaAclSmbaLcl9hmekdnaYcFeGce0mbahaifydbaH9hmdkaLcufcFeGce0mbagawfydbaO9hmekaDaEcx2fgAaHaOa8KcFeGgYEBdlaAaOaHaYEBdbaAaYa8AGcb9hBdwaEcefhEkaeclfgecx9hmbkdna5cifg5ad9pmba8Fcxfh8FaEcifaT9nmekkaETmdcbhiinJbbbbJbbjZaqaQaDaicx2fgAydlgKaAydbgYaAydwgHEgLcdtfydbc8S2fgeIdyg8S:va8SJbbbb9BEaeIdwaaaYaKaHEg8Fcx2fgHIdwgRNaeIdzaHIdbg8PNaeIdaMg8Sa8SMMaRNaeIdlaHIdlg8RNaeIdCaRNaeId3Mg8Sa8SMMa8RNaeIdba8PNaeIdxa8RNaeIdKMg8Sa8SMMa8PNaeId8KMMM:lNh80JbbbbJbbjZaqaQaYcdtfydbc8S2fgeIdyg8S:va8SJbbbb9BEaeIdwaaaKcx2fgHIdwg8VNaeIdzaHIdbg8WNaeIdaMg8Sa8SMMa8VNaeIdlaHIdlg8UNaeIdCa8VNaeId3Mg8Sa8SMMa8UNaeIdba8WNaeIdxa8UNaeIdKMg8Sa8SMMa8WNaeId8KMMM:lNh8YaAcwfh3aAclfhwdna8JTmbavaYc8S2fgOIdwa8VNaOIdza8WNaOIdaMg8Sa8SMMa8VNaOIdla8UNaOIdCa8VNaOId3Mg8Sa8SMMa8UNaOIdba8WNaOIdxa8UNaOIdKMg8Sa8SMMa8WNaOId8KMMMh8SayaKa8J2cdtfhHaraYa8J2cltfheaOIdyh8Xa8JhOinaHIdbgIaIa8XNaecxfIdba8VaecwfIdbNa8WaeIdbNa8UaeclfIdbNMMMgIaIM:tNa8SMh8SaHclfhHaeczfheaOcufgOmbkavaLc8S2fgOIdwaRNaOIdza8PNaOIdaMgIaIMMaRNaOIdla8RNaOIdCaRNaOId3MgIaIMMa8RNaOIdba8PNaOIdxa8RNaOIdKMgIaIMMa8PNaOId8KMMMhIaya8Fa8J2cdtfhHaraLa8J2cltfheaOIdyh8Wa8JhOinaHIdbg8Va8Va8WNaecxfIdbaRaecwfIdbNa8PaeIdbNa8RaeclfIdbNMMMg8Va8VM:tNaIMhIaHclfhHaeczfheaOcufgOmbka80aI:lMh80a8Ya8S:lMh8YkawaKa8Fa8Ya809FgeEBdbaAaYaLaeEBdba3a8Ya80aeEUdbaicefgiaE9hmbkasc;Wbfcbcj;qbz:ljjjb8Aa6heaEhHinasc;WbfaeydbcA4cF8FGgOcFAaOcFA6EcdtfgOaOydbcefBdbaecxfheaHcufgHmbkcbhecbhHinasc;WbfaefgOydbhAaOaHBdbaAaHfhHaeclfgecj;qb9hmbkcbhea6hHinasc;WbfaHydbcA4cF8FGgOcFAaOcFA6EcdtfgOaOydbgOcefBdbaSaOcdtfaeBdbaHcxfhHaEaecefge9hmbkadak9RgOci9Uh9kdnalTmbcbhea8MhHinaHaeBdbaHclfhHalaecefge9hmbkkcbh0a9hcbalz:ljjjbh9maOcO9Uh9na9kce4h9oasydwh9pcbh8KcbhwdninaDaSawcdtfydbcx2fg3Idwg8Sac9Emea8Ka9k9pmeJFFuuhIdna9oaE9pmbaDaSa9ocdtfydbcx2fIdwJbb;aZNhIkdna8SaI9ETmba8San9ETmba8Ka9n0mdkdna9maQa3ydlgicdtg9qfydbgAfg9rRbba9maQa3ydbgLcdtg9sfydbgHfg9tRbbVmbaXaLfRbbh9udna9eaHcdtfgeclfydbgOaeydbgeSmbaOae9RhKa9paecitfheaaaAcx2fg8Lcwfh5a8Lclfh9vaaaHcx2fg8Acwfh9wa8Aclfh9xcbhHceh8Fdnindna8MaeydbcdtfydbgOaASmba8MaeclfydbcdtfydbgYaASmbaOaYSmbaaaYcx2fgYIdbaaaOcx2fgOIdbg8V:tg8Sa9xIdbaOIdlgR:tg8WNa8AIdba8V:tg8UaYIdlaR:tgIN:tg8Pa8Sa9vIdbaR:tg8XNa8LIdba8V:tg80aIN:tgRNaIa9wIdbaOIdwg8R:tg8YNa8WaYIdwa8R:tg8VN:tg8WaIa5Idba8R:tg81Na8Xa8VN:tgINa8Va8UNa8Ya8SN:tg8Ra8Va80Na81a8SN:tg8SNMMa8Pa8PNa8Wa8WNa8Ra8RNMMaRaRNaIaINa8Sa8SNMMN:rJbbj8:N9FmdkaecwfheaHcefgHaK6h8FaKaH9hmbkka8FceGTmba9ocefh9oxeka3cwfhHdndndndna9uc9:fPdebdkaLheina8MaecdtgefaiBdba8EaefydbgeaL9hmbxikkdnagahaha9sfydbaiSEa8Ea9sfydbgLcdtfydbgecu9hmba8Ea9qfydbheka8Ma9sfaiBdbaehika8MaLcdtfaiBdbka9tce86bba9rce86bbaHIdbg8Sanana8S9DEhna0cefh0cecda9uceSEa8Kfh8KkawcefgwaE9hmbkka0TmddnalTmbcbhKcbhiindna8MaicdtgefydbgOaiSmbaQaOcdtfydbh8FdnaiaQaefydb9hg3mbaqa8Fc8S2fgeaqaic8S2fgHIdbaeIdbMUdbaeaHIdlaeIdlMUdlaeaHIdwaeIdwMUdwaeaHIdxaeIdxMUdxaeaHIdzaeIdzMUdzaeaHIdCaeIdCMUdCaeaHIdKaeIdKMUdKaeaHId3aeId3MUd3aeaHIdaaeIdaMUdaaeaHId8KaeId8KMUd8KaeaHIdyaeIdyMUdyka8JTmbavaOc8S2fgeavaic8S2gwfgHIdbaeIdbMUdbaeaHIdlaeIdlMUdlaeaHIdwaeIdwMUdwaeaHIdxaeIdxMUdxaeaHIdzaeIdzMUdzaeaHIdCaeIdCMUdCaeaHIdKaeIdKMUdKaeaHId3aeId3MUd3aeaHIdaaeIdaMUdaaeaHId8KaeId8KMUd8KaeaHIdyaeIdyMUdya9iaO2hLarhHa8JhAinaHaLfgeaHaKfgOIdbaeIdbMUdbaeclfgYaOclfIdbaYIdbMUdbaecwfgYaOcwfIdbaYIdbMUdbaecxfgeaOcxfIdbaeIdbMUdbaHczfhHaAcufgAmbka3mbJbbbbJbbjZaqawfgeIdyg8S:va8SJbbbb9BEaeIdwaaa8Fcx2fgHIdwg8SNaeIdzaHIdbgINaeIdaMg8Va8VMMa8SNaeIdlaHIdlg8VNaeIdCa8SNaeId3Mg8Sa8SMMa8VNaeIdbaINaeIdxa8VNaeIdKMg8Sa8SMMaINaeId8KMMM:lNg8SaBaBa8S9DEhBkaKa9ifhKaicefgial9hmbkcbhHahheindnaeydbgOcuSmbdnaHa8MaOcdtgAfydbgO9hmbcuhOahaAfydbgAcuSmba8MaAcdtfydbhOkaeaOBdbkaeclfhealaHcefgH9hmbkcbhHagheindnaeydbgOcuSmbdnaHa8MaOcdtgAfydbgO9hmbcuhOagaAfydbgAcuSmba8MaAcdtfydbhOkaeaOBdbkaeclfhealaHcefgH9hmbkkaBana8JEhBcbhYabhecbhKindna8MaeydbcdtfydbgHa8MaeclfydbcdtfydbgOSmbaHa8MaecwfydbcdtfydbgASmbaOaASmbabaYcdtfgLaHBdbaLcwfaABdbaLclfaOBdbaYcifhYkaecxfheaKcifgKad6mbkdndna9cTmbaYak9nmba8ZaB9FTmbcbhdabhecbhHindnaoaCaeydbgOcdtfydbcdtfIdbaB9ETmbabadcdtfgAaOBdbaAclfaeclfydbBdbaAcwfaecwfydbBdbadcifhdkaecxfheaHcifgHaY6mbkJFFuuh8ZaJTmeaoheaJhHJFFuuh8SinaeIdbgIa8Sa8SaI9EEg8Va8SaIaB9EgOEh8Sa8Va8ZaOEh8ZaeclfheaHcufgHmbxdkkaYhdkadak0mbxdkkasclfabadalaQz:cjjjbkdndnadak0mbadhOxekdna9cmbadhOxekdna8Zac9FmbadhOxekina8ZJbb;aZNg8Saca8Sac9DEh8VJbbbbh8SdnaJTmbaoheaJhHinaeIdbgIa8SaIa8V9FEa8SaIa8S9EEh8SaeclfheaHcufgHmbkkcbhOabhecbhHindnaoaCaeydbgAcdtfydbcdtfIdba8V9ETmbabaOcdtfgYaABdbaYclfaeclfydbBdbaYcwfaecwfydbBdbaOcifhOkaecxfheaHcifgHad6mbkJFFuuh8ZdnaJTmbaoheaJhHJFFuuhIinaeIdbgRaIaIaR9EEg8PaIaRa8V9EgAEhIa8Pa8ZaAEh8ZaeclfheaHcufgHmbkkdnaOad9hmbadhOxdka8Sanana8S9DEhnaOak9nmeaOhda8Zac9FmbkkdnamcjjjjlGTmbazmbaOTmbcbhQabheinaXaeydbgAfRbbc3thKaecwfgLydbhHdndnahaAcdtg8FfydbaeclfgiydbgCSmbcbhYagaCcdtfydbaA9hmekcjjjj94hYkaeaKaYVaAVBdbaXaCfRbbc3thKdndnahaCcdtfydbaHSmbcbhYagaHcdtfydbaC9hmekcjjjj94hYkaiaKaYVaCVBdbaXaHfRbbc3thYdndnahaHcdtfydbaASmbcbhCaga8FfydbaH9hmekcjjjj94hCkaLaYaCVaHVBdbaecxfheaQcifgQaO6mbkkdnazTmbaOTmbaOheinabazabydbcdtfydbBdbabclfhbaecufgembkkdnaPTmbaPa83an:rNUdbkasyd2gecdtascxffc98fhHdninaeTmeaHydbcbyd;O1jjbH:bjjjbbaHc98fhHaecufhexbkkasc;W;qbf8KjjjjbaOk;Yieouabydlhvabydbclfcbaicdtz:ljjjbhoadci9UhrdnadTmbdnalTmbaehwadhDinaoalawydbcdtfydbcdtfgqaqydbcefBdbawclfhwaDcufgDmbxdkkaehwadhDinaoawydbcdtfgqaqydbcefBdbawclfhwaDcufgDmbkkdnaiTmbcbhDaohwinawydbhqawaDBdbawclfhwaqaDfhDaicufgimbkkdnadci6mbinaecwfydbhwaeclfydbhDaeydbhidnalTmbalawcdtfydbhwalaDcdtfydbhDalaicdtfydbhikavaoaicdtfgqydbcitfaDBdbavaqydbcitfawBdlaqaqydbcefBdbavaoaDcdtfgqydbcitfawBdbavaqydbcitfaiBdlaqaqydbcefBdbavaoawcdtfgwydbcitfaiBdbavawydbcitfaDBdlawawydbcefBdbaecxfhearcufgrmbkkabydbcbBdbk;Podvuv998Jjjjjbca9RgvcFFF;7rBd3av9cFFF;7;3FF:;Fb83dCavcFFF97Bdzav9cFFF;7FFF:;u83dwdnadTmbaicd4hodnabmbdnalTmbcbhrinaealarcdtfydbao2cdtfhwcbhiinavcCfaifgDawaifIdbgqaDIdbgkakaq9EEUdbavcwfaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkarcefgrad9hmbxikkaocdthrcbhwincbhiinavcCfaifgDaeaifIdbgqaDIdbgkakaq9EEUdbavcwfaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkaearfheawcefgwad9hmbxdkkdnalTmbcbhrinabarcx2fgiaealarcdtfydbao2cdtfgwIdbUdbaiawIdlUdlaiawIdwUdwcbhiinavcCfaifgDawaifIdbgqaDIdbgkakaq9EEUdbavcwfaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkarcefgrad9hmbxdkkaocdthlcbhraehwinabarcx2fgiaearao2cdtfgDIdbUdbaiaDIdlUdlaiaDIdwUdwcbhiinavcCfaifgDawaifIdbgqaDIdbgkakaq9EEUdbavcwfaifgDaqaDIdbgkakaq9DEUdbaiclfgicx9hmbkawalfhwarcefgrad9hmbkkJbbbbavIdwavIdCgk:tgqaqJbbbb9DEgqavIdxavIdKgx:tgmamaq9DEgqavIdzavId3gm:tgPaPaq9DEhPdnabTmbadTmbJbbbbJbbjZaP:vaPJbbbb9BEhqinabaqabIdbak:tNUdbabclfgvaqavIdbax:tNUdbabcwfgvaqavIdbam:tNUdbabcxfhbadcufgdmbkkaPk8MbabaeadaialavcbcbcbcbcbaoarawaDz:bjjjbk8MbabaeadaialavaoarawaDaqakaxamaPz:bjjjbk:nCoDud99rue99lul998Jjjjjbc;Wb9Rgw8KjjjjbdndnarmbcbhDxekawcxfcbc;Kbz:ljjjb8Aawcuadcx2adc;v:Q;v:Qe0Ecbyd;S1jjbHjjjjbbgqBdxawceBd2aqaeadaicbz:djjjb8AawcuadcdtadcFFFFi0Egkcbyd;S1jjbHjjjjbbgxBdzawcdBd2adcd4adfhmceheinaegicetheaiam6mbkcbhPawcuaicdtgsaicFFFFi0Ecbyd;S1jjbHjjjjbbgzBdCawciBd2dndnar:ZgH:rJbbbZMgO:lJbbb9p9DTmbaO:Ohexekcjjjj94hekaicufhAc:bwhmcbhCadhXcbhQinaChLaeamgKcufaeaK9iEaPgDcefaeaD9kEhYdndnadTmbaYcuf:YhOaqhiaxheadhmindndnaiIdbaONJbbbZMg8A:lJbbb9p9DTmba8A:OhCxekcjjjj94hCkaCcCthCdndnaiclfIdbaONJbbbZMg8A:lJbbb9p9DTmba8A:OhExekcjjjj94hEkaEcqtaCVhCdndnaicwfIdbaONJbbbZMg8A:lJbbb9p9DTmba8A:OhExekcjjjj94hEkaeaCaEVBdbaicxfhiaeclfheamcufgmmbkazcFeasz:ljjjbh3cbh5cbh8Eindna3axa8EcdtfydbgCcm4aC7c:v;t;h;Ev2gics4ai7aAGgmcdtfgEydbgecuSmbaeaCSmbcehiina3amaifaAGgmcdtfgEydbgecuSmeaicefhiaeaC9hmbkkaEaCBdba5aecuSfh5a8Ecefg8Ead9hmbxdkkazcFeasz:ljjjb8Acbh5kaDaYa5ar0giEhPaLa5aiEhCdna5arSmbaYaKaiEgmaP9Rcd9imbdndnaQcl0mbdnaX:ZgOaL:Zg8A:taY:Yg8FaD:Y:tgaa8FaK:Y:tgha5:ZggaH:tNNNaOaH:tahNa8Aag:tNa8AaH:taaNagaO:tNM:va8FMJbbbZMgO:lJbbb9p9DTmbaO:Ohexdkcjjjj94hexekaPamfcd9Theka5aXaiEhXaQcefgQcs9hmekkdndnaCmbcihicbhDxekcbhiawakcbyd;S1jjbHjjjjbbg8EBdKawclBd2aPcuf:Yh8AdndnadTmbaqhiaxheadhmindndnaiIdba8ANJbbbZMgO:lJbbb9p9DTmbaO:OhCxekcjjjj94hCkaCcCthCdndnaiclfIdba8ANJbbbZMgO:lJbbb9p9DTmbaO:OhExekcjjjj94hEkaEcqtaCVhCdndnaicwfIdba8ANJbbbZMgO:lJbbb9p9DTmbaO:OhExekcjjjj94hEkaeaCaEVBdbaicxfhiaeclfheamcufgmmbkazcFeasz:ljjjbh3cbhDcbh5inaxa5cdtgYfydbgCcm4aC7c:v;t;h;Ev2gics4ai7hecbhidndnina3aeaAGgmcdtfgEydbgecuSmednaxaecdtgEfydbaCSmbaicefgiamfheaiaA9nmekka8EaEfydbhixekaEa5BdbaDhiaDcefhDka8EaYfaiBdba5cefg5ad9hmbkcuaDc32giaDc;j:KM;jb0EhexekazcFeasz:ljjjb8AcbhDcbhekawaecbyd;S1jjbHjjjjbbgeBd3awcvBd2aecbaiz:ljjjbhEavcd4hxdnadTmbdnalTmbaxcdth3a8EhCalheaqhmadhAinaEaCydbc32fgiamIdbaiIdbMUdbaiamclfIdbaiIdlMUdlaiamcwfIdbaiIdwMUdwaiaeIdbaiIdxMUdxaiaeclfIdbaiIdzMUdzaiaecwfIdbaiIdCMUdCaiaiIdKJbbjZMUdKaCclfhCaea3fheamcxfhmaAcufgAmbxdkka8EhmaqheadhCinaEamydbc32fgiaeIdbaiIdbMUdbaiaeclfIdbaiIdlMUdlaiaecwfIdbaiIdwMUdwaiaiIdxJbbbbMUdxaiaiIdzJbbbbMUdzaiaiIdCJbbbbMUdCaiaiIdKJbbjZMUdKamclfhmaecxfheaCcufgCmbkkdnaDTmbaEhiaDheinaiaiIdbJbbbbJbbjZaicKfIdbgO:vaOJbbbb9BEgONUdbaiclfgmaOamIdbNUdbaicwfgmaOamIdbNUdbaicxfgmaOamIdbNUdbaiczfgmaOamIdbNUdbaicCfgmaOamIdbNUdbaic3fhiaecufgembkkcbhCawcuaDcdtgYaDcFFFFi0Egicbyd;S1jjbHjjjjbbgeBdaawcoBd2awaicbyd;S1jjbHjjjjbbg3Bd8KaecFeaYz:ljjjbh5dnadTmbJbbjZJbbjZa8A:vaPceSEaoNgOaONh8Aaxcdthxalheina8Aaec;C1jjbalEgmIdwaEa8EydbgAc32fgiIdC:tgOaONamIdbaiIdx:tgOaONamIdlaiIdz:tgOaONMMNaqcwfIdbaiIdw:tgOaONaqIdbaiIdb:tgOaONaqclfIdbaiIdl:tgOaONMMMhOdndna5aAcdtgifgmydbcuSmba3aifIdbaO9ETmekamaCBdba3aifaOUdbka8Eclfh8EaeaxfheaqcxfhqadaCcefgC9hmbkkaba5aYz:kjjjb8AcrhikaicdthiinaiTmeaic98fgiawcxffydbcbyd;O1jjbH:bjjjbbxbkkawc;Wbf8KjjjjbaDk:Odieui99iu8Jjjjjbca9RgicFFF;7rBd3ai9cFFF;7;3FF:;Fb83dCaicFFF97Bdzai9cFFF;7FFF:;u83dwdndnaembJbbjFhlJbbjFhvJbbjFhoxekadcd4cdthrcbhwincbhdinaicCfadfgDabadfIdbglaDIdbgvaval9EEUdbaicwfadfgDalaDIdbgvaval9DEUdbadclfgdcx9hmbkabarfhbawcefgwae9hmbkaiIdzaiId3:thoaiIdxaiIdK:thvaiIdwaiIdC:thlkJbbbbalalJbbbb9DEglavaval9DEglaoaoal9DEk9DeeuabcFeaicdtz:ljjjbhlcbhbdnadTmbindnalaeydbcdtfgiydbcu9hmbaiabBdbabcefhbkaeclfheadcufgdmbkkabk9teiucbcbyd;W1jjbgeabcifc98GfgbBd;W1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd;W1jjbgeabcrfc94GfgbBd;W1jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd;W1jjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd;W1jjbfgdBd;W1jjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akk6eiucbhidnadTmbdninabRbbglaeRbbgv9hmeaecefheabcefhbadcufgdmbxdkkalav9Rhikaikk:bedbcjwk9Oeeebeebebbeeebebbbbbebebbbbbbbbbebbbdbbbbbbbebbbebbbdbbbbbbbbbbbeeeeebebbebbebebbbeebbbbbbbbbbbbbbbbbbbbbc;OwkxebbbdbbbjNbb'; // embed! wasm\n\n\tvar wasmpack = new Uint8Array([\n\t\t32, 0, 65, 2, 1, 106, 34, 33, 3, 128, 11, 4, 13, 64, 6, 253, 10, 7, 15, 116, 127, 5, 8, 12, 40, 16, 19, 54, 20, 9, 27, 255, 113, 17, 42, 67,\n\t\t24, 23, 146, 148, 18, 14, 22, 45, 70, 69, 56, 114, 101, 21, 25, 63, 75, 136, 108, 28, 118, 29, 73, 115,\n\t]);\n\n\tif (typeof WebAssembly !== 'object') {\n\t\treturn {\n\t\t\tsupported: false,\n\t\t};\n\t}\n\n\tvar instance;\n\n\tvar ready = WebAssembly.instantiate(unpack(wasm), {}).then(function (result) {\n\t\tinstance = result.instance;\n\t\tinstance.exports.__wasm_call_ctors();\n\t});\n\n\tfunction unpack(data) {\n\t\tvar result = new Uint8Array(data.length);\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tvar ch = data.charCodeAt(i);\n\t\t\tresult[i] = ch > 96 ? ch - 97 : ch > 64 ? ch - 39 : ch + 4;\n\t\t}\n\t\tvar write = 0;\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tresult[write++] = result[i] < 60 ? wasmpack[result[i]] : (result[i] - 60) * 64 + result[++i];\n\t\t}\n\t\treturn result.buffer.slice(0, write);\n\t}\n\n\tfunction assert(cond) {\n\t\tif (!cond) {\n\t\t\tthrow new Error('Assertion failed');\n\t\t}\n\t}\n\n\tfunction bytes(view) {\n\t\treturn new Uint8Array(view.buffer, view.byteOffset, view.byteLength);\n\t}\n\n\tfunction reorder(fun, indices, vertices) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar ip = sbrk(indices.length * 4);\n\t\tvar rp = sbrk(vertices * 4);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\tvar indices8 = bytes(indices);\n\t\theap.set(indices8, ip);\n\t\tvar unique = fun(rp, ip, indices.length, vertices);\n\t\t// heap may have grown\n\t\theap = new Uint8Array(instance.exports.memory.buffer);\n\t\tvar remap = new Uint32Array(vertices);\n\t\tnew Uint8Array(remap.buffer).set(heap.subarray(rp, rp + vertices * 4));\n\t\tindices8.set(heap.subarray(ip, ip + indices.length * 4));\n\t\tsbrk(ip - sbrk(0));\n\n\t\tfor (var i = 0; i < indices.length; ++i) indices[i] = remap[indices[i]];\n\n\t\treturn [remap, unique];\n\t}\n\n\tfunction maxindex(source) {\n\t\tvar result = 0;\n\t\tfor (var i = 0; i < source.length; ++i) {\n\t\t\tvar index = source[i];\n\t\t\tresult = result < index ? index : result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction simplify(fun, indices, index_count, vertex_positions, vertex_count, vertex_positions_stride, target_index_count, target_error, options) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar te = sbrk(4);\n\t\tvar ti = sbrk(index_count * 4);\n\t\tvar sp = sbrk(vertex_count * vertex_positions_stride);\n\t\tvar si = sbrk(index_count * 4);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(vertex_positions), sp);\n\t\theap.set(bytes(indices), si);\n\t\tvar result = fun(ti, si, index_count, sp, vertex_count, vertex_positions_stride, target_index_count, target_error, options, te);\n\t\t// heap may have grown\n\t\theap = new Uint8Array(instance.exports.memory.buffer);\n\t\tvar target = new Uint32Array(result);\n\t\tbytes(target).set(heap.subarray(ti, ti + result * 4));\n\t\tvar error = new Float32Array(1);\n\t\tbytes(error).set(heap.subarray(te, te + 4));\n\t\tsbrk(te - sbrk(0));\n\t\treturn [target, error[0]];\n\t}\n\n\tfunction simplifyAttr(\n\t\tfun,\n\t\tindices,\n\t\tindex_count,\n\t\tvertex_positions,\n\t\tvertex_count,\n\t\tvertex_positions_stride,\n\t\tvertex_attributes,\n\t\tvertex_attributes_stride,\n\t\tattribute_weights,\n\t\tvertex_lock,\n\t\ttarget_index_count,\n\t\ttarget_error,\n\t\toptions\n\t) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar te = sbrk(4);\n\t\tvar ti = sbrk(index_count * 4);\n\t\tvar sp = sbrk(vertex_count * vertex_positions_stride);\n\t\tvar sa = sbrk(vertex_count * vertex_attributes_stride);\n\t\tvar sw = sbrk(attribute_weights.length * 4);\n\t\tvar si = sbrk(index_count * 4);\n\t\tvar vl = vertex_lock ? sbrk(vertex_count) : 0;\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(vertex_positions), sp);\n\t\theap.set(bytes(vertex_attributes), sa);\n\t\theap.set(bytes(attribute_weights), sw);\n\t\theap.set(bytes(indices), si);\n\t\tif (vertex_lock) {\n\t\t\theap.set(bytes(vertex_lock), vl);\n\t\t}\n\t\tvar result = fun(\n\t\t\tti,\n\t\t\tsi,\n\t\t\tindex_count,\n\t\t\tsp,\n\t\t\tvertex_count,\n\t\t\tvertex_positions_stride,\n\t\t\tsa,\n\t\t\tvertex_attributes_stride,\n\t\t\tsw,\n\t\t\tattribute_weights.length,\n\t\t\tvl,\n\t\t\ttarget_index_count,\n\t\t\ttarget_error,\n\t\t\toptions,\n\t\t\tte\n\t\t);\n\t\t// heap may have grown\n\t\theap = new Uint8Array(instance.exports.memory.buffer);\n\t\tvar target = new Uint32Array(result);\n\t\tbytes(target).set(heap.subarray(ti, ti + result * 4));\n\t\tvar error = new Float32Array(1);\n\t\tbytes(error).set(heap.subarray(te, te + 4));\n\t\tsbrk(te - sbrk(0));\n\t\treturn [target, error[0]];\n\t}\n\n\tfunction simplifyScale(fun, vertex_positions, vertex_count, vertex_positions_stride) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar sp = sbrk(vertex_count * vertex_positions_stride);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(vertex_positions), sp);\n\t\tvar result = fun(sp, vertex_count, vertex_positions_stride);\n\t\tsbrk(sp - sbrk(0));\n\t\treturn result;\n\t}\n\n\tfunction simplifyPoints(\n\t\tfun,\n\t\tvertex_positions,\n\t\tvertex_count,\n\t\tvertex_positions_stride,\n\t\tvertex_colors,\n\t\tvertex_colors_stride,\n\t\tcolor_weight,\n\t\ttarget_vertex_count\n\t) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar ti = sbrk(target_vertex_count * 4);\n\t\tvar sp = sbrk(vertex_count * vertex_positions_stride);\n\t\tvar sc = sbrk(vertex_count * vertex_colors_stride);\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(vertex_positions), sp);\n\t\tif (vertex_colors) {\n\t\t\theap.set(bytes(vertex_colors), sc);\n\t\t}\n\t\tvar result = fun(ti, sp, vertex_count, vertex_positions_stride, sc, vertex_colors_stride, color_weight, target_vertex_count);\n\t\t// heap may have grown\n\t\theap = new Uint8Array(instance.exports.memory.buffer);\n\t\tvar target = new Uint32Array(result);\n\t\tbytes(target).set(heap.subarray(ti, ti + result * 4));\n\t\tsbrk(ti - sbrk(0));\n\t\treturn target;\n\t}\n\n\tvar simplifyOptions = {\n\t\tLockBorder: 1,\n\t\tSparse: 2,\n\t\tErrorAbsolute: 4,\n\t\tPrune: 8,\n\t\t_InternalDebug: 1 << 30, // internal, don't use!\n\t};\n\n\treturn {\n\t\tready: ready,\n\t\tsupported: true,\n\n\t\t// set this to true to be able to use simplifyPoints and simplifyWithAttributes\n\t\t// note that these functions are experimental and may change interface/behavior in a way that will require revising calling code\n\t\tuseExperimentalFeatures: false,\n\n\t\tcompactMesh: function (indices) {\n\t\t\tassert(\n\t\t\t\tindices instanceof Uint32Array || indices instanceof Int32Array || indices instanceof Uint16Array || indices instanceof Int16Array\n\t\t\t);\n\t\t\tassert(indices.length % 3 == 0);\n\n\t\t\tvar indices32 = indices.BYTES_PER_ELEMENT == 4 ? indices : new Uint32Array(indices);\n\t\t\treturn reorder(instance.exports.meshopt_optimizeVertexFetchRemap, indices32, maxindex(indices) + 1);\n\t\t},\n\n\t\tsimplify: function (indices, vertex_positions, vertex_positions_stride, target_index_count, target_error, flags) {\n\t\t\tassert(\n\t\t\t\tindices instanceof Uint32Array || indices instanceof Int32Array || indices instanceof Uint16Array || indices instanceof Int16Array\n\t\t\t);\n\t\t\tassert(indices.length % 3 == 0);\n\t\t\tassert(vertex_positions instanceof Float32Array);\n\t\t\tassert(vertex_positions.length % vertex_positions_stride == 0);\n\t\t\tassert(vertex_positions_stride >= 3);\n\t\t\tassert(target_index_count >= 0 && target_index_count <= indices.length);\n\t\t\tassert(target_index_count % 3 == 0);\n\t\t\tassert(target_error >= 0);\n\n\t\t\tvar options = 0;\n\t\t\tfor (var i = 0; i < (flags ? flags.length : 0); ++i) {\n\t\t\t\tassert(flags[i] in simplifyOptions);\n\t\t\t\tassert(this.useExperimentalFeatures || flags[i] != 'Prune'); // set useExperimentalFeatures to use experimental flags like Prune\n\t\t\t\toptions |= simplifyOptions[flags[i]];\n\t\t\t}\n\n\t\t\tvar indices32 = indices.BYTES_PER_ELEMENT == 4 ? indices : new Uint32Array(indices);\n\t\t\tvar result = simplify(\n\t\t\t\tinstance.exports.meshopt_simplify,\n\t\t\t\tindices32,\n\t\t\t\tindices.length,\n\t\t\t\tvertex_positions,\n\t\t\t\tvertex_positions.length / vertex_positions_stride,\n\t\t\t\tvertex_positions_stride * 4,\n\t\t\t\ttarget_index_count,\n\t\t\t\ttarget_error,\n\t\t\t\toptions\n\t\t\t);\n\t\t\tresult[0] = indices instanceof Uint32Array ? result[0] : new indices.constructor(result[0]);\n\n\t\t\treturn result;\n\t\t},\n\n\t\tsimplifyWithAttributes: function (\n\t\t\tindices,\n\t\t\tvertex_positions,\n\t\t\tvertex_positions_stride,\n\t\t\tvertex_attributes,\n\t\t\tvertex_attributes_stride,\n\t\t\tattribute_weights,\n\t\t\tvertex_lock,\n\t\t\ttarget_index_count,\n\t\t\ttarget_error,\n\t\t\tflags\n\t\t) {\n\t\t\tassert(this.useExperimentalFeatures); // set useExperimentalFeatures to use this; note that this function is experimental and may change interface in a way that will require revising calling code\n\t\t\tassert(\n\t\t\t\tindices instanceof Uint32Array || indices instanceof Int32Array || indices instanceof Uint16Array || indices instanceof Int16Array\n\t\t\t);\n\t\t\tassert(indices.length % 3 == 0);\n\t\t\tassert(vertex_positions instanceof Float32Array);\n\t\t\tassert(vertex_positions.length % vertex_positions_stride == 0);\n\t\t\tassert(vertex_positions_stride >= 3);\n\t\t\tassert(vertex_attributes instanceof Float32Array);\n\t\t\tassert(vertex_attributes.length % vertex_attributes_stride == 0);\n\t\t\tassert(vertex_attributes_stride >= 0);\n\t\t\tassert(vertex_lock == null || vertex_lock instanceof Uint8Array);\n\t\t\tassert(vertex_lock == null || vertex_lock.length == vertex_positions.length / vertex_positions_stride);\n\t\t\tassert(target_index_count >= 0 && target_index_count <= indices.length);\n\t\t\tassert(target_index_count % 3 == 0);\n\t\t\tassert(target_error >= 0);\n\t\t\tassert(Array.isArray(attribute_weights));\n\t\t\tassert(vertex_attributes_stride >= attribute_weights.length);\n\t\t\tassert(attribute_weights.length <= 32);\n\t\t\tfor (var i = 0; i < attribute_weights.length; ++i) {\n\t\t\t\tassert(attribute_weights[i] >= 0);\n\t\t\t}\n\n\t\t\tvar options = 0;\n\t\t\tfor (var i = 0; i < (flags ? flags.length : 0); ++i) {\n\t\t\t\tassert(flags[i] in simplifyOptions);\n\t\t\t\toptions |= simplifyOptions[flags[i]];\n\t\t\t}\n\n\t\t\tvar indices32 = indices.BYTES_PER_ELEMENT == 4 ? indices : new Uint32Array(indices);\n\t\t\tvar result = simplifyAttr(\n\t\t\t\tinstance.exports.meshopt_simplifyWithAttributes,\n\t\t\t\tindices32,\n\t\t\t\tindices.length,\n\t\t\t\tvertex_positions,\n\t\t\t\tvertex_positions.length / vertex_positions_stride,\n\t\t\t\tvertex_positions_stride * 4,\n\t\t\t\tvertex_attributes,\n\t\t\t\tvertex_attributes_stride * 4,\n\t\t\t\tnew Float32Array(attribute_weights),\n\t\t\t\tvertex_lock ? new Uint8Array(vertex_lock) : null,\n\t\t\t\ttarget_index_count,\n\t\t\t\ttarget_error,\n\t\t\t\toptions\n\t\t\t);\n\t\t\tresult[0] = indices instanceof Uint32Array ? result[0] : new indices.constructor(result[0]);\n\n\t\t\treturn result;\n\t\t},\n\n\t\tgetScale: function (vertex_positions, vertex_positions_stride) {\n\t\t\tassert(vertex_positions instanceof Float32Array);\n\t\t\tassert(vertex_positions.length % vertex_positions_stride == 0);\n\t\t\tassert(vertex_positions_stride >= 3);\n\t\t\treturn simplifyScale(\n\t\t\t\tinstance.exports.meshopt_simplifyScale,\n\t\t\t\tvertex_positions,\n\t\t\t\tvertex_positions.length / vertex_positions_stride,\n\t\t\t\tvertex_positions_stride * 4\n\t\t\t);\n\t\t},\n\n\t\tsimplifyPoints: function (vertex_positions, vertex_positions_stride, target_vertex_count, vertex_colors, vertex_colors_stride, color_weight) {\n\t\t\tassert(this.useExperimentalFeatures); // set useExperimentalFeatures to use this; note that this function is experimental and may change interface in a way that will require revising calling code\n\t\t\tassert(vertex_positions instanceof Float32Array);\n\t\t\tassert(vertex_positions.length % vertex_positions_stride == 0);\n\t\t\tassert(vertex_positions_stride >= 3);\n\t\t\tassert(target_vertex_count >= 0 && target_vertex_count <= vertex_positions.length / vertex_positions_stride);\n\t\t\tif (vertex_colors) {\n\t\t\t\tassert(vertex_colors instanceof Float32Array);\n\t\t\t\tassert(vertex_colors.length % vertex_colors_stride == 0);\n\t\t\t\tassert(vertex_colors_stride >= 3);\n\t\t\t\tassert(vertex_positions.length / vertex_positions_stride == vertex_colors.length / vertex_colors_stride);\n\t\t\t\treturn simplifyPoints(\n\t\t\t\t\tinstance.exports.meshopt_simplifyPoints,\n\t\t\t\t\tvertex_positions,\n\t\t\t\t\tvertex_positions.length / vertex_positions_stride,\n\t\t\t\t\tvertex_positions_stride * 4,\n\t\t\t\t\tvertex_colors,\n\t\t\t\t\tvertex_colors_stride * 4,\n\t\t\t\t\tcolor_weight,\n\t\t\t\t\ttarget_vertex_count\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn simplifyPoints(\n\t\t\t\t\tinstance.exports.meshopt_simplifyPoints,\n\t\t\t\t\tvertex_positions,\n\t\t\t\t\tvertex_positions.length / vertex_positions_stride,\n\t\t\t\t\tvertex_positions_stride * 4,\n\t\t\t\t\tundefined,\n\t\t\t\t\t0,\n\t\t\t\t\t0,\n\t\t\t\t\ttarget_vertex_count\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t};\n})();\n\nexport { MeshoptSimplifier };\n","// This file is part of meshoptimizer library and is distributed under the terms of MIT License.\n// Copyright (C) 2016-2024, by Arseny Kapoulkine (arseny.kapoulkine@gmail.com)\nvar MeshoptClusterizer = (function () {\n\t// Built with clang version 18.1.2\n\t// Built from meshoptimizer 0.22\n\tvar wasm =\n\t\t'b9H79Tebbbefx9Geueu9Geub9Gbb9Giuuueu9Gkuuuuuuuuuu99eu9Gvuuuuueu9Gkuuuuuuuuu9999eu9Gruuuuuuub9Gkuuuuuuuuuuueu9Gouuuuuub9Giuuub9GluuuubiOHdilvorwDqrkbiibeilve9Weiiviebeoweuec:q:Odkr:Yewo9TW9T9VV95dbH9F9F939H79T9F9J9H229F9Jt9VV7bb8A9TW79O9V9Wt9F9I919P29K9nW79O2Wt79c9V919U9KbeX9TW79O9V9Wt9F9I919P29K9nW79O2Wt7bd39TW79O9V9Wt9F9J9V9T9W91tWJ2917tWV9c9V919U9K7br39TW79O9V9Wt9F9J9V9T9W91tW9nW79O2Wt9c9V919U9K7bDL9TW79O9V9Wt9F9V9Wt9P9T9P96W9nW79O2Wtbql79IV9RbkDwebcekdsPq;L9kHdbkIbabaec9:fgefcufae9Ugeabci9Uadfcufad9Ugbaeab0Ek:oAlPue99eux998Jjjjjbc:We9Rgk8Kjjjjbakc;mbfcbc;Kbz:njjjb8AakcuaocdtgxaocFFFFi0Egmcbyd:e1jjbHjjjjbbgPBd9makceBd:SeakaPBdnakamcbyd:e1jjbHjjjjbbgsBd9qakcdBd:SeakasBd9eakcualcdtalcFFFFi0Ecbyd:e1jjbHjjjjbbgzBd9uakazBd9iakciBd:SeaPcbaxz:njjjbhHalci9UhOdnalTmbaihPalhAinaHaPydbcdtfgCaCydbcefBdbaPclfhPaAcufgAmbkkdnaoTmbcbhPashAaHhCaohXinaAaPBdbaAclfhAaCydbaPfhPaCclfhCaXcufgXmbkkdnalci6mbcbhPaihAinaAcwfydbhCaAclfydbhXasaAydbcdtfgQaQydbgQcefBdbazaQcdtfaPBdbasaXcdtfgXaXydbgXcefBdbazaXcdtfaPBdbasaCcdtfgCaCydbgCcefBdbazaCcdtfaPBdbaAcxfhAaOaPcefgP9hmbkkdnaoTmbaHhAashPaohCinaPaPydbaAydb9RBdbaAclfhAaPclfhPaCcufgCmbkkakamcbyd:e1jjbHjjjjbbgPBd9yakclBd:SeaPaHaxz:mjjjbhmakaOcbyd:e1jjbHjjjjbbgPBd9CakcvBd:SeaPcbaOz:njjjbhLakcuaOcK2alcjjjjd0Ecbyd:e1jjbHjjjjbbgKBd9GakcoBd:SeJbbbbhYdnalci6g8Ambarcd4hxaihAaKhPaOhrJbbbbhEinavaAclfydbax2cdtfgCIdlh3avaAydbax2cdtfgXIdlhYavaAcwfydbax2cdtfgQIdlh5aCIdwh8EaXIdwh8FaQIdwhaaPaCIdbghaXIdbggMaQIdbg8JMJbbnn:vUdbaPclfaXIdlaCIdlMaQIdlMJbbnn:vUdbaQIdwh8KaCIdwh8LaXIdwh8MaPcxfa3aY:tg3aaa8F:tgaNa5aY:tg5a8Ea8F:tg8EN:tgYJbbbbJbbjZahag:tgha5Na8Jag:tgga3N:tg8Fa8FNaYaYNa8EagNaaahN:tgYaYNMM:rgg:vagJbbbb9BEg3NUdbaPczfaYa3NUdbaPcCfa8Fa3NUdbaPcwfa8Ka8Ma8LMMJbbnn:vUdbaEagMhEaAcxfhAaPcKfhParcufgrmbkaEaO:Z:vJbbbZNhYkakcuaOcdtalcFFFF970Ecbyd:e1jjbHjjjjbbgCBd9KakcrBd:SeaYaD:ZN:rhYdna8AmbcbhPaChAinaAaPBdbaAclfhAaOaPcefgP9hmbkkaYJbbbZNh8MakcuaOcltalcFFFFd0Ecbyd:e1jjbHjjjjbbg8ABd9OakcwBd:Secba8AaKaCaOz:djjjb8Aakaocbyd:e1jjbHjjjjbbgPBd2aPcFeaoz:njjjbhrakc8Wfcwf9cb83ibak9cb83i8WcbhPJbbbbhEJbbbbh5Jbbbbh8EJbbbbhYJbbbbh8FJbbbbhgcbhlinJbbbbh3dnaPTmbJbbjZaP:Z:vh3kaka8Ea3NgaUdaaka5a3NghUd3akaEa3Ng8JUdKJbbbbh3dnagagNaYaYNa8Fa8FNMMg8KJbbbb9BmbJbbjZa8K:r:vh3kakaga3NUd8Saka8Fa3NUdyakaYa3NUd8Kdndndnakyd8WgQakydUgAakcKfaeaiakc;abfaKamara8Maqz:ejjjbgCcuSmbdnaPaD9pmbaAaraiaCcx2fgXydbfRbbcFeSfaraXclfydbfRbbcFeSfaraXcwfydbfRbbcFeSfaw9nmdkaQaAcbaeaiakc;abfaKamara8MJbbbbz:ejjjbgCcu9hmekakaaUdCakahUdzaka8JUdxakcuBdwakcFFF;7rBdla8AcbaKaLakcxfakcwfakclfz:fjjjbakydwgCcuSmekdnakc8WfaiaCcx2fgOydbgPaOclfydbgAaOcwfydbgXarabaeadalawaDz:gjjjbTmbalcefhlJbbbbhEJbbbbh5Jbbbbh8EJbbbbhYJbbbbh8FJbbbbhgkamaPcdtfgPaPydbcufBdbamaAcdtfgPaPydbcufBdbamaXcdtfgPaPydbcufBdbcbhXinazasaOaXcdtfydbcdtgAfydbcdtfgxhPaHaAfgvydbgQhAdnaQTmbdninaPydbaCSmeaPclfhPaAcufgATmdxbkkaPaxaQcdtfc98fydbBdbavavydbcufBdbkaXcefgXci9hmbkaKaCcK2fgPIdbh3aPIdlhaaPIdwhhaPIdxh8JaPIdzh8KaPIdCh8LaLaCfce86bbaga8LMhga8Fa8KMh8FaYa8JMhYa8EahMh8Ea5aaMh5aEa3MhEakyd88hPxekkdnaPTmbdnakyd80gAaPci2fgCciGTmbadaCfcbaPaAcu7fciGcefz:njjjb8AkabalcltfgPak8Pi8W83dbaPcwfakc8Wfcwf8Pib83dbalcefhlkcahPdninaPc98Smeakc;mbfaPfydbcbydj1jjbH:bjjjbbaPc98fhPxbkkakc:Wef8Kjjjjbalk;3vivuv99lu8Jjjjjbca9Rgv8Kjjjjbdndnalcw0mbaiydbhoaeabcitfgralcdtcufBdlaraoBdbdnalcd6mbaiclfhoalcufhwarcxfhrinaoydbhDarcuBdbarc98faDBdbarcwfhraoclfhoawcufgwmbkkalabfhrxekcbhDavczfcwfcbBdbav9cb83izavcwfcbBdbav9cb83ibJbbjZhqJbbjZhkinadaiaDcdtfydbcK2fhwcbhrinavczfarfgoawarfIdbgxaoIdbgm:tgPakNamMgmUdbavarfgoaPaxam:tNaoIdbMUdbarclfgrcx9hmbkJbbjZaqJbbjZMgq:vhkaDcefgDal9hmbkcbhoadcbcecdavIdlgxavIdwgm9GEgravIdbgPam9GEaraPax9GEgscdtgrfhzavczfarfIdbhxaihralhwinaiaocdtfgDydbhHaDarydbgOBdbaraHBdbarclfhraoazaOcK2fIdbax9Dfhoawcufgwmbkaeabcitfhrdndnaocv6mbaoalc98f6mekaraiydbBdbaralcdtcufBdlaiclfhoalcufhwarcxfhrinaoydbhDarcuBdbarc98faDBdbarcwfhraoclfhoawcufgwmbkalabfhrxekaraxUdbaeabcitfgrarydlc98GasVBdlabcefaeadaiaoz:djjjbhwararydlciGawabcu7fcdtVBdlawaeadaiaocdtfalao9Rz:djjjbhrkavcaf8Kjjjjbark;Bloeue99vue99Due99dndnaembcuhkxekJbbjZaq:thxaiabcdtfhmavydbhPavydlhsavydwhzcbhHJFFuuhOcvhbcuhkindnaPamaHcdtfydbcdtgvfydbgATmbazasavfydbcdtfhiindndnawalaiydbgCcx2fgvclfydbgXfRbbcFeSawavydbgQfRbbcFeSfawavcwfydbgLfRbbcFeSfgKmbcbhvxekcehvaraQcdtfydbgYceSmbcehvaraXcdtfydbg8AceSmbcehvaraLcdtfydbgEceSmbdna8AcdSaYcdSfaEcdSfcd6mbaKcefhvxekaKcdfhvkdnavab9kmbdndnadTmbaoaCcK2fgQIdwadIdw:tg3a3NaQIdbadIdb:tg3a3NaQIdladIdl:tg3a3NMM:raD:vaxNJbbjZMJ9VO:d86JbbjZaQIdCadIdCNaQIdxadIdxNaQIdzadIdzNMMaqN:tg3a3J9VO:d869DENh3xekaraQcdtfydbaraXcdtfydbfaraLcdtfydbfc99f:Zh3kaCakavab6a3aO9DVgQEhkavabaQEhba3aOaQEhOkaiclfhiaAcufgAmbkkaHcefgHae9hmbkkakk;bddlue99dndndnabaecitfgrydlgwciGgDci9hmbarclfhqxekinabcbawcd4gwalaDcdtfIdbabaecitfIdb:tgkJbbbb9FEgDaecefgefadaialavaoz:fjjjbak:laoIdb9FTmdabaDaw7aefgecitfgrydlgwciGgDci9hmbkarclfhqkabaecitfhecuhbindnaiaeydbgDfRbbmbadaDcK2fgrIdwalIdw:tgkakNarIdbalIdb:tgkakNarIdlalIdl:tgkakNMM:rgkaoIdb9DTmbaoakUdbavaDBdbaqydbhwkaecwfheabcefgbawcd46mbkkk;yleoudnaladfgkRbbcFeSalaefgxRbbgmcFeSfabydwgPfalaifgsRbbcFeSfaD0abydxaq9pVgzce9hmbavawcltfgmab8Pdb83dbamcwfabcwfgm8Pdb83dbdndnamydbmbcbhqxekcbhDaohminalamabydbcdtfydbfcFe86bbamclfhmaDcefgDabydwgq6mbkkdnabydxglci2gDabydlgmfgPciGTmbaraPfcbalamcu7fciGcefz:njjjb8Aabydxci2hDabydlhmabydwhqkab9cb83dwababydbaqfBdbabaDcifc98GamfBdlaxRbbhmcbhPkdnamcFeGcFe9hmbaxaP86bbababydwgmcefBdwaoabydbcdtfamcdtfaeBdbkdnakRbbcFe9hmbakabydw86bbababydwgmcefBdwaoabydbcdtfamcdtfadBdbkdnasRbbcFe9hmbasabydw86bbababydwgmcefBdwaoabydbcdtfamcdtfaiBdbkarabydlfabydxci2faxRbb86bbarabydlfabydxci2fcefakRbb86bbarabydlfabydxci2fcdfasRbb86bbababydxcefBdxazk;Ckovud99euv99eul998Jjjjjbc:G;ae9Rgo8KjjjjbdndnadTmbavcd4hrcbhwcbhDindnaiaeclfydbar2cdtfgvIdbaiaeydbar2cdtfgqIdbgk:tgxaiaecwfydbar2cdtfgmIdlaqIdlgP:tgsNamIdbak:tgzavIdlaP:tgPN:tgkakNaPamIdwaqIdwgH:tgONasavIdwaH:tgHN:tgPaPNaHazNaOaxN:tgxaxNMM:rgsJbbbb9Bmbaoc:G:qefawcx2fgAakas:vUdwaAaxas:vUdlaAaPas:vUdbaocafawc8K2fgAaq8Pdb83dbaAav8Pdb83dxaAam8Pdb83dKaAcwfaqcwfydbBdbaAcCfavcwfydbBdbaAcafamcwfydbBdbawcefhwkaecxfheaDcifgDad6mbkab9cb83dbabcyf9cb83dbabcaf9cb83dbabcKf9cb83dbabczf9cb83dbabcwf9cb83dbawTmeao9cb83iKao9cb83izaoczfaocafawci2z1jjjbaoIdKhCaoIdChXaoIdzhQao9cb83iwao9cb83ibaoaoc:G:qefawz1jjjbJbbjZhkaoIdwgPJbbbbJbbjZaPaPNaoIdbgPaPNaoIdlgsasNMM:rgx:vaxJbbbb9BEgzNhxasazNhsaPazNhzaoc:G:qefheawhvinaecwfIdbaxNaeIdbazNasaeclfIdbNMMgPakaPak9DEhkaecxfheavcufgvmbkabaCUdwabaXUdlabaQUdbabaoId3UdxdndnakJ;n;m;m899FmbJbbbbhPaoc:G:qefheaocafhvinaCavcwfIdb:taecwfIdbgHNaQavIdb:taeIdbgONaXavclfIdb:taeclfIdbgLNMMaxaHNazaONasaLNMM:vgHaPaHaP9EEhPavc8KfhvaecxfheawcufgwmbkabazUd3abc8KfaxUdbabcafasUdbabcKfaCaxaPN:tUdbabcCfaXasaPN:tUdbabaQazaPN:tUdzabJbbjZakakN:t:rgkUdydndnaxJbbj:;axJbbj:;9GEgPJbbjZaPJbbjZ9FEJbb;:9cNJbbbZJbbb:;axJbbbb9GEMgP:lJbbb9p9DTmbaP:Ohexekcjjjj94hekabc8Ufae86bbdndnasJbbj:;asJbbj:;9GEgPJbbjZaPJbbjZ9FEJbb;:9cNJbbbZJbbb:;asJbbbb9GEMgP:lJbbb9p9DTmbaP:Ohvxekcjjjj94hvkabcRfav86bbdndnazJbbj:;azJbbj:;9GEgPJbbjZaPJbbjZ9FEJbb;:9cNJbbbZJbbb:;azJbbbb9GEMgP:lJbbb9p9DTmbaP:Ohqxekcjjjj94hqkabaq86b8SdndnaecKtcK91:YJbb;:9c:vax:t:lavcKtcK91:YJbb;:9c:vas:t:laqcKtcK91:YJbb;:9c:vaz:t:lakMMMJbb;:9cNJbbjZMgk:lJbbb9p9DTmbak:Ohexekcjjjj94hekaecFbaecFb9iEhexekabcjjj;8iBdycFbhekabae86b8Vxekab9cb83dbabcyf9cb83dbabcaf9cb83dbabcKf9cb83dbabczf9cb83dbabcwf9cb83dbkaoc:G;aef8Kjjjjbk:mvdouq99cbhi8Jjjjjbca9RglczfcwfcbBdbal9cb83izalcwfcbBdbal9cb83ibdnadTmbcbhvinaeaifhocbhrinalczfarfgwavawydbgwaoarfIdbgDaearawcx2ffIdb9DEBdbalarfgwavawydbgwaDaearawcx2ffIdb9EEBdbarclfgrcx9hmbkaicxfhiavcefgvad9hmbkkJbbbbhDcbhrcbhicbhvinaealarfydbcx2fgwIdwaealczfarfydbcx2fgoIdw:tgqaqNawIdbaoIdb:tgqaqNawIdlaoIdl:tgqaqNMMgqaDaqaD9EgwEhDavaiawEhiarclfhravcefgvci9hmbkaealczfaicdtgvfydbcx2fgrIdwaealavfydbcx2fglIdwMJbbbZNhqarIdlalIdlMJbbbZNhkarIdbalIdbMJbbbZNhxaD:rJbbbZNhDdnadTmbindnaecwfIdbgmaq:tgPaPNaeIdbgsax:tgPaPNaeclfIdbgzak:tgPaPNMMgPaDaDN9ETmbaqaDaP:rgH:vJbbbZNJbbbZMgPNamJbbjZaP:tgONMhqakaPNazaONMhkaxaPNasaONMhxaDaHMJbbbZNhDkaecxfheadcufgdmbkkabaDUdxabaqUdwabakUdlabaxUdbkjeeiu8Jjjjjbcj8W9Rgr8Kjjjjbaici2hwdnaiTmbawceawce0EhDarhiinaiaeadRbbcdtfydbBdbadcefhdaiclfhiaDcufgDmbkkabarawaladaoz:hjjjbarcj8Wf8Kjjjjbk:Ylequ8Jjjjjbcjx9Rgl8Kjjjjbcbhvalcjqfcbaiz:njjjb8AdndnadTmbcjehoaehrincuhwarhDcuhqavhkdninawakaoalcjqfaDcefRbbfRbb9RcFeGci6aoalcjqfaDRbbfRbb9RcFeGci6faoalcjqfaDcdfRbbfRbb9RcFeGci6fgxaq9mgmEhwdnammbaxce0mdkaxaqaxaq9kEhqaDcifhDadakcefgk9hmbkkaeawci2fgDcdfRbbhqaDcefRbbhxaDRbbhkaeavci2fgDcifaDawav9Rci2z:qjjjb8Aakalcjqffaocefgo86bbaxalcjqffao86bbaDcdfaq86bbaDcefax86bbaDak86bbaqalcjqffao86bbarcifhravcefgvad9hmbkalcFeaiz:njjjbhoadci2gDceaDce0EhqcbhxindnaoaeRbbgkfgwRbbgDcFe9hmbawax86bbaocjdfaxcdtfabakcdtfydbBdbaxhDaxcefhxkaeaD86bbaecefheaqcufgqmbkaxcdthDxekcbhDkabalcjdfaDz:mjjjb8Aalcjxf8Kjjjjbk9teiucbcbyd11jjbgeabcifc98GfgbBd11jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik;LeeeudndnaeabVciGTmbabhixekdndnadcz9pmbabhixekabhiinaiaeydbBdbaiclfaeclfydbBdbaicwfaecwfydbBdbaicxfaecxfydbBdbaeczfheaiczfhiadc9Wfgdcs0mbkkadcl6mbinaiaeydbBdbaeclfheaiclfhiadc98fgdci0mbkkdnadTmbinaiaeRbb86bbaicefhiaecefheadcufgdmbkkabk;aeedudndnabciGTmbabhixekaecFeGc:b:c:ew2hldndnadcz9pmbabhixekabhiinaialBdbaicxfalBdbaicwfalBdbaiclfalBdbaiczfhiadc9Wfgdcs0mbkkadcl6mbinaialBdbaiclfhiadc98fgdci0mbkkdnadTmbinaiae86bbaicefhiadcufgdmbkkabk9teiucbcbyd11jjbgeabcrfc94GfgbBd11jjbdndnabZbcztgd9nmbcuhiabad9RcFFifcz4nbcuSmekaehikaik9:eiuZbhedndncbyd11jjbgdaecztgi9nmbcuheadai9RcFFifcz4nbcuSmekadhekcbabae9Rcifc98Gcbyd11jjbfgdBd11jjbdnadZbcztge9nmbadae9RcFFifcz4nb8Akk:;Deludndndnadch9pmbabaeSmdaeabadfgi9Rcbadcet9R0mekabaead;8qbbxekaeab7ciGhldndndnabae9pmbdnalTmbadhvabhixikdnabciGmbadhvabhixdkadTmiabaeRbb86bbadcufhvdnabcefgiciGmbaecefhexdkavTmiabaeRbe86beadc9:fhvdnabcdfgiciGmbaecdfhexdkavTmiabaeRbd86bdadc99fhvdnabcifgiciGmbaecifhexdkavTmiabaeRbi86biabclfhiaeclfheadc98fhvxekdnalmbdnaiciGTmbadTmlabadcufgifglaeaifRbb86bbdnalciGmbaihdxekaiTmlabadc9:fgifglaeaifRbb86bbdnalciGmbaihdxekaiTmlabadc99fgifglaeaifRbb86bbdnalciGmbaihdxekaiTmlabadc98fgdfaeadfRbb86bbkadcl6mbdnadc98fgocd4cefciGgiTmbaec98fhlabc98fhvinavadfaladfydbBdbadc98fhdaicufgimbkkaocx6mbaec9Wfhvabc9WfhoinaoadfgicxfavadfglcxfydbBdbaicwfalcwfydbBdbaiclfalclfydbBdbaialydbBdbadc9Wfgdci0mbkkadTmdadhidnadciGglTmbaecufhvabcufhoadhiinaoaifavaifRbb86bbaicufhialcufglmbkkadcl6mdaec98fhlabc98fhvinavaifgecifalaifgdcifRbb86bbaecdfadcdfRbb86bbaecefadcefRbb86bbaeadRbb86bbaic98fgimbxikkavcl6mbdnavc98fglcd4cefcrGgdTmbavadcdt9RhvinaiaeydbBdbaeclfheaiclfhiadcufgdmbkkalc36mbinaiaeydbBdbaiaeydlBdlaiaeydwBdwaiaeydxBdxaiaeydzBdzaiaeydCBdCaiaeydKBdKaiaeyd3Bd3aecafheaicafhiavc9Gfgvci0mbkkavTmbdndnavcrGgdmbavhlxekavc94GhlinaiaeRbb86bbaicefhiaecefheadcufgdmbkkavcw6mbinaiaeRbb86bbaiaeRbe86beaiaeRbd86bdaiaeRbi86biaiaeRbl86blaiaeRbv86bvaiaeRbo86boaiaeRbr86braicwfhiaecwfhealc94fglmbkkabkkAebcjwkxebbbdbbbzNbb'; // embed! wasm\n\n\tvar wasmpack = new Uint8Array([\n\t\t32, 0, 65, 2, 1, 106, 34, 33, 3, 128, 11, 4, 13, 64, 6, 253, 10, 7, 15, 116, 127, 5, 8, 12, 40, 16, 19, 54, 20, 9, 27, 255, 113, 17, 42, 67,\n\t\t24, 23, 146, 148, 18, 14, 22, 45, 70, 69, 56, 114, 101, 21, 25, 63, 75, 136, 108, 28, 118, 29, 73, 115,\n\t]);\n\n\tif (typeof WebAssembly !== 'object') {\n\t\treturn {\n\t\t\tsupported: false,\n\t\t};\n\t}\n\n\tvar instance;\n\n\tvar ready = WebAssembly.instantiate(unpack(wasm), {}).then(function (result) {\n\t\tinstance = result.instance;\n\t\tinstance.exports.__wasm_call_ctors();\n\t});\n\n\tfunction unpack(data) {\n\t\tvar result = new Uint8Array(data.length);\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tvar ch = data.charCodeAt(i);\n\t\t\tresult[i] = ch > 96 ? ch - 97 : ch > 64 ? ch - 39 : ch + 4;\n\t\t}\n\t\tvar write = 0;\n\t\tfor (var i = 0; i < data.length; ++i) {\n\t\t\tresult[write++] = result[i] < 60 ? wasmpack[result[i]] : (result[i] - 60) * 64 + result[++i];\n\t\t}\n\t\treturn result.buffer.slice(0, write);\n\t}\n\n\tfunction assert(cond) {\n\t\tif (!cond) {\n\t\t\tthrow new Error('Assertion failed');\n\t\t}\n\t}\n\n\tfunction bytes(view) {\n\t\treturn new Uint8Array(view.buffer, view.byteOffset, view.byteLength);\n\t}\n\n\tvar BOUNDS_SIZE = 48;\n\tvar MESHLET_SIZE = 16;\n\n\tfunction extractMeshlet(buffers, index) {\n\t\tvar vertex_offset = buffers.meshlets[index * 4 + 0];\n\t\tvar triangle_offset = buffers.meshlets[index * 4 + 1];\n\t\tvar vertex_count = buffers.meshlets[index * 4 + 2];\n\t\tvar triangle_count = buffers.meshlets[index * 4 + 3];\n\n\t\treturn {\n\t\t\tvertices: buffers.vertices.subarray(vertex_offset, vertex_offset + vertex_count),\n\t\t\ttriangles: buffers.triangles.subarray(triangle_offset, triangle_offset + triangle_count * 3),\n\t\t};\n\t}\n\n\tfunction buildMeshlets(indices, vertex_positions, vertex_count, vertex_positions_stride, max_vertices, max_triangles, cone_weight) {\n\t\tvar sbrk = instance.exports.sbrk;\n\t\tvar max_meshlets = instance.exports.meshopt_buildMeshletsBound(indices.length, max_vertices, max_triangles);\n\n\t\t// allocate memory\n\t\tvar meshletsp = sbrk(max_meshlets * MESHLET_SIZE);\n\t\tvar meshlet_verticesp = sbrk(max_meshlets * max_vertices * 4);\n\t\tvar meshlet_trianglesp = sbrk(max_meshlets * max_triangles * 3);\n\n\t\tvar indicesp = sbrk(indices.byteLength);\n\t\tvar verticesp = sbrk(vertex_positions.byteLength);\n\n\t\t// copy input data to wasm memory\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(indices), indicesp);\n\t\theap.set(bytes(vertex_positions), verticesp);\n\n\t\tvar count = instance.exports.meshopt_buildMeshlets(\n\t\t\tmeshletsp,\n\t\t\tmeshlet_verticesp,\n\t\t\tmeshlet_trianglesp,\n\t\t\tindicesp,\n\t\t\tindices.length,\n\t\t\tverticesp,\n\t\t\tvertex_count,\n\t\t\tvertex_positions_stride,\n\t\t\tmax_vertices,\n\t\t\tmax_triangles,\n\t\t\tcone_weight\n\t\t);\n\n\t\t// heap might (will?) have grown -> re-acquire\n\t\theap = new Uint8Array(instance.exports.memory.buffer);\n\n\t\tvar meshletBytes = heap.subarray(meshletsp, meshletsp + count * MESHLET_SIZE);\n\t\tvar meshlets = new Uint32Array(meshletBytes.buffer, meshletBytes.byteOffset, meshletBytes.byteLength / 4).slice();\n\n\t\tfor (var i = 0; i < count; ++i) {\n\t\t\tvar vertex_offset = meshlets[i * 4 + 0];\n\t\t\tvar triangle_offset = meshlets[i * 4 + 1];\n\t\t\tvar vertex_count = meshlets[i * 4 + 2];\n\t\t\tvar triangle_count = meshlets[i * 4 + 3];\n\n\t\t\tinstance.exports.meshopt_optimizeMeshlet(\n\t\t\t\tmeshlet_verticesp + vertex_offset * 4,\n\t\t\t\tmeshlet_trianglesp + triangle_offset,\n\t\t\t\ttriangle_count,\n\t\t\t\tvertex_count\n\t\t\t);\n\t\t}\n\n\t\tvar last_vertex_offset = meshlets[(count - 1) * 4 + 0];\n\t\tvar last_triangle_offset = meshlets[(count - 1) * 4 + 1];\n\t\tvar last_vertex_count = meshlets[(count - 1) * 4 + 2];\n\t\tvar last_triangle_count = meshlets[(count - 1) * 4 + 3];\n\n\t\tvar used_vertices = last_vertex_offset + last_vertex_count;\n\t\tvar used_triangles = last_triangle_offset + ((last_triangle_count * 3 + 3) & ~3);\n\n\t\tvar result = {\n\t\t\tmeshlets: meshlets,\n\t\t\tvertices: new Uint32Array(heap.buffer, meshlet_verticesp, used_vertices).slice(),\n\t\t\ttriangles: new Uint8Array(heap.buffer, meshlet_trianglesp, used_triangles * 3).slice(),\n\t\t\tmeshletCount: count,\n\t\t};\n\n\t\t// reset memory\n\t\tsbrk(meshletsp - sbrk(0));\n\n\t\treturn result;\n\t}\n\n\tfunction extractBounds(boundsp) {\n\t\tvar bounds_floats = new Float32Array(instance.exports.memory.buffer, boundsp, BOUNDS_SIZE / 4);\n\n\t\t// see meshopt_Bounds in meshoptimizer.h for layout\n\t\treturn {\n\t\t\tcenterX: bounds_floats[0],\n\t\t\tcenterY: bounds_floats[1],\n\t\t\tcenterZ: bounds_floats[2],\n\t\t\tradius: bounds_floats[3],\n\t\t\tconeApexX: bounds_floats[4],\n\t\t\tconeApexY: bounds_floats[5],\n\t\t\tconeApexZ: bounds_floats[6],\n\t\t\tconeAxisX: bounds_floats[7],\n\t\t\tconeAxisY: bounds_floats[8],\n\t\t\tconeAxisZ: bounds_floats[9],\n\t\t\tconeCutoff: bounds_floats[10],\n\t\t};\n\t}\n\n\tfunction computeMeshletBounds(buffers, vertex_positions, vertex_count, vertex_positions_stride) {\n\t\tvar sbrk = instance.exports.sbrk;\n\n\t\tvar results = [];\n\n\t\t// allocate memory that's constant for all meshlets\n\t\tvar verticesp = sbrk(vertex_positions.byteLength);\n\t\tvar meshlet_verticesp = sbrk(buffers.vertices.byteLength);\n\t\tvar meshlet_trianglesp = sbrk(buffers.triangles.byteLength);\n\t\tvar resultp = sbrk(BOUNDS_SIZE);\n\n\t\t// copy vertices to wasm memory\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(vertex_positions), verticesp);\n\t\theap.set(bytes(buffers.vertices), meshlet_verticesp);\n\t\theap.set(bytes(buffers.triangles), meshlet_trianglesp);\n\n\t\tfor (var i = 0; i < buffers.meshletCount; ++i) {\n\t\t\tvar vertex_offset = buffers.meshlets[i * 4 + 0];\n\t\t\tvar triangle_offset = buffers.meshlets[i * 4 + 0 + 1];\n\t\t\tvar triangle_count = buffers.meshlets[i * 4 + 0 + 3];\n\n\t\t\tinstance.exports.meshopt_computeMeshletBounds(\n\t\t\t\tresultp,\n\t\t\t\tmeshlet_verticesp + vertex_offset * 4,\n\t\t\t\tmeshlet_trianglesp + triangle_offset,\n\t\t\t\ttriangle_count,\n\t\t\t\tverticesp,\n\t\t\t\tvertex_count,\n\t\t\t\tvertex_positions_stride\n\t\t\t);\n\n\t\t\tresults.push(extractBounds(resultp));\n\t\t}\n\n\t\t// reset memory\n\t\tsbrk(verticesp - sbrk(0));\n\n\t\treturn results;\n\t}\n\n\tfunction computeClusterBounds(indices, vertex_positions, vertex_count, vertex_positions_stride) {\n\t\tvar sbrk = instance.exports.sbrk;\n\n\t\t// allocate memory\n\t\tvar resultp = sbrk(BOUNDS_SIZE);\n\t\tvar indicesp = sbrk(indices.byteLength);\n\t\tvar verticesp = sbrk(vertex_positions.byteLength);\n\n\t\t// copy input data to wasm memory\n\t\tvar heap = new Uint8Array(instance.exports.memory.buffer);\n\t\theap.set(bytes(indices), indicesp);\n\t\theap.set(bytes(vertex_positions), verticesp);\n\n\t\tinstance.exports.meshopt_computeClusterBounds(resultp, indicesp, indices.length, verticesp, vertex_count, vertex_positions_stride);\n\n\t\tvar result = extractBounds(resultp);\n\n\t\t// reset memory\n\t\tsbrk(resultp - sbrk(0));\n\n\t\treturn result;\n\t}\n\n\treturn {\n\t\tready: ready,\n\t\tsupported: true,\n\t\tbuildMeshlets: function (indices, vertex_positions, vertex_positions_stride, max_vertices, max_triangles, cone_weight) {\n\t\t\tassert(indices.length % 3 == 0);\n\t\t\tassert(vertex_positions instanceof Float32Array);\n\t\t\tassert(vertex_positions.length % vertex_positions_stride == 0);\n\t\t\tassert(vertex_positions_stride >= 3);\n\t\t\tassert(max_vertices <= 255 || max_vertices > 0);\n\t\t\tassert(max_triangles <= 512);\n\t\t\tassert(max_triangles % 4 == 0);\n\n\t\t\tcone_weight = cone_weight || 0.0;\n\n\t\t\tvar indices32 = indices.BYTES_PER_ELEMENT == 4 ? indices : new Uint32Array(indices);\n\n\t\t\treturn buildMeshlets(\n\t\t\t\tindices32,\n\t\t\t\tvertex_positions,\n\t\t\t\tvertex_positions.length / vertex_positions_stride,\n\t\t\t\tvertex_positions_stride * 4,\n\t\t\t\tmax_vertices,\n\t\t\t\tmax_triangles,\n\t\t\t\tcone_weight\n\t\t\t);\n\t\t},\n\t\tcomputeClusterBounds: function (indices, vertex_positions, vertex_positions_stride) {\n\t\t\tassert(indices.length % 3 == 0);\n\t\t\tassert(indices.length / 3 <= 512);\n\t\t\tassert(vertex_positions instanceof Float32Array);\n\t\t\tassert(vertex_positions.length % vertex_positions_stride == 0);\n\t\t\tassert(vertex_positions_stride >= 3);\n\n\t\t\tvar indices32 = indices.BYTES_PER_ELEMENT == 4 ? indices : new Uint32Array(indices);\n\n\t\t\treturn computeClusterBounds(indices32, vertex_positions, vertex_positions.length / vertex_positions_stride, vertex_positions_stride * 4);\n\t\t},\n\t\tcomputeMeshletBounds: function (buffers, vertex_positions, vertex_positions_stride) {\n\t\t\tassert(buffers.meshletCount != 0);\n\t\t\tassert(vertex_positions instanceof Float32Array);\n\t\t\tassert(vertex_positions.length % vertex_positions_stride == 0);\n\t\t\tassert(vertex_positions_stride >= 3);\n\n\t\t\treturn computeMeshletBounds(buffers, vertex_positions, vertex_positions.length / vertex_positions_stride, vertex_positions_stride * 4);\n\t\t},\n\t\textractMeshlet: function (buffers, index) {\n\t\t\tassert(index >= 0 && index < buffers.meshletCount);\n\n\t\t\treturn extractMeshlet(buffers, index);\n\t\t},\n\t};\n})();\n\nexport { MeshoptClusterizer };\n","import * as THREE from 'three';\r\nimport { LinkedHashMap } from '../utils/LinkedHashMap';\r\nimport { B3DMDecoder } from \"../decoder/B3DMDecoder\";\r\nimport { SplatsDecoder } from \"../decoder/SplatsDecoder\";\r\nimport { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';\r\nimport { DRACOLoader } from 'three/addons/loaders/DRACOLoader.js';\r\nimport { KTX2Loader } from \"three/addons/loaders/KTX2Loader\";\r\nimport { resolveImplicite } from './implicit/ImplicitTileResolver.js';\r\nimport { MeshoptDecoder } from 'meshoptimizer';\r\n\r\nlet concurrentDownloads = 0;\r\n\r\n\r\n/**\r\n * A Tile loader that manages caching and load order.\r\n * The cache is an LRU cache and is defined by the number of items it can hold.\r\n * The actual number of cached items might grow beyond max if all items are in use.\r\n * \r\n * The load order is designed for optimal perceived loading speed (nearby tiles are refined first).\r\n * @class\r\n */\r\nclass TileLoader {\r\n    /**\r\n     * Creates a tile loader with a maximum number of cached items and callbacks.\r\n     * The only required property is a renderer that will be used to visualize the tiles.\r\n     * The maxCachedItems property is the size of the cache in number of objects, mesh tile and tileset.json files.\r\n     * The mesh and point callbacks will be called for every incoming mesh or points.\r\n     * \r\n     *\r\n     * \r\n     * @param {Object} [options] - Optional configuration object.\r\n     * @param {renderer} [options.renderer] - the WebGL renderer\r\n     * @param {number} [options.maxCachedItems=100] - the cache size.\r\n     * @param {function} [options.meshCallback = undefined] - A callback to call on newly decoded meshes.\r\n     * @param {function} [options.pointsCallback = undefined] - A callback to call on newly decoded points.\r\n     * @param {sring} [options.proxy = undefined] - An optional proxy that tile requests will be directed too as POST requests with the actual tile url in the body of the request.\r\n     * @param {KTX2Loader} [options.ktx2Loader = undefined] - A KTX2Loader (three/addons)\r\n     * @param {DRACOLoader} [options.dracoLoader = undefined] - A DRACOLoader (three/addons)\r\n     * @param {number} [options.downloadParallelism = 8] - Maximum number of parallel downloads\r\n     * @param {number} [options.timeout = 5000] - number of milliseconds to keep tiles in cache before clearing\r\n     */\r\n    constructor(options) {\r\n        this.downloadParallelism = options.downloadParallelism == undefined? 8 : options.downloadParallelism;\r\n        this.timeout = (options.timeout != undefined) ? options.timeout : 5000;\r\n        this.renderer = options.renderer;\r\n        this.zUpToYUpMatrix = new THREE.Matrix4();\r\n        this.zUpToYUpMatrix.set(1, 0, 0, 0,\r\n            0, 0, -1, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 0, 1);\r\n        this.maxCachedItems = 100;\r\n        this.proxy = options.proxy;\r\n        if (!!options) {\r\n            this.meshCallback = options.meshCallback;\r\n            this.pointsCallback = options.pointsCallback;\r\n            if (options.maxCachedItems != undefined) this.maxCachedItems = options.maxCachedItems;\r\n        }\r\n\r\n\r\n        this.gltfLoader = new GLTFLoader();\r\n        if (!!options && !!options.dracoLoader) {\r\n            this.gltfLoader.setDRACOLoader(options.dracoLoader);\r\n            this.hasDracoLoader = true;\r\n        } else {\r\n            const dracoLoader = new DRACOLoader();\r\n            dracoLoader.setDecoderPath('https://storage.googleapis.com/ogc-3d-tiles/draco/');\r\n            this.dracoLoader = dracoLoader;\r\n            this.gltfLoader.setDRACOLoader(dracoLoader);\r\n            this.gltfLoader.hasDracoLoader = true;\r\n        }\r\n\r\n        if (!!options && !!options.ktx2Loader) {\r\n            this.gltfLoader.setKTX2Loader(options.ktx2Loader);\r\n            this.hasKTX2Loader = true;\r\n        } else if (!!options && !!options.renderer) {\r\n            const ktx2Loader = new KTX2Loader();\r\n            ktx2Loader.setTranscoderPath('https://storage.googleapis.com/ogc-3d-tiles/basis/').detectSupport(options.renderer);\r\n            this.ktx2loader = ktx2Loader;\r\n            this.gltfLoader.setKTX2Loader(ktx2Loader);\r\n            this.gltfLoader.hasKTX2Loader = true;\r\n        }\r\n\r\n        this.gltfLoader.setMeshoptDecoder(MeshoptDecoder);\r\n        this.hasMeshOptDecoder = true;\r\n\r\n        this.b3dmDecoder = new B3DMDecoder(this.gltfLoader);\r\n        this.splatsDecoder = new SplatsDecoder(this.gltfLoader, this.renderer);\r\n\r\n        this.cache = new LinkedHashMap();\r\n        this.register = {};\r\n\r\n\r\n        this.ready = [];\r\n        this.downloads = [];\r\n        this.nextReady = [];\r\n        this.nextDownloads = [];\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * To be called in the render loop or at regular intervals.\r\n     * launches tile downloading and loading in an orderly fashion.\r\n     */\r\n    update() {\r\n\r\n        const self = this;\r\n        if (concurrentDownloads < self.downloadParallelism) {\r\n            self._download();\r\n        }\r\n\r\n        self._loadBatch();\r\n\r\n    }\r\n\r\n\r\n    _scheduleDownload(f) {\r\n        this.downloads.unshift(f);\r\n    }\r\n    _download() {\r\n\r\n        if (this.nextDownloads.length == 0) {\r\n            this._getNextDownloads();\r\n            if (this.nextDownloads.length == 0) return;\r\n        }\r\n        while (this.nextDownloads.length > 0) {\r\n            const nextDownload = this.nextDownloads.shift();\r\n            if (!!nextDownload && nextDownload.shouldDoDownload()) {\r\n                nextDownload.doDownload();\r\n            }\r\n        }\r\n        return;\r\n    }\r\n    _meshReceived(cache, register, key, distanceFunction, getSiblings, level, uuid) {\r\n        this.ready.unshift([cache, register, key, distanceFunction, getSiblings, level, uuid]);\r\n    }\r\n\r\n    _loadBatch() {\r\n        if (this.nextReady.length == 0) {\r\n            this._getNextReady();\r\n        }\r\n        while (this.nextReady.length > 0) {\r\n            const data = this.nextReady.shift();\r\n            if (!data) return;\r\n            const cache = data[0];\r\n            const register = data[1];\r\n            const key = data[2];\r\n            const mesh = cache.get(key);\r\n\r\n            if (!!mesh && !!register[key]) {\r\n                Object.keys(register[key]).forEach(tile => {\r\n                    const callback = register[key][tile];\r\n                    if (!!callback) {\r\n                        callback(mesh);\r\n                        register[key][tile] = null;\r\n                    }\r\n                });\r\n            }\r\n            if (this.nextReady.length == 0) {\r\n                this._getNextReady();\r\n            }\r\n        }\r\n\r\n        return;\r\n\r\n        /* while (this.ready.length > 0) {\r\n            const data = this.ready.shift();\r\n            if (!data) return 0;\r\n            const cache = data[0];\r\n            const register = data[1];\r\n            const key = data[2];\r\n            const mesh = cache.get(key);\r\n\r\n            if (!!mesh && !!register[key]) {\r\n                Object.keys(register[key]).forEach(tile => {\r\n                    const callback = register[key][tile];\r\n                    if (!!callback) {\r\n                        callback(mesh);\r\n                        register[key][tile] = null;\r\n                    }\r\n                });\r\n            }\r\n            return;\r\n        } */\r\n    }\r\n\r\n    _getNextDownloads() {\r\n        let smallestDistance = Number.POSITIVE_INFINITY;\r\n        let closest = -1;\r\n        for (let i = this.downloads.length - 1; i >= 0; i--) {\r\n            if (!this.downloads[i].shouldDoDownload()) {\r\n                this.downloads.splice(i, 1);\r\n                continue;\r\n            }\r\n            if (!this.downloads[i].distanceFunction) { // if no distance function, must be a json, give absolute priority!\r\n                this.nextDownloads.push(this.downloads.splice(i, 1)[0]);\r\n            }\r\n        }\r\n        if (this.nextDownloads.length > 0) return;\r\n        let highestLevel = 0;\r\n        let lowestLevel = Number.MAX_SAFE_INTEGER;\r\n        let lowestIndex = -1;\r\n        for (let i = this.downloads.length - 1; i >= 0; i--) {\r\n\r\n            const dist = this.downloads[i].distanceFunction();\r\n            if (dist <= smallestDistance) {\r\n                smallestDistance = dist;\r\n                closest = i;\r\n            }\r\n            highestLevel = Math.max(this.downloads[i].level);\r\n            if (this.downloads[i].loadingStrategy != \"IMMEDIATE\" && this.downloads[i].level < lowestLevel) {\r\n                lowestLevel = this.downloads[i].level;\r\n                lowestIndex = i;\r\n            }\r\n\r\n        }\r\n        let closestItem;\r\n        if (highestLevel > lowestLevel + 4) {\r\n            closestItem = this.downloads.splice(lowestIndex, 1).pop();\r\n        } else if (closest >= 0) {\r\n            closestItem = this.downloads.splice(closest, 1).pop();\r\n        }\r\n        if (!!closestItem) {\r\n            this.nextDownloads.push(closestItem);\r\n            const siblings = closestItem.getSiblings();\r\n            for (let i = this.downloads.length - 1; i >= 0; i--) {\r\n                if (siblings.map(s => s.uuid).includes(this.downloads[i].uuid)) {\r\n                    this.nextDownloads.push(this.downloads.splice(i, 1).pop());\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    _getNextReady() {\r\n        let smallestDistance = Number.POSITIVE_INFINITY;\r\n        let closest = -1;\r\n        for (let i = this.ready.length - 1; i >= 0; i--) {\r\n\r\n            if (!this.ready[i][3]) {// if no distance function, must be a json, give absolute priority!\r\n                this.nextReady.push(this.ready.splice(i, 1)[0]);\r\n            }\r\n        }\r\n        if (this.nextReady.length > 0) return;\r\n        for (let i = this.ready.length - 1; i >= 0; i--) {\r\n            const dist = this.ready[i][3]() * this.ready[i][5];\r\n            if (dist <= smallestDistance) {\r\n                smallestDistance = dist;\r\n                closest = i\r\n            }\r\n        }\r\n        if (closest >= 0) {\r\n            const closestItem = this.ready.splice(closest, 1).pop();\r\n            this.nextReady.push(closestItem);\r\n            const siblings = closestItem[4]();\r\n            for (let i = this.ready.length - 1; i >= 0; i--) {\r\n                if (siblings.map(s => s.uuid).includes(this.ready[i][6])) {\r\n                    this.nextReady.push(this.ready.splice(i, 1).pop());\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Schedules a tile content to be downloaded\r\n     * \r\n     * @param {AbortController} abortController \r\n     * @param {string|Number} tileIdentifier \r\n     * @param {string} path \r\n     * @param {Function} callback \r\n     * @param {Function} distanceFunction \r\n     * @param {Function} getSiblings \r\n     * @param {Number} level \r\n     * @param {Boolean} sceneZupToYup \r\n     * @param {Boolean} meshZupToYup \r\n     * @param {Number} geometricError \r\n     */\r\n    get(abortController, tileIdentifier, path, callback, distanceFunction, getSiblings, level, loadingStrategy, sceneZupToYup, meshZupToYup, geometricError, splatsMesh) {\r\n        const self = this;\r\n        const key = _simplifyPath(path);\r\n\r\n        const realAbortController = new AbortController();\r\n        abortController.signal.addEventListener(\"abort\", () => {\r\n            if (!self.register[key] || Object.keys(self.register[key]).length == 0) {\r\n                realAbortController.abort(\"user abort\");\r\n            }\r\n        })\r\n\r\n        if (!path.includes(\".b3dm\") && !path.includes(\".json\") && !path.includes(\".gltf\") && !path.includes(\".glb\")) {\r\n            console.error(\"the 3DTiles cache can only be used to load B3DM, gltf and json data\");\r\n            return;\r\n        }\r\n        if (!self.register[key]) {\r\n            self.register[key] = {};\r\n        }\r\n        if (!!self.register[key][tileIdentifier]) {\r\n            console.error(\" a tile should only be loaded once\");\r\n        }\r\n        self.register[key][tileIdentifier] = callback;\r\n\r\n        const cachedObject = self.cache.get(key);\r\n        if (!!cachedObject) {\r\n            this._meshReceived(self.cache, self.register, key, distanceFunction, getSiblings, level, tileIdentifier);\r\n        } else /* if (Object.keys(self.register[key]).length == 1) */ {\r\n            let downloadFunction;\r\n            if (path.includes(\".b3dm\")) {\r\n                downloadFunction = () => {\r\n\r\n\r\n                    var fetchFunction;\r\n                    if (!self.proxy) {\r\n                        fetchFunction = () => {\r\n                            return fetch(path, { signal: realAbortController.signal });\r\n                        }\r\n                    } else {\r\n                        fetchFunction = () => {\r\n                            return fetch(self.proxy,\r\n                                {\r\n                                    method: 'POST',\r\n                                    body: path,\r\n                                    signal: realAbortController.signal\r\n                                }\r\n                            );\r\n                        }\r\n                    }\r\n                    concurrentDownloads++;\r\n                    fetchFunction().then(result => {\r\n                        if (!result.ok) {\r\n                            console.error(\"could not load tile with path : \" + path)\r\n                            throw new Error(`couldn't load \"${path}\". Request failed with status ${result.status} : ${result.statusText}`);\r\n                        }\r\n                        return result.arrayBuffer();\r\n\r\n                    }).then(resultArrayBuffer => {\r\n\r\n                        return this.b3dmDecoder.parseB3DM(resultArrayBuffer, (mesh) => { self.meshCallback(mesh, geometricError) }, sceneZupToYup, meshZupToYup);\r\n                    }).then(mesh => {\r\n                        self.cache.put(key, mesh);\r\n                        this._meshReceived(self.cache, self.register, key, distanceFunction, getSiblings, level, tileIdentifier);\r\n                        self._checkSize();\r\n                    }).catch((e) => {\r\n                        //console.error(e)\r\n                    }).finally(() => {\r\n                        concurrentDownloads--;\r\n                    });\r\n\r\n                }\r\n            } else if (path.includes(\".glb\") || path.includes(\".gltf\")) {\r\n                if (splatsMesh) {\r\n\r\n                    downloadFunction = () => {\r\n\r\n\r\n                        var fetchFunction;\r\n                        if (!self.proxy) {\r\n                            fetchFunction = () => {\r\n                                return fetch(path, { signal: realAbortController.signal });\r\n                            }\r\n                        } else {\r\n                            fetchFunction = () => {\r\n                                return fetch(self.proxy,\r\n                                    {\r\n                                        method: 'POST',\r\n                                        body: path,\r\n                                        signal: realAbortController.signal\r\n                                    }\r\n                                );\r\n                            }\r\n                        }\r\n                        concurrentDownloads++;\r\n                        fetchFunction().then(result => {\r\n                            if (!result.ok) {\r\n                                console.error(\"could not load tile with path : \" + path)\r\n                                throw new Error(`couldn't load \"${path}\". Request failed with status ${result.status} : ${result.statusText}`);\r\n                            }\r\n                            return result.arrayBuffer();\r\n\r\n                        }).then(resultArrayBuffer => {\r\n\r\n                            return this.splatsDecoder.parseSplats(resultArrayBuffer, sceneZupToYup, meshZupToYup, splatsMesh);\r\n                        }).then(mesh => {\r\n                            self.cache.put(key, mesh);\r\n                            self._meshReceived(self.cache, self.register, key, distanceFunction, getSiblings, level, tileIdentifier);\r\n                            self._checkSize();\r\n                        }).catch((e) => {\r\n                            //console.error(e)\r\n                        }).finally(() => {\r\n                            concurrentDownloads--;\r\n                        });\r\n\r\n                    }\r\n                }\r\n                else {\r\n                    downloadFunction = () => {\r\n                        var fetchFunction;\r\n                        if (!self.proxy) {\r\n                            fetchFunction = () => {\r\n                                return fetch(path, { signal: realAbortController.signal });\r\n                            }\r\n                        } else {\r\n                            fetchFunction = () => {\r\n                                return fetch(self.proxy,\r\n                                    {\r\n                                        method: 'POST',\r\n                                        body: path,\r\n                                        signal: realAbortController.signal\r\n                                    }\r\n                                );\r\n                            }\r\n                        }\r\n                        concurrentDownloads++;\r\n                        fetchFunction().then(result => {\r\n                            if (!result.ok) {\r\n                                console.error(\"could not load tile with path : \" + path)\r\n                                throw new Error(`couldn't load \"${path}\". Request failed with status ${result.status} : ${result.statusText}`);\r\n                            }\r\n                            return result.arrayBuffer();\r\n                        }).then(async arrayBuffer => {\r\n                            await _checkLoaderInitialized(this.gltfLoader);\r\n                            this.gltfLoader.parse(arrayBuffer, null, gltf => {\r\n                                gltf.scene.asset = gltf.asset;\r\n                                if (sceneZupToYup) {\r\n                                    gltf.scene.applyMatrix4(this.zUpToYUpMatrix);\r\n                                }\r\n                                gltf.scene.traverse((o) => {\r\n\r\n                                    if (o.isMesh) {\r\n                                        if (meshZupToYup) {\r\n                                            o.applyMatrix4(this.zUpToYUpMatrix);\r\n                                        }\r\n                                        if (!!self.meshCallback) {\r\n                                            self.meshCallback(o, geometricError);\r\n                                        }\r\n                                    }\r\n                                    if (o.isPoints) {\r\n\r\n                                        if (!!self.pointsCallback) {\r\n                                            self.pointsCallback(o, geometricError);\r\n                                        }\r\n                                    }\r\n                                });\r\n\r\n                                self.cache.put(key, gltf.scene);\r\n                                self._meshReceived(self.cache, self.register, key, distanceFunction, getSiblings, level, tileIdentifier);\r\n                                self._checkSize();\r\n                            });\r\n                        }).catch((e) => {\r\n                            if (e !== \"user abort\" && e.code !== 20) {\r\n                                //console.error(e);\r\n                            }\r\n                        }).finally(() => {\r\n                            concurrentDownloads--;\r\n                        });\r\n\r\n\r\n                    }\r\n                }\r\n\r\n            } else if (path.includes(\".json\")) {\r\n                downloadFunction = () => {\r\n                    var fetchFunction;\r\n                    if (!self.proxy) {\r\n                        fetchFunction = () => {\r\n                            return fetch(path, { signal: realAbortController.signal });\r\n                        }\r\n                    } else {\r\n                        fetchFunction = () => {\r\n                            return fetch(self.proxy,\r\n                                {\r\n                                    method: 'POST',\r\n                                    body: path,\r\n                                    signal: realAbortController.signal\r\n                                }\r\n                            );\r\n                        }\r\n                    }\r\n                    concurrentDownloads++;\r\n                    fetchFunction().then(result => {\r\n                        if (!result.ok) {\r\n                            console.error(\"could not load tile with path : \" + path)\r\n                            throw new Error(`couldn't load \"${path}\". Request failed with status ${result.status} : ${result.statusText}`);\r\n                        }\r\n                        return result.json();\r\n\r\n                    }).then(json => {\r\n                        return resolveImplicite(json, path)\r\n                    }).then(json => {\r\n                        self.cache.put(key, json);\r\n                        self._meshReceived(self.cache, self.register, key);\r\n                        self._checkSize();\r\n                    }).catch((e) => {\r\n                        console.error(e)\r\n                    }).finally(() => {\r\n                        concurrentDownloads--;\r\n                    });\r\n                }\r\n            }\r\n            this._scheduleDownload({\r\n                \"shouldDoDownload\": () => {\r\n                    return !abortController.signal.aborted && !!self.register[key] && Object.keys(self.register[key]).length > 0 && !self.cache.get(key);\r\n                },\r\n                \"doDownload\": downloadFunction,\r\n                \"distanceFunction\": distanceFunction,\r\n                \"getSiblings\": getSiblings,\r\n                \"level\": level,\r\n                \"loadingStrategy\": loadingStrategy,\r\n                \"uuid\": tileIdentifier\r\n            })\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Invalidates all the unused cached tiles.\r\n     */\r\n    clear() {\r\n        const temp = this.maxCachedItems;\r\n        this.maxCachedItems = 0;\r\n        this._checkSize();\r\n        this.maxCachedItems = temp;\r\n    }\r\n\r\n    /**\r\n     *  unregisters a tile content for a specific tile, removing it from the cache if no other tile is using the same content.\r\n     * @param {string} path the content path/url\r\n     * @param {string|Number} tileIdentifier the tile ID\r\n     */\r\n    invalidate(path, tileIdentifier) {\r\n        const key = _simplifyPath(path);\r\n        const self = this;\r\n        if (!!self.register[key]) {\r\n            setTimeout(() => {\r\n                if (self.register && self.register[key]) {\r\n                    delete self.register[key][tileIdentifier];\r\n                    self._checkSize();\r\n                }\r\n            }, self.timeout);\r\n\r\n        }\r\n    }\r\n\r\n    dispose() {\r\n        let entry = this.cache.head();\r\n        this._disposeEntryContent(entry);\r\n        while ((entry = entry.next()).key != undefined) {\r\n            this._disposeEntryContent(entry);\r\n        }\r\n        this.cache.reset();\r\n        this.cache = undefined;\r\n        this.register = undefined;\r\n        if(this.dracoLoader) this.dracoLoader.dispose();\r\n        if(this.ktx2loader) this.ktx2loader.dispose();\r\n    }\r\n    _checkSize() {\r\n        const self = this;\r\n\r\n        let i = 0;\r\n\r\n        while (self.cache.size() > self.maxCachedItems && i < self.cache.size()) {\r\n            i++;\r\n            const entry = self.cache.head();\r\n            const reg = self.register[entry.key];\r\n            if (!!reg) {\r\n                if (Object.keys(reg).length > 0) {\r\n                    self.cache.remove(entry.key);\r\n                    self.cache.put(entry.key, entry.value);\r\n                } else {\r\n                    self.cache.remove(entry.key);\r\n                    delete self.register[entry.key];\r\n                    //self.register[entry.key] = undefined;\r\n                    self._disposeEntryContent(entry);\r\n\r\n                }\r\n            }\r\n\r\n        }\r\n    }\r\n    _disposeEntryContent(entry) {\r\n        if(!entry.value) return;\r\n        if (entry.value.isSplatsBatch) {\r\n            entry.value.remove();\r\n        } else if (!!entry.value.traverse) {\r\n            entry.value.traverse((o) => {\r\n\r\n                if (o.material) {\r\n                    // dispose materials\r\n                    if (o.material.length) {\r\n                        for (let i = 0; i < o.material.length; ++i) {\r\n                            o.material[i].dispose();\r\n                        }\r\n                    }\r\n                    else {\r\n                        o.material.dispose()\r\n                    }\r\n                }\r\n                if (o.geometry) {\r\n                    // dispose geometry\r\n                    o.geometry.dispose();\r\n\r\n                }\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nasync function _checkLoaderInitialized(loader) {\r\n    const self = this;\r\n    return new Promise((resolve) => {\r\n        const interval = setInterval(() => {\r\n            if ((!loader.hasDracoLoader || loader.dracoLoader) && (!loader.hasKTX2Loader || loader.ktx2Loader)) {\r\n                clearInterval(interval);\r\n                resolve();\r\n            }\r\n        }, 10); // check every 100ms\r\n    });\r\n};\r\n\r\nfunction _simplifyPath(main_path) {\r\n\r\n    var parts = main_path.split('/'),\r\n        new_path = [],\r\n        length = 0;\r\n    for (var i = 0; i < parts.length; i++) {\r\n        var part = parts[i];\r\n        if (part === '.' || part === '' || part === '..') {\r\n            if (part === '..' && length > 0) {\r\n                length--;\r\n            }\r\n            continue;\r\n        }\r\n        new_path[length++] = part;\r\n    }\r\n\r\n    if (length === 0) {\r\n        return '/';\r\n    }\r\n\r\n    var result = '';\r\n    for (var i = 0; i < length; i++) {\r\n        result += '/' + new_path[i];\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport { TileLoader };","import { isComparable } from '../utils';\nexport var DFSOperation;\n(function (DFSOperation) {\n    DFSOperation[DFSOperation[\"VISIT\"] = 0] = \"VISIT\";\n    DFSOperation[DFSOperation[\"PROCESS\"] = 1] = \"PROCESS\";\n})(DFSOperation || (DFSOperation = {}));\nexport class Range {\n    low;\n    high;\n    includeLow;\n    includeHigh;\n    constructor(low, high, includeLow = true, includeHigh = true) {\n        this.low = low;\n        this.high = high;\n        this.includeLow = includeLow;\n        this.includeHigh = includeHigh;\n        if (!(isComparable(low) && isComparable(high)))\n            throw new RangeError('low or high is not comparable');\n        if (low > high)\n            throw new RangeError('low must be less than or equal to high');\n    }\n    // Determine whether a key is within the range\n    isInRange(key, comparator) {\n        const lowCheck = this.includeLow ? comparator(key, this.low) >= 0 : comparator(key, this.low) > 0;\n        const highCheck = this.includeHigh ? comparator(key, this.high) <= 0 : comparator(key, this.high) < 0;\n        return lowCheck && highCheck;\n    }\n}\n//# sourceMappingURL=index.js.map","// 'path' module extracted from Node.js v8.11.1 (only the posix part)\n// transplited with Babel\n\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nfunction assertPath(path) {\n  if (typeof path !== 'string') {\n    throw new TypeError('Path must be a string. Received ' + JSON.stringify(path));\n  }\n}\n\n// Resolves . and .. elements in a path with directory names\nfunction normalizeStringPosix(path, allowAboveRoot) {\n  var res = '';\n  var lastSegmentLength = 0;\n  var lastSlash = -1;\n  var dots = 0;\n  var code;\n  for (var i = 0; i <= path.length; ++i) {\n    if (i < path.length)\n      code = path.charCodeAt(i);\n    else if (code === 47 /*/*/)\n      break;\n    else\n      code = 47 /*/*/;\n    if (code === 47 /*/*/) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (res.length < 2 || lastSegmentLength !== 2 || res.charCodeAt(res.length - 1) !== 46 /*.*/ || res.charCodeAt(res.length - 2) !== 46 /*.*/) {\n          if (res.length > 2) {\n            var lastSlashIndex = res.lastIndexOf('/');\n            if (lastSlashIndex !== res.length - 1) {\n              if (lastSlashIndex === -1) {\n                res = '';\n                lastSegmentLength = 0;\n              } else {\n                res = res.slice(0, lastSlashIndex);\n                lastSegmentLength = res.length - 1 - res.lastIndexOf('/');\n              }\n              lastSlash = i;\n              dots = 0;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSegmentLength = 0;\n            lastSlash = i;\n            dots = 0;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0)\n            res += '/..';\n          else\n            res = '..';\n          lastSegmentLength = 2;\n        }\n      } else {\n        if (res.length > 0)\n          res += '/' + path.slice(lastSlash + 1, i);\n        else\n          res = path.slice(lastSlash + 1, i);\n        lastSegmentLength = i - lastSlash - 1;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === 46 /*.*/ && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n\nfunction _format(sep, pathObject) {\n  var dir = pathObject.dir || pathObject.root;\n  var base = pathObject.base || (pathObject.name || '') + (pathObject.ext || '');\n  if (!dir) {\n    return base;\n  }\n  if (dir === pathObject.root) {\n    return dir + base;\n  }\n  return dir + sep + base;\n}\n\nvar posix = {\n  // path.resolve([from ...], to)\n  resolve: function resolve() {\n    var resolvedPath = '';\n    var resolvedAbsolute = false;\n    var cwd;\n\n    for (var i = arguments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n      var path;\n      if (i >= 0)\n        path = arguments[i];\n      else {\n        if (cwd === undefined)\n          cwd = process.cwd();\n        path = cwd;\n      }\n\n      assertPath(path);\n\n      // Skip empty entries\n      if (path.length === 0) {\n        continue;\n      }\n\n      resolvedPath = path + '/' + resolvedPath;\n      resolvedAbsolute = path.charCodeAt(0) === 47 /*/*/;\n    }\n\n    // At this point the path should be resolved to a full absolute path, but\n    // handle relative paths to be safe (might happen when process.cwd() fails)\n\n    // Normalize the path\n    resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n\n    if (resolvedAbsolute) {\n      if (resolvedPath.length > 0)\n        return '/' + resolvedPath;\n      else\n        return '/';\n    } else if (resolvedPath.length > 0) {\n      return resolvedPath;\n    } else {\n      return '.';\n    }\n  },\n\n  normalize: function normalize(path) {\n    assertPath(path);\n\n    if (path.length === 0) return '.';\n\n    var isAbsolute = path.charCodeAt(0) === 47 /*/*/;\n    var trailingSeparator = path.charCodeAt(path.length - 1) === 47 /*/*/;\n\n    // Normalize the path\n    path = normalizeStringPosix(path, !isAbsolute);\n\n    if (path.length === 0 && !isAbsolute) path = '.';\n    if (path.length > 0 && trailingSeparator) path += '/';\n\n    if (isAbsolute) return '/' + path;\n    return path;\n  },\n\n  isAbsolute: function isAbsolute(path) {\n    assertPath(path);\n    return path.length > 0 && path.charCodeAt(0) === 47 /*/*/;\n  },\n\n  join: function join() {\n    if (arguments.length === 0)\n      return '.';\n    var joined;\n    for (var i = 0; i < arguments.length; ++i) {\n      var arg = arguments[i];\n      assertPath(arg);\n      if (arg.length > 0) {\n        if (joined === undefined)\n          joined = arg;\n        else\n          joined += '/' + arg;\n      }\n    }\n    if (joined === undefined)\n      return '.';\n    return posix.normalize(joined);\n  },\n\n  relative: function relative(from, to) {\n    assertPath(from);\n    assertPath(to);\n\n    if (from === to) return '';\n\n    from = posix.resolve(from);\n    to = posix.resolve(to);\n\n    if (from === to) return '';\n\n    // Trim any leading backslashes\n    var fromStart = 1;\n    for (; fromStart < from.length; ++fromStart) {\n      if (from.charCodeAt(fromStart) !== 47 /*/*/)\n        break;\n    }\n    var fromEnd = from.length;\n    var fromLen = fromEnd - fromStart;\n\n    // Trim any leading backslashes\n    var toStart = 1;\n    for (; toStart < to.length; ++toStart) {\n      if (to.charCodeAt(toStart) !== 47 /*/*/)\n        break;\n    }\n    var toEnd = to.length;\n    var toLen = toEnd - toStart;\n\n    // Compare paths to find the longest common path from root\n    var length = fromLen < toLen ? fromLen : toLen;\n    var lastCommonSep = -1;\n    var i = 0;\n    for (; i <= length; ++i) {\n      if (i === length) {\n        if (toLen > length) {\n          if (to.charCodeAt(toStart + i) === 47 /*/*/) {\n            // We get here if `from` is the exact base path for `to`.\n            // For example: from='/foo/bar'; to='/foo/bar/baz'\n            return to.slice(toStart + i + 1);\n          } else if (i === 0) {\n            // We get here if `from` is the root\n            // For example: from='/'; to='/foo'\n            return to.slice(toStart + i);\n          }\n        } else if (fromLen > length) {\n          if (from.charCodeAt(fromStart + i) === 47 /*/*/) {\n            // We get here if `to` is the exact base path for `from`.\n            // For example: from='/foo/bar/baz'; to='/foo/bar'\n            lastCommonSep = i;\n          } else if (i === 0) {\n            // We get here if `to` is the root.\n            // For example: from='/foo'; to='/'\n            lastCommonSep = 0;\n          }\n        }\n        break;\n      }\n      var fromCode = from.charCodeAt(fromStart + i);\n      var toCode = to.charCodeAt(toStart + i);\n      if (fromCode !== toCode)\n        break;\n      else if (fromCode === 47 /*/*/)\n        lastCommonSep = i;\n    }\n\n    var out = '';\n    // Generate the relative path based on the path difference between `to`\n    // and `from`\n    for (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\n      if (i === fromEnd || from.charCodeAt(i) === 47 /*/*/) {\n        if (out.length === 0)\n          out += '..';\n        else\n          out += '/..';\n      }\n    }\n\n    // Lastly, append the rest of the destination (`to`) path that comes after\n    // the common path parts\n    if (out.length > 0)\n      return out + to.slice(toStart + lastCommonSep);\n    else {\n      toStart += lastCommonSep;\n      if (to.charCodeAt(toStart) === 47 /*/*/)\n        ++toStart;\n      return to.slice(toStart);\n    }\n  },\n\n  _makeLong: function _makeLong(path) {\n    return path;\n  },\n\n  dirname: function dirname(path) {\n    assertPath(path);\n    if (path.length === 0) return '.';\n    var code = path.charCodeAt(0);\n    var hasRoot = code === 47 /*/*/;\n    var end = -1;\n    var matchedSlash = true;\n    for (var i = path.length - 1; i >= 1; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          if (!matchedSlash) {\n            end = i;\n            break;\n          }\n        } else {\n        // We saw the first non-path separator\n        matchedSlash = false;\n      }\n    }\n\n    if (end === -1) return hasRoot ? '/' : '.';\n    if (hasRoot && end === 1) return '//';\n    return path.slice(0, end);\n  },\n\n  basename: function basename(path, ext) {\n    if (ext !== undefined && typeof ext !== 'string') throw new TypeError('\"ext\" argument must be a string');\n    assertPath(path);\n\n    var start = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i;\n\n    if (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\n      if (ext.length === path.length && ext === path) return '';\n      var extIdx = ext.length - 1;\n      var firstNonSlashEnd = -1;\n      for (i = path.length - 1; i >= 0; --i) {\n        var code = path.charCodeAt(i);\n        if (code === 47 /*/*/) {\n            // If we reached a path separator that was not part of a set of path\n            // separators at the end of the string, stop now\n            if (!matchedSlash) {\n              start = i + 1;\n              break;\n            }\n          } else {\n          if (firstNonSlashEnd === -1) {\n            // We saw the first non-path separator, remember this index in case\n            // we need it if the extension ends up not matching\n            matchedSlash = false;\n            firstNonSlashEnd = i + 1;\n          }\n          if (extIdx >= 0) {\n            // Try to match the explicit extension\n            if (code === ext.charCodeAt(extIdx)) {\n              if (--extIdx === -1) {\n                // We matched the extension, so mark this as the end of our path\n                // component\n                end = i;\n              }\n            } else {\n              // Extension does not match, so our result is the entire path\n              // component\n              extIdx = -1;\n              end = firstNonSlashEnd;\n            }\n          }\n        }\n      }\n\n      if (start === end) end = firstNonSlashEnd;else if (end === -1) end = path.length;\n      return path.slice(start, end);\n    } else {\n      for (i = path.length - 1; i >= 0; --i) {\n        if (path.charCodeAt(i) === 47 /*/*/) {\n            // If we reached a path separator that was not part of a set of path\n            // separators at the end of the string, stop now\n            if (!matchedSlash) {\n              start = i + 1;\n              break;\n            }\n          } else if (end === -1) {\n          // We saw the first non-path separator, mark this as the end of our\n          // path component\n          matchedSlash = false;\n          end = i + 1;\n        }\n      }\n\n      if (end === -1) return '';\n      return path.slice(start, end);\n    }\n  },\n\n  extname: function extname(path) {\n    assertPath(path);\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n    for (var i = path.length - 1; i >= 0; --i) {\n      var code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            startPart = i + 1;\n            break;\n          }\n          continue;\n        }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46 /*.*/) {\n          // If this is our first dot, mark it as the start of our extension\n          if (startDot === -1)\n            startDot = i;\n          else if (preDotState !== 1)\n            preDotState = 1;\n      } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 || end === -1 ||\n        // We saw a non-dot character immediately before the dot\n        preDotState === 0 ||\n        // The (right-most) trimmed path component is exactly '..'\n        preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      return '';\n    }\n    return path.slice(startDot, end);\n  },\n\n  format: function format(pathObject) {\n    if (pathObject === null || typeof pathObject !== 'object') {\n      throw new TypeError('The \"pathObject\" argument must be of type Object. Received type ' + typeof pathObject);\n    }\n    return _format('/', pathObject);\n  },\n\n  parse: function parse(path) {\n    assertPath(path);\n\n    var ret = { root: '', dir: '', base: '', ext: '', name: '' };\n    if (path.length === 0) return ret;\n    var code = path.charCodeAt(0);\n    var isAbsolute = code === 47 /*/*/;\n    var start;\n    if (isAbsolute) {\n      ret.root = '/';\n      start = 1;\n    } else {\n      start = 0;\n    }\n    var startDot = -1;\n    var startPart = 0;\n    var end = -1;\n    var matchedSlash = true;\n    var i = path.length - 1;\n\n    // Track the state of characters (if any) we see before our first dot and\n    // after any path separator we find\n    var preDotState = 0;\n\n    // Get non-dir info\n    for (; i >= start; --i) {\n      code = path.charCodeAt(i);\n      if (code === 47 /*/*/) {\n          // If we reached a path separator that was not part of a set of path\n          // separators at the end of the string, stop now\n          if (!matchedSlash) {\n            startPart = i + 1;\n            break;\n          }\n          continue;\n        }\n      if (end === -1) {\n        // We saw the first non-path separator, mark this as the end of our\n        // extension\n        matchedSlash = false;\n        end = i + 1;\n      }\n      if (code === 46 /*.*/) {\n          // If this is our first dot, mark it as the start of our extension\n          if (startDot === -1) startDot = i;else if (preDotState !== 1) preDotState = 1;\n        } else if (startDot !== -1) {\n        // We saw a non-dot and non-path separator before our dot, so we should\n        // have a good chance at having a non-empty extension\n        preDotState = -1;\n      }\n    }\n\n    if (startDot === -1 || end === -1 ||\n    // We saw a non-dot character immediately before the dot\n    preDotState === 0 ||\n    // The (right-most) trimmed path component is exactly '..'\n    preDotState === 1 && startDot === end - 1 && startDot === startPart + 1) {\n      if (end !== -1) {\n        if (startPart === 0 && isAbsolute) ret.base = ret.name = path.slice(1, end);else ret.base = ret.name = path.slice(startPart, end);\n      }\n    } else {\n      if (startPart === 0 && isAbsolute) {\n        ret.name = path.slice(1, startDot);\n        ret.base = path.slice(1, end);\n      } else {\n        ret.name = path.slice(startPart, startDot);\n        ret.base = path.slice(startPart, end);\n      }\n      ret.ext = path.slice(startDot, end);\n    }\n\n    if (startPart > 0) ret.dir = path.slice(0, startPart - 1);else if (isAbsolute) ret.dir = '/';\n\n    return ret;\n  },\n\n  sep: '/',\n  delimiter: ':',\n  win32: null,\n  posix: null\n};\n\nposix.posix = posix;\n\nmodule.exports = posix;\n","export class IterableElementBase {\n    /**\n     * The protected constructor initializes the options for the IterableElementBase class, including the\n     * toElementFn function.\n     * @param [options] - An optional object that contains the following properties:\n     */\n    constructor(options) {\n        if (options) {\n            const { toElementFn } = options;\n            if (typeof toElementFn === 'function')\n                this._toElementFn = toElementFn;\n            else if (toElementFn)\n                throw new TypeError('toElementFn must be a function type');\n        }\n    }\n    _toElementFn;\n    get toElementFn() {\n        return this._toElementFn;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(1)\n     *\n     * The function is an implementation of the Symbol.iterator method that returns an IterableIterator.\n     * @param {any[]} args - The `args` parameter in the code snippet represents a rest parameter. It\n     * allows the function to accept any number of arguments as an array. In this case, the `args`\n     * parameter is used to pass any number of arguments to the `_getIterator` method.\n     */\n    *[Symbol.iterator](...args) {\n        yield* this._getIterator(...args);\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * The function returns an iterator that yields all the values in the object.\n     */\n    *values() {\n        for (const item of this) {\n            yield item;\n        }\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(1)\n     *\n     * The `every` function checks if every element in the array satisfies a given predicate.\n     * @param predicate - The `predicate` parameter is a callback function that takes three arguments:\n     * the current element being processed, its index, and the array it belongs to. It should return a\n     * boolean value indicating whether the element satisfies a certain condition or not.\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that specifies the value\n     * to be used as `this` when executing the `predicate` function. If `thisArg` is provided, it will be\n     * passed as the `this` value to the `predicate` function. If `thisArg` is\n     * @returns The `every` method is returning a boolean value. It returns `true` if every element in\n     * the array satisfies the provided predicate function, and `false` otherwise.\n     */\n    every(predicate, thisArg) {\n        let index = 0;\n        for (const item of this) {\n            if (!predicate.call(thisArg, item, index++, this)) {\n                return false;\n            }\n        }\n        return true;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(1)\n     *\n     * The \"some\" function checks if at least one element in a collection satisfies a given predicate.\n     * @param predicate - The `predicate` parameter is a callback function that takes three arguments:\n     * `value`, `index`, and `array`. It should return a boolean value indicating whether the current\n     * element satisfies the condition.\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that specifies the value\n     * to be used as the `this` value when executing the `predicate` function. If `thisArg` is provided,\n     * it will be passed as the `this` value to the `predicate` function. If `thisArg\n     * @returns a boolean value. It returns true if the predicate function returns true for any element\n     * in the collection, and false otherwise.\n     */\n    some(predicate, thisArg) {\n        let index = 0;\n        for (const item of this) {\n            if (predicate.call(thisArg, item, index++, this)) {\n                return true;\n            }\n        }\n        return false;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(1)\n     *\n     * The `forEach` function iterates over each element in an array-like object and calls a callback\n     * function for each element.\n     * @param callbackfn - The callbackfn parameter is a function that will be called for each element in\n     * the array. It takes three arguments: the current element being processed, the index of the current\n     * element, and the array that forEach was called upon.\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that specifies the value\n     * to be used as `this` when executing the `callbackfn` function. If `thisArg` is provided, it will\n     * be passed as the `this` value to the `callbackfn` function. If `thisArg\n     */\n    forEach(callbackfn, thisArg) {\n        let index = 0;\n        for (const item of this) {\n            callbackfn.call(thisArg, item, index++, this);\n        }\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(1)\n     *\n     * The `find` function iterates over the elements of an array-like object and returns the first\n     * element that satisfies the provided callback function.\n     * @param predicate - The predicate parameter is a function that will be called for each element in\n     * the array. It takes three arguments: the current element being processed, the index of the current\n     * element, and the array itself. The function should return a boolean value indicating whether the\n     * current element matches the desired condition.\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that specifies the value\n     * to be used as `this` when executing the `callbackfn` function. If `thisArg` is provided, it will\n     * be passed as the `this` value to the `callbackfn` function. If `thisArg\n     * @returns The `find` method returns the first element in the array that satisfies the provided\n     * callback function. If no element satisfies the callback function, `undefined` is returned.\n     */\n    find(predicate, thisArg) {\n        let index = 0;\n        for (const item of this) {\n            if (predicate.call(thisArg, item, index++, this))\n                return item;\n        }\n        return;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(1)\n     *\n     * The function checks if a given element exists in a collection.\n     * @param {E} element - The parameter \"element\" is of type E, which means it can be any type. It\n     * represents the element that we want to check for existence in the collection.\n     * @returns a boolean value. It returns true if the element is found in the collection, and false\n     * otherwise.\n     */\n    has(element) {\n        for (const ele of this) {\n            if (ele === element)\n                return true;\n        }\n        return false;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(1)\n     *\n     * The `reduce` function iterates over the elements of an array-like object and applies a callback\n     * function to reduce them into a single value.\n     * @param callbackfn - The callbackfn parameter is a function that will be called for each element in\n     * the array. It takes four arguments:\n     * @param {U} initialValue - The initialValue parameter is the initial value of the accumulator. It\n     * is the value that the accumulator starts with before the reduction operation begins.\n     * @returns The `reduce` method is returning the final value of the accumulator after iterating over\n     * all the elements in the array and applying the callback function to each element.\n     */\n    reduce(callbackfn, initialValue) {\n        let accumulator = initialValue ?? 0;\n        let index = 0;\n        for (const item of this) {\n            accumulator = callbackfn(accumulator, item, index++, this);\n        }\n        return accumulator;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * The `toArray` function converts a linked list into an array.\n     * @returns The `toArray()` method is returning an array of type `E[]`.\n     */\n    toArray() {\n        return [...this];\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * The print function logs the elements of an array to the console.\n     */\n    toVisual() {\n        return [...this];\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * The print function logs the elements of an array to the console.\n     */\n    print() {\n        console.log(this.toVisual());\n    }\n}\n//# sourceMappingURL=iterable-element-base.js.map","/**\n * data-structure-typed\n * @author Kirk Qi\n * @copyright Copyright (c) 2022 Kirk Qi <qilinaus@gmail.com>\n * @license MIT License\n */\nimport { IterableElementBase } from '../base';\n/**\n * 1. Complete Binary Tree: Heaps are typically complete binary trees, meaning every level is fully filled except possibly for the last level, which has nodes as far left as possible.\n * 2. Heap Properties: Each node in a heap follows a specific order property, which varies depending on the type of heap:\n * Max Heap: The value of each parent node is greater than or equal to the value of its children.\n * Min Heap: The value of each parent node is less than or equal to the value of its children.\n * 3. Root Node Access: In a heap, the largest element (in a max heap) or the smallest element (in a min heap) is always at the root of the tree.\n * 4. Efficient Insertion and Deletion: Due to its structure, a heap allows for insertion and deletion operations in logarithmic time (O(log n)).\n * 5. Managing Dynamic Data Sets: Heaps effectively manage dynamic data sets, especially when frequent access to the largest or smallest elements is required.\n * 6. Non-linear Search: While a heap allows rapid access to its largest or smallest element, it is less efficient for other operations, such as searching for a specific element, as it is not designed for these tasks.\n * 7. Efficient Sorting Algorithms: For example, heap sort. Heap sort uses the properties of a heap to sort elements.\n * 8. Graph Algorithms: Such as Dijkstra's shortest path algorithm and Prime's minimum-spanning tree algorithm, which use heaps to improve performance.\n * @example\n * // Use Heap to sort an array\n *     function heapSort(arr: number[]): number[] {\n *       const heap = new Heap<number>(arr, { comparator: (a, b) => a - b });\n *       const sorted: number[] = [];\n *       while (!heap.isEmpty()) {\n *         sorted.push(heap.poll()!); // Poll minimum element\n *       }\n *       return sorted;\n *     }\n *\n *     const array = [5, 3, 8, 4, 1, 2];\n *     console.log(heapSort(array)); // [1, 2, 3, 4, 5, 8]\n * @example\n * // Use Heap to solve top k problems\n *     function topKElements(arr: number[], k: number): number[] {\n *       const heap = new Heap<number>([], { comparator: (a, b) => b - a }); // Max heap\n *       arr.forEach(num => {\n *         heap.add(num);\n *         if (heap.size > k) heap.poll(); // Keep the heap size at K\n *       });\n *       return heap.toArray();\n *     }\n *\n *     const numbers = [10, 30, 20, 5, 15, 25];\n *     console.log(topKElements(numbers, 3)); // [15, 10, 5]\n * @example\n * // Use Heap to merge sorted sequences\n *     function mergeSortedSequences(sequences: number[][]): number[] {\n *       const heap = new Heap<{ value: number; seqIndex: number; itemIndex: number }>([], {\n *         comparator: (a, b) => a.value - b.value // Min heap\n *       });\n *\n *       // Initialize heap\n *       sequences.forEach((seq, seqIndex) => {\n *         if (seq.length) {\n *           heap.add({ value: seq[0], seqIndex, itemIndex: 0 });\n *         }\n *       });\n *\n *       const merged: number[] = [];\n *       while (!heap.isEmpty()) {\n *         const { value, seqIndex, itemIndex } = heap.poll()!;\n *         merged.push(value);\n *\n *         if (itemIndex + 1 < sequences[seqIndex].length) {\n *           heap.add({\n *             value: sequences[seqIndex][itemIndex + 1],\n *             seqIndex,\n *             itemIndex: itemIndex + 1\n *           });\n *         }\n *       }\n *\n *       return merged;\n *     }\n *\n *     const sequences = [\n *       [1, 4, 7],\n *       [2, 5, 8],\n *       [3, 6, 9]\n *     ];\n *     console.log(mergeSortedSequences(sequences)); // [1, 2, 3, 4, 5, 6, 7, 8, 9]\n * @example\n * // Use Heap to dynamically maintain the median\n *     class MedianFinder {\n *       private low: MaxHeap<number>; // Max heap, stores the smaller half\n *       private high: MinHeap<number>; // Min heap, stores the larger half\n *\n *       constructor() {\n *         this.low = new MaxHeap<number>([]);\n *         this.high = new MinHeap<number>([]);\n *       }\n *\n *       addNum(num: number): void {\n *         if (this.low.isEmpty() || num <= this.low.peek()!) this.low.add(num);\n *         else this.high.add(num);\n *\n *         // Balance heaps\n *         if (this.low.size > this.high.size + 1) this.high.add(this.low.poll()!);\n *         else if (this.high.size > this.low.size) this.low.add(this.high.poll()!);\n *       }\n *\n *       findMedian(): number {\n *         if (this.low.size === this.high.size) return (this.low.peek()! + this.high.peek()!) / 2;\n *         return this.low.peek()!;\n *       }\n *     }\n *\n *     const medianFinder = new MedianFinder();\n *     medianFinder.addNum(10);\n *     console.log(medianFinder.findMedian()); // 10\n *     medianFinder.addNum(20);\n *     console.log(medianFinder.findMedian()); // 15\n *     medianFinder.addNum(30);\n *     console.log(medianFinder.findMedian()); // 20\n *     medianFinder.addNum(40);\n *     console.log(medianFinder.findMedian()); // 25\n *     medianFinder.addNum(50);\n *     console.log(medianFinder.findMedian()); // 30\n * @example\n * // Use Heap for load balancing\n *     function loadBalance(requests: number[], servers: number): number[] {\n *       const serverHeap = new Heap<{ id: number; load: number }>([], { comparator: (a, b) => a.load - b.load }); // min heap\n *       const serverLoads = new Array(servers).fill(0);\n *\n *       for (let i = 0; i < servers; i++) {\n *         serverHeap.add({ id: i, load: 0 });\n *       }\n *\n *       requests.forEach(req => {\n *         const server = serverHeap.poll()!;\n *         serverLoads[server.id] += req;\n *         server.load += req;\n *         serverHeap.add(server); // The server after updating the load is re-entered into the heap\n *       });\n *\n *       return serverLoads;\n *     }\n *\n *     const requests = [5, 2, 8, 3, 7];\n *     console.log(loadBalance(requests, 3)); // [12, 8, 5]\n * @example\n * // Use Heap to schedule tasks\n *     type Task = [string, number];\n *\n *     function scheduleTasks(tasks: Task[], machines: number): Map<number, Task[]> {\n *       const machineHeap = new Heap<{ id: number; load: number }>([], { comparator: (a, b) => a.load - b.load }); // Min heap\n *       const allocation = new Map<number, Task[]>();\n *\n *       // Initialize the load on each machine\n *       for (let i = 0; i < machines; i++) {\n *         machineHeap.add({ id: i, load: 0 });\n *         allocation.set(i, []);\n *       }\n *\n *       // Assign tasks\n *       tasks.forEach(([task, load]) => {\n *         const machine = machineHeap.poll()!;\n *         allocation.get(machine.id)!.push([task, load]);\n *         machine.load += load;\n *         machineHeap.add(machine); // The machine after updating the load is re-entered into the heap\n *       });\n *\n *       return allocation;\n *     }\n *\n *     const tasks: Task[] = [\n *       ['Task1', 3],\n *       ['Task2', 1],\n *       ['Task3', 2],\n *       ['Task4', 5],\n *       ['Task5', 4]\n *     ];\n *     const expectedMap = new Map<number, Task[]>();\n *     expectedMap.set(0, [\n *       ['Task1', 3],\n *       ['Task4', 5]\n *     ]);\n *     expectedMap.set(1, [\n *       ['Task2', 1],\n *       ['Task3', 2],\n *       ['Task5', 4]\n *     ]);\n *     console.log(scheduleTasks(tasks, 2)); // expectedMap\n */\nexport class Heap extends IterableElementBase {\n    /**\n     * The constructor initializes a heap data structure with optional elements and options.\n     * @param elements - The `elements` parameter is an iterable object that contains the initial\n     * elements to be added to the heap.\n     * It is an optional parameter, and if not provided, the heap will\n     * be initialized as empty.\n     * @param [options] - The `options` parameter is an optional object that can contain additional\n     * configuration options for the heap.\n     * In this case, it is used to specify a custom comparator\n     * function for comparing elements in the heap.\n     * The comparator function is used to determine the\n     * order of elements in the heap.\n     */\n    constructor(elements = [], options) {\n        super(options);\n        if (options) {\n            const { comparator } = options;\n            if (comparator)\n                this._comparator = comparator;\n        }\n        this.addMany(elements);\n    }\n    _elements = [];\n    /**\n     * The function returns an array of elements.\n     * @returns The element array is being returned.\n     */\n    get elements() {\n        return this._elements;\n    }\n    /**\n     * Get the size (number of elements) of the heap.\n     */\n    get size() {\n        return this.elements.length;\n    }\n    /**\n     * Get the last element in the heap, which is not necessarily a leaf node.\n     * @returns The last element or undefined if the heap is empty.\n     */\n    get leaf() {\n        return this.elements[this.size - 1] ?? undefined;\n    }\n    /**\n     * Static method that creates a binary heap from an array of elements and a comparison function.\n     * @returns A new Heap instance.\n     * @param elements\n     * @param options\n     */\n    static heapify(elements, options) {\n        return new Heap(elements, options);\n    }\n    /**\n     * Time Complexity: O(log n)\n     * Space Complexity: O(1)\n     *\n     * The add function pushes an element into an array and then triggers a bubble-up operation.\n     * @param {E} element - The `element` parameter represents the element that you want to add to the\n     * data structure.\n     * @returns The `add` method is returning a boolean value, which is the result of calling the\n     * `_bubbleUp` method with the index `this.elements.length - 1` as an argument.\n     */\n    add(element) {\n        this._elements.push(element);\n        return this._bubbleUp(this.elements.length - 1);\n    }\n    /**\n     * Time Complexity: O(k log n)\n     * Space Complexity: O(1)\n     *\n     * The `addMany` function iterates over elements and adds them to a collection, returning an array of\n     * boolean values indicating success or failure.\n     * @param {Iterable<E> | Iterable<R>} elements - The `elements` parameter in the `addMany` method is\n     * an iterable containing elements of type `E` or `R`. The method iterates over each element in the\n     * iterable and adds them to the data structure. If a transformation function `_toElementFn` is\n     * provided, it transforms the element\n     * @returns The `addMany` method returns an array of boolean values indicating whether each element\n     * in the input iterable was successfully added to the data structure.\n     */\n    addMany(elements) {\n        const ans = [];\n        for (const el of elements) {\n            if (this._toElementFn) {\n                ans.push(this.add(this._toElementFn(el)));\n                continue;\n            }\n            ans.push(this.add(el));\n        }\n        return ans;\n    }\n    /**\n     * Time Complexity: O(log n)\n     * Space Complexity: O(1)\n     *\n     * Remove and return the top element (the smallest or largest element) from the heap.\n     * @returns The top element or undefined if the heap is empty.\n     */\n    poll() {\n        if (this.elements.length === 0)\n            return;\n        const value = this.elements[0];\n        const last = this.elements.pop();\n        if (this.elements.length) {\n            this.elements[0] = last;\n            this._sinkDown(0, this.elements.length >> 1);\n        }\n        return value;\n    }\n    /**\n     * Time Complexity: O(1)\n     * Space Complexity: O(1)\n     *\n     * Peek at the top element of the heap without removing it.\n     * @returns The top element or undefined if the heap is empty.\n     */\n    peek() {\n        return this.elements[0];\n    }\n    /**\n     * Check if the heap is empty.\n     * @returns True if the heap is empty, otherwise false.\n     */\n    isEmpty() {\n        return this.size === 0;\n    }\n    /**\n     * Reset the elements of the heap. Make the elements empty.\n     */\n    clear() {\n        this._elements = [];\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * Clear and add elements of the heap\n     * @param elements\n     */\n    refill(elements) {\n        this._elements = elements;\n        return this.fix();\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(1)\n     *\n     * Use a comparison function to check whether a binary heap contains a specific element.\n     * @param element - the element to check.\n     * @returns Returns true if the specified element is contained; otherwise, returns false.\n     */\n    has(element) {\n        return this.elements.includes(element);\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(1)\n     *\n     * The `delete` function removes an element from an array-like data structure, maintaining the order\n     * and structure of the remaining elements.\n     * @param {E} element - The `element` parameter represents the element that you want to delete from\n     * the array `this.elements`.\n     * @returns The `delete` function is returning a boolean value. It returns `true` if the element was\n     * successfully deleted from the array, and `false` if the element was not found in the array.\n     */\n    delete(element) {\n        const index = this.elements.indexOf(element);\n        if (index < 0)\n            return false;\n        if (index === 0) {\n            this.poll();\n        }\n        else if (index === this.elements.length - 1) {\n            this.elements.pop();\n        }\n        else {\n            this.elements.splice(index, 1, this.elements.pop());\n            this._bubbleUp(index);\n            this._sinkDown(index, this.elements.length >> 1);\n        }\n        return true;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(log n)\n     *\n     * Depth-first search (DFS) method, different traversal orders can be selected。\n     * @param order - Traverse order parameter: 'IN' (in-order), 'PRE' (pre-order) or 'POST' (post-order).\n     * @returns An array containing elements traversed in the specified order.\n     */\n    dfs(order = 'PRE') {\n        const result = [];\n        // Auxiliary recursive function, traverses the binary heap according to the traversal order\n        const _dfs = (index) => {\n            const left = 2 * index + 1, right = left + 1;\n            if (index < this.size) {\n                if (order === 'IN') {\n                    _dfs(left);\n                    result.push(this.elements[index]);\n                    _dfs(right);\n                }\n                else if (order === 'PRE') {\n                    result.push(this.elements[index]);\n                    _dfs(left);\n                    _dfs(right);\n                }\n                else if (order === 'POST') {\n                    _dfs(left);\n                    _dfs(right);\n                    result.push(this.elements[index]);\n                }\n            }\n        };\n        _dfs(0); // Traverse starting from the root node\n        return result;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * Clone the heap, creating a new heap with the same elements.\n     * @returns A new Heap instance containing the same elements.\n     */\n    clone() {\n        return new Heap(this, { comparator: this.comparator, toElementFn: this.toElementFn });\n    }\n    /**\n     * Time Complexity: O(n log n)\n     * Space Complexity: O(n)\n     *\n     * Sort the elements in the heap and return them as an array.\n     * @returns An array containing the elements sorted in ascending order.\n     */\n    sort() {\n        const visitedNode = [];\n        const cloned = new Heap(this, { comparator: this.comparator });\n        while (cloned.size !== 0) {\n            const top = cloned.poll();\n            if (top !== undefined)\n                visitedNode.push(top);\n        }\n        return visitedNode;\n    }\n    /**\n     * Time Complexity: O(n log n)\n     * Space Complexity: O(n)\n     *\n     * Fix the entire heap to maintain heap properties.\n     */\n    fix() {\n        const results = [];\n        for (let i = Math.floor(this.size / 2); i >= 0; i--)\n            results.push(this._sinkDown(i, this.elements.length >> 1));\n        return results;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * The `filter` function creates a new Heap object containing elements that pass a given callback\n     * function.\n     * @param callback - The `callback` parameter is a function that will be called for each element in\n     * the heap. It takes three arguments: the current element, the index of the current element, and the\n     * heap itself. The callback function should return a boolean value indicating whether the current\n     * element should be included in the filtered list\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that specifies the value\n     * to be used as `this` when executing the `callback` function. If `thisArg` is provided, it will be\n     * passed as the `this` value to the `callback` function. If `thisArg` is\n     * @returns The `filter` method is returning a new `Heap` object that contains the elements that pass\n     * the filter condition specified by the `callback` function.\n     */\n    filter(callback, thisArg) {\n        const filteredList = new Heap([], { toElementFn: this.toElementFn, comparator: this.comparator });\n        let index = 0;\n        for (const current of this) {\n            if (callback.call(thisArg, current, index, this)) {\n                filteredList.add(current);\n            }\n            index++;\n        }\n        return filteredList;\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * The `map` function creates a new heap by applying a callback function to each element of the\n     * original heap.\n     * @param callback - The `callback` parameter is a function that will be called for each element in\n     * the heap. It takes three arguments: `el` (the current element), `index` (the index of the current\n     * element), and `this` (the heap itself). The callback function should return a value of\n     * @param comparator - The `comparator` parameter is a function that defines the order of the\n     * elements in the heap. It takes two elements `a` and `b` as arguments and returns a negative number\n     * if `a` should be placed before `b`, a positive number if `a` should be placed after\n     * @param [toElementFn] - The `toElementFn` parameter is an optional function that converts the raw\n     * element `RR` to the desired type `T`. It takes a single argument `rawElement` of type `RR` and\n     * returns a value of type `T`. This function is used to transform the elements of the original\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that allows you to\n     * specify the value of `this` within the callback function. It is used to set the context or scope\n     * in which the callback function will be executed. If `thisArg` is provided, it will be used as the\n     * value of\n     * @returns a new instance of the `Heap` class with the mapped elements.\n     */\n    map(callback, comparator, toElementFn, thisArg) {\n        const mappedHeap = new Heap([], { comparator, toElementFn });\n        let index = 0;\n        for (const el of this) {\n            mappedHeap.add(callback.call(thisArg, el, index, this));\n            index++;\n        }\n        return mappedHeap;\n    }\n    _DEFAULT_COMPARATOR = (a, b) => {\n        if (typeof a === 'object' || typeof b === 'object') {\n            throw TypeError(`When comparing object types, a custom comparator must be defined in the constructor's options parameter.`);\n        }\n        if (a > b)\n            return 1;\n        if (a < b)\n            return -1;\n        return 0;\n    };\n    _comparator = this._DEFAULT_COMPARATOR;\n    /**\n     * The function returns the value of the _comparator property.\n     * @returns The `_comparator` property is being returned.\n     */\n    get comparator() {\n        return this._comparator;\n    }\n    /**\n     * The function `_getIterator` returns an iterable iterator for the elements in the class.\n     */\n    *_getIterator() {\n        for (const element of this.elements) {\n            yield element;\n        }\n    }\n    /**\n     * Time Complexity: O(log n)\n     * Space Complexity: O(1)\n     *\n     * Float operation to maintain heap properties after adding an element.\n     * @param index - The index of the newly added element.\n     */\n    _bubbleUp(index) {\n        const element = this.elements[index];\n        while (index > 0) {\n            const parent = (index - 1) >> 1;\n            const parentItem = this.elements[parent];\n            if (this.comparator(parentItem, element) <= 0)\n                break;\n            this.elements[index] = parentItem;\n            index = parent;\n        }\n        this.elements[index] = element;\n        return true;\n    }\n    /**\n     * Time Complexity: O(log n)\n     * Space Complexity: O(1)\n     *\n     * Sinking operation to maintain heap properties after removing the top element.\n     * @param index - The index from which to start sinking.\n     * @param halfLength\n     */\n    _sinkDown(index, halfLength) {\n        const element = this.elements[index];\n        while (index < halfLength) {\n            let left = (index << 1) | 1;\n            const right = left + 1;\n            let minItem = this.elements[left];\n            if (right < this.elements.length && this.comparator(minItem, this.elements[right]) > 0) {\n                left = right;\n                minItem = this.elements[right];\n            }\n            if (this.comparator(minItem, element) >= 0)\n                break;\n            this.elements[index] = minItem;\n            index = left;\n        }\n        this.elements[index] = element;\n        return true;\n    }\n}\nexport class FibonacciHeapNode {\n    element;\n    degree;\n    left;\n    right;\n    child;\n    parent;\n    marked;\n    /**\n     * The constructor function initializes an object with an element and a degree, and sets the marked\n     * property to false.\n     * @param {E} element - The \"element\" parameter represents the value or data that will be stored in\n     * the node of a data structure. It can be any type of data, such as a number, string, object, or\n     * even another data structure.\n     * @param [degree=0] - The degree parameter represents the degree of the element in a data structure\n     * called a Fibonacci heap. The degree of a node is the number of children it has. By default, the\n     * degree is set to 0 when a new node is created.\n     */\n    constructor(element, degree = 0) {\n        this.element = element;\n        this.degree = degree;\n        this.marked = false;\n    }\n}\nexport class FibonacciHeap {\n    /**\n     * The constructor function initializes a FibonacciHeap object with an optional comparator function.\n     * @param [comparator] - The `comparator` parameter is an optional argument that represents a\n     * function used to compare elements in the FibonacciHeap. If a comparator function is provided, it\n     * will be used to determine the order of elements in the heap. If no comparator function is\n     * provided, a default comparator function will be used.\n     */\n    constructor(comparator) {\n        this.clear();\n        this._comparator = comparator || this._defaultComparator;\n        if (typeof this.comparator !== 'function') {\n            throw new Error('FibonacciHeap constructor: given comparator should be a function.');\n        }\n    }\n    _root;\n    /**\n     * The function returns the root node of a Fibonacci heap.\n     * @returns The method is returning either a FibonacciHeapNode object or undefined.\n     */\n    get root() {\n        return this._root;\n    }\n    _size = 0;\n    /**\n     * The function returns the size of an object.\n     * @returns The size of the object, which is a number.\n     */\n    get size() {\n        return this._size;\n    }\n    _min;\n    /**\n     * The function returns the minimum node in a Fibonacci heap.\n     * @returns The method is returning the minimum node of the Fibonacci heap, which is of type\n     * `FibonacciHeapNode<E>`. If there is no minimum node, it will return `undefined`.\n     */\n    get min() {\n        return this._min;\n    }\n    _comparator;\n    /**\n     * The function returns the comparator used for comparing elements.\n     * @returns The `_comparator` property of the object.\n     */\n    get comparator() {\n        return this._comparator;\n    }\n    /**\n     * Get the size (number of elements) of the heap.\n     * @returns {number} The size of the heap.  Returns 0 if the heap is empty. Returns -1 if the heap is invalid.\n     */\n    clear() {\n        this._root = undefined;\n        this._min = undefined;\n        this._size = 0;\n    }\n    /**\n     * Time Complexity: O(1)\n     * Space Complexity: O(1)\n     *\n     * Insert an element into the heap and maintain the heap properties.\n     * @param element\n     * @returns {FibonacciHeap<E>} FibonacciHeap<E> - The heap itself.\n     */\n    add(element) {\n        return this.push(element);\n    }\n    /**\n     * Time Complexity: O(1)\n     * Space Complexity: O(1)\n     *\n     * Insert an element into the heap and maintain the heap properties.\n     * @param element\n     * @returns {FibonacciHeap<E>} FibonacciHeap<E> - The heap itself.\n     */\n    push(element) {\n        const node = this.createNode(element);\n        node.left = node;\n        node.right = node;\n        this.mergeWithRoot(node);\n        if (!this.min || this.comparator(node.element, this.min.element) <= 0) {\n            this._min = node;\n        }\n        this._size++;\n        return this;\n    }\n    /**\n     * Time Complexity: O(1)\n     * Space Complexity: O(1)\n     *\n     * Peek at the top element of the heap without removing it.\n     * @returns The top element or undefined if the heap is empty.\n     * @protected\n     */\n    peek() {\n        return this.min ? this.min.element : undefined;\n    }\n    /**\n     * Time Complexity: O(n), where n is the number of elements in the linked list.\n     * Space Complexity: O(1)\n     *\n     * Get the size (number of elements) of the heap.\n     * @param {FibonacciHeapNode<E>} head - The head of the linked list.\n     * @protected\n     * @returns FibonacciHeapNode<E>[] - An array containing the elements of the linked list.\n     */\n    consumeLinkedList(head) {\n        const elements = [];\n        if (!head)\n            return elements;\n        let node = head;\n        let flag = false;\n        while (true) {\n            if (node === head && flag)\n                break;\n            else if (node === head)\n                flag = true;\n            if (node) {\n                elements.push(node);\n                node = node.right;\n            }\n        }\n        return elements;\n    }\n    /**\n     * Time Complexity: O(1)\n     * Space Complexity: O(1)\n     *\n     * @param parent\n     * @param node\n     */\n    mergeWithChild(parent, node) {\n        if (!parent.child) {\n            parent.child = node;\n        }\n        else {\n            node.right = parent.child.right;\n            node.left = parent.child;\n            parent.child.right.left = node;\n            parent.child.right = node;\n        }\n    }\n    /**\n     * Time Complexity: O(log n)\n     * Space Complexity: O(1)\n     *\n     * Remove and return the top element (the smallest or largest element) from the heap.\n     * @returns The top element or undefined if the heap is empty.\n     */\n    poll() {\n        return this.pop();\n    }\n    /**\n     * Time Complexity: O(log n)\n     * Space Complexity: O(1)\n     *\n     * Remove and return the top element (the smallest or largest element) from the heap.\n     * @returns The top element or undefined if the heap is empty.\n     */\n    pop() {\n        if (this._size === 0)\n            return undefined;\n        const z = this.min;\n        if (z.child) {\n            const elements = this.consumeLinkedList(z.child);\n            for (const node of elements) {\n                this.mergeWithRoot(node);\n                node.parent = undefined;\n            }\n        }\n        this.removeFromRoot(z);\n        if (z === z.right) {\n            this._min = undefined;\n            this._root = undefined;\n        }\n        else {\n            this._min = z.right;\n            this._consolidate();\n        }\n        this._size--;\n        return z.element;\n    }\n    /**\n     * Time Complexity: O(1)\n     * Space Complexity: O(1)\n     *\n     * merge two heaps. The heap that is merged will be cleared. The heap that is merged into will remain.\n     * @param heapToMerge\n     */\n    merge(heapToMerge) {\n        if (heapToMerge.size === 0) {\n            return; // Nothing to merge\n        }\n        // Merge the root lists of the two heaps\n        if (this.root && heapToMerge.root) {\n            const thisRoot = this.root;\n            const otherRoot = heapToMerge.root;\n            const thisRootRight = thisRoot.right;\n            const otherRootLeft = otherRoot.left;\n            thisRoot.right = otherRoot;\n            otherRoot.left = thisRoot;\n            thisRootRight.left = otherRootLeft;\n            otherRootLeft.right = thisRootRight;\n        }\n        // Update the minimum node\n        if (!this.min || (heapToMerge.min && this.comparator(heapToMerge.min.element, this.min.element) < 0)) {\n            this._min = heapToMerge.min;\n        }\n        // Update the size\n        this._size += heapToMerge.size;\n        // Clear the heap that was merged\n        heapToMerge.clear();\n    }\n    /**\n     * Create a new node.\n     * @param element\n     * @protected\n     */\n    createNode(element) {\n        return new FibonacciHeapNode(element);\n    }\n    /**\n     * Default comparator function used by the heap.\n     * @param {E} a\n     * @param {E} b\n     * @protected\n     */\n    _defaultComparator(a, b) {\n        if (a < b)\n            return -1;\n        if (a > b)\n            return 1;\n        return 0;\n    }\n    /**\n     * Time Complexity: O(1)\n     * Space Complexity: O(1)\n     *\n     * Merge the given node with the root list.\n     * @param node - The node to be merged.\n     */\n    mergeWithRoot(node) {\n        if (!this.root) {\n            this._root = node;\n        }\n        else {\n            node.right = this.root.right;\n            node.left = this.root;\n            this.root.right.left = node;\n            this.root.right = node;\n        }\n    }\n    /**\n     * Time Complexity: O(1)\n     * Space Complexity: O(1)\n     *\n     * Remove and return the top element (the smallest or largest element) from the heap.\n     * @param node - The node to be removed.\n     * @protected\n     */\n    removeFromRoot(node) {\n        if (this.root === node)\n            this._root = node.right;\n        if (node.left)\n            node.left.right = node.right;\n        if (node.right)\n            node.right.left = node.left;\n    }\n    /**\n     * Time Complexity: O(1)\n     * Space Complexity: O(1)\n     *\n     * Remove and return the top element (the smallest or largest element) from the heap.\n     * @param y\n     * @param x\n     * @protected\n     */\n    _link(y, x) {\n        this.removeFromRoot(y);\n        y.left = y;\n        y.right = y;\n        this.mergeWithChild(x, y);\n        x.degree++;\n        y.parent = x;\n    }\n    /**\n     * Time Complexity: O(n log n)\n     * Space Complexity: O(n)\n     *\n     * Remove and return the top element (the smallest or largest element) from the heap.\n     * @protected\n     */\n    _consolidate() {\n        const A = new Array(this._size);\n        const elements = this.consumeLinkedList(this.root);\n        let x, y, d, t;\n        for (const node of elements) {\n            x = node;\n            d = x.degree;\n            while (A[d]) {\n                y = A[d];\n                if (this.comparator(x.element, y.element) > 0) {\n                    t = x;\n                    x = y;\n                    y = t;\n                }\n                this._link(y, x);\n                A[d] = undefined;\n                d++;\n            }\n            A[d] = x;\n        }\n        for (let i = 0; i < this._size; i++) {\n            if (A[i] && this.comparator(A[i].element, this.min.element) <= 0) {\n                this._min = A[i];\n            }\n        }\n    }\n}\n//# sourceMappingURL=heap.js.map","import { Heap } from '../heap';\n/**\n * 1. Element Priority: In a PriorityQueue, elements are sorted according to their priority. Each dequeue (element removal) operation removes the element with the highest priority. The priority can be determined based on the natural ordering of the elements or through a provided comparator (Comparator).\n * 2. Heap-Based Implementation: PriorityQueue is typically implemented using a binary heap, allowing both insertion and removal operations to be completed in O(log n) time, where n is the number of elements in the queue.\n * 3. Task Scheduling: In systems where tasks need to be processed based on the urgency of tasks rather than the order of arrival.\n * 4. Dijkstra's Algorithm: In shortest path algorithms for graphs, used to select the next shortest edge to visit.\n * 5. Huffman Coding: Used to select the smallest node combination when constructing a Huffman tree.\n * 6. Kth Largest Element in a Data Stream: Used to maintain a min-heap of size K for quickly finding the Kth largest element in stream data\n */\nexport class PriorityQueue extends Heap {\n    /**\n     * The constructor initializes a priority queue with optional elements and options.\n     * @param elements - The `elements` parameter is an iterable object that contains the initial\n     * elements to be added to the priority queue. It is an optional parameter, and if not provided, the\n     * priority queue will be initialized as empty.\n     * @param [options] - The `options` parameter is an optional object that can be used to customize the\n     * behavior of the priority queue. It can contain the following properties:\n     */\n    constructor(elements = [], options) {\n        super(elements, options);\n    }\n    /**\n     * The `clone` function returns a new instance of the `PriorityQueue` class with the same comparator\n     * and toElementFn as the original instance.\n     * @returns The method is returning a new instance of the `PriorityQueue` class with the same\n     * elements and properties as the current instance.\n     */\n    clone() {\n        return new PriorityQueue(this, { comparator: this.comparator, toElementFn: this.toElementFn });\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * The `filter` function creates a new PriorityQueue object containing elements that pass a given callback\n     * function.\n     * @param callback - The `callback` parameter is a function that will be called for each element in\n     * the heap. It takes three arguments: the current element, the index of the current element, and the\n     * heap itself. The callback function should return a boolean value indicating whether the current\n     * element should be included in the filtered list\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that specifies the value\n     * to be used as `this` when executing the `callback` function. If `thisArg` is provided, it will be\n     * passed as the `this` value to the `callback` function. If `thisArg` is\n     * @returns The `filter` method is returning a new `PriorityQueue` object that contains the elements that pass\n     * the filter condition specified by the `callback` function.\n     */\n    filter(callback, thisArg) {\n        const filteredPriorityQueue = new PriorityQueue([], {\n            toElementFn: this.toElementFn,\n            comparator: this.comparator\n        });\n        let index = 0;\n        for (const current of this) {\n            if (callback.call(thisArg, current, index, this)) {\n                filteredPriorityQueue.add(current);\n            }\n            index++;\n        }\n        return filteredPriorityQueue;\n    }\n    /**\n     * Time Complexity: O(n log n)\n     * Space Complexity: O(n)\n     *\n     * The `map` function creates a new heap by applying a callback function to each element of the\n     * original heap.\n     * @param callback - The `callback` parameter is a function that will be called for each element in\n     * the heap. It takes three arguments: `el` (the current element), `index` (the index of the current\n     * element), and `this` (the heap itself). The callback function should return a value of\n     * @param comparator - The `comparator` parameter is a function that defines the order of the\n     * elements in the heap. It takes two elements `a` and `b` as arguments and returns a negative number\n     * if `a` should be placed before `b`, a positive number if `a` should be placed after\n     * @param [toElementFn] - The `toElementFn` parameter is an optional function that converts the raw\n     * element `RR` to the desired type `T`. It takes a single argument `rawElement` of type `RR` and\n     * returns a value of type `T`. This function is used to transform the elements of the original\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that allows you to\n     * specify the value of `this` within the callback function. It is used to set the context or scope\n     * in which the callback function will be executed. If `thisArg` is provided, it will be used as the\n     * value of\n     * @returns a new instance of the `PriorityQueue` class with the mapped elements.\n     */\n    map(callback, comparator, toElementFn, thisArg) {\n        const mappedPriorityQueue = new PriorityQueue([], { comparator, toElementFn });\n        let index = 0;\n        for (const el of this) {\n            mappedPriorityQueue.add(callback.call(thisArg, el, index, this));\n            index++;\n        }\n        return mappedPriorityQueue;\n    }\n}\n//# sourceMappingURL=priority-queue.js.map","import { PriorityQueue } from './priority-queue';\n/**\n *\n */\nexport class MinPriorityQueue extends PriorityQueue {\n    /**\n     * The constructor initializes a PriorityQueue with optional elements and options, including a\n     * comparator function.\n     * @param elements - The `elements` parameter is an iterable object that contains the initial\n     * elements to be added to the priority queue. It is optional and defaults to an empty array if not\n     * provided.\n     * @param options - The `options` parameter is an object that contains additional configuration\n     * options for the priority queue. In this case, it has a property called `comparator,` which is a\n     * function used to compare elements in the priority queue. The `comparator` function takes two\n     * parameters `a` and `b`\n     */\n    constructor(elements = [], options) {\n        super(elements, options);\n    }\n    /**\n     * The `clone` function returns a new instance of the `MinPriorityQueue` class with the same\n     * comparator and toElementFn as the original instance.\n     * @returns The method is returning a new instance of the `MinPriorityQueue` class with the same\n     * properties as the current instance.\n     */\n    clone() {\n        return new MinPriorityQueue(this, { comparator: this.comparator, toElementFn: this.toElementFn });\n    }\n    /**\n     * Time Complexity: O(n)\n     * Space Complexity: O(n)\n     *\n     * The `filter` function creates a new MinPriorityQueue object containing elements that pass a given callback\n     * function.\n     * @param callback - The `callback` parameter is a function that will be called for each element in\n     * the heap. It takes three arguments: the current element, the index of the current element, and the\n     * heap itself. The callback function should return a boolean value indicating whether the current\n     * element should be included in the filtered list\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that specifies the value\n     * to be used as `this` when executing the `callback` function. If `thisArg` is provided, it will be\n     * passed as the `this` value to the `callback` function. If `thisArg` is\n     * @returns The `filter` method is returning a new `MinPriorityQueue` object that contains the elements that pass\n     * the filter condition specified by the `callback` function.\n     */\n    filter(callback, thisArg) {\n        const filteredPriorityQueue = new MinPriorityQueue([], {\n            toElementFn: this.toElementFn,\n            comparator: this.comparator\n        });\n        let index = 0;\n        for (const current of this) {\n            if (callback.call(thisArg, current, index, this)) {\n                filteredPriorityQueue.add(current);\n            }\n            index++;\n        }\n        return filteredPriorityQueue;\n    }\n    /**\n     * Time Complexity: O(n log n)\n     * Space Complexity: O(n)\n     *\n     * The `map` function creates a new heap by applying a callback function to each element of the\n     * original heap.\n     * @param callback - The `callback` parameter is a function that will be called for each element in\n     * the heap. It takes three arguments: `el` (the current element), `index` (the index of the current\n     * element), and `this` (the heap itself). The callback function should return a value of\n     * @param comparator - The `comparator` parameter is a function that defines the order of the\n     * elements in the heap. It takes two elements `a` and `b` as arguments and returns a negative number\n     * if `a` should be placed before `b`, a positive number if `a` should be placed after\n     * @param [toElementFn] - The `toElementFn` parameter is an optional function that converts the raw\n     * element `RR` to the desired type `T`. It takes a single argument `rawElement` of type `RR` and\n     * returns a value of type `T`. This function is used to transform the elements of the original\n     * @param {any} [thisArg] - The `thisArg` parameter is an optional argument that allows you to\n     * specify the value of `this` within the callback function. It is used to set the context or scope\n     * in which the callback function will be executed. If `thisArg` is provided, it will be used as the\n     * value of\n     * @returns a new instance of the `MinPriorityQueue` class with the mapped elements.\n     */\n    map(callback, comparator, toElementFn, thisArg) {\n        const mappedPriorityQueue = new MinPriorityQueue([], { comparator, toElementFn });\n        let index = 0;\n        for (const el of this) {\n            mappedPriorityQueue.add(callback.call(thisArg, el, index, this));\n            index++;\n        }\n        return mappedPriorityQueue;\n    }\n}\n//# sourceMappingURL=min-priority-queue.js.map","// Import necessary classes from three.js\r\nimport { Box3, Vector3, Ray } from 'three';\r\n\r\n\r\nconst tmpBox3 = new Box3();\r\nconst tmpVector1 = new Vector3();\r\nconst tmpVector2 = new Vector3();\r\nconst tmpVector3 = new Vector3();\r\nconst tmpVector4 = new Vector3();\r\n\r\n\r\n/**\r\n * Octree class for splats raycast.\r\n */\r\nclass SplatsCollider {\r\n    /**\r\n     * @param {Box3} bounds - The bounding box of the octree node.\r\n     * @param {number} maxPoints - Maximum number of points per node before subdivision.\r\n     * @param {number} [threshold] - Optional threshold. If not provided, it defaults to bounds diagonal / 100000.\r\n     */\r\n    constructor(bounds, maxPoints, threshold = undefined) {\r\n        this.bounds = new Box3();\r\n        this.bounds.copy(bounds);\r\n        this.maxPointsPerNode = maxPoints;\r\n        this.points = [];\r\n        this.children = null;\r\n\r\n        if (threshold !== undefined) {\r\n            this.threshold = threshold;\r\n        } else {\r\n            tmpVector1.subVectors(bounds.max, bounds.min);\r\n            this.threshold = tmpVector1.length() / 100000;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Inserts a splat object into the Octree.\r\n     * @param {Object} splat - The splat object with a Vector3 'center' property.\r\n     */\r\n    insert(splat) {\r\n        const center = splat.center;\r\n\r\n        if (!this.bounds.containsPoint(center)) return;\r\n\r\n        if (this.children === null) {\r\n            if (this.points.length < this.maxPointsPerNode) {\r\n                this.points.push(splat);\r\n            } else {\r\n                this.subdivide();\r\n                this.insert(splat);\r\n            }\r\n        } else {\r\n            const index = this.getChildIndex(center);\r\n            this.children[index].insert(splat);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Queries the Octree with a Ray to find all splats within a threshold.\r\n     * Returns the splats ordered front to back relative to the ray origin.\r\n     * @param {Ray} ray - The three.js Ray object.\r\n     * @param {number} [threshold=this.threshold] - The maximum allowed distance from the ray.\r\n     * @returns {Array<{ t: number, splat: Object }>} - Array of splats within the threshold, sorted by t ascending.\r\n     */\r\n    query(ray, queryResults, threshold = this.threshold) {\r\n        this.queryRecursive(ray, queryResults, threshold);\r\n    }\r\n\r\n    /**\r\n     * Recursively queries the Octree to find all splats within a threshold.\r\n     * @private\r\n     * @param {Ray} ray - The three.js Ray object.\r\n     * @param {number} threshold - The maximum allowed distance from the ray.\r\n     */\r\n    queryRecursive(ray, queryResults, threshold) {\r\n        // Expand the bounds by the threshold\r\n        tmpBox3.copy(this.bounds).expandByScalar(threshold);\r\n\r\n        // Check if the ray intersects the expanded bounds\r\n        if (!ray.intersectBox(tmpBox3, tmpVector1)) return;\r\n\r\n        if (this.children === null) {\r\n            for (let splat of this.points) {\r\n                const center = splat.center;\r\n\r\n                // Find the closest point on the ray to the splat center\r\n                ray.closestPointToPoint(center, tmpVector1);\r\n\r\n                // Vector from ray origin to the closest point\r\n                tmpVector2.copy(tmpVector1).sub(ray.origin);\r\n\r\n                // Calculate t parameter along the ray\r\n                const t = tmpVector2.dot(ray.direction);\r\n\r\n                // Ignore splats behind the ray origin\r\n                if (t < 0) continue;\r\n\r\n                // Calculate the distance from the splat center to the closest point on the ray\r\n                const distance = center.distanceTo(tmpVector1);\r\n\r\n                if (distance <= threshold) {\r\n                    // Add the splat and its t to the query results\r\n                    queryResults.push({ distance: t, point: center });\r\n                }\r\n            }\r\n        } else {\r\n            for (let child of this.children) {\r\n                child.queryRecursive(ray, queryResults, threshold);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Determines which child Octree node the point belongs to.\r\n     * @private\r\n     * @param {Vector3} point - The point to determine the child index for.\r\n     * @returns {number} - The index of the child node (0-7).\r\n     */\r\n    getChildIndex(point) {\r\n        let index = 0;\r\n        this.bounds.getCenter(tmpVector1);\r\n\r\n        if (point.x >= tmpVector1.x) index |= 1;\r\n        if (point.y >= tmpVector1.y) index |= 2;\r\n        if (point.z >= tmpVector1.z) index |= 4;\r\n\r\n        return index;\r\n    }\r\n\r\n    /**\r\n * Subdivides the current Octree node into eight children.\r\n * @private\r\n */\r\n    subdivide() {\r\n        this.children = new Array(8);\r\n\r\n        // Calculate half the size of the current node's bounds\r\n        tmpVector1.copy(this.bounds.max).sub(this.bounds.min).multiplyScalar(0.5); // size / 2\r\n\r\n        // Copy the minimum bounds of the current node\r\n        const parentMin = tmpVector2.copy(this.bounds.min);\r\n\r\n        for (let i = 0; i < 8; i++) {\r\n            // Start with the parent minimum bounds\r\n            tmpVector3.copy(parentMin);\r\n\r\n            // Adjust the child min based on the index bits\r\n            if (i & 1) tmpVector3.x += tmpVector1.x;\r\n            if (i & 2) tmpVector3.y += tmpVector1.y;\r\n            if (i & 4) tmpVector3.z += tmpVector1.z;\r\n\r\n            // Calculate child max by adding the half size to child min\r\n            tmpVector4.copy(tmpVector3).add(tmpVector1); // childMax = childMin + halfSize\r\n\r\n            // Set up child bounds using pre-defined temporary Box3\r\n            tmpBox3.set(tmpVector3, tmpVector4);\r\n\r\n            // Create a new child Octree node with the calculated bounds\r\n            this.children[i] = new SplatsCollider(tmpBox3, this.maxPointsPerNode, this.threshold);\r\n        }\r\n\r\n        // Re-insert existing splats into the appropriate children\r\n        for (let splat of this.points) {\r\n            const index = this.getChildIndex(splat.center);\r\n            this.children[index].insert(splat);\r\n        }\r\n\r\n        // Clear points from the current node\r\n        this.points = null;\r\n    }\r\n}\r\n\r\nexport { SplatsCollider };\r\n","import {\r\n    Mesh, InstancedMesh, ShaderMaterial, Vector2, Vector3, Vector4, Box2, Box3, DataArrayTexture,\r\n    FloatType, HalfFloatType, RGBFormat, RGBAFormat, FrontSide, AlwaysDepth, PlaneGeometry, Matrix3,\r\n    NearestFilter, Data3DTexture, DataTexture, UnsignedByteType, BufferAttribute, InstancedBufferAttribute, DynamicDrawUsage,\r\n    LinearSRGBColorSpace, InstancedBufferGeometry,\r\n    WebGL3DRenderTarget, OrthographicCamera, Scene,\r\n    NeverDepth\r\n} from \"three\";\r\nimport {\r\n    MinPriorityQueue\r\n} from 'data-structure-typed';\r\nimport { SplatsCollider } from \"./SplatsColider\";\r\nimport WorkerConstructor from './PointsManager.worker.js?worker';\r\n\r\nconst tmpVector = new Vector3();\r\nconst tmpVector2 = new Vector3();\r\nconst zUpToYUpMatrix3x3 = new Matrix3();\r\nzUpToYUpMatrix3x3.set(\r\n    1, 0, 0,\r\n    0, 0, 1,\r\n    0, -1, 0);\r\n\r\nclass SplatsMesh extends Mesh {\r\n    constructor(renderer, isStatic, fragShader) {\r\n\r\n        const textureSize = 512;\r\n\r\n        const numTextures = 1;\r\n        const batchSize = Math.min(Math.ceil(4096 / textureSize) * textureSize, Math.pow(textureSize, 2));\r\n        let maxSplats = numTextures * Math.pow(textureSize, 2);\r\n        maxSplats = Math.floor(maxSplats / batchSize) * batchSize;\r\n\r\n\r\n        const colorRenderTarget = new WebGL3DRenderTarget(textureSize, textureSize, numTextures, {\r\n            magFilter: NearestFilter,\r\n            minFilter: NearestFilter,\r\n            anisotropy: 0,\r\n            depthBuffer: false,\r\n            resolveDepthBuffer: false,\r\n        })\r\n        renderer.initRenderTarget(colorRenderTarget);\r\n\r\n        const positionRenderTarget = new WebGL3DRenderTarget(textureSize, textureSize, numTextures, {\r\n            magFilter: NearestFilter,\r\n            minFilter: NearestFilter,\r\n            anisotropy: 0,\r\n            type: FloatType,\r\n            depthBuffer: false,\r\n            resolveDepthBuffer: false,\r\n        })\r\n        positionRenderTarget.texture.type = FloatType;\r\n        renderer.initRenderTarget(positionRenderTarget);\r\n        const cov1RenderTarget = new WebGL3DRenderTarget(textureSize, textureSize, numTextures, {\r\n            magFilter: NearestFilter,\r\n            minFilter: NearestFilter,\r\n            anisotropy: 0,\r\n            type: FloatType,\r\n            depthBuffer: false,\r\n            resolveDepthBuffer: false,\r\n        })\r\n        cov1RenderTarget.texture.type = FloatType;\r\n        renderer.initRenderTarget(cov1RenderTarget);\r\n        const cov2RenderTarget = new WebGL3DRenderTarget(textureSize, textureSize, numTextures, {\r\n            magFilter: NearestFilter,\r\n            minFilter: NearestFilter,\r\n            anisotropy: 0,\r\n            type: FloatType,\r\n            depthBuffer: false,\r\n            resolveDepthBuffer: false,\r\n        })\r\n        cov2RenderTarget.texture.type = FloatType;\r\n        renderer.initRenderTarget(cov2RenderTarget);\r\n\r\n\r\n        const material = new ShaderMaterial(\r\n            {\r\n                uniforms: {\r\n                    textureSize: { value: textureSize },\r\n                    numSlices: { value: numTextures },\r\n                    cov1Texture: { value: cov1RenderTarget.texture },\r\n                    cov2Texture: { value: cov2RenderTarget.texture },\r\n                    colorTexture: { value: colorRenderTarget.texture },\r\n                    positionTexture: { value: positionRenderTarget.texture },\r\n                    zUpToYUpMatrix3x3: { value: zUpToYUpMatrix3x3 },\r\n                    sizeMultiplier: { value: 1 },\r\n                    cropRadius: { value: Number.MAX_VALUE },\r\n                    cameraNear: {value: 0.01},\r\n                    cameraFar: {value: 10},\r\n                    computeLinearDepth:{value: true}\r\n                },\r\n                vertexShader: splatsVertexShader(),\r\n                fragmentShader: fragShader?fragShader:splatsFragmentShader(),\r\n                transparent: true,\r\n                side: FrontSide,\r\n                depthTest: false,\r\n                depthWrite: false,\r\n                //depthFunc: AlwaysDepth\r\n            }\r\n        );\r\n        const geometry = new InstancedBufferGeometry();\r\n        const vertices = new Float32Array([-0.5, 0.5, 0, 0.5, 0.5, 0, -0.5, -0.5, 0, 0.5, -0.5, 0]);\r\n        const indices = [0, 2, 1, 2, 3, 1];\r\n\r\n        geometry.setIndex(indices);\r\n        geometry.setAttribute('position', new BufferAttribute(vertices, 3));\r\n        const order = new Uint32Array(maxSplats);\r\n\r\n        const orderAttribute = new InstancedBufferAttribute(order, 1, false);\r\n        orderAttribute.needsUpdate = true\r\n        orderAttribute.setUsage(DynamicDrawUsage);\r\n        geometry.setAttribute('order', orderAttribute);\r\n        geometry.instanceCount = 0;\r\n\r\n\r\n        super(geometry, material);\r\n        this.matrixAutoUpdate = false;\r\n        this.numBatches = 0;\r\n        this.numVisibleBatches = 0;\r\n        this.orderAttribute = orderAttribute;\r\n        this.textureSize = textureSize;\r\n        this.numTextures = numTextures;\r\n        this.batchSize = batchSize;\r\n        this.maxSplats = maxSplats;\r\n        this.numSplatsRendered = 0;\r\n\r\n        this.colorRenderTarget = colorRenderTarget;\r\n        this.positionRenderTarget = positionRenderTarget;\r\n        this.cov1RenderTarget = cov1RenderTarget;\r\n        this.cov2RenderTarget = cov2RenderTarget;\r\n\r\n        this.renderer = renderer;\r\n\r\n        this.sortID = 0;\r\n\r\n        this.freeAddresses = new MinPriorityQueue();\r\n        for (let i = 0; i < this.maxSplats; i += batchSize) {\r\n            this.freeAddresses.add(i);\r\n        }\r\n\r\n        this.worker = new WorkerConstructor({ type: 'module' });\r\n\r\n        this.sortListeners = [];\r\n        this.worker.onmessage = message => {\r\n            const newOrder = new Uint32Array(message.data.order);\r\n            this.numSplatsRendered = newOrder.length;\r\n            //console.log(newOrder.length)\r\n            if (newOrder.length > this.orderAttribute.count) {\r\n                const geometry = new InstancedBufferGeometry();\r\n                const vertices = new Float32Array([-0.5, 0.5, 0, 0.5, 0.5, 0, -0.5, -0.5, 0, 0.5, -0.5, 0]);\r\n                const indices = [0, 2, 1, 2, 3, 1];\r\n\r\n                geometry.setIndex(indices);\r\n                geometry.setAttribute('position', new BufferAttribute(vertices, 3));\r\n                const order = new Uint32Array(this.maxSplats);\r\n\r\n                const orderAttribute = new InstancedBufferAttribute(order, 1, false);\r\n                orderAttribute.needsUpdate = true\r\n                orderAttribute.setUsage(DynamicDrawUsage);\r\n                geometry.setAttribute('order', orderAttribute);\r\n                geometry.instanceCount = 0;\r\n\r\n                this.geometry.dispose();\r\n                this.geometry = geometry;\r\n                this.orderAttribute = orderAttribute;\r\n            }\r\n            this.orderAttribute.clearUpdateRanges();\r\n            this.orderAttribute.set(newOrder);\r\n            this.orderAttribute.addUpdateRange(0, newOrder.length);\r\n            this.orderAttribute.needsUpdate = true;\r\n            this.geometry.instanceCount = message.data.count;\r\n            this.geometry.needsUpdate = true;\r\n            for (let i = this.sortListeners.length - 1; i >= 0; i--) {\r\n                const done = this.sortListeners[i](message.data.id);\r\n                if (done) {\r\n                    this.sortListeners.splice(i, 1);\r\n                }\r\n            }\r\n        }\r\n        this.cameraPosition = new Vector3(0, 0, 0);\r\n        this.rotateOnAxis(new Vector3(1, 0, 0), Math.PI * 0.5);\r\n        this.frustumCulled = false;\r\n\r\n\r\n        /// Copy setup ///\r\n        this.copyMaterial2D = new ShaderMaterial(\r\n            {\r\n                uniforms: {\r\n                    sourceTexture: {},\r\n                },\r\n                vertexShader: vertexCopyShader(),\r\n                fragmentShader: fragmentCopyShader2D(),\r\n                transparent: false,\r\n                side: FrontSide,\r\n                depthTest: false,\r\n                depthWrite: false\r\n            }\r\n        );\r\n        this.copyMaterial3D = new ShaderMaterial(\r\n            {\r\n                uniforms: {\r\n                    sourceTexture: {},\r\n                    w: { value: 0.0 }\r\n                },\r\n                vertexShader: vertexCopyShader(),\r\n                fragmentShader: fragmentCopyShader3D(),\r\n                transparent: false,\r\n                side: FrontSide,\r\n                depthTest: false,\r\n                depthWrite: false\r\n            }\r\n        );\r\n        this.copyCamera = new OrthographicCamera(-0.5, 0.5, 0.5, -0.5, 0.1, 10);\r\n        this.copyCamera.position.z = 1;\r\n        this.copyScene = new Scene();\r\n        const copyGeometry = new PlaneGeometry(1, 1);\r\n        this.copyQuad = new Mesh(copyGeometry, this.copyMaterial2D);\r\n        this.copyScene.add(this.copyQuad);\r\n        this.copyScene.matrixAutoUpdate = false;\r\n        this.copyQuad.matrixAutoUpdate = false;\r\n        const self = this;\r\n        \r\n    }\r\n\r\n    dispose() {\r\n        this.material.dispose();\r\n        this.copyMaterial2D.dispose();\r\n        this.copyMaterial3D.dispose();\r\n        this.cov1RenderTarget.dispose();\r\n        this.cov2RenderTarget.dispose();\r\n        this.positionRenderTarget.dispose();\r\n        this.colorRenderTarget.dispose();\r\n        this.worker.terminate();\r\n        this.worker = null;\r\n        this.orderAttribute.array =undefined;\r\n        this.geometry.dispose();\r\n    }\r\n\r\n    copyTex2D(src, dst, scissorBox, layer) {\r\n        this.copyMaterial2D.uniforms.sourceTexture.value = src;\r\n        const prevAutoClear = this.renderer.autoClear;\r\n        const prevRenderTarget = this.renderer.getRenderTarget();\r\n        this.renderer.autoClear = false;\r\n        const scissorWidth = scissorBox[2] - scissorBox[0];\r\n        const scissorHeight = scissorBox[3] - scissorBox[1];\r\n        dst.viewport.set(scissorBox[0], scissorBox[1], scissorWidth, scissorHeight);\r\n\r\n        this.renderer.setRenderTarget(dst, layer);\r\n        this.renderer.render(this.copyScene, this.copyCamera);\r\n\r\n        this.renderer.setRenderTarget(prevRenderTarget);\r\n\r\n        this.renderer.autoClear = prevAutoClear;\r\n\r\n    }\r\n\r\n    copyTex3D(src, dst, numLayers) {\r\n        this.copyMaterial3D.uniforms.sourceTexture.value = src;\r\n\r\n        const prevAutoClear = this.renderer.autoClear;\r\n        const prevRenderTarget = this.renderer.getRenderTarget();\r\n        this.renderer.autoClear = false;\r\n\r\n        this.copyQuad.material = this.copyMaterial3D;\r\n\r\n        for (let layer = 0; layer < numLayers; layer++) {\r\n            this.renderer.setRenderTarget(dst, layer);\r\n            this.copyMaterial3D.uniforms.w.value = (layer + 0.5) / (numLayers);\r\n            this.renderer.render(this.copyScene, this.copyCamera);\r\n        }\r\n\r\n        this.copyQuad.material = this.copyMaterial2D;\r\n\r\n        this.renderer.setRenderTarget(prevRenderTarget);\r\n        this.renderer.autoClear = prevAutoClear;\r\n\r\n    }\r\n\r\n    /**\r\n     * Specify a size multiplier for splats\r\n     * @param {number} sizeMultiplier \r\n     */\r\n    setSplatsSizeMultiplier(sizeMultiplier) {\r\n        this.material.uniforms.sizeMultiplier.value = sizeMultiplier;\r\n    }\r\n    /**\r\n     * specify a crop radius for splats\r\n     * @param {number} cropRadius \r\n     */\r\n    setSplatsCropRadius(cropRadius) {\r\n        this.material.uniforms.cropRadius.value = cropRadius;\r\n    }\r\n\r\n    sort(cameraPosition) {\r\n        if(!this.worker) return;\r\n        if (!cameraPosition && this.cameraPosition) {\r\n            this.worker.postMessage({\r\n                method: \"sort\",\r\n                xyz: [this.cameraPosition.x, this.cameraPosition.z, -this.cameraPosition.y],\r\n                id: this.sortID++\r\n            })\r\n        }\r\n        else if (!this.cameraPosition || !cameraPosition.equals(this.cameraPosition)) {\r\n            this.cameraPosition.copy(cameraPosition);\r\n            this.worker.postMessage({\r\n                method: \"sort\",\r\n                xyz: [this.cameraPosition.x, this.cameraPosition.z, -this.cameraPosition.y],\r\n                id: this.sortID++\r\n            })\r\n        }\r\n    }\r\n    raycast(raycaster, intersects) {\r\n        // overrides the method because the SplatsMesh itself is not meant to be raycast onto, the tiles should be individualy raycast\r\n    }\r\n\r\n    addSplatsTile(positions, colors, cov1, cov2) {\r\n        if(!this.worker) return;\r\n        const self = this;\r\n        \r\n        const positionArray = positions.data ? positions.data.array : positions.array;\r\n        const stride = positions.data && positions.data.isInterleavedBuffer ? positions.data.stride : 3;\r\n        const offset = positions.data && positions.data.isInterleavedBuffer ? positions.offset : 0;\r\n        const numBatches = Math.ceil(positionArray.length / (this.batchSize * stride));\r\n        const textureAddresses = [];\r\n        const pointManagerAddresses = [];\r\n\r\n\r\n        /// raycasting ///\r\n        // const start = performance.now();\r\n        let raycast = () => { }\r\n        const positionsOnly = new Float32Array((positionArray.length / stride) * 3);\r\n\r\n\r\n        for (let i = 0; i < positionArray.length / 3; i++) {\r\n            positionsOnly[i * 3] = positionArray[i * stride + offset];\r\n            positionsOnly[i * 3 + 1] = positionArray[i * stride + offset + 1];\r\n            positionsOnly[i * 3 + 2] = positionArray[i * stride + offset + 2];\r\n        }\r\n\r\n        // console.log(performance.now()-start)\r\n        raycast = (ray, intersects, threshold) => {\r\n            const threshSquared = threshold * threshold;\r\n            for (let i = 0; i < positionsOnly.length; i += 3) {\r\n                tmpVector.set(positionsOnly[i], -positionsOnly[i + 2], positionsOnly[i + 1])\r\n                const dot = tmpVector2.copy(tmpVector).sub(ray.origin).dot(ray.direction);\r\n                if (dot > 0) {\r\n                    const d = ray.distanceSqToPoint(tmpVector);\r\n                    if (d < threshSquared) {\r\n                        intersects.push({ distance: dot, point: tmpVector.clone(), type: \"splat\" });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (numBatches > this.freeAddresses.size) {\r\n            this.growTextures();\r\n        }\r\n\r\n        for (let i = 0; i < numBatches; i++) {\r\n            const address = this.freeAddresses.poll();\r\n            if (isNaN(address)) {\r\n                console.log(\"insuficient texture size to store splats info\")\r\n            }\r\n            if (address == 0) {\r\n            }\r\n            textureAddresses.push(address);\r\n            pointManagerAddresses.push(address * 3);\r\n            const startIndex = i * this.batchSize;\r\n            this.addSplatsBatch(startIndex, address, positions, colors, cov1, cov2);\r\n        }\r\n\r\n\r\n        self.worker.postMessage({\r\n            method: \"addBatches\",\r\n            insertionIndexes: pointManagerAddresses,\r\n            positions: positionArray.buffer,\r\n            offset: offset,\r\n            stride: stride,\r\n            batchSize: self.batchSize,\r\n        }, [positionArray.buffer]);\r\n\r\n        let visible = false;\r\n        const hide = () => {\r\n            \r\n            if (visible == true && self.worker) {\r\n                self.numVisibleBatches--;\r\n                visible = false;\r\n                self.worker.postMessage({\r\n                    method: \"hideBatches\",\r\n                    insertionIndexes: pointManagerAddresses,\r\n                    xyz: [self.cameraPosition.x, self.cameraPosition.z, -self.cameraPosition.y],\r\n                    id: self.sortID++\r\n                });\r\n            }\r\n\r\n        }\r\n\r\n\r\n        const show = (callback) => {\r\n            if (visible == false && self.worker) {\r\n                self.numVisibleBatches--;\r\n                visible = true;\r\n                const sortID = self.sortID;\r\n                const listener = (id => {\r\n                    if (id >= sortID) {\r\n                        callback();\r\n                        return true;\r\n                    }\r\n                    return false;\r\n                });\r\n                self.sortListeners.push(listener)\r\n    \r\n                self.worker.postMessage({\r\n                    method: \"showBatches\",\r\n                    insertionIndexes: pointManagerAddresses,\r\n                    xyz: [self.cameraPosition.x, self.cameraPosition.z, -self.cameraPosition.y],\r\n                    id: self.sortID++\r\n                });\r\n            }\r\n\r\n\r\n        }\r\n        const remove = () => {\r\n            if(!self.worker) return;\r\n            raycast = undefined;\r\n            self.worker.postMessage({\r\n                method: \"removeBatches\",\r\n                insertionIndexes: pointManagerAddresses,\r\n                xyz: [self.cameraPosition.x, self.cameraPosition.z, -self.cameraPosition.y],\r\n                id: self.sortID++\r\n            });\r\n            textureAddresses.forEach(address => self.freeAddresses.add(address));\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n        return {\r\n            hide: hide,\r\n            show: show,\r\n            remove: remove,\r\n            sort: this.sort,\r\n            raycast: raycast,\r\n            isSplatsBatch: true\r\n        }\r\n\r\n    }\r\n    addSplatsBatch(positionsStartIndex, address, positions, colors, cov1, cov2) {\r\n\r\n\r\n        const positionArray = new Float32Array(this.batchSize * 4);\r\n        const colorsArray = new Uint8Array(this.batchSize * 4);\r\n        const cov1Array = new Float32Array(this.batchSize * 4);\r\n        const cov2Array = new Float32Array(this.batchSize * 4);\r\n\r\n\r\n        for (let i = address; i < address + this.batchSize; i++) {\r\n            const base = i - address;\r\n            const arrayIndexBase4 = base * 4;\r\n\r\n            const positionIndex = positionsStartIndex + base;\r\n            if (positionIndex >= positions.count) break;\r\n\r\n            positionArray[arrayIndexBase4] = positions.getX(positionIndex)\r\n            positionArray[arrayIndexBase4 + 1] = positions.getY(positionIndex)\r\n            positionArray[arrayIndexBase4 + 2] = positions.getZ(positionIndex)\r\n\r\n            const r = Math.floor(colors.getX(positionIndex) * 255);\r\n            const g = Math.floor(colors.getY(positionIndex) * 255);\r\n            const b = Math.floor(colors.getZ(positionIndex) * 255);\r\n            const a = Math.floor(colors.getW(positionIndex) * 255);\r\n\r\n            colorsArray[arrayIndexBase4] = Math.floor(colors.getX(positionIndex) * 255);\r\n            colorsArray[arrayIndexBase4 + 1] = Math.floor(colors.getY(positionIndex) * 255);\r\n            colorsArray[arrayIndexBase4 + 2] = Math.floor(colors.getZ(positionIndex) * 255);\r\n            colorsArray[arrayIndexBase4 + 3] = Math.floor(colors.getW(positionIndex) * 255);\r\n\r\n\r\n            cov1Array[arrayIndexBase4] = cov1.getX(positionIndex)\r\n            cov1Array[arrayIndexBase4 + 1] = cov1.getY(positionIndex)\r\n            cov1Array[arrayIndexBase4 + 2] = cov1.getZ(positionIndex)\r\n            cov2Array[arrayIndexBase4] = cov2.getX(positionIndex)\r\n            cov2Array[arrayIndexBase4 + 1] = cov2.getY(positionIndex)\r\n            cov2Array[arrayIndexBase4 + 2] = cov2.getZ(positionIndex)\r\n\r\n        }\r\n\r\n        const destTextureLayer = Math.floor(address / Math.pow(this.textureSize, 2));\r\n        const srcHeight = Math.ceil(this.batchSize / this.textureSize);\r\n        const scissor = [0, (address / this.textureSize) - (destTextureLayer * this.textureSize), this.textureSize];\r\n        scissor.push(scissor[1] + srcHeight);\r\n        const batchPositionTexture = new DataTexture(positionArray, this.textureSize, srcHeight, RGBAFormat, FloatType);\r\n        batchPositionTexture.generateMipmaps = false;\r\n        batchPositionTexture.magFilter = NearestFilter;\r\n        batchPositionTexture.minFilter = NearestFilter;\r\n        batchPositionTexture.anisotropy = 0;\r\n        batchPositionTexture.needsUpdate = true;\r\n        this.renderer.initTexture(batchPositionTexture)\r\n        this.renderer.initRenderTarget(this.positionRenderTarget)\r\n        this.copyTex2D(batchPositionTexture, this.positionRenderTarget, scissor, destTextureLayer)\r\n        batchPositionTexture.dispose();\r\n\r\n\r\n        const batchColorTexture = new DataTexture(colorsArray, this.textureSize, srcHeight, RGBAFormat, UnsignedByteType);\r\n        batchColorTexture.generateMipmaps = false;\r\n        batchColorTexture.magFilter = NearestFilter;\r\n        batchColorTexture.minFilter = NearestFilter;\r\n        batchColorTexture.anisotropy = 0;\r\n        batchColorTexture.needsUpdate = true;\r\n        this.renderer.initTexture(batchColorTexture)\r\n        this.copyTex2D(batchColorTexture, this.colorRenderTarget, scissor, destTextureLayer);\r\n        batchColorTexture.dispose();\r\n\r\n\r\n        const batchCov1Texture = new DataTexture(cov1Array, this.textureSize, srcHeight, RGBAFormat, FloatType);\r\n        batchCov1Texture.generateMipmaps = false;\r\n        batchCov1Texture.magFilter = NearestFilter;\r\n        batchCov1Texture.minFilter = NearestFilter;\r\n        batchCov1Texture.anisotropy = 0;\r\n        batchCov1Texture.needsUpdate = true;\r\n        this.renderer.initTexture(batchCov1Texture)\r\n        this.copyTex2D(batchCov1Texture, this.cov1RenderTarget, scissor, destTextureLayer)\r\n        batchCov1Texture.dispose();\r\n\r\n        const batchCov2Texture = new DataTexture(cov2Array, this.textureSize, srcHeight, RGBAFormat, FloatType);\r\n        batchCov2Texture.generateMipmaps = false;\r\n        batchCov2Texture.magFilter = NearestFilter;\r\n        batchCov2Texture.minFilter = NearestFilter;\r\n        batchCov2Texture.anisotropy = 0;\r\n        batchCov2Texture.needsUpdate = true;\r\n        this.renderer.initTexture(batchCov2Texture)\r\n        this.copyTex2D(batchCov2Texture, this.cov2RenderTarget, scissor, destTextureLayer);\r\n        batchCov2Texture.dispose();\r\n\r\n    }\r\n\r\n    growTextures() {\r\n\r\n        //const start = performance.now();\r\n        for (let i = this.maxSplats; i < this.maxSplats + (this.textureSize * this.textureSize); i += this.batchSize) {\r\n            this.freeAddresses.add(i);\r\n        }\r\n        this.maxSplats += (this.textureSize * this.textureSize);\r\n\r\n\r\n\r\n        const newNumTextures = this.numTextures + 1;\r\n        const colorRenderTarget = new WebGL3DRenderTarget(this.textureSize, this.textureSize, newNumTextures, {\r\n            magFilter: NearestFilter,\r\n            minFilter: NearestFilter,\r\n            anisotropy: 0,\r\n            depthBuffer: false,\r\n            resolveDepthBuffer: false,\r\n        })\r\n\r\n\r\n        this.renderer.initRenderTarget(colorRenderTarget);\r\n        this.copyTex3D(this.colorRenderTarget.texture, colorRenderTarget, this.numTextures);\r\n        this.colorRenderTarget.dispose();\r\n        this.colorRenderTarget = colorRenderTarget;\r\n        this.material.uniforms.colorTexture.value = this.colorRenderTarget.texture;\r\n\r\n\r\n        const positionRenderTarget = new WebGL3DRenderTarget(this.textureSize, this.textureSize, newNumTextures, {\r\n            magFilter: NearestFilter,\r\n            minFilter: NearestFilter,\r\n            anisotropy: 0,\r\n            type: FloatType,\r\n            depthBuffer: false,\r\n            resolveDepthBuffer: false,\r\n        })\r\n        positionRenderTarget.texture.type = FloatType;\r\n        this.renderer.initRenderTarget(positionRenderTarget);\r\n        this.copyTex3D(this.positionRenderTarget.texture, positionRenderTarget, this.numTextures);\r\n        this.positionRenderTarget.dispose();\r\n        this.positionRenderTarget = positionRenderTarget;\r\n        this.material.uniforms.positionTexture.value = this.positionRenderTarget.texture;\r\n\r\n\r\n        const cov1RenderTarget = new WebGL3DRenderTarget(this.textureSize, this.textureSize, newNumTextures, {\r\n            magFilter: NearestFilter,\r\n            minFilter: NearestFilter,\r\n            anisotropy: 0,\r\n            type: FloatType,\r\n            depthBuffer: false,\r\n            resolveDepthBuffer: false,\r\n        })\r\n        cov1RenderTarget.texture.type = FloatType;\r\n        this.renderer.initRenderTarget(cov1RenderTarget);\r\n        this.copyTex3D(this.cov1RenderTarget.texture, cov1RenderTarget, this.numTextures);\r\n        this.cov1RenderTarget.dispose();\r\n        this.cov1RenderTarget = cov1RenderTarget;\r\n        this.material.uniforms.cov1Texture.value = this.cov1RenderTarget.texture;\r\n\r\n        const cov2RenderTarget = new WebGL3DRenderTarget(this.textureSize, this.textureSize, newNumTextures, {\r\n            magFilter: NearestFilter,\r\n            minFilter: NearestFilter,\r\n            anisotropy: 0,\r\n            type: FloatType,\r\n            depthBuffer: false,\r\n            resolveDepthBuffer: false,\r\n        })\r\n        cov2RenderTarget.texture.type = FloatType;\r\n        this.renderer.initRenderTarget(cov2RenderTarget);\r\n        this.copyTex3D(this.cov2RenderTarget.texture, cov2RenderTarget, this.numTextures);\r\n        this.cov2RenderTarget.dispose();\r\n        this.cov2RenderTarget = cov2RenderTarget;\r\n        this.material.uniforms.cov2Texture.value = this.cov2RenderTarget.texture;\r\n\r\n\r\n        this.numTextures = newNumTextures;\r\n        this.material.uniforms.numSlices.value = this.numTextures;\r\n\r\n        //console.log(\"grow \" + (performance.now() - start) + \" ms\")\r\n    }\r\n\r\n} export { SplatsMesh }\r\n\r\nfunction saveBuffer(pixelBuffer) {\r\n    const canvas = document.createElement('canvas');\r\n    const width = 512;\r\n    const height = 512;\r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    const context = canvas.getContext('2d');\r\n    const imageData = context.createImageData(width, height);\r\n\r\n    // WebGL's coordinate system is bottom-left, so we need to flip the image vertically\r\n    for (let y = 0; y < height; y++) {\r\n        for (let x = 0; x < width; x++) {\r\n            const srcIndex = (y * width + x) * 4;\r\n            const destIndex = ((height - y - 1) * width + x) * 4;\r\n            imageData.data[destIndex] = pixelBuffer[srcIndex];       // R\r\n            imageData.data[destIndex + 1] = pixelBuffer[srcIndex + 1]; // G\r\n            imageData.data[destIndex + 2] = pixelBuffer[srcIndex + 2]; // B\r\n            imageData.data[destIndex + 3] = pixelBuffer[srcIndex + 3]; // A\r\n        }\r\n    }\r\n    context.putImageData(imageData, 0, 0);\r\n\r\n    // 6. Convert the canvas to a PNG and trigger download\r\n    canvas.toBlob((blob) => {\r\n        const url = URL.createObjectURL(blob);\r\n        const link = document.createElement('a');\r\n        link.href = url;\r\n        link.download = `layer_.png`;\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n        URL.revokeObjectURL(url);\r\n    }, 'image/png');\r\n}\r\nexport function splatsVertexShader() {\r\n    return `\r\nprecision highp float;\r\nprecision highp int;\r\n\r\n#include <common>\r\n#include <packing>\r\n\r\nuniform float textureSize;\r\nuniform float numSlices;\r\nuniform float sizeMultiplier;\r\nin uint order;\r\nout vec4 color;\r\nout vec2 vUv;\r\nout vec3 splatPositionWorld;\r\nout vec3 splatPositionModel;\r\nout float splatDepth;\r\n//out float orthographicDepth;\r\nout float splatCrop;\r\nuniform sampler3D colorTexture;\r\nuniform sampler3D positionTexture;\r\nuniform sampler3D cov1Texture;\r\nuniform sampler3D cov2Texture;\r\nuniform mat3 zUpToYUpMatrix3x3;\r\nuniform float logDepthBufFC;\r\n//uniform float cameraNear;\r\n//uniform float cameraFar;\r\n//uniform bool computeLinearDepth;\r\n\r\n\r\nvoid getVertexData(out vec3 position, out mat3 covariance) {\r\n    float index = float(order)+0.1; // add small offset to avoid floating point errors with modulo\r\n    float pixelsPerSlice = textureSize * textureSize;\r\n    float sliceIndex = floor(index / pixelsPerSlice);\r\n    float slicePixelIndex = mod(index,pixelsPerSlice);\r\n\r\n    float x = mod(slicePixelIndex,textureSize);\r\n    float y = floor(slicePixelIndex / textureSize);\r\n\r\n    vec3 uvw = vec3((x + 0.5) / textureSize, (y + 0.5) / textureSize, (sliceIndex + 0.5) / numSlices);\r\n\r\n    // Position\r\n    position = texture(positionTexture, uvw).xyz;\r\n    \r\n    \r\n    \r\n    \r\n    vec4 cov1 = texture(cov1Texture, uvw);\r\n    vec4 cov2 = texture(cov2Texture, uvw);\r\n\r\n    covariance[0][0] = cov1.x;\r\n    covariance[1][0] = cov1.y;\r\n    covariance[0][1] = cov1.y;\r\n    covariance[2][0] = cov1.z;\r\n    covariance[0][2] = cov1.z;\r\n\r\n    covariance[1][1] = cov2.x;\r\n    covariance[2][1] = cov2.y;\r\n    covariance[1][2] = cov2.y;\r\n    covariance[2][2] = cov2.z;\r\n\r\n    \r\n     \r\n\r\n    //covariance *= 4.0;\r\n    mat3 modelRotation = zUpToYUpMatrix3x3*transpose(mat3(modelMatrix));\r\n    covariance = transpose(zUpToYUpMatrix3x3) * covariance * zUpToYUpMatrix3x3;\r\n    covariance = transpose(modelRotation) * covariance * (modelRotation);\r\n\r\n    // Color\r\n    color = texture(colorTexture, uvw);\r\n    // color = vec4(uvw.z, 0.0,0.0,1.0);\r\n}\r\n\r\nvoid modelTransform(in vec3 splatPosition, in mat3 covariance, inout vec3 vertexPosition){\r\n    vec3 upReference = vec3(0.0, 1.0, 0.0);\r\n    vec3 look = normalize(cameraPosition - splatPosition);\r\n    vec3 right = normalize(cross(upReference, look));\r\n\r\n    float rightLength = length(cross(upReference, look));\r\n    if (rightLength < 1e-6) { // Check if vectors are parallel\r\n        upReference = vec3(1.0, 0.0, 0.0); // Choose an alternative up vector\r\n        right = normalize(cross(upReference, look));\r\n    }\r\n\r\n    vec3 up = cross(look, right);\r\n\r\n    // Construct the billboard rotation matrix\r\n    mat3 billboardRot = mat3(\r\n        right.x, right.y, right.z,\r\n        up.x, up.y, up.z,\r\n        look.x, look.y, look.z);\r\n\r\n    mat3 cov2D = transpose(billboardRot) * covariance * billboardRot;\r\n    \r\n    float a = max(cov2D[0][0],1e-6);\r\n    float b = cov2D[0][1];\r\n    \r\n    float c = max(cov2D[1][1],1e-6);\r\n\r\n    \r\n    float trace = a + c;\r\n    float det = a * c - b * b;\r\n    \r\n\r\n    float traceOver2 = 0.5 * trace;\r\n    float dist = sqrt(max(traceOver2*traceOver2 - det, 0.0));\r\n    //float dist = sqrt(max(0.1, traceOver2 * traceOver2 - det));\r\n\r\n    float lambda1 = max(0.0, traceOver2 + dist);\r\n    float lambda2 = max(0.0, traceOver2 - dist);\r\n\r\n\r\n    vec2 eigenvector1;\r\n    if(abs(covariance[0][1]) < 1e-7 && abs(covariance[0][2]) < 1e-7 && abs(covariance[1][2]) < 1e-7){\r\n\t\t\t\t\teigenvector1 = vec2(0,1);\r\n\t}else{\r\n\t\teigenvector1 = normalize(vec2(b, lambda1 - a));\r\n\t}\r\n    vec2 eigenvector2 = vec2(-eigenvector1.y, eigenvector1.x);\r\n    float l1 = sqrt(lambda1);\r\n    float l2 = sqrt(lambda2);\r\n\r\n    eigenvector1 *= l1*2.0;\r\n    eigenvector2 *= l2*2.0;\r\n    vertexPosition.xy = vertexPosition.x * eigenvector1 + vertexPosition.y * eigenvector2;\r\n    vertexPosition = billboardRot * vertexPosition + splatPosition;\r\n}\r\n\r\n\r\nvoid main() {\r\n    vUv = vec2(position);\r\n\r\n    splatPositionModel = vec3(0.0);\r\n    mat3 covariance = mat3(0.0);\r\n    getVertexData(splatPositionModel, covariance);\r\n    splatCrop = 0.5*sqrt(color.w); // discard more pixels when opacity is low\r\n    splatPositionWorld = (modelMatrix * vec4(splatPositionModel, 1.0)).xyz;\r\n    \r\n\r\n    vec3 outPosition = vec3(position)*sizeMultiplier;\r\n    modelTransform(splatPositionWorld, covariance, outPosition);\r\n    \r\n    gl_Position = projectionMatrix * viewMatrix * vec4(outPosition, 1.0);\r\n    /* if(computeLinearDepth){\r\n        orthographicDepth = viewZToOrthographicDepth( -gl_Position.w, cameraNear, cameraFar );\r\n    } */\r\n    \r\n    vec4 centerP = projectionMatrix * viewMatrix * vec4(splatPositionWorld, 1.0);\r\n    #if defined( USE_LOGDEPTHBUF )\r\n\t    float isPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\r\n        splatDepth = isPerspective == 0.0 ? centerP.z : log2( 1.0 + centerP.w ) * logDepthBufFC * 0.5;\r\n    #else\r\n        splatDepth = (centerP.z / centerP.w)* 0.5 + 0.5;\r\n    #endif\r\n\r\n    \r\n}\r\n`};\r\nexport function splatsFragmentShader() {\r\n    return `\r\nprecision highp float;\r\n\r\nin vec4 color;\r\nin vec2 vUv;\r\nin vec3 splatPositionModel;\r\nin vec3 splatPositionWorld;\r\nin float splatDepth;\r\n//in float orthographicDepth;\r\nin float splatCrop;\r\nuniform float textureSize;\r\nuniform float cropRadius;\r\n\r\nvoid main() {\r\n    if(length(splatPositionModel)>cropRadius) discard;\r\n    float l = length(vUv);\r\n    \r\n    // Early discard for pixels outside the radius\r\n    if (l > 0.5) {\r\n        discard;\r\n    };\r\n     vec2 p = vUv * 4.0;\r\n    float alpha = exp(-dot(p, p));\r\n\r\n    gl_FragColor = vec4(pow(color.xyz,vec3(1.0/2.2)), color.w * pow(alpha, 1.8)); \r\n    //gl_FragColor = vec4(splatDepth,0.0,0.0,1.0); \r\n    //gl_FragDepth = splatDepth;\r\n    \r\n}`\r\n};\r\n\r\nfunction vertexCopyShader() {\r\n    return `\r\n\r\nout vec2 vUv;\r\n\r\nvoid main() {\r\n    vUv = uv;\r\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n}`\r\n};\r\n\r\nfunction fragmentCopyShader2D() {\r\n    return `\r\nprecision highp float;\r\n\r\nuniform sampler2D sourceTexture;\r\n\r\nin vec2 vUv;\r\n\r\nvoid main() {\r\n    gl_FragColor = texture( sourceTexture, vUv );\r\n}`\r\n};\r\n\r\n\r\nfunction fragmentCopyShader3D() {\r\n    return `\r\nprecision highp float;\r\n\r\nuniform sampler3D sourceTexture;\r\nuniform float w;\r\n\r\nin vec2 vUv;\r\n\r\nvoid main() {\r\n    gl_FragColor = texture( sourceTexture, vec3(vUv, w) );\r\n}`\r\n};","import * as THREE from 'three';\r\nimport { OBB } from \"../geometry/obb\";\r\nimport { TileLoader } from \"./TileLoader\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport * as path from \"path-browserify\"\r\nimport { resolveImplicite } from './implicit/ImplicitTileResolver.js';\r\nimport { SplatsMesh } from '../splats/SplatsMesh';\r\nvar averageTime = 0;\r\n\r\n\r\nvar copyrightDiv;\r\nconst tempSphere = new THREE.Sphere(new THREE.Vector3(0, 0, 0), 1);\r\nconst tempOBB = new OBB([0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1]);\r\nconst tempBox3 = new THREE.Box3();\r\nconst tempVec1 = new THREE.Vector3(0, 0, 0);\r\nconst tempVec2 = new THREE.Vector3(0, 0, 0);\r\nconst upVector = new THREE.Vector3(0, 1, 0);\r\nconst tempRay = new THREE.Ray();\r\nconst inverseWorld = new THREE.Matrix4();\r\nconst transformedProjection = new THREE.Matrix4();\r\nconst frustum = new THREE.Frustum();\r\nconst transformedCameraPosition = new THREE.Vector3();\r\nconst tempIntersects = [];\r\n\r\nconst tempQuaternion = new THREE.Quaternion();\r\nconst copyright = {};\r\n\r\n/**\r\n * @returns a list of vendors that are required by copyright to be displayed in the app.\r\n */\r\nfunction getOGC3DTilesCopyrightInfo() {\r\n    var list = [];\r\n    for (let key in copyright) {\r\n        if (copyright.hasOwnProperty(key) && copyright[key] > 0) { // This checks if the key is actually part of the object and not its prototype.\r\n            list.push(key);\r\n        }\r\n    }\r\n    return list;\r\n\r\n}\r\n\r\n\r\n/**\r\n * class representing a tiled and multileveled mesh or point-cloud according to the OGC3DTiles 1.1 spec\r\n * @class\r\n * @extends {THREE.Object3D}\r\n */\r\nclass OGC3DTile extends THREE.Object3D {\r\n\r\n    /**\r\n     * @param {Object} [properties] - the properties for this tileset\r\n     * @param {String} [properties.url] - the url to the parent tileset.json\r\n     * @param {Object} [properties.queryParams = undefined] - optional, path params to add to individual tile urls\r\n     * @param {Number} [properties.geometricErrorMultiplier = 1] - the geometric error of the parent. 1.0 by default corresponds to a maxScreenSpaceError of 16\r\n     * @param {Boolean} [properties.loadOutsideView = false] - if truthy, tiles otside the camera frustum will be loaded with the least possible amount of detail\r\n     * @param {TileLoader} [properties.tileLoader = undefined] - A tile loader that can be shared among tilesets in order to share a common cache.\r\n     * @param {Function} [properties.meshCallback = undefined] - A callback function that will be called on every mesh\r\n     * @param {Function} [properties.pointsCallback = undefined] - A callback function that will be called on every points\r\n     * @param {Function} [properties.onLoadCallback = undefined] - A callback function that will be called when the root tile has been loaded\r\n     * @param {OcclusionCullingService} [properties.occlusionCullingService = undefined] - A service that handles occlusion culling\r\n     * @param {Boolean} [properties.centerModel = false] - If true, the tileset will be centered on 0,0,0 and in the case of georeferenced tilesets that use the \"region\" bounding volume, it will also be rotated so that the up axis matched the world y axis.\r\n     * @param {Boolean} [properties.static = false] - If true, the tileset is considered static which improves performance but the matrices aren't automatically updated\r\n     * @param {String} [properties.rootPath = undefined] - optional the root path for fetching children\r\n     * @param {String} [properties.json = undefined] - optional json object representing the tileset sub-tree\r\n     * @param {Number} [properties.parentGeometricError = undefined] - optional geometric error of the parent\r\n     * @param {Object} [properties.parentBoundingVolume = undefined] - optional bounding volume of the parent\r\n     * @param {String} [properties.parentRefine = undefined] - optional refine strategy of the parent of the parent\r\n     * @param {THREE.Camera} [properties.cameraOnLoad = undefined] - optional the camera used when loading this particular sub-tile\r\n     * @param {OGC3DTile} [properties.parentTile = undefined] - optional the OGC3DTile object that loaded this tile as a child\r\n     * @param {String} [properties.proxy = undefined] - optional the url to a proxy service. Instead of fetching tiles via a GET request, a POST will be sent to the proxy url with the real tile address in the body of the request.\r\n     * @param {Boolean} [properties.displayErrors = false] - optional value indicating that errors should be shown on screen.\r\n     * @param {THREE.Renderer} [properties.renderer = undefined] - optional the renderer used to display the tileset. Used to infer render resolution at runtime and to instantiate a ktx2loader on the fly if not provided. \r\n     * @param {Number} [properties.domWidth = undefined] - optional the canvas width (used to calculate geometric error). If a renderer is provided, it'll be used instead, else a default value is used.  \r\n     * @param {Number} [properties.domHeight = undefined] - optional the canvas height (used to calculate geometric error). If a renderer is provided, it'll be used instead, else a default value is used.  \r\n     * @param {DracoLoader} [properties.dracoLoader = undefined] - optional a draco loader (three/addons).\r\n     * @param {KTX2Loader} [properties.ktx2Loader = undefined] - optional a ktx2 loader (three/addons).\r\n     * @param {Number} [properties.distanceBias = 1] - optional a bias that allows loading more or less detail closer to the camera relative to far away. The value should be a positive number. A value below 1 loads less detail near the camera and a value above 1 loads more detail near the camera. This needs to be compensated by the geometricErrorMultiplier in order to load a reasonable number of tiles.\r\n     * @param {String} [properties.loadingStrategy = \"INCREMENTAL\"] - optional a strategy for loading tiles \r\n     *      -  \"INCREMENTAL\" loads intermediate LODs and will load nearer tiles first\r\n     *      -  \"PERLEVEL\" loads intermediate LODs and loads nearer tiles first but waits for all tiles of the lowest level to be loaded before loading higher detail tiles\r\n     *      -  \"IMMEDIATE\" skips intermediate LODs. tiles are missing until loaded when moving to a new area\r\n     * @param {String} [properties.drawBoundingVolume = false] - optional draws the bounding volume (may cause flickering)\r\n     * @param {String} [properties.splatsFragmentShader = undefined] - optional pass a custom fragment shader for rendering splats\r\n     */\r\n    constructor(properties) {\r\n        super();\r\n        const self = this;\r\n        self.splatsMesh = properties.splatsMesh;\r\n        this.contentURL = [];\r\n        if (!!properties.domWidth && !!properties.domHeight) {\r\n            this.rendererSize = new THREE.Vector2(properties.domWidth, properties.domHeight);\r\n        } else {\r\n            this.rendererSize = new THREE.Vector2(1000, 1000);\r\n        }\r\n        this.loadingStrategy = properties.loadingStrategy ? properties.loadingStrategy.toUpperCase() : \"INCREMENTAL\";\r\n        this.distanceBias = Math.max(0.0001, properties.distanceBias ? properties.distanceBias : 1);\r\n        this.proxy = properties.proxy;\r\n        this.drawBoundingVolume = properties.drawBoundingVolume ? properties.drawBoundingVolume : false;\r\n        this.displayErrors = properties.displayErrors;\r\n        this.displayCopyright = properties.displayCopyright;\r\n        if (properties.queryParams) {\r\n            this.queryParams = { ...properties.queryParams };\r\n        }\r\n        this.uuid = uuidv4();\r\n        if (!!properties.tileLoader) {\r\n            this.tileLoader = properties.tileLoader;\r\n        } else {\r\n            const tileLoaderOptions = {};\r\n            tileLoaderOptions.meshCallback = !properties.meshCallback ? (mesh, geometricError) => {\r\n                mesh.material.wireframe = false;\r\n                mesh.material.side = THREE.DoubleSide;\r\n            } : properties.meshCallback;\r\n            tileLoaderOptions.pointsCallback = !properties.pointsCallback ? (points, geometricError) => {\r\n                points.material.size = Math.pow(geometricError, 0.33);\r\n                points.material.sizeAttenuation = true;\r\n            } : properties.pointsCallback;\r\n            tileLoaderOptions.proxy = this.proxy;\r\n            tileLoaderOptions.renderer = properties.renderer;\r\n            tileLoaderOptions.dracoLoader = properties.dracoLoader;\r\n            tileLoaderOptions.ktx2Loader = properties.ktx2Loader;\r\n            self.tileLoader = new TileLoader(tileLoaderOptions);\r\n            const update = this.update\r\n            this.update = (camera) => {\r\n                update.call(self, camera);\r\n                self.tileLoader.update();\r\n            }\r\n        }\r\n        this.displayCopyright = !!properties.displayCopyright;\r\n        // set properties general to the entire tileset\r\n        this.geometricErrorMultiplier = !!properties.geometricErrorMultiplier ? properties.geometricErrorMultiplier : 1.0;\r\n        this.splatsCropRadius = Number.MAX_VALUE;\r\n        this.splatsSizeMultiplier = 1;\r\n\r\n        this.renderer = properties.renderer;\r\n        this.meshCallback = properties.meshCallback;\r\n        this.loadOutsideView = properties.loadOutsideView;\r\n        this.cameraOnLoad = properties.cameraOnLoad;\r\n        this.parentTile = properties.parentTile;\r\n        this.occlusionCullingService = properties.occlusionCullingService;\r\n        this.static = properties.static;\r\n        if (this.occlusionCullingService) {\r\n            this.color = new THREE.Color();\r\n            this.color.setHex(Math.random() * 0xffffff);\r\n            this.colorID = THREE.MathUtils.clamp(self.color.r * 255, 0, 255) << 16 ^ THREE.MathUtils.clamp(self.color.g * 255, 0, 255) << 8 ^ THREE.MathUtils.clamp(self.color.b * 255, 0, 255) << 0;\r\n        }\r\n        if (this.static) {\r\n            this.matrixAutoUpdate = false;\r\n            this.matrixWorldAutoUpdate = false;\r\n        }\r\n\r\n        // declare properties specific to the tile for clarity\r\n        this.childrenTiles = [];\r\n        this.meshContent = [];\r\n        this.tileContent;\r\n        this.refine; // defaults to \"REPLACE\"\r\n        this.rootPath;\r\n        this.geometricError;\r\n        this.boundingVolume;\r\n        this.json; // the json corresponding to this tile\r\n        this.materialVisibility = false;\r\n        this.level = properties.level ? properties.level : 0;\r\n        this.hasMeshContent = 0; // true when the provided json has a content field pointing to a B3DM file\r\n        this.hasUnloadedJSONContent = 0; // true when the provided json has a content field pointing to a JSON file that is not yet loaded\r\n        this.centerModel = properties.centerModel;\r\n        this.abortController = new AbortController();\r\n\r\n        this.onLoadCallback = properties.onLoadCallback;\r\n        //this.layers.disable(0);\r\n        //this.octree = new Octree();\r\n\r\n        if (!!properties.json) { // If this tile is created as a child of another tile, properties.json is not null\r\n\r\n            self._setup(properties);\r\n\r\n\r\n        } else if (properties.url) { // If only the url to the tileset.json is provided\r\n            var url = properties.url;\r\n            if (self.queryParams) {\r\n                var props = \"\";\r\n                for (let key in self.queryParams) {\r\n                    if (self.queryParams.hasOwnProperty(key)) {\r\n                        props += \"&\" + key + \"=\" + self.queryParams[key];\r\n                    }\r\n                }\r\n                if (url.includes(\"?\")) {\r\n                    url += props;\r\n                } else {\r\n                    url += \"?\" + props.substring(1);\r\n                }\r\n            }\r\n\r\n\r\n            var fetchFunction;\r\n            if (self.proxy) {\r\n                fetchFunction = () => {\r\n                    return fetch(self.proxy,\r\n                        {\r\n                            method: 'POST',\r\n                            body: url,\r\n                            signal: self.abortController.signal\r\n                        }\r\n                    );\r\n                }\r\n            } else {\r\n                fetchFunction = () => {\r\n                    return fetch(url, { signal: self.abortController.signal });\r\n                }\r\n            }\r\n            fetchFunction().then(result => {\r\n                if (!result.ok) {\r\n                    throw new Error(`couldn't load \"${properties.url}\". Request failed with status ${result.status} : ${result.statusText}`);\r\n                }\r\n                result.json().then(json => { return resolveImplicite(json, url) }).then(json => {\r\n                    self._setup({ rootPath: path.dirname(properties.url), json: json });\r\n                });\r\n            }).catch(e => { if (self.displayErrors) _showError(e) });\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Specify a size multiplier for splats\r\n     * @param {number} sizeMultiplier \r\n     */\r\n    setSplatsSizeMultiplier(sizeMultiplier) {\r\n        this.splatsSizeMultiplier = sizeMultiplier;\r\n        if (this.splatsMesh) {\r\n            this.splatsMesh.setSplatsSizeMultiplier(this.splatsSizeMultiplier)\r\n        }\r\n    }\r\n    /**\r\n     * specify a crop radius for splats\r\n     * @param {number} cropRadius \r\n     */\r\n    setSplatsCropRadius(cropRadius) {\r\n        this.splatsCropRadius = cropRadius;\r\n        if (this.splatsMesh) {\r\n            this.splatsMesh.setSplatsCropRadius(this.splatsCropRadius)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Manually updates all the matrices of the tileset. \r\n     * To be called after transforming a {@link OGC3DTile tileset} instantiated with the \"static\" option\r\n     */\r\n    updateMatrices() {\r\n        this.updateMatrix();\r\n        if(this.splatsMesh) this.splatsMesh.updateMatrix();\r\n        if (this.static) {\r\n            this.traverse(o => {\r\n                if (o.isObject3D) {\r\n                    o.matrixWorldAutoUpdate = true;\r\n                }\r\n            });\r\n            if(this.splatsMesh) this.splatsMesh.matrixWorldAutoUpdate = true;\r\n        }\r\n        this.updateMatrixWorld(true);\r\n        \r\n        if (this.static) {\r\n            this.traverse(o => {\r\n                if (o.isObject3D) o.matrixWorldAutoUpdate = false;\r\n            });\r\n            if(this.splatsMesh) this.splatsMesh.matrixWorldAutoUpdate = false;\r\n        }\r\n    }\r\n    /**\r\n     * Call this to specify the canvas width/height when it changes (used to compute tiles geometric error that controls tile refinement).\r\n     * It's unnecessary to call this when the {@link OGC3DTile} is instantiated with the renderer.\r\n     * \r\n     * @param {Number} width \r\n     * @param {Number} height \r\n     */\r\n    setCanvasSize(width, height) {\r\n        this.rendererSize.set(width, height);\r\n    }\r\n\r\n    async _setup(properties) {\r\n        const self = this;\r\n\r\n        if (properties.json.extensionsRequired) {\r\n            if (properties.json.extensionsRequired.includes(\"JDULTRA_gaussian_splats\") || properties.json.extensionsRequired.includes(\"JDULTRA_gaussian_splats_V2\")) {\r\n                self.splatsMesh = new SplatsMesh(self.tileLoader.renderer)\r\n                self.splatsMesh.setSplatsCropRadius(self.splatsCropRadius)\r\n                self.splatsMesh.setSplatsSizeMultiplier(self.splatsSizeMultiplier)\r\n                if(self.static) self.splatsMesh.matrixWorldAutoUpdate = false;\r\n                self.add(self.splatsMesh);\r\n                self.updateMatrices();\r\n                \r\n            }\r\n        }\r\n        if (!!properties.json.root) {\r\n            self.json = properties.json.root;\r\n            if (!self.json.refine) self.json.refine = properties.json.refine;\r\n            if (!self.json.geometricError) self.json.geometricError = properties.json.geometricError;\r\n            if (!self.json.transform) self.json.transform = properties.json.transform;\r\n            if (!self.json.boundingVolume) self.json.boundingVolume = properties.json.boundingVolume;\r\n        } else {\r\n            self.json = properties.json;\r\n        }\r\n\r\n\r\n        if (!self.json.children) {\r\n            if (self.json.getChildren) {\r\n                self.json.children = await self.json.getChildren();\r\n            } else {\r\n                self.json.children = [];\r\n            }\r\n        }\r\n        self.rootPath = !!properties.json.rootPath ? properties.json.rootPath : properties.rootPath;\r\n\r\n        // decode refine\r\n        if (!!self.json.refine) {\r\n            self.refine = self.json.refine;\r\n        } else {\r\n            self.refine = properties.parentRefine;\r\n        }\r\n        // decode geometric error\r\n        if (!!self.json.geometricError) {\r\n            self.geometricError = self.json.geometricError;\r\n        } else {\r\n            self.geometricError = properties.parentGeometricError;\r\n        }\r\n\r\n\r\n        // decode transform\r\n        if (!!self.json.transform) {\r\n            let mat = new THREE.Matrix4();\r\n            mat.elements = self.json.transform;\r\n            self.applyMatrix4(mat);\r\n\r\n        }\r\n\r\n        /* self.matrixWorldNeedsUpdate = true;\r\n        //self.updateMatrix();\r\n        if (self.parentTile) {\r\n            self.parentTile.updateMatrixWorld(true);\r\n            //self.parentTile.updateWorldMatrix(true, true);\r\n        } */\r\n\r\n        // decode volume\r\n        if (!!self.json.boundingVolume) {\r\n            if (!!self.json.boundingVolume.box) {\r\n                self.boundingVolume = new OBB(self.json.boundingVolume.box);\r\n            } else if (!!self.json.boundingVolume.region) {\r\n                const region = self.json.boundingVolume.region;\r\n                self._transformWGS84ToCartesian(region[0], region[1], region[4], tempVec1);\r\n                self._transformWGS84ToCartesian(region[2], region[3], region[5], tempVec2);\r\n                tempVec1.lerp(tempVec2, 0.5);\r\n                self.boundingVolume = new THREE.Sphere(new THREE.Vector3(tempVec1.x, tempVec1.y, tempVec1.z), tempVec1.distanceTo(tempVec2));\r\n            } else if (!!self.json.boundingVolume.sphere) {\r\n                const sphere = self.json.boundingVolume.sphere;\r\n                self.boundingVolume = new THREE.Sphere(new THREE.Vector3(sphere[0], sphere[1], sphere[2]), sphere[3]);\r\n            } else {\r\n                self.boundingVolume = properties.parentBoundingVolume;\r\n            }\r\n        } else {\r\n            self.boundingVolume = properties.parentBoundingVolume;\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n        function _checkContent(e) {\r\n            if (!!e.uri && e.uri.includes(\"json\")) {\r\n                self.hasUnloadedJSONContent++;\r\n            } else if (!!e.url && e.url.includes(\"json\")) {\r\n                self.hasUnloadedJSONContent++;\r\n            } else {\r\n                self.hasMeshContent++;\r\n            }\r\n        }\r\n\r\n        if (!!self.json.content) { //if there is a content, json or otherwise, schedule it to be loaded \r\n            _checkContent(self.json.content);\r\n            if (self.hasMeshContent == 0) {\r\n                self.level = Math.max(0, self.parentTile ? self.parentTile.level + 0.01 : 0.0);\r\n            }\r\n            self._load();\r\n\r\n        } else if (!!self.json.contents) { //if there is a content, json or otherwise, schedule it to be loaded \r\n            self.json.contents.forEach(e => _checkContent(e))\r\n            if (self.hasMeshContent == 0) {\r\n                self.level = Math.max(0, self.parentTile ? self.parentTile.level + 0.01 : 0.0);\r\n            }\r\n\r\n            //scheduleLoadTile(this);\r\n        }\r\n\r\n\r\n        if (!!self.centerModel) {\r\n            tempVec2.copy(self.boundingVolume.center);\r\n\r\n            //tempSphere.applyMatrix4(self.matrixWorld);\r\n            if (!!this.json.boundingVolume.region) {\r\n                this._transformWGS84ToCartesian(\r\n                    (this.json.boundingVolume.region[0] + this.json.boundingVolume.region[2]) * 0.5,\r\n                    (this.json.boundingVolume.region[1] + this.json.boundingVolume.region[3]) * 0.5,\r\n                    (this.json.boundingVolume.region[4] + this.json.boundingVolume.region[5]) * 0.5,\r\n                    tempVec1);\r\n\r\n                tempQuaternion.setFromUnitVectors(tempVec1.normalize(), upVector.normalize());\r\n                self.applyQuaternion(tempQuaternion);\r\n            } else if (!!this.json.boundingVolume.box) {\r\n                // 从box的方向向量中提取旋转\r\n                const box = this.json.boundingVolume.box;\r\n                const xAxis = new THREE.Vector3(box[3], box[4], box[5]).normalize();\r\n                const yAxis = new THREE.Vector3(box[6], box[7], box[8]).normalize();\r\n                const zAxis = new THREE.Vector3(box[9], box[10], box[11]).normalize();\r\n                \r\n                // 创建旋转矩阵\r\n                const rotationMatrix = new THREE.Matrix4();\r\n                rotationMatrix.makeBasis(xAxis, yAxis, zAxis);\r\n                \r\n                // 从旋转矩阵中提取四元数\r\n                const quaternion = new THREE.Quaternion();\r\n                quaternion.setFromRotationMatrix(rotationMatrix);\r\n                \r\n                // 计算将y轴对齐到世界坐标系的旋转\r\n                const alignmentQuaternion = new THREE.Quaternion();\r\n                alignmentQuaternion.setFromUnitVectors(zAxis, upVector);\r\n                \r\n                // 应用180度水平旋转\r\n                const horizontalRotation = new THREE.Quaternion();\r\n                horizontalRotation.setFromAxisAngle(upVector, Math.PI);\r\n                \r\n                // 组合所有旋转：先应用原始旋转的逆，然后是垂直对齐，最后是水平旋转\r\n                self.quaternion.copy(horizontalRotation).multiply(alignmentQuaternion).multiply(quaternion.invert());\r\n            }\r\n            tempVec2.applyMatrix4(self.matrix);\r\n            self.position.sub(tempVec2);\r\n\r\n            self.updateMatrices();\r\n            //self.updateMatrixWorld(true);\r\n        }\r\n        if (self.onLoadCallback) self.onLoadCallback(self);\r\n        self.isSetup = true;\r\n\r\n\r\n        if (self.level > 0 && self.drawBoundingVolume) {\r\n            if (self.bbox) {\r\n                console.log(\"double setup\")\r\n            }\r\n            if (this.boundingVolume.aabb) {\r\n                let box = this.boundingVolume.aabb.clone();\r\n                box.applyMatrix4(this.matrixWorld);\r\n                self.bbox = new THREE.Box3Helper(box, new THREE.Color(Math.random(), Math.random(), Math.random()));\r\n                //self.bbox.renderOrder = -1;\r\n                self.add(self.bbox);\r\n                self.bbox.material.visible = false;\r\n            } else if (self.boundingVolume instanceof OBB) {\r\n                self.bbox = self.boundingVolume.helper();\r\n                self.add(self.bbox);\r\n                self.bbox.material.visible = false;\r\n            }\r\n        }\r\n\r\n    }\r\n    _assembleURL(root, relative) {\r\n        // Append a slash to the root URL if it doesn't already have one\r\n        if (!root.endsWith('/')) {\r\n            root += '/';\r\n        }\r\n\r\n        const rootUrl = new URL(root);\r\n        let rootParts = rootUrl.pathname.split('/').filter(p => p !== '');\r\n        let relativeParts = relative.split('/').filter(p => p !== '');\r\n\r\n        for (let i = 1; i <= rootParts.length; i++) {\r\n            if (i >= relativeParts.length) break;\r\n            const rootToken = rootParts.slice(rootParts.length - i, rootParts.length).join('/');\r\n            const relativeToken = relativeParts.slice(0, i).join('/');\r\n            if (rootToken === relativeToken) {\r\n                for (let j = 0; j < i; j++) {\r\n                    rootParts.pop();\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n\r\n        while (relativeParts.length > 0 && relativeParts[0] === '..') {\r\n            rootParts.pop();\r\n            relativeParts.shift();\r\n        }\r\n\r\n        return `${rootUrl.protocol}//${rootUrl.host}/${[...rootParts, ...relativeParts].join('/')}`;\r\n    }\r\n\r\n    _extractQueryParams(url, params) {\r\n        const urlObj = new URL(url);\r\n\r\n        // Iterate over all the search parameters\r\n        for (let [key, value] of urlObj.searchParams) {\r\n            params[key] = value;\r\n        }\r\n\r\n        // Remove the query string\r\n        urlObj.search = '';\r\n        return urlObj.toString();\r\n    }\r\n    async _load(loadJson = true, loadMesh = true) {\r\n\r\n        var self = this;\r\n        if (self.deleted) return;\r\n        if (!!self.json.content) {\r\n            await loadContent(self.json.content, null, loadJson, loadMesh);\r\n        } else if (!!self.json.contents) {\r\n            let promises = self.json.contents.map((content, index) => loadContent(content, index, loadJson, loadMesh));\r\n\r\n            Promise.all(promises)\r\n            //self.json.contents.forEach(content=> loadContent(content, i))\r\n        }\r\n\r\n        async function loadContent(content, contentIndex, loadJson, loadMesh) {\r\n            let url;\r\n            if (!!content.uri) {\r\n                url = content.uri;\r\n            } else if (!!content.url) {\r\n                url = content.url;\r\n            }\r\n            const urlRegex = /^(?:http|https|ftp|tcp|udp):\\/\\/\\S+/;\r\n\r\n            if (urlRegex.test(self.rootPath)) { // url\r\n\r\n                if (!urlRegex.test(url)) {\r\n                    url = self._assembleURL(self.rootPath, url);\r\n                }\r\n            } else { //path\r\n                if (path.isAbsolute(self.rootPath)) {\r\n                    url = self.rootPath + path.sep + url;\r\n                }\r\n            }\r\n            url = self._extractQueryParams(url, self.queryParams);\r\n            if (self.queryParams) {\r\n                var props = \"\";\r\n                for (let key in self.queryParams) {\r\n                    if (self.queryParams.hasOwnProperty(key)) { // This check is necessary to skip properties from the object's prototype chain\r\n                        props += \"&\" + key + \"=\" + self.queryParams[key];\r\n                    }\r\n                }\r\n                if (url.includes(\"?\")) {\r\n                    url += props;\r\n                } else {\r\n                    url += \"?\" + props.substring(1);\r\n                }\r\n            }\r\n\r\n            if (!!url) {\r\n                self.contentURL.push(url);\r\n                if (loadMesh && (url.includes(\".b3dm\") || url.includes(\".glb\") || url.includes(\".gltf\"))) {\r\n\r\n                    try {\r\n\r\n                        self.tileLoader.get(self.abortController, self.uuid, url, mesh => {\r\n\r\n                            if (!!self.deleted) {\r\n                                return;\r\n                            }\r\n                            if (mesh.asset && mesh.asset.copyright) {\r\n                                mesh.asset.copyright.split(';').forEach(s => {\r\n                                    if (!!copyright[s]) {\r\n                                        copyright[s]++;\r\n                                    } else {\r\n                                        copyright[s] = 1;\r\n                                    }\r\n                                });\r\n                                if (self.displayCopyright) {\r\n                                    _updateCopyrightLabel();\r\n                                }\r\n                            }\r\n\r\n                            self.meshContent.push(mesh);\r\n                            if (!self.splatsMesh) {\r\n                                mesh.traverse((o) => {\r\n                                    if (o.isMesh || o.isPoints) {\r\n                                        o.layers.disable(0);\r\n\r\n                                        //if(o.material.transparent) o.layers.enable(31);\r\n                                    }\r\n                                    if (o.isMesh) {\r\n\r\n                                        if (self.occlusionCullingService) {\r\n                                            const position = o.geometry.attributes.position;\r\n                                            const colors = [];\r\n                                            for (let i = 0; i < position.count; i++) {\r\n                                                colors.push(self.color.r, self.color.g, self.color.b);\r\n                                            }\r\n                                            o.geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));\r\n                                        }\r\n\r\n                                        //o.material.visible = false;\r\n                                    }\r\n                                });\r\n                                self.add(mesh);\r\n                                self.updateMatrices();\r\n                            }\r\n\r\n\r\n                        }, !self.cameraOnLoad ? () => 0 : () => {\r\n                            /* if (self.parentTile && (self.parentTile.metric != undefined && self.parentTile.metric < 0) || self.parentTile.deleted) {\r\n                                return Number.MAX_VALUE;\r\n                            }  */\r\n\r\n                            if (self.loadingStrategy == \"IMMEDIATE\") {\r\n                                return self._calculateDistanceToCamera(self.cameraOnLoad);\r\n                            }\r\n                            if (self.loadingStrategy == \"INCREMENTAL\") {\r\n\r\n                                if (self.parentTile) {\r\n                                    return self.parentTile._calculateDistanceToCamera(self.cameraOnLoad) / Math.max(1, self.parentTile.level);\r\n                                } else {\r\n                                    return self._calculateDistanceToCamera(self.cameraOnLoad) / Math.max(1, self.level);\r\n                                }\r\n                                /* if (self.parentTile) {\r\n                                    if(self.parentTile.materialVisibility) return 0;\r\n                                    return 1/self.parentTile._calculateDistanceToCamera(self.cameraOnLoad);\r\n                                } else {\r\n                                    return 0;\r\n                                } */\r\n                            }\r\n                            if (self.loadingStrategy == \"PERLEVEL\") {\r\n                                if (self.parentTile) {\r\n                                    return self.level + self.parentTile._calculateDistanceToCamera(self.cameraOnLoad);\r\n                                } else {\r\n                                    return self.level + self._calculateDistanceToCamera(self.cameraOnLoad);\r\n                                }\r\n                            }\r\n                            return 0;\r\n\r\n                            /* let multiplier = 1;\r\n                            if ((self.metric!=undefined && self.metric < 0) || self.deleted) multiplier = 2;\r\n                            if (self.parentTile) {\r\n                                return self.parentTile._calculateDistanceToCamera(self.cameraOnLoad) * multiplier * self.level;\r\n                            } else {\r\n                                return self._calculateDistanceToCamera(self.cameraOnLoad) * multiplier * self.level;\r\n                            } */\r\n                        }, () => self._getSiblings(),\r\n                            self.level,\r\n                            self.loadingStrategy,\r\n                            !!self.json.boundingVolume.region ? false : true,\r\n                            !!self.json.boundingVolume.region,\r\n                            self.geometricError,\r\n                            self.splatsMesh\r\n                        );\r\n                    } catch (e) {\r\n                        if (self.displayErrors) _showError(e)\r\n                    }\r\n\r\n\r\n                } else if (loadJson && url.includes(\".json\")) {\r\n                    self.jsonRequested = url;\r\n                    self.tileLoader.get(self.abortController, self.uuid, url, async json => {\r\n                        self.jsonReceived = true;\r\n                        if (!!self.deleted) return;\r\n\r\n                        json.rootPath = path.dirname(url);\r\n                        self.json.children.push(json);\r\n                        if (contentIndex == null) {\r\n                            delete self.json.content;\r\n                        } else {\r\n                            delete self.json.contents.splice(contentIndex, 1);\r\n                        }\r\n\r\n                        self.hasUnloadedJSONContent--;\r\n                        /* self.matrixWorldNeedsUpdate = true;\r\n                        self.updateMatrix();\r\n                        if (self.parentTile) {\r\n                            self.parentTile.updateMatrixWorld(true);\r\n                            //self.parentTile.updateWorldMatrix(true, true);\r\n                        } */\r\n                    });\r\n\r\n                }\r\n\r\n\r\n                /* self.matrixWorldNeedsUpdate = true;\r\n                self.updateMatrix();\r\n                if (self.parentTile) {\r\n                    self.parentTile.updateMatrixWorld(true);\r\n                    //self.parentTile.updateWorldMatrix(true, true);\r\n                } */\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Disposes of all the resources used by the tileset.\r\n     */\r\n    dispose() {\r\n        const self = this;\r\n\r\n\r\n        self.meshContent.forEach(mc => {\r\n            if (!!mc && !!mc.asset && mc.asset.copyright) {\r\n                mc.asset.copyright.split(';').forEach(s => {\r\n                    if (!!copyright[s]) {\r\n                        copyright[s]--;\r\n                    }\r\n                });\r\n                if (self.displayCopyright) {\r\n                    _updateCopyrightLabel();\r\n                }\r\n            }\r\n        })\r\n\r\n\r\n\r\n        self.childrenTiles.forEach(tile => tile.dispose());\r\n        self.deleted = true;\r\n\r\n        if (self.splatsMesh) {\r\n\r\n            self.meshContent.forEach(splat => splat.hide());\r\n            if (!self.parentTile) {\r\n                self.splatsMesh.dispose();\r\n                self.splatsMesh = undefined;\r\n            }\r\n        }\r\n        if (!!self.contentURL) {\r\n            self.contentURL.forEach(url => {\r\n                self.tileLoader.invalidate(url, self.uuid);\r\n            })\r\n            self.contentURL = [];\r\n        }\r\n\r\n        if (!!self.abortController && !self.jsonRequested) { // abort tile request\r\n            self.abortController.abort(\"tile not needed\");\r\n        }\r\n        this.parent = null;\r\n        self.meshContent = [];\r\n        if (self.bbox) self.bbox.dispose();\r\n        //this.parentTile = null;\r\n        this.dispatchEvent({ type: 'removed' });\r\n    }\r\n    _disposeMeshContent() {\r\n        const self = this;\r\n        if (!!self.deleted) return;\r\n        self.deleted = true;\r\n        if (!!self.abortController) { // abort tile request\r\n            self.abortController.abort(\"tile not needed\");\r\n            self.abortController = new AbortController();\r\n        }\r\n        for (let i = self.meshContent.length - 1; i >= 0; i--) {\r\n            const mc = self.meshContent[i];\r\n            if (!!mc && !!mc.asset && mc.asset.copyright) {\r\n                mc.asset.copyright.split(';').forEach(s => {\r\n                    if (!!copyright[s]) {\r\n                        copyright[s]--;\r\n                    }\r\n                });\r\n                if (self.displayCopyright) {\r\n                    _updateCopyrightLabel();\r\n                }\r\n            }\r\n\r\n            self.remove(mc);\r\n        }\r\n        if (self.splatsMesh) {\r\n            self.meshContent.forEach(splat => splat.hide());\r\n        }\r\n        self.meshContent = [];\r\n        self.contentURL.forEach(url => {\r\n            //console.log(url)\r\n            self.tileLoader.invalidate(url, self.uuid);\r\n        })\r\n        self.contentURL = [];\r\n\r\n    }\r\n    _disposeChildren() {\r\n        var self = this;\r\n\r\n        self.childrenTiles.forEach(tile => {\r\n            tile.dispose();\r\n            self.remove(tile)\r\n        });\r\n        self.childrenTiles = [];\r\n        /* self.children = [];\r\n        if (self.meshContent.length > 0) {\r\n            self.meshContent.forEach(mc => {\r\n                self.children.push(mc);\r\n            });\r\n        } */\r\n    }\r\n\r\n    raycast(raycaster, intersects) {\r\n        //console.log(\"raycast\")\r\n        if (!this.splatsMesh) {\r\n            return super.raycast(raycaster, intersects);\r\n        } else {\r\n            tempRay.copy(raycaster.ray);\r\n            inverseWorld.copy(this.matrixWorld).invert();\r\n            tempRay.applyMatrix4(inverseWorld);\r\n            let intersection = false;\r\n            if (this.boundingVolume instanceof OBB) {\r\n                intersection = this.boundingVolume.intersectsRay(tempRay);\r\n            } else if (this.boundingVolume instanceof THREE.Sphere) {\r\n                //sphere\r\n                intersection = ray.intersectsSphere(this.boundingVolume);\r\n            } else {\r\n                return false;\r\n\r\n            }\r\n            if (intersection && this.materialVisibility && !!this.splatsReady) {\r\n                tempIntersects.length = 0;\r\n                this.meshContent.forEach(mc => {\r\n                    if (mc.isSplatsBatch) {\r\n                        mc.raycast(tempRay, tempIntersects, raycaster.params.Points.threshold);\r\n                        tempIntersects.forEach(t => {\r\n                            t.point.applyMatrix4(this.matrixWorld);\r\n                        }),\r\n                            intersects.push(...tempIntersects);\r\n                    }\r\n                })\r\n            }\r\n\r\n            return intersection;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * To be called in the render loop.\r\n     * @param {THREE.Camera} camera a camera that the tileset will be rendered with.\r\n     * @returns {{numTilesLoaded: number, numTilesRendered: number, maxLOD: number, percentageLoaded: number}} An object containing describing the current state of the loaded tileset.\r\n     */\r\n    update(camera) {\r\n        const frustum = new THREE.Frustum();\r\n        frustum.setFromProjectionMatrix(new THREE.Matrix4().multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse));\r\n\r\n\r\n\r\n        let numTiles = [0];\r\n        let numTilesRendered = [0];\r\n        let maxLOD = [0];\r\n        let percentageLoaded = [0];\r\n        if (this.refine == \"REPLACE\") {\r\n            switch (this.loadingStrategy) {\r\n                case \"IMMEDIATE\": this._updateImmediate(camera, frustum); this._statsImmediate(maxLOD, numTiles, percentageLoaded, numTilesRendered); break;\r\n                default: this._update(camera, frustum); this._stats(maxLOD, numTiles, percentageLoaded, numTilesRendered);\r\n            }\r\n        } else {\r\n            this._update(camera, frustum);\r\n            this._stats(maxLOD, numTiles, percentageLoaded, numTilesRendered);\r\n        }\r\n\r\n        if (numTiles > 0) {\r\n            percentageLoaded[0] /= numTiles[0];\r\n        }\r\n\r\n        //// sort ////\r\n        if (this.splatsMesh) {\r\n            transformedCameraPosition.copy(camera.position);\r\n            inverseWorld.copy(this.matrixWorld).invert();\r\n            transformedCameraPosition.applyMatrix4(inverseWorld);\r\n\r\n            this.splatsMesh.sort(transformedCameraPosition);\r\n        }\r\n\r\n        return { numTilesLoaded: numTiles[0], numTilesRendered: numTilesRendered[0], maxLOD: maxLOD[0], percentageLoaded: percentageLoaded[0] }\r\n    }\r\n\r\n    _updateImmediate(camera, frustum) {\r\n        this._computeMetricRecursive(camera, frustum);\r\n        this._updateNodeVisibilityImmediate();\r\n        this._expandTreeImmediate(camera);\r\n        this.shouldBeVisible = this.metric > 0 ? true : !!this.loadOutsideView;\r\n        this._shouldBeVisibleUpdateImmediate();\r\n        this._trimTreeImmediate();\r\n        this._loadMeshImmediate();\r\n\r\n\r\n    }\r\n\r\n\r\n    _statsImmediate(maxLOD, numTiles, percentageLoaded, numTilesRendered) {\r\n        maxLOD[0] = Math.max(maxLOD[0], this.level);\r\n        if (this.shouldBeVisible || !!this.materialVisibility) {\r\n            numTiles[0]++;\r\n            if (!!this.materialVisibility) percentageLoaded[0]++;\r\n        }\r\n        if (!!this.materialVisibility) numTilesRendered[0]++;\r\n\r\n\r\n        this.childrenTiles.forEach(child => {\r\n            child._statsImmediate(maxLOD, numTiles, percentageLoaded, numTilesRendered);\r\n        })\r\n    }\r\n    _stats(maxLOD, numTiles, percentageLoaded, numTilesRendered) {\r\n        maxLOD[0] = Math.max(maxLOD[0], this.level);\r\n        if (this.hasMeshContent) {\r\n            numTiles[0]++;\r\n            if (this.meshContent.length == this.hasMeshContent) percentageLoaded[0]++;\r\n            if (!!this.materialVisibility) numTilesRendered[0]++;\r\n        }\r\n\r\n\r\n        this.childrenTiles.forEach(child => {\r\n            child._stats(maxLOD, numTiles, percentageLoaded, numTilesRendered);\r\n        })\r\n    }\r\n\r\n\r\n\r\n    _trimTreeImmediate() {\r\n        if (this.metric == undefined) return;\r\n\r\n        else if (this.hasMeshContent && ((this.shouldBeVisible && this.materialVisibility))) {\r\n            if (self.splatsMesh && !self.splatsReady) {\r\n                return;\r\n            }\r\n            this._disposeChildren();\r\n        } else {\r\n            this.childrenTiles.forEach(child => {\r\n                child._trimTreeImmediate();\r\n            })\r\n        }\r\n\r\n    }\r\n    _updateNodeVisibilityImmediate(parentDisplaysMesh = false) {\r\n        //updateNodeVisibilityCount++;\r\n\r\n        const self = this;\r\n        if (!self.hasMeshContent) {\r\n            self.childrenTiles.forEach(child => {\r\n                child._updateNodeVisibilityImmediate(parentDisplaysMesh);\r\n            })\r\n            return;\r\n        }\r\n\r\n        if (self.shouldBeVisible) {\r\n            if (self.meshContent.length == self.hasMeshContent) {\r\n                if (!self.materialVisibility) {\r\n                    //console.log(!!self.splatsReady)\r\n                    self._changeContentVisibility(true);\r\n                    self.childrenTiles.forEach(child => {\r\n                        child._updateNodeVisibilityImmediate(parentDisplaysMesh);\r\n                    })\r\n                } else {\r\n                    self.childrenTiles.forEach(child => {\r\n                        child._updateNodeVisibilityImmediate(true);\r\n                    })\r\n                }\r\n\r\n            } else {\r\n                self.childrenTiles.forEach(child => {\r\n                    child._updateNodeVisibilityImmediate(parentDisplaysMesh);\r\n                })\r\n            }\r\n        } else {\r\n            if (!self.loadOutsideView && self.metric < 0) {\r\n                self._changeContentVisibility(false);\r\n                if (self.meshContent.length > 0) self._disposeMeshContent();\r\n                self.childrenTiles.forEach(child => {\r\n                    child._updateNodeVisibilityImmediate(true);\r\n                })\r\n                return;\r\n            }\r\n\r\n            if (self.materialVisibility && (!self.splatsMesh || !!self.splatsReady)) {\r\n\r\n                if (parentDisplaysMesh) {\r\n                    self._changeContentVisibility(false);\r\n                    if (self.meshContent.length > 0) self._disposeMeshContent();\r\n                    self.childrenTiles.forEach(child => {\r\n                        child._updateNodeVisibilityImmediate(parentDisplaysMesh);\r\n                    })\r\n                } else {\r\n                    let allChildrenReady = true;\r\n                    self.childrenTiles.every(child => {\r\n\r\n                        if (!child._isReadyImmediate()) {\r\n                            allChildrenReady = false;\r\n                            return false;\r\n                        }\r\n                        return true;\r\n                    });\r\n                    if (allChildrenReady && self.childrenTiles.length > 0) {\r\n                        self._changeContentVisibility(false);\r\n                        if (self.meshContent.length > 0) self._disposeMeshContent();\r\n                        self.childrenTiles.forEach(child => {\r\n                            child._updateNodeVisibilityImmediate(parentDisplaysMesh);\r\n                        })\r\n                    } else {\r\n\r\n                        self.childrenTiles.forEach(child => {\r\n                            child._updateNodeVisibilityImmediate((!self.splatsMesh || !!self.splatsReady));\r\n                        })\r\n                    }\r\n                }\r\n\r\n            } else {\r\n\r\n                self.childrenTiles.forEach(child => {\r\n                    child._updateNodeVisibilityImmediate(parentDisplaysMesh);\r\n                })\r\n            }\r\n        }\r\n\r\n\r\n\r\n    }\r\n    _shouldBeVisibleUpdateImmediate() {\r\n        const self = this;\r\n        if (!self.hasMeshContent) {\r\n\r\n            self.childrenTiles.forEach(child => {\r\n                child.shouldBeVisible = true;\r\n                child._shouldBeVisibleUpdateImmediate();\r\n            })\r\n            self.shouldBeVisible = false;\r\n\r\n        }\r\n        else if (self.metric == undefined) {\r\n            self.shouldBeVisible = false;\r\n        }\r\n        else if (self.metric < 0) {\r\n            self.shouldBeVisible = !!self.loadOutsideView;\r\n            self.childrenTiles.forEach(child => {\r\n                child._setShouldNotBeVisibleRecursive();\r\n            });\r\n        }\r\n        else if (self.metric < self.geometricErrorMultiplier * self.geometricError) {\r\n            if (self.hasUnloadedJSONContent) {\r\n                //self.shouldBeVisible = true;\r\n\r\n            } else {\r\n                if (!!self.json && !!self.json.children && self.json.children.length > 0) {\r\n                    self.shouldBeVisible = false;\r\n                    self.childrenTiles.forEach(child => {\r\n                        child.shouldBeVisible = true;\r\n                        child._shouldBeVisibleUpdateImmediate();\r\n                    })\r\n\r\n                } else {\r\n                    self.shouldBeVisible = true;\r\n\r\n                }\r\n            }\r\n\r\n        } else {\r\n\r\n            self.childrenTiles.forEach(child => {\r\n                child._setShouldNotBeVisibleRecursive();\r\n            });\r\n        }\r\n    }\r\n\r\n    _setShouldNotBeVisibleRecursive() {\r\n        const self = this;\r\n        self.shouldBeVisible = false;\r\n        self.childrenTiles.forEach(child => {\r\n            child._setShouldNotBeVisibleRecursive();\r\n        })\r\n    }\r\n    _loadMeshImmediate() {\r\n        const self = this;\r\n        if (!self.hasMeshContent) {\r\n            self.childrenTiles.forEach(child => {\r\n                child._loadMeshImmediate();\r\n            });\r\n            return;\r\n        }\r\n        if (self.shouldBeVisible) {\r\n            if (self.meshContent.length < self.hasMeshContent &&\r\n                self.contentURL.length == 0) {\r\n\r\n                self.deleted = false;\r\n\r\n                self._load(false, true);\r\n            }\r\n        } else {\r\n            self.childrenTiles.forEach(child => {\r\n                child._loadMeshImmediate();\r\n            })\r\n        }\r\n\r\n    }\r\n\r\n    _computeMetricRecursive(camera, frustum) {\r\n        const self = this;\r\n        self.metric = -1;\r\n        if (!self.isSetup) return;\r\n\r\n        if (!!self.boundingVolume && !!self.geometricError) {\r\n            self.metric = self._calculateUpdateMetric(camera, frustum);\r\n        }\r\n        self.childrenTiles.forEach(child => child._computeMetricRecursive(camera, frustum));\r\n\r\n\r\n    }\r\n\r\n\r\n    _expandTreeImmediate(camera) {\r\n        const self = this;\r\n\r\n        if (!self.hasUnloadedJSONContent) {\r\n            if (!self.hasMeshContent) {\r\n                if (!!self.json && !!self.json.children && self.childrenTiles.length < self.json.children.length) {\r\n                    self._loadJsonChildren(camera);\r\n\r\n                }\r\n            } else {\r\n                if (self.occlusionCullingService && self.hasMeshContent && !self.occlusionCullingService.hasID(self.colorID)) {\r\n                    // don't load children\r\n                } else {\r\n                    if (self.metric >= 0 && self.metric < self.geometricErrorMultiplier * self.geometricError &&\r\n                        !!self.json && !!self.json.children && self.childrenTiles.length < self.json.children.length\r\n                    ) {\r\n                        self._loadJsonChildren(camera);\r\n                    }\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        self.childrenTiles.forEach(child => child._expandTreeImmediate(camera));\r\n    }\r\n\r\n\r\n    _update(camera, frustum) {\r\n        const self = this;\r\n\r\n        if (!self.isSetup) return;\r\n        // let dist = self.boundingVolume.distanceToPoint(new THREE.Vector3(3980, 4980.416656099139, 3.2851604304346775));\r\n        // if (dist< 1) {\r\n        //     self._changeContentVisibility(false);\r\n        //     console.log(dist+\" \"+self.level)\r\n        // }\r\n        const visibilityBeforeUpdate = self.materialVisibility;\r\n\r\n        if (!!self.boundingVolume && !!self.geometricError) {\r\n            self.metric = self._calculateUpdateMetric(camera, frustum);\r\n        }\r\n        self.childrenTiles.forEach(child => child._update(camera, frustum));\r\n\r\n        _updateNodeVisibility(self.metric);\r\n        _updateTree(self.metric);\r\n        _trimTree(self.metric, visibilityBeforeUpdate);\r\n\r\n\r\n\r\n        function _updateTree(metric) {\r\n            // If this tile does not have mesh content but it has children\r\n            if (metric < 0 && self.hasMeshContent) return;\r\n            if (self.occlusionCullingService && self.hasMeshContent && !self.occlusionCullingService.hasID(self.colorID)) {\r\n                return;\r\n            }\r\n            if (!self.hasMeshContent || (metric <= self.geometricErrorMultiplier * self.geometricError && (self.meshContent.length > 0 || self.splatsMesh))) {\r\n                if (!!self.json && !!self.json.children && self.childrenTiles.length != self.json.children.length) {\r\n                    self._loadJsonChildren(camera);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        function _updateNodeVisibility(metric) {\r\n\r\n            // outside frustum\r\n            if (metric < 0) {\r\n                self.inFrustum = false;\r\n                self._changeContentVisibility(!!self.loadOutsideView);\r\n                return;\r\n            } else {\r\n                self.inFrustum = true;\r\n            }\r\n            //doesn't have a mesh content\r\n            if (!self.hasMeshContent) return;\r\n\r\n            // mesh content not yet loaded\r\n            if (self.meshContent.length < self.hasMeshContent) {\r\n                return;\r\n            }\r\n\r\n\r\n\r\n\r\n            // has no children\r\n            if (self.childrenTiles.length == 0) {\r\n                self._changeContentVisibility(true);\r\n                return;\r\n            }\r\n\r\n            // has children\r\n            if (metric >= self.geometricErrorMultiplier * self.geometricError) { // Ideal LOD or before this lod\r\n\r\n                self._changeContentVisibility(true);\r\n            } else if (metric < self.geometricErrorMultiplier * self.geometricError) { // Ideal LOD is past this one\r\n                // if children are visible and have been displayed, can be hidden\r\n                if (self.refine == \"REPLACE\") {\r\n                    let allChildrenReady = true;\r\n                    self.childrenTiles.every(child => {\r\n\r\n                        if (!child._isReady()) {\r\n                            allChildrenReady = false;\r\n                            return false;\r\n                        }\r\n                        return true;\r\n                    });\r\n                    if (allChildrenReady) {\r\n                        self._changeContentVisibility(false);\r\n                    }\r\n                    else {\r\n                        self._changeContentVisibility(true);\r\n                    }\r\n                }\r\n\r\n\r\n            }\r\n        }\r\n\r\n\r\n\r\n        function _trimTree(metric, visibilityBeforeUpdate) {\r\n            if (!self.hasMeshContent) return;\r\n            if (!self.inFrustum) { // outside frustum\r\n                self._disposeChildren();\r\n                //_updateNodeVisibility(metric);\r\n                return;\r\n            }\r\n            if (self.occlusionCullingService &&\r\n                !visibilityBeforeUpdate &&\r\n                self.hasMeshContent &&\r\n                self.meshContent.length > 0 &&\r\n                self.materialVisibility &&\r\n                self._areAllChildrenLoadedAndHidden()) {\r\n\r\n                if (self.splatsMesh && this.materialVisibility && !self.splatsReady) {\r\n                    return;\r\n                }\r\n                self._disposeChildren();\r\n                //_updateNodeVisibility(metric);\r\n                return;\r\n            }\r\n            if (metric >= self.geometricErrorMultiplier * self.geometricError) {\r\n                if (self.splatsMesh && self.materialVisibility && !self.splatsReady) {\r\n                    return;\r\n                }\r\n                self._disposeChildren();\r\n                //_updateNodeVisibility(metric);\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n\r\n\r\n    }\r\n\r\n    _loadJsonChildren(camera) {\r\n        const self = this;\r\n        for (let i = self.json.children.length - 1; i >= 0; i--) {\r\n            if (!self.json.children[i].root && !self.json.children[i].children && !self.json.children[i].getChildren && !self.json.children[i].content && !self.json.children[i].contents) {\r\n                self.json.children.splice(i, 1);\r\n            }\r\n        }\r\n        self.json.children.forEach(childJSON => {\r\n\r\n            let childTile = new OGC3DTile({\r\n                parentTile: self,\r\n                queryParams: self.queryParams,\r\n                parentGeometricError: self.geometricError,\r\n                parentBoundingVolume: self.boundingVolume,\r\n                parentRefine: self.refine,\r\n                json: childJSON,\r\n                rootPath: self.rootPath,\r\n                geometricErrorMultiplier: self.geometricErrorMultiplier,\r\n                loadOutsideView: self.loadOutsideView,\r\n                level: Math.floor(self.level) + 1,\r\n                tileLoader: self.tileLoader,\r\n                cameraOnLoad: camera,\r\n                occlusionCullingService: self.occlusionCullingService,\r\n                renderer: self.renderer,\r\n                static: self.static,\r\n                centerModel: false,\r\n                displayErrors: self.displayErrors,\r\n                displayCopyright: self.displayCopyright,\r\n                distanceBias: self.distanceBias,\r\n                loadingStrategy: self.loadingStrategy,\r\n                drawBoundingVolume: self.drawBoundingVolume,\r\n                splatsMesh: self.splatsMesh\r\n            });\r\n            self.childrenTiles.push(childTile);\r\n            self.add(childTile);\r\n        });\r\n\r\n        self.updateMatrices(true);\r\n    }\r\n\r\n    _areAllChildrenLoadedAndHidden() {\r\n        let allLoadedAndHidden = true;\r\n        const self = this;\r\n        this.childrenTiles.every(child => {\r\n            if (child.hasMeshContent) {\r\n                if (child.childrenTiles.length > 0) {\r\n                    allLoadedAndHidden = false;\r\n                    return false;\r\n                }\r\n                if (!child.metric < 0) {\r\n                    return true;\r\n                };\r\n                if (child.materialVisibility && (!self.splatsMesh || !!self.splatsReady)) {\r\n                    allLoadedAndHidden = false;\r\n                    return false;\r\n                } else if (self.occlusionCullingService.hasID(child.colorID)) {\r\n                    allLoadedAndHidden = false;\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (!child._areAllChildrenLoadedAndHidden()) {\r\n                    allLoadedAndHidden = false;\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n        return allLoadedAndHidden;\r\n    }\r\n\r\n    /**\r\n     * Node is ready if it is outside frustum, if it was drawn at least once or if all it's children are ready\r\n     * @returns true if ready\r\n     */\r\n    _isReady() {\r\n\r\n        // if outside frustum\r\n        if (this.metric == undefined) {\r\n            return false;\r\n        }\r\n        if (this.metric < 0) {\r\n            return true;\r\n        }\r\n        // if json is not done loading\r\n        if (this.hasUnloadedJSONContent) {\r\n            return false;\r\n        }\r\n        // if empty tile\r\n        if (!this.hasMeshContent && this.json.children.length == 0 && !this.hasUnloadedJSONContent) {\r\n            return true;\r\n        }\r\n        // if this tile has no mesh content or if it's marked as visible false, look at children\r\n        if ((!this.hasMeshContent || this.meshContent.length == 0 || (!this.materialVisibility))) {\r\n            if (this.children.length > 0) {\r\n                var allChildrenReady = true;\r\n                this.childrenTiles.every(child => {\r\n                    if (!child._isReady()) {\r\n                        allChildrenReady = false;\r\n                        //console.log(child.level)\r\n                        return false;\r\n                    }\r\n                    return true;\r\n                });\r\n                return allChildrenReady;\r\n            } else {\r\n                return false\r\n            }\r\n\r\n        }\r\n\r\n\r\n        // if this tile has no mesh content\r\n        if (!this.hasMeshContent) {\r\n            return true;\r\n        }\r\n        // if mesh content not yet loaded\r\n        if (this.meshContent.length < this.hasMeshContent) {\r\n            return false;\r\n        }\r\n\r\n\r\n        if (this.materialVisibility) {\r\n            return true;\r\n        }\r\n\r\n\r\n\r\n        return false;\r\n\r\n    }\r\n\r\n    _isReadyImmediate() {\r\n\r\n        if (!!this.materialVisibility || (!this.loadOutsideView && this.metric < 0)) {\r\n            return true;\r\n        } else {\r\n            /* if (this.splatsMesh) {\r\n                if (this.splatsReady) {\r\n                    return true\r\n                } else {\r\n                    return false;\r\n                }\r\n            } else {\r\n                return false;\r\n            } */\r\n            //return false;\r\n            if (this.childrenTiles.length > 0) {\r\n                var allChildrenReady = true;\r\n                this.childrenTiles.every(child => {\r\n                    if (!child._isReadyImmediate()) {\r\n                        allChildrenReady = false;\r\n                        return false;\r\n                    }\r\n                    return true;\r\n                });\r\n                return allChildrenReady;\r\n            } else {\r\n                return false;\r\n                /* if (this.splatsMesh) {\r\n                    if (this.splatsReady) {\r\n                        return true\r\n                    } else {\r\n                        return false;\r\n                    }\r\n                } else {\r\n                    return false;\r\n                } */\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    _changeContentVisibility(visibility) {\r\n        const self = this;\r\n        if (self.bbox) {\r\n\r\n            self.bbox.material.visible = visibility;\r\n        }\r\n        if (self.splatsMesh) {\r\n            if (visibility != self.materialVisibility) {\r\n                let splatsCount = 0;\r\n                self.meshContent.forEach(mc => {\r\n                    if (visibility && mc.isSplatsBatch) {\r\n                        //self.splatsReady = true;\r\n                        splatsCount++;\r\n\r\n                        mc.show(() => {\r\n                            if (self.materialVisibility) {\r\n                                self.splatsReady = true;\r\n                            }\r\n\r\n                        });\r\n\r\n                    }\r\n                    else {\r\n                        mc.hide();\r\n                        self.splatsReady = false;\r\n                    }\r\n                });\r\n\r\n                self.materialVisibility = visibility;\r\n            }\r\n        } else {\r\n            if (self.hasMeshContent && self.meshContent.length > 0) {\r\n                if (visibility) {\r\n                    self.meshContent.forEach(mc => {\r\n                        mc.traverse((o) => {\r\n                            if (o.isMesh || o.isPoints) {\r\n                                o.layers.enable(0);\r\n                            }\r\n                        });\r\n                    })\r\n\r\n                } else {\r\n                    self.meshContent.forEach(mc => {\r\n                        mc.traverse((o) => {\r\n                            if (o.isMesh || o.isPoints) {\r\n                                o.layers.disable(0);\r\n                            }\r\n                        });\r\n                    })\r\n\r\n                }\r\n            }\r\n\r\n            if (self.materialVisibility == visibility) {\r\n                return;\r\n            }\r\n            self.materialVisibility = visibility\r\n        }\r\n\r\n\r\n\r\n\r\n\r\n    }\r\n    _calculateUpdateMetric(camera, frustum) {\r\n        ////// return -1 if not in frustum\r\n        let distance = 0;\r\n        if (this.boundingVolume instanceof OBB) {\r\n            // box\r\n            tempOBB.copy(this.boundingVolume);\r\n            tempOBB.applyMatrix4(this.matrixWorld);\r\n            if (!tempOBB.inFrustum(frustum)) return -1;\r\n            distance = Math.max(0, tempOBB.distanceToPoint(camera.position) - camera.near);\r\n\r\n            /* tempSphere.center.copy(this.boundingVolume.center);\r\n            tempSphere.radius = Math.sqrt(this.boundingVolume.halfSize.x*this.boundingVolume.halfSize.x+ this.boundingVolume.halfSize.y*this.boundingVolume.halfSize.y+ this.boundingVolume.halfSize.z*this.boundingVolume.halfSize.z)\r\n            tempSphere.applyMatrix4(this.matrixWorld);\r\n            if (!frustum.intersectsSphere(tempSphere)) return -1;\r\n            distance = Math.max(0, camera.position.distanceTo(tempSphere.center) - tempSphere.radius - camera.near); */\r\n        } else if (this.boundingVolume instanceof THREE.Sphere) {\r\n            //sphere\r\n            tempSphere.copy(this.boundingVolume);\r\n            tempSphere.applyMatrix4(this.matrixWorld);\r\n            if (!frustum.intersectsSphere(tempSphere)) return -1;\r\n            distance = Math.max(0, camera.position.distanceTo(tempSphere.center) - tempSphere.radius - camera.near);\r\n        } else {\r\n            console.error(\"unsupported shape\");\r\n            return -1\r\n\r\n        }\r\n\r\n        /////// Apply the bias factor to the distance\r\n        distance = Math.pow(distance, this.distanceBias);\r\n        /////// return metric based on geometric error and distance\r\n\r\n\r\n        if (distance == 0) {\r\n            return 0;\r\n        }\r\n        const scale = this.matrixWorld.getMaxScaleOnAxis();\r\n        if (!!this.renderer) {\r\n            this.renderer.getDrawingBufferSize(this.rendererSize);\r\n        }\r\n        let s = this.rendererSize.y;\r\n        let fov = camera.fov;\r\n        if (camera.aspect < 1) {\r\n            fov *= camera.aspect;\r\n            s = this.rendererSize.x;\r\n        }\r\n\r\n        let lambda = 2.0 * Math.tan(0.5 * fov * 0.01745329251994329576923690768489) * distance;\r\n\r\n        return (16 * lambda) / (s * scale);\r\n    }\r\n\r\n    _getSiblings() {\r\n        const self = this;\r\n        const tiles = [];\r\n        if (!self.parentTile) return tiles;\r\n        let p = self.parentTile;\r\n        while (!p.hasMeshContent && !!p.parentTile) {\r\n            p = p.parentTile;\r\n        }\r\n        p.childrenTiles.forEach(child => {\r\n            if (!!child && child != self) {\r\n                while (!child.hasMeshContent && !!child.childrenTiles[0]) {\r\n                    child = child.childrenTiles[0];\r\n                }\r\n                tiles.push(child);\r\n            }\r\n        });\r\n        return tiles;\r\n    }\r\n    _calculateDistanceToCamera(camera) {\r\n        if (this.boundingVolume instanceof OBB) {\r\n            // box\r\n            tempOBB.copy(this.boundingVolume);\r\n            tempOBB.applyMatrix4(this.matrixWorld);\r\n            return Math.max(0, tempOBB.distanceToPoint(camera.position));\r\n            //if (!frustum.intersectsSphere(tempSphere)) return -1;\r\n        } else if (this.boundingVolume instanceof THREE.Sphere) {\r\n            //sphere\r\n            tempSphere.copy(this.boundingVolume);\r\n            tempSphere.applyMatrix4(this.matrixWorld);\r\n            return Math.max(0, camera.position.distanceTo(tempSphere.center) - tempSphere.radius);\r\n        }\r\n        else {\r\n            console.error(\"unsupported shape\");\r\n            return -1;\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Set the Geometric Error Multiplier for the tileset.\r\n     * the {@param geometricErrorMultiplier} can be a number between 1 and infinity.\r\n     * A {@param geometricErrorMultiplier} of 1 (default) corresponds to a max ScreenSpace error (MSE) of 16.  \r\n     * A lower {@param geometricErrorMultiplier} loads less detail (higher MSE) and a higher {@param geometricErrorMultiplier} loads more detail (lower MSE)\r\n     * \r\n     * @param {Number} geometricErrorMultiplier set the LOD multiplier for the entire tileset\r\n     */\r\n    setGeometricErrorMultiplier(geometricErrorMultiplier) {\r\n        this.geometricErrorMultiplier = geometricErrorMultiplier;\r\n        //this.splatsReady = true;\r\n        this.childrenTiles.forEach(child => child.setGeometricErrorMultiplier(geometricErrorMultiplier));\r\n    }\r\n\r\n    /**\r\n     * Set the Distance Bias for the tileset.\r\n     * the {@param distanceBias} can be a number between 0 and infinity.\r\n     * A {@param distanceBias} is applied as an exponent to camera-to-tile distance.  \r\n     * the {@link geometricErrorMultiplier} should be used to balance out the amount of detail loaded\r\n     * \r\n     * @param {Number} distanceBias set the distance bias for the entire tileset\r\n     */\r\n    setDistanceBias(distanceBias) {\r\n        this.distanceBias = distanceBias;\r\n        this.childrenTiles.forEach(child => child.setDistanceBias(distanceBias));\r\n    }\r\n\r\n    _transformWGS84ToCartesian(lon, lat, h, sfct) {\r\n        const a = 6378137.0;\r\n        const e = 0.006694384442042;\r\n        const N = a / (Math.sqrt(1.0 - (e * Math.pow(Math.sin(lat), 2))));\r\n        const cosLat = Math.cos(lat);\r\n        const cosLon = Math.cos(lon);\r\n        const sinLat = Math.sin(lat);\r\n        const sinLon = Math.sin(lon);\r\n        const nPh = (N + h);\r\n        const x = nPh * cosLat * cosLon;\r\n        const y = nPh * cosLat * sinLon;\r\n        const z = (0.993305615557957 * N + h) * sinLat;\r\n\r\n        sfct.set(x, y, z);\r\n    }\r\n}\r\nexport { OGC3DTile, getOGC3DTilesCopyrightInfo };\r\n\r\nfunction _showError(error) {\r\n    // Create a new div element\r\n    var errorDiv = document.createElement(\"div\");\r\n\r\n    // Set its text content\r\n    errorDiv.textContent = error;\r\n\r\n    // Set styles\r\n    errorDiv.style.position = 'fixed'; // Fix position to the viewport\r\n    errorDiv.style.top = '10px'; // Set top position\r\n    errorDiv.style.left = '50%'; // Center horizontally\r\n    errorDiv.style.transform = 'translateX(-50%)'; // Make sure it's centered accurately\r\n    errorDiv.style.padding = '10px'; // Add some padding\r\n    errorDiv.style.backgroundColor = '#ff8800'; // Set a background color\r\n    errorDiv.style.color = '#ffffff'; // Set a text color\r\n    errorDiv.style.zIndex = '9999'; // Make sure it's on top of other elements\r\n\r\n    // Append the new div to the body\r\n    document.body.appendChild(errorDiv);\r\n\r\n    // After 3 seconds, remove the error message\r\n    setTimeout(function () {\r\n        errorDiv.remove();\r\n    }, 8000);\r\n}\r\n\r\nfunction _updateCopyrightLabel() {\r\n    // Create a new div\r\n    if (!copyrightDiv) {\r\n        copyrightDiv = document.createElement('div');\r\n        copyrightDiv.style.position = 'fixed';\r\n        copyrightDiv.style.bottom = '20px';\r\n        copyrightDiv.style.left = '20px';\r\n        copyrightDiv.style.color = 'white';\r\n        copyrightDiv.style.textShadow = '2px 2px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000';\r\n        copyrightDiv.style.padding = '10px';\r\n        copyrightDiv.style.backgroundColor = 'rgba(0, 0, 0, 0.1)'; // semi-transparent black background\r\n\r\n        // Append the div to the body of the document\r\n        document.body.appendChild(copyrightDiv);\r\n    }\r\n\r\n    // Set the text content of the div\r\n    const list = getOGC3DTilesCopyrightInfo();\r\n    let listString = \"\";\r\n    list.forEach(item => {\r\n        listString += item + \", \";\r\n    });\r\n    listString = listString.slice(0, -2);\r\n\r\n    copyrightDiv.textContent = listString\r\n    // Style the div\r\n\r\n}\r\n\r\n","import * as THREE from 'three';\r\nimport { OBB } from \"../../geometry/obb\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport * as path from \"path-browserify\";\r\n\r\nconst tempSphere = new THREE.Sphere(new THREE.Vector3(0, 0, 0), 1);\r\nconst tempVec1 = new THREE.Vector3(0, 0, 0);\r\nconst tempVec2 = new THREE.Vector3(0, 0, 0);\r\nconst upVector = new THREE.Vector3(0, 1, 0);\r\nconst rendererSize = new THREE.Vector2();\r\nconst tempQuaternion = new THREE.Quaternion();\r\nconst tempMatrix = new THREE.Matrix4();\r\n\r\nclass InstancedTile extends THREE.Object3D {\r\n\r\n    /**\r\n     * \r\n     * @param {\r\n     *   json: optional,\r\n     *   url: optional,\r\n     *   rootPath: optional,\r\n     *   parentGeometricError: optional,\r\n     *   parentBoundingVolume: optional,\r\n     *   parentRefinement: optional,\r\n     *   loadOutsideView: Boolean,\r\n     *   tileLoader : InstancedTileLoader,\r\n     *   cameraOnLoad: camera,\r\n     *   parentTile: OGC3DTile,\r\n     *   onLoadCallback: function,\r\n     *   centerModel: Boolean,\r\n     *   queryParams: String,\r\n     *   distanceBias: distanceBias\r\n     * } properties \r\n     */\r\n    constructor(properties) {\r\n        super();\r\n        const self = this;\r\n        if (properties.queryParams) {\r\n            this.queryParams = { ...properties.queryParams };\r\n        }\r\n        this.uuid = uuidv4();\r\n        if (!!properties.tileLoader) {\r\n            this.tileLoader = properties.tileLoader;\r\n        } else {\r\n            console.error(\"an instanced tileset must be provided an InstancedTilesetLoader\");\r\n        }\r\n        // set properties general to the entire tileset\r\n        this.master = properties.master;\r\n        this.loadOutsideView = properties.loadOutsideView;\r\n        this.cameraOnLoad = properties.cameraOnLoad;\r\n        this.parentTile = properties.parentTile;\r\n        this.distanceBias = Math.max(0.0001,properties.distanceBias? properties.distanceBias:1);\r\n\r\n        // declare properties specific to the tile for clarity\r\n        this.childrenTiles = [];\r\n        this.jsonChildren = [];\r\n        this.meshContent = new Set();\r\n\r\n        this.static = properties.static;\r\n        if (this.static) {\r\n            this.matrixAutoUpdate = false;\r\n            this.matrixWorldAutoUpdate = false;\r\n        }\r\n        this.tileContent;\r\n        this.refinement; // defaults to \"REPLACE\"\r\n        this.rootPath;\r\n        this.geometricError;\r\n        this.boundingVolume;\r\n        this.json; // the json corresponding to this tile\r\n        this.materialVisibility = false;\r\n        this.inFrustum = true;\r\n        this.level = properties.level ? properties.level : 0;\r\n        this.hasMeshContent = 0; // true when the provided json has a content field pointing to a B3DM file\r\n        this.hasUnloadedJSONContent = 0; // true when the provided json has a content field pointing to a JSON file that is not yet loaded\r\n        this.centerModel = properties.centerModel;\r\n\r\n        this.deleted = false;\r\n        this.abortController = new AbortController();\r\n\r\n        if (!!properties.json) { // If this tile is created as a child of another tile, properties.json is not null\r\n            this.rootPath = !!properties.json.rootPath ? properties.json.rootPath : properties.rootPath;\r\n            if (properties.json.children) this.jsonChildren = properties.json.children;\r\n            self.setup(properties);\r\n        } else if (properties.url) { // If only the url to the tileset.json is provided\r\n\r\n\r\n            this.loadJson = (json, url) => {\r\n                //json = JSON.parse(JSON.stringify(json))\r\n                const p = path.dirname(url);\r\n                self.setup({ rootPath: p, json: json, onLoadCallback: properties.onLoadCallback });\r\n\r\n\r\n\r\n            }\r\n            var url = properties.url;\r\n            if (self.queryParams) {\r\n                var props = \"\";\r\n                for (let key in self.queryParams) {\r\n                    if (self.queryParams.hasOwnProperty(key)) { // This check is necessary to skip properties from the object's prototype chain\r\n                        props += \"&\" + key + \"=\" + self.queryParams[key];\r\n                    }\r\n                }\r\n                if (url.includes(\"?\")) {\r\n                    url += props;\r\n                } else {\r\n                    url += \"?\" + props.substring(1);\r\n                }\r\n            }\r\n            self.tileLoader.get(self.abortController, url, self.uuid, self);\r\n        }\r\n    }\r\n\r\n    async setup(properties) {\r\n        const self = this;\r\n\r\n        if (!!properties.json.root) {\r\n            self.json = properties.json.root;\r\n            if (!self.json.children && self.json.getChildren) {\r\n                self.json.children = await self.json.getChildren();\r\n            }\r\n            self.jsonChildren = self.json.children;\r\n            if (!self.json.refinement) self.json.refinement = properties.json.refinement;\r\n            if (!self.json.geometricError) self.json.geometricError = properties.json.geometricError;\r\n            if (!self.json.transform) self.json.transform = properties.json.transform;\r\n            if (!self.json.boundingVolume) self.json.boundingVolume = properties.json.boundingVolume;\r\n        } else {\r\n            self.json = properties.json;\r\n            if (!self.json.children && self.json.getChildren) {\r\n                self.json.children = await self.json.getChildren();\r\n                self.jsonChildren = self.json.children;\r\n            }\r\n        }\r\n\r\n        self.rootPath = !!properties.json.rootPath ? properties.json.rootPath : properties.rootPath;\r\n\r\n        // decode refinement\r\n        if (!!self.json.refinement) {\r\n            self.refinement = self.json.refinement;\r\n        } else {\r\n            self.refinement = properties.parentRefinement;\r\n        }\r\n        // decode geometric error\r\n        if (!!self.json.geometricError) {\r\n            self.geometricError = self.json.geometricError;\r\n        } else {\r\n            self.geometricError = properties.parentGeometricError;\r\n        }\r\n        // decode transform\r\n        let mat = new THREE.Matrix4();\r\n        if (!!self.json.transform && !self.centerModel) {\r\n            mat.elements = self.json.transform;\r\n        }\r\n\r\n        self.applyMatrix4(mat);\r\n\r\n        if (!!self.parentTile && !!self.parentTile.matrix) {\r\n\r\n            self.matrix.premultiply(self.parentTile.matrix);\r\n            //self.matrix.premultiply(self.master.matrixWorld);\r\n            self.matrix.decompose(self.position, self.quaternion, self.scale)\r\n        }\r\n\r\n\r\n        self.matrixWorldNeedsUpdate = true;\r\n        self.updateWorldMatrix(true, true)\r\n        \r\n\r\n        // decode volume\r\n        if (!!self.json.boundingVolume) {\r\n            if (!!self.json.boundingVolume.box) {\r\n                self.boundingVolume = new OBB(self.json.boundingVolume.box);\r\n            } else if (!!self.json.boundingVolume.region) {\r\n                const region = self.json.boundingVolume.region;\r\n                self.transformWGS84ToCartesian(region[0], region[1], region[4], tempVec1);\r\n                self.transformWGS84ToCartesian(region[2], region[3], region[5], tempVec2);\r\n                tempVec1.lerp(tempVec2, 0.5);\r\n                self.boundingVolume = new THREE.Sphere(new THREE.Vector3(tempVec1.x, tempVec1.y, tempVec1.z), tempVec1.distanceTo(tempVec2));\r\n            } else if (!!self.json.boundingVolume.sphere) {\r\n                const sphere = self.json.boundingVolume.sphere;\r\n                self.boundingVolume = new THREE.Sphere(new THREE.Vector3(sphere[0], sphere[1], sphere[2]), sphere[3]);\r\n            } else {\r\n                self.boundingVolume = properties.parentBoundingVolume;\r\n            }\r\n        } else {\r\n            self.boundingVolume = properties.parentBoundingVolume;\r\n        }\r\n\r\n        function checkContent(e) {\r\n            if (!!e.uri && e.uri.includes(\"json\")) {\r\n                self.hasUnloadedJSONContent++;\r\n            } else if (!!e.url && e.url.includes(\"json\")) {\r\n                self.hasUnloadedJSONContent++;\r\n            } else {\r\n                self.hasMeshContent++;\r\n            }\r\n        }\r\n        if (!!self.json.content) { //if there is a content, json or otherwise, schedule it to be loaded \r\n            checkContent(self.json.content);\r\n\r\n            self.load();\r\n        } else if (!!self.json.contents) { //if there is a content, json or otherwise, schedule it to be loaded \r\n            self.json.contents.forEach(e => checkContent(e))\r\n\r\n            self.load();\r\n            //scheduleLoadTile(this);\r\n        }\r\n\r\n        if (!!self.centerModel) {\r\n            const tempSphere = new THREE.Sphere();\r\n            if (self.boundingVolume instanceof OBB) {\r\n                // box\r\n                tempSphere.copy(self.boundingVolume.sphere);\r\n            } else if (self.boundingVolume instanceof THREE.Sphere) {\r\n                //sphere\r\n                tempSphere.copy(self.boundingVolume);\r\n            }\r\n\r\n            //tempSphere.applyMatrix4(self.matrixWorld);\r\n            if (!!this.json.boundingVolume.region) {\r\n                self.transformWGS84ToCartesian(\r\n                    (self.json.boundingVolume.region[0] + self.json.boundingVolume.region[2]) * 0.5,\r\n                    (self.json.boundingVolume.region[1] + self.json.boundingVolume.region[3]) * 0.5,\r\n                    (self.json.boundingVolume.region[4] + self.json.boundingVolume.region[5]) * 0.5,\r\n                    tempVec1);\r\n\r\n                tempQuaternion.setFromUnitVectors(tempVec1.normalize(), upVector.normalize());\r\n                self.master.applyQuaternion(tempQuaternion);\r\n                self.master.updateWorldMatrix(false, false)\r\n            }\r\n            tempMatrix.makeTranslation(-tempSphere.center.x * self.scale.x, -tempSphere.center.y * self.scale.y, -tempSphere.center.z * self.scale.z);\r\n            //self.master.applyMatrix4(tempMatrix);\r\n            self.master.matrix.multiply(tempMatrix);\r\n            self.master.matrix.decompose(self.master.position, self.master.quaternion, self.master.scale);\r\n        }\r\n\r\n        self.isSetup = true;\r\n        if (properties.onLoadCallback) properties.onLoadCallback(self);\r\n    }\r\n\r\n    isAbsolutePathOrURL(input) {\r\n        // Check if it's an absolute URL with various protocols\r\n        const urlRegex = /^(?:http|https|ftp|tcp|udp):\\/\\/\\S+/;\r\n        const absoluteURL = urlRegex.test(input);\r\n\r\n        // Check if it's an absolute path\r\n        const absolutePath = input.startsWith('/') && !input.startsWith('//');\r\n\r\n        return absoluteURL || absolutePath;\r\n    }\r\n\r\n    assembleURL(root, relative) {\r\n        // Append a slash to the root URL if it doesn't already have one\r\n        if (!root.endsWith('/')) {\r\n            root += '/';\r\n        }\r\n\r\n        const rootUrl = new URL(root);\r\n        let rootParts = rootUrl.pathname.split('/').filter(p => p !== '');\r\n        let relativeParts = relative.split('/').filter(p => p !== '');\r\n\r\n        for (let i = 1; i <= rootParts.length; i++) {\r\n            if (i >= relativeParts.length) break;\r\n            const rootToken = rootParts.slice(rootParts.length - i, rootParts.length).join('/');\r\n            const relativeToken = relativeParts.slice(0, i).join('/');\r\n            if (rootToken === relativeToken) {\r\n                for (let j = 0; j < i; j++) {\r\n                    rootParts.pop();\r\n                }\r\n                break;\r\n            }\r\n        }\r\n\r\n\r\n        while (relativeParts.length > 0 && relativeParts[0] === '..') {\r\n            rootParts.pop();\r\n            relativeParts.shift();\r\n        }\r\n\r\n        return `${rootUrl.protocol}//${rootUrl.host}/${[...rootParts, ...relativeParts].join('/')}`;\r\n    }\r\n    extractQueryParams(url, params) {\r\n        const urlObj = new URL(url);\r\n\r\n        // Iterate over all the search parameters\r\n        for (let [key, value] of urlObj.searchParams) {\r\n            params[key] = value;\r\n        }\r\n\r\n        // Remove the query string\r\n        urlObj.search = '';\r\n        return urlObj.toString();\r\n    }\r\n    load() {\r\n        var self = this;\r\n        if (self.deleted) return;\r\n        if (!!self.json.content) {\r\n\r\n            loadContent(self.json.content);\r\n        } else if (!!self.json.contents) {\r\n            self.json.contents.forEach(content => loadContent(content))\r\n        }\r\n        function loadContent(content) {\r\n            let url;\r\n            if (!!content.uri) {\r\n                url = content.uri;\r\n            } else if (!!content.url) {\r\n                url = content.url;\r\n            }\r\n            const urlRegex = /^(?:http|https|ftp|tcp|udp):\\/\\/\\S+/;\r\n\r\n            if (urlRegex.test(self.rootPath)) { // url\r\n                if (!urlRegex.test(url)) {\r\n                    url = self.assembleURL(self.rootPath, url)\r\n                }\r\n            } else { //path\r\n                if (path.isAbsolute(self.rootPath)) {\r\n                    url = self.rootPath + path.sep + url;\r\n                }\r\n            }\r\n            url = self.extractQueryParams(url, self.queryParams);\r\n            if (self.queryParams) {\r\n                var props = \"\";\r\n                for (let key in self.queryParams) {\r\n                    if (self.queryParams.hasOwnProperty(key)) { // This check is necessary to skip properties from the object's prototype chain\r\n                        props += \"&\" + key + \"=\" + self.queryParams[key];\r\n                    }\r\n                }\r\n                if (url.includes(\"?\")) {\r\n                    url += props;\r\n                } else {\r\n                    url += \"?\" + props.substring(1);\r\n                }\r\n            }\r\n\r\n            if (!!url) {\r\n                if (url.includes(\".b3dm\") || url.includes(\".glb\") || url.includes(\".gltf\")) {\r\n                    self.contentURL = url;\r\n\r\n\r\n                    self.tileLoader.get(self.abortController, url, self.uuid, self, !self.cameraOnLoad ? () => 0 : () => {\r\n                        return self.calculateDistanceToCamera(self.cameraOnLoad);\r\n                    }, () => self.getSiblings(),\r\n                        self.level,\r\n                        !!self.json.boundingVolume.region ? false : true,\r\n                        !!self.json.boundingVolume.region,\r\n                        self.geometricError);\r\n                } else if (url.includes(\".json\")) {\r\n                    self.tileLoader.get(self.abortController, url, self.uuid, self);\r\n                }\r\n            }\r\n\r\n            \r\n        }\r\n\r\n    }\r\n\r\n    loadMesh(mesh) {\r\n        const self = this;\r\n        if (self.deleted) {\r\n            return;\r\n        }\r\n        //self.updateWorldMatrix(false, true);\r\n        self.meshContent.add(mesh);\r\n\r\n    }\r\n\r\n    loadJson(json, url) {\r\n        if (this.deleted) {\r\n            return;\r\n        }\r\n        if (!!this.json.children) {\r\n            this.jsonChildren = this.json.children;\r\n        }\r\n\r\n        json.rootPath = path.dirname(url);\r\n        this.jsonChildren.push(json);\r\n        this.hasUnloadedJSONContent--;\r\n    }\r\n\r\n    dispose() {\r\n\r\n        const self = this;\r\n        self.childrenTiles.forEach(tile => tile.dispose());\r\n\r\n        self.deleted = true;\r\n        if (self.abortController) self.abortController.abort();\r\n        this.parent = null;\r\n        this.parentTile = null;\r\n        this.dispatchEvent({ type: 'removed' });\r\n    }\r\n    disposeChildren() {\r\n\r\n        var self = this;\r\n\r\n        self.childrenTiles.forEach(tile => tile.dispose());\r\n        self.childrenTiles = [];\r\n\r\n    }\r\n\r\n\r\n    _update(camera, frustum) {\r\n        const self = this;\r\n        if (!self.isSetup) return;\r\n\r\n        const visibilityBeforeUpdate = self.materialVisibility;\r\n\r\n        if (!!self.boundingVolume && !!self.geometricError) {\r\n            self.metric = self.calculateUpdateMetric(camera, frustum);\r\n        }\r\n        self.childrenTiles.forEach(child => child._update(camera, frustum));\r\n\r\n        updateNodeVisibility(self.metric);\r\n        updateTree(self.metric);\r\n        trimTree(self.metric, visibilityBeforeUpdate);\r\n\r\n        function updateTree(metric) {\r\n            // If this tile does not have mesh content but it has children\r\n            if (metric < 0 && self.hasMeshContent) return;\r\n\r\n            if ((!self.hasMeshContent && self.rootPath) || (metric < self.master.geometricErrorMultiplier * self.geometricError && self.meshContent.size > 0)) {\r\n                if (!!self.json && !!self.jsonChildren && self.childrenTiles.length != self.jsonChildren.length) {\r\n                    loadJsonChildren();\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        function updateNodeVisibility(metric) {\r\n\r\n            //doesn't have a mesh content\r\n            if (!self.hasMeshContent) {\r\n                return;\r\n            }\r\n            // mesh content not yet loaded\r\n            if (self.meshContent.size < self.hasMeshContent) {\r\n                return;\r\n            }\r\n\r\n            // outside frustum\r\n            if (metric < 0) {\r\n                self.inFrustum = false;\r\n                self.changeContentVisibility(!!self.loadOutsideView);\r\n                return;\r\n            } else {\r\n                self.inFrustum = true;\r\n            }\r\n\r\n            // has no children\r\n            if (self.childrenTiles.length == 0) {\r\n                self.changeContentVisibility(true);\r\n                return;\r\n            }\r\n\r\n            // has children\r\n            if (metric >= self.master.geometricErrorMultiplier * self.geometricError) { // Ideal LOD or before ideal lod\r\n\r\n                self.changeContentVisibility(true);\r\n            } else if (metric < self.master.geometricErrorMultiplier * self.geometricError) { // Ideal LOD is past this one\r\n                // if children are visible and have been displayed, can be hidden\r\n                let allChildrenReady = true;\r\n                self.childrenTiles.every(child => {\r\n\r\n                    if (!child.isReady()) {\r\n                        allChildrenReady = false;\r\n                        return false;\r\n                    }\r\n                    return true;\r\n                });\r\n                if (allChildrenReady) {\r\n                    self.changeContentVisibility(false);\r\n                }\r\n            }\r\n        }\r\n\r\n        function trimTree(metric, visibilityBeforeUpdate) {\r\n            if (!self.hasMeshContent) return;\r\n            if (!self.inFrustum) { // outside frustum\r\n                self.disposeChildren();\r\n                updateNodeVisibility(metric);\r\n                return;\r\n            }\r\n            if (metric >= self.master.geometricErrorMultiplier * self.geometricError) {\r\n                self.disposeChildren();\r\n                updateNodeVisibility(metric);\r\n                return;\r\n            }\r\n\r\n        }\r\n\r\n\r\n        function loadJsonChildren() {\r\n            self.jsonChildren.forEach(childJSON => {\r\n                if (!childJSON.root && !childJSON.children && !childJSON.getChildren && !childJSON.content && !childJSON.contents) {\r\n                    return;\r\n                }\r\n                let childTile = new InstancedTile({\r\n                    parentTile: self,\r\n                    queryParams: self.queryParams,\r\n                    parentGeometricError: self.geometricError,\r\n                    parentBoundingVolume: self.boundingVolume,\r\n                    parentRefinement: self.refinement,\r\n                    json: childJSON,\r\n                    rootPath: self.rootPath,\r\n                    loadOutsideView: self.loadOutsideView,\r\n                    level: self.level + 1,\r\n                    tileLoader: self.tileLoader,\r\n                    cameraOnLoad: camera,\r\n                    master: self.master,\r\n                    centerModel: false,\r\n                });\r\n                self.childrenTiles.push(childTile);\r\n                //self.add(childTile);\r\n            });\r\n        }\r\n\r\n    }\r\n\r\n    areAllChildrenLoadedAndHidden() {\r\n        let allLoadedAndHidden = true;\r\n        const self = this;\r\n        this.childrenTiles.every(child => {\r\n            if (child.hasMeshContent) {\r\n                if (child.childrenTiles.length > 0) {\r\n                    allLoadedAndHidden = false;\r\n                    return false;\r\n                }\r\n                if (!child.inFrustum) {\r\n                    return true;\r\n                };\r\n                if (!child.materialVisibility || child.meshesToDisplay != child.meshesDisplayed) {\r\n                    allLoadedAndHidden = false;\r\n                    return false;\r\n                }\r\n            } else {\r\n                if (!child.areAllChildrenLoadedAndHidden()) {\r\n                    allLoadedAndHidden = false;\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        });\r\n        return allLoadedAndHidden;\r\n    }\r\n\r\n    /**\r\n     * Node is ready if it is outside frustum, if it was drawn at least once or if all it's children are ready\r\n     * @returns true if ready\r\n     */\r\n    isReady() {\r\n        // if outside frustum\r\n        if (!this.inFrustum) return true;\r\n\r\n        // if json is not done loading\r\n        if (this.hasUnloadedJSONContent) {\r\n            return false;\r\n        }\r\n        if ((!this.hasMeshContent || this.meshContent.size == 0 || !this.materialVisibility)) {\r\n            if (this.childrenTiles.length > 0) {\r\n                var allChildrenReady = true;\r\n                this.childrenTiles.every(child => {\r\n                    if (!child.isReady()) {\r\n                        allChildrenReady = false;\r\n                        return false;\r\n                    }\r\n                    return true;\r\n                });\r\n                return allChildrenReady;\r\n            } else {\r\n                return false;\r\n            }\r\n\r\n        }\r\n        // if this tile has no mesh content\r\n        if (!this.hasMeshContent) {\r\n            return true;\r\n        }\r\n        // if mesh content not yet loaded\r\n        if (this.meshContent.size < this.hasMeshContent) {\r\n            return false;\r\n        }\r\n\r\n        // if this tile has been marked to hide it's content\r\n        if (!this.materialVisibility) {\r\n            return false;\r\n        }\r\n\r\n\r\n        return true;\r\n\r\n    }\r\n\r\n\r\n    changeContentVisibility(visibility) {\r\n        const self = this;\r\n        self.materialVisibility = visibility;\r\n\r\n\r\n\r\n    }\r\n    calculateUpdateMetric(camera, frustum) {\r\n        ////// return -1 if not in frustum\r\n        if (this.boundingVolume instanceof OBB) {\r\n            // box\r\n            tempSphere.copy(this.boundingVolume.sphere);\r\n            tempSphere.applyMatrix4(this.matrixWorld);\r\n            if (!frustum.intersectsSphere(tempSphere)) return -1;\r\n        } else if (this.boundingVolume instanceof THREE.Sphere) {\r\n            //sphere\r\n            tempSphere.copy(this.boundingVolume);\r\n            tempSphere.applyMatrix4(this.matrixWorld);\r\n            if (!frustum.intersectsSphere(tempSphere)) return -1;\r\n        } else {\r\n            console.error(\"unsupported shape\");\r\n            return -1\r\n        }\r\n\r\n        /////// return metric based on geometric error and distance\r\n\r\n        let distance = Math.max(0, camera.position.distanceTo(tempSphere.center) - tempSphere.radius);\r\n\r\n        /////// Apply the bias factor to the distance\r\n        distance = Math.pow(distance,this.distanceBias);\r\n\r\n        if (distance == 0) {\r\n            return 0;\r\n        }\r\n        const scale = this.matrixWorld.getMaxScaleOnAxis();\r\n        this.master._renderSize(rendererSize);\r\n        let s = rendererSize.y;\r\n        let fov = camera.fov;\r\n        if (camera.aspect < 1) {\r\n            fov *= camera.aspect;\r\n            s = rendererSize.x;\r\n        }\r\n\r\n        let lambda = 2.0 * Math.tan(0.5 * fov * 0.01745329251994329576923690768489) * distance;\r\n\r\n        return (window.devicePixelRatio * 16 * lambda) / (s * scale);\r\n\r\n    }\r\n\r\n    getSiblings() {\r\n        const self = this;\r\n        const tiles = [];\r\n        if (!self.parentTile) return tiles;\r\n        let p = self.parentTile;\r\n        while (!p.hasMeshContent && !!p.parentTile) {\r\n            p = p.parentTile;\r\n        }\r\n        p.childrenTiles.forEach(child => {\r\n            if (!!child && child != self) {\r\n                while (!child.hasMeshContent && !!child.childrenTiles[0]) {\r\n                    child = child.childrenTiles[0];\r\n                }\r\n                tiles.push(child);\r\n            }\r\n        });\r\n        return tiles;\r\n    }\r\n    calculateDistanceToCamera(camera) {\r\n        if (this.boundingVolume instanceof OBB) {\r\n            // box\r\n            tempSphere.copy(this.boundingVolume.sphere);\r\n            tempSphere.applyMatrix4(this.matrixWorld);\r\n            //if (!frustum.intersectsSphere(tempSphere)) return -1;\r\n        } else if (this.boundingVolume instanceof THREE.Sphere) {\r\n            //sphere\r\n            tempSphere.copy(this.boundingVolume);\r\n            tempSphere.applyMatrix4(this.matrixWorld);\r\n            //if (!frustum.intersectsSphere(tempSphere)) return -1;\r\n        }\r\n        else {\r\n            console.error(\"unsupported shape\")\r\n        }\r\n        return Math.max(0, camera.position.distanceTo(tempSphere.center) - tempSphere.radius);\r\n    }\r\n\r\n    getWorldMatrix() {\r\n        const self = this;\r\n        return self.matrixWorld;\r\n    }\r\n\r\n    transformWGS84ToCartesian(lon, lat, h, sfct) {\r\n        const a = 6378137.0;\r\n        const e = 0.006694384442042;\r\n        const N = a / (Math.sqrt(1.0 - (e * Math.pow(Math.sin(lat), 2))));\r\n        const cosLat = Math.cos(lat);\r\n        const cosLon = Math.cos(lon);\r\n        const sinLat = Math.sin(lat);\r\n        const sinLon = Math.sin(lon);\r\n        const nPh = (N + h);\r\n        const x = nPh * cosLat * cosLon;\r\n        const y = nPh * cosLat * sinLon;\r\n        const z = (0.993305615557957 * N + h) * sinLat;\r\n\r\n        sfct.set(x, y, z);\r\n    }\r\n}\r\nexport { InstancedTile };","import * as THREE from 'three';\r\nimport {InstancedTile} from \"./InstancedTile.js\"\r\n\r\n/**\r\n * Similarly to {@link OGC3DTile}, this class that extends THREE.Object3D loads a tiled and multileveled OGC3DTiles 1.0 or 1.1 dataset.\r\n * The difference is that tiles are instanced. This is useful when one wants to load the same tileset hundreds or even thousands of times.\r\n * Imagine rendering hundreds of very high detail cars driving in a city.\r\n * Each tile content is instanced but each {@link InstancedOGC3DTile} object also has it's own LOD tree making this scenario very efficient.\r\n * @class\r\n */\r\nclass InstancedOGC3DTile extends THREE.Object3D {\r\n\r\n    /**\r\n     * \r\n     * @param {Object} [properties] - the properties for this tileset\r\n     * @param {Object} [properties.url] - the url to the parent tileset.json\r\n     * @param {Object} [properties.pathParams] - optional, path params to add to individual tile urls (starts with \"?\").\r\n     * @param {Object} [properties.geometricErrorMultiplier] - the geometric error of the parent. 1.0 by default corresponds to a maxScreenSpaceError of 16\r\n     * @param {Object} [properties.loadOutsideView] - if truthy, tiles otside the camera frustum will be loaded with the least possible amount of detail\r\n     * @param {Object} [properties.tileLoader] - A tile loader that can be shared among tilesets in order to share a common cache.\r\n     * @param {Object} [properties.pointsCallback] - A callback function that will be called on every points\r\n     * @param {Object} [properties.onLoadCallback] - A callback function that will be called when the root tile has been loaded\r\n     * @param {Object} [properties.occlusionCullingService] - A service that handles occlusion culling\r\n     * @param {Object} [properties.centerModel] - If true, the tileset will be centered on 0,0,0 and in the case of georeferenced tilesets that use the \"region\" bounding volume, it will also be rotated so that the up axis matched the world y axis.\r\n     * @param {Object} [properties.static] - If true, the tileset is considered static which improves performance but the tileset cannot be moved\r\n     * @param {Object} [properties.rootPath] - optional the root path for fetching children\r\n     * @param {Object} [properties.json] - optional json object representing the tileset sub-tree\r\n     * @param {Object} [properties.parentGeometricError] - optional geometric error of the parent\r\n     * @param {Object} [properties.parentBoundingVolume] - optional bounding volume of the parent\r\n     * @param {Object} [properties.parentRefinement] - optional refinement strategy of the parent of the parent\r\n     * @param {Object} [properties.cameraOnLoad] - optional the camera used when loading this particular sub-tile\r\n     * @param {Object} [properties.parentTile] - optional the OGC3DTile object that loaded this tile as a child\r\n     * @param {Number} [properties.domWidth = 1000] - optional the canvas width (used to calculate geometric error). If a renderer is provided, it'll be used instead, else a default value is used.  \r\n     * @param {Number} [properties.domHeight = 1000] - optional the canvas height (used to calculate geometric error). If a renderer is provided, it'll be used instead, else a default value is used.  \r\n     * @param {Object} [properties.renderer = undefined] - optional the renderer is used to infer the canvas size and compute tiles geometric error.\r\n     * @param {Number} [properties.distanceBias] - optional a bias that allows loading more or less detail closer to the camera relative to far away. The value should be a positive number. A value below 1 loads less detail near the camera and a value above 1 loads more detail near the camera. This needs to be compensated by the geometricErrorMultiplier in order to load a reasonable number of tiles.\r\n     */\r\n    constructor(properties) {\r\n        super();\r\n        properties.master = this;\r\n        \r\n        if(!!properties.domWidth && !!properties.domHeight){\r\n            this.rendererSize = new THREE.Vector2(properties.domWidth, properties.domHeight);\r\n        }else{\r\n            this.rendererSize = new THREE.Vector2(1000, 1000);\r\n        }\r\n        this.renderer = properties.renderer;\r\n        this.distanceBias = Math.max(0.0001,properties.distanceBias? properties.distanceBias:1);\r\n\r\n        this.geometricErrorMultiplier = properties.geometricErrorMultiplier? properties.geometricErrorMultiplier:1.0;\r\n        this.tileset = new InstancedTile(properties);\r\n        if (properties.static) {\r\n            this.matrixAutoUpdate = false;\r\n        }\r\n        this.tileLoader = properties.tileLoader;\r\n    }\r\n\r\n    _renderSize(size){\r\n        if(!!this.renderer){\r\n            this.renderer.getDrawingBufferSize(size);\r\n        }else{\r\n            size.copy(this.rendererSize);\r\n        }\r\n        \r\n    }\r\n\r\n    /**\r\n     * Call this to specify the canvas width/height when it changes (used to compute tiles geometric error that controls tile refinement).\r\n     * It's unnecessary to call this when the {@link OGC3DTile} is instantiated with the renderer.\r\n     * \r\n     * @param {Number} width \r\n     * @param {Number} height \r\n     */\r\n     setCanvasSize(width, height){\r\n        this.rendererSize.set(width, height);\r\n    }\r\n    /**\r\n     * To be called in the render loop.\r\n     * @param {Three.Camera} camera a camera that the tileset will be rendered with.\r\n     */\r\n    update(camera, frustum){\r\n        if(!!frustum){\r\n            this.tileset._update(camera, frustum);\r\n        }else{\r\n            const frustum = new THREE.Frustum();\r\n            frustum.setFromProjectionMatrix(new THREE.Matrix4().multiplyMatrices(camera.projectionMatrix, camera.matrixWorldInverse));\r\n            this.tileset._update(camera, frustum);\r\n        }\r\n        \r\n    }\r\n    \r\n    /** \r\n     * Set the Geometric Error Multiplier for the tileset.\r\n     * the {@param geometricErrorMultiplier} can be a number between 1 and infinity.\r\n     * A {@param geometricErrorMultiplier} of 1 (default) corresponds to a max ScreenSpace error (MSE) of 16.  \r\n     * A lower {@param geometricErrorMultiplier} loads less detail (higher MSE) and a higher {@param geometricErrorMultiplier} loads more detail (lower MSE)\r\n     * \r\n     * @param {Number} geometricErrorMultiplier set the LOD multiplier for the entire tileset\r\n     */\r\n    setGeometricErrorMultiplier(geometricErrorMultiplier) {\r\n        this.geometricErrorMultiplier = geometricErrorMultiplier?geometricErrorMultiplier:1.0;\r\n    }\r\n}\r\nexport { InstancedOGC3DTile };","import * as THREE from 'three';\r\n\r\nclass MeshTile{\r\n    constructor(scene){\r\n        const self = this;\r\n        self.scene = scene;\r\n        self.instancedTiles = [];\r\n        self.instancedMesh;\r\n        \r\n\r\n        self.reuseableMatrix = new THREE.Matrix4();\r\n    }\r\n    addInstance(instancedTile){\r\n        const self = this;\r\n        instancedTile.added = true;\r\n        instancedTile.listOMesh = self.instancedTiles;\r\n        self.instancedTiles.push(instancedTile);\r\n        if(self.instancedMesh){\r\n            instancedTile.loadMesh(self.instancedMesh)\r\n        }\r\n    }\r\n\r\n    addToScene(){\r\n        //this.instancedMesh.instanceMatrix.setUsage( THREE.DynamicDrawUsage );\r\n        const self = this;\r\n        self.instancedMesh.setMatrixAt(0,new THREE.Matrix4());\r\n        self.instancedMesh.instanceMatrix.needsUpdate = true;\r\n        self.instancedMesh.count = 1;\r\n        \r\n        self.scene.add(self.instancedMesh);\r\n        self.instancedMesh.onAfterRender = () => {\r\n            delete self.instancedMesh.onAfterRender;\r\n            self.instancedMesh.displayedOnce = true;\r\n        };\r\n    }\r\n\r\n    setObject(instancedMesh){\r\n        const self = this;\r\n        self.instancedMesh = instancedMesh;\r\n        self.instancedMesh.matrixAutoUpdate = false;\r\n        self.instancedMesh.matrixWorldAutoUpdate = false;\r\n        if(!self.scene.children.includes(instancedMesh)){\r\n            this.addToScene();\r\n        }\r\n        \r\n        for(let i = 0; i<self.instancedTiles.length; i++){\r\n            self.instancedTiles[i].loadMesh(self.instancedMesh)\r\n        }\r\n    }\r\n\r\n    update(){\r\n        const self = this;\r\n\r\n        for(let i = self.instancedTiles.length-1; i>=0; i--){\r\n            if(self.instancedTiles[i].deleted){\r\n                self.instancedTiles.splice(i,1);\r\n            }\r\n        }\r\n        \r\n        if(!!self.instancedMesh){\r\n            \r\n            self.instancedMesh.count = 0;\r\n            self.instancedMesh.instancedTiles = [];\r\n            for(let i = 0; i<self.instancedTiles.length; i++){\r\n                self.instancedTiles[i].meshContent.add(self.instancedMesh);\r\n                if(self.instancedTiles[i].materialVisibility){\r\n                    self.instancedMesh.count++;\r\n                    self.reuseableMatrix.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);\r\n                    self.reuseableMatrix.multiply(self.instancedTiles[i].matrixWorld);\r\n                    self.reuseableMatrix.multiply(self.instancedMesh.baseMatrix);\r\n                    //self.reuseableMatrix.premultiply(self.instancedTiles[i].master.matrixWorld);\r\n                    self.instancedMesh.setMatrixAt(self.instancedMesh.count-1, self.reuseableMatrix );\r\n                    //self.instancedMesh.getMatrixAt(0, t);\r\n                    //console.log(self.instancedMesh.baseMatrix)\r\n                    self.instancedMesh.instancedTiles.push(self.instancedTiles[i])\r\n                }\r\n            }\r\n            \r\n            self.instancedMesh.instanceMatrix.needsUpdate = true;\r\n            self.instancedMesh.needsUpdate = true;\r\n            self.instancedMesh.computeBoundingSphere();\r\n        }\r\n    }\r\n\r\n    getCount(){\r\n        return this.instancedTiles.length;\r\n    }\r\n\r\n    dispose(){\r\n        const self = this;\r\n        if(self.instancedTiles.length>0){\r\n            return false;\r\n        }\r\n        else{\r\n            if(!!self.instancedMesh){\r\n                //console.log(self.instancedMesh.parent)\r\n                self.scene.remove(self.instancedMesh);\r\n                self.instancedMesh.traverse((o) => {\r\n                    if(o.dispose) o.dispose();\r\n                    if (o.material) {\r\n                        // dispose materials\r\n                        if (o.material.length) {\r\n                            for (let i = 0; i < o.material.length; ++i) {\r\n                                o.material[i].dispose();\r\n                            }\r\n                        }\r\n                        else {\r\n                            o.material.dispose()\r\n                        }\r\n                    }\r\n                    if (o.geometry) o.geometry.dispose();\r\n                });\r\n                self.instancedMesh.dispose();\r\n                return true;\r\n            }\r\n            return false;\r\n        }\r\n    }\r\n\r\n}export { MeshTile };","\r\n\r\nclass JsonTile{\r\n    constructor(){\r\n        const self = this;\r\n        self.count = 0;\r\n        self.json;\r\n        self.instancedTiles = [];\r\n    }\r\n\r\n    addInstance(instanceTile){\r\n        this.instancedTiles.push(instanceTile);\r\n        if(this.json){\r\n            instanceTile.loadJson(this.json, this.url)\r\n        }\r\n    }\r\n\r\n    \r\n\r\n    setObject(json, url){\r\n        const self = this;\r\n        self.json = json;\r\n        self.url = url;\r\n        for(let i = 0; i<self.instancedTiles.length; i++){\r\n            self.instancedTiles[i].loadJson( self.json, self.url );\r\n        }\r\n    }\r\n\r\n    getCount(){\r\n        return this.instancedTiles.length;\r\n    }\r\n    update(){\r\n        const self = this;\r\n        for(let i = self.instancedTiles.length-1; i>=0; i--){\r\n            if(self.instancedTiles[i].deleted){\r\n                self.instancedTiles.splice(i,1);\r\n            }\r\n        }\r\n    }\r\n    dispose(){\r\n        if(!!this.json && this.instancedTiles.length == 0){\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n}export { JsonTile };","import * as THREE from 'three';\r\nimport { LinkedHashMap } from '../../utils/LinkedHashMap';\r\nimport { B3DMDecoder } from \"../../decoder/B3DMDecoder\";\r\nimport { MeshTile } from './MeshTile';\r\nimport { JsonTile } from './JsonTile';\r\nimport { GLTFLoader } from 'three/addons/loaders/GLTFLoader.js';\r\nimport { DRACOLoader } from 'three/addons/loaders/DRACOLoader.js';\r\nimport { KTX2Loader } from \"three/addons/loaders/KTX2Loader\";\r\nimport { resolveImplicite } from '../implicit/ImplicitTileResolver.js';\r\nimport { InstancedOGC3DTile } from './InstancedOGC3DTile';\r\nimport { MeshoptDecoder } from 'meshoptimizer';\r\n\r\nlet concurrentDownloads = 0;\r\n\r\n\r\n/**\r\n * A Tile loader that manages caching and load order for instanced tiles.\r\n * The cache is an LRU cache and is defined by the number of items it can hold.\r\n * The actual number of cached items might grow beyond max if all items are in use.\r\n * \r\n * The load order is designed for optimal perceived loading speed (nearby tiles are refined first).\r\n *\r\n */\r\nclass InstancedTileLoader {\r\n    /**\r\n     * Creates a tile loader with a maximum number of cached items and callbacks.\r\n     * The only required property is a renderer that will be used to visualize the tiles.\r\n     * The maxCachedItems property is the size of the cache in number of objects, mesh tile and tileset.json files.\r\n     * The mesh and point callbacks will be called for every incoming mesh or points.\r\n     *\r\n     * @param {scene} [scene] - a threejs scene.\r\n     * @param {Object} [options] - Optional configuration object.\r\n     * @param {number} [options.maxCachedItems=100] - the cache size.\r\n     * @param {number} [options.maxInstances=1] - the cache size.\r\n     * @param {function} [options.meshCallback] - A callback to call on newly decoded meshes.\r\n     * @param {function} [options.pointsCallback] - A callback to call on newly decoded points.\r\n     * @param {sring} [options.proxy] - An optional proxy that tile requests will be directed too as POST requests with the actual tile url in the body of the request.\r\n     * @param {KTX2Loader} [options.ktx2Loader = undefined] - A KTX2Loader (three/addons)\r\n     * @param {DRACOLoader} [options.dracoLoader = undefined] - A DRACOLoader (three/addons)\r\n     * @param {renderer} [options.renderer = undefined] - optional the renderer, this is required only for on the fly ktx2 support. not needed if you pass a ktx2Loader manually\r\n     \r\n     */\r\n    constructor(scene, options) {\r\n        this.zUpToYUpMatrix = new THREE.Matrix4();\r\n        this.zUpToYUpMatrix.set(1, 0, 0, 0,\r\n            0, 0, -1, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 0, 1);\r\n        this.maxCachedItems = 100;\r\n        this.maxInstances = 1;\r\n        this.proxy = options.proxy;\r\n        if (!!options) {\r\n            this.meshCallback = options.meshCallback;\r\n            this.pointsCallback = options.pointsCallback;\r\n            if (options.maxCachedItems) this.maxCachedItems = options.maxCachedItems;\r\n            if (options.maxInstances) this.maxInstances = options.maxInstances;\r\n\r\n        }\r\n\r\n\r\n        this.gltfLoader = new GLTFLoader();\r\n        if (!!options && !!options.dracoLoader) {\r\n            this.gltfLoader.setDRACOLoader(options.dracoLoader);\r\n            this.hasDracoLoader = true;\r\n        } else {\r\n            const dracoLoader = new DRACOLoader();\r\n            dracoLoader.setDecoderPath('https://www.gstatic.com/draco/versioned/decoders/1.4.3/');\r\n            this.gltfLoader.setDRACOLoader(dracoLoader);\r\n            this.gltfLoader.hasDracoLoader = true;\r\n        }\r\n\r\n        if (!!options && !!options.ktx2Loader) {\r\n            this.gltfLoader.setKTX2Loader(options.ktx2Loader);\r\n            this.hasKTX2Loader = true;\r\n        } else if (!!options && !!options.renderer) {\r\n            const ktx2Loader = new KTX2Loader();\r\n            ktx2Loader.setTranscoderPath('https://storage.googleapis.com/ogc-3d-tiles/basis/').detectSupport(options.renderer);\r\n            this.gltfLoader.setKTX2Loader(ktx2Loader);\r\n            this.gltfLoader.hasKTX2Loader = true;\r\n        }\r\n\r\n        this.gltfLoader.setMeshoptDecoder(MeshoptDecoder);\r\n        this.hasMeshOptDecoder = true;\r\n\r\n        this.b3dmDecoder = new B3DMDecoder(this.gltfLoader);\r\n\r\n\r\n        this.cache = new LinkedHashMap();\r\n        this.scene = scene;\r\n\r\n        this.ready = [];\r\n        this.downloads = [];\r\n        this.nextReady = [];\r\n        this.nextDownloads = [];\r\n\r\n    }\r\n\r\n    /**\r\n     * To be called in the render loop or at regular intervals.\r\n     * launches tile downloading and loading in an orderly fashion.\r\n     */\r\n    update() {\r\n        const self = this;\r\n        self._checkSize();\r\n        self.cache._data.forEach(v => {\r\n            v.update();\r\n        })\r\n\r\n        if (concurrentDownloads < 8) {\r\n            self._download();\r\n        }\r\n        self._loadBatch();\r\n    }\r\n\r\n\r\n    _download() {\r\n        const self = this;\r\n        if (self.nextDownloads.length == 0) {\r\n            self._getNextDownloads();\r\n            if (self.nextDownloads.length == 0) return;\r\n        }\r\n        while (self.nextDownloads.length > 0) {\r\n            const nextDownload = self.nextDownloads.shift();\r\n            if (!!nextDownload) {//} && nextDownload.shouldDoDownload()) {\r\n                //nextDownload.doDownload();\r\n                if (nextDownload.path.includes(\".b3dm\")) {\r\n                    var fetchFunction;\r\n                    if (!self.proxy) {\r\n                        fetchFunction = () => {\r\n                            return fetch(nextDownload.path);\r\n                        }\r\n                    } else {\r\n                        fetchFunction = () => {\r\n                            return fetch(self.proxy,\r\n                                {\r\n                                    method: 'POST',\r\n                                    body: nextDownload.path\r\n                                }\r\n                            );\r\n                        }\r\n                    }\r\n                    concurrentDownloads++;\r\n                    fetchFunction().then(result => {\r\n                        if (!result.ok) {\r\n                            console.error(\"could not load tile with path : \" + nextDownload.path)\r\n                            throw new Error(`couldn't load \"${nextDownload.path}\". Request failed with status ${result.status} : ${result.statusText}`);\r\n                        }\r\n                        return result.arrayBuffer();\r\n\r\n                    }).then(resultArrayBuffer => {\r\n                        return this.b3dmDecoder.parseB3DMInstanced(resultArrayBuffer, (mesh) => { self.meshCallback(mesh, nextDownload.geometricError) }, self.maxInstances, nextDownload.sceneZupToYup, nextDownload.meshZupToYup);\r\n                    }).then(mesh => {\r\n                        mesh.frustumCulled = false;\r\n                        nextDownload.tile.setObject(mesh);\r\n                        self.ready.unshift(nextDownload);\r\n\r\n                    }).catch(e => console.error(e))\r\n                        .finally(() => {\r\n                            concurrentDownloads--;\r\n                        });\r\n                } if (nextDownload.path.includes(\".glb\") || (nextDownload.path.includes(\".gltf\"))) {\r\n                    var fetchFunction;\r\n                    if (!self.proxy) {\r\n                        fetchFunction = () => {\r\n                            return fetch(nextDownload.path);\r\n                        }\r\n                    } else {\r\n                        fetchFunction = () => {\r\n                            return fetch(self.proxy,\r\n                                {\r\n                                    method: 'POST',\r\n                                    body: nextDownload.path\r\n                                }\r\n                            );\r\n                        }\r\n                    }\r\n                    concurrentDownloads++;\r\n                    fetchFunction().then(result => {\r\n                        if (!result.ok) {\r\n                            throw new Error(\"missing content\");\r\n                        }\r\n                        return result.arrayBuffer();\r\n                    }).then(async arrayBuffer => {\r\n                        await _checkLoaderInitialized(this.gltfLoader);\r\n                        this.gltfLoader.parse(arrayBuffer, null, gltf => {\r\n                            gltf.scene.asset = gltf.asset;\r\n\r\n                            if (nextDownload.sceneZupToYup) {\r\n                                gltf.scene.applyMatrix4(this.zUpToYUpMatrix);\r\n                            }\r\n                            gltf.scene.traverse((o) => {\r\n                                o.geometricError = nextDownload.geometricError;\r\n                                if (o.isMesh) {\r\n                                    if (nextDownload.meshZupToYup) {\r\n                                        o.applyMatrix4(this.zUpToYUpMatrix);\r\n                                    }\r\n                                    if (!!self.meshCallback) {\r\n                                        self.meshCallback(o, o.geometricError);\r\n                                    }\r\n                                }\r\n                                if (o.isPoints) {\r\n                                    console.error(\"instanced point cloud is not supported\");\r\n                                }\r\n                            });\r\n                            let instancedMesh;\r\n                            gltf.scene.updateWorldMatrix(false, true)\r\n                            gltf.scene.traverse(child => {\r\n                                //TODO several meshes in a single gltf\r\n                                if (child.isMesh) {\r\n                                    instancedMesh = new THREE.InstancedMesh(child.geometry, child.material, self.maxInstances);\r\n                                    instancedMesh.baseMatrix = child.matrixWorld;\r\n                                }\r\n\r\n                            });\r\n                            self.ready.unshift(nextDownload);\r\n                            if (!instancedMesh) {\r\n                                gltf.scene.traverse(c => {\r\n                                    if (c.dispose) c.dispose();\r\n                                    if (c.material) c.material.dispose();\r\n                                });\r\n                            } else {\r\n                                instancedMesh.frustumCulled = false;\r\n                                nextDownload.tile.setObject(instancedMesh);\r\n                            }\r\n                        });\r\n                    }, e => {\r\n                        console.error(\"could not load tile : \" + nextDownload.path)\r\n                    }).finally(() => {\r\n                        concurrentDownloads--;\r\n                    });\r\n\r\n\r\n\r\n                } else if (nextDownload.path.includes(\".json\")) {\r\n                    var fetchFunction;\r\n                    if (!self.proxy) {\r\n                        fetchFunction = () => {\r\n                            return fetch(nextDownload.path);\r\n                        }\r\n                    } else {\r\n                        fetchFunction = () => {\r\n                            return fetch(self.proxy,\r\n                                {\r\n                                    method: 'POST',\r\n                                    body: nextDownload.path\r\n                                }\r\n                            );\r\n                        }\r\n                    }\r\n                    concurrentDownloads++;\r\n                    fetchFunction().then(result => {\r\n                        if (!result.ok) {\r\n                            console.error(\"could not load tile with path : \" + nextDownload.path)\r\n                            throw new Error(`couldn't load \"${nextDownload.path}\". Request failed with status ${result.status} : ${result.statusText}`);\r\n                        }\r\n                        return result.json();\r\n\r\n                    }).then(json => {\r\n                        return resolveImplicite(json, nextDownload.path)\r\n                    }).then(json => {\r\n                        nextDownload.tile.setObject(json, nextDownload.path);\r\n                        self.ready.unshift(nextDownload);\r\n                    })\r\n                        .catch(e => console.error(e)).finally(() => {\r\n                            concurrentDownloads--;\r\n                        });\r\n                }\r\n            }\r\n        }\r\n        return;\r\n    }\r\n\r\n    _loadBatch() {\r\n        if (this.nextReady.length == 0) {\r\n            this._getNextReady();\r\n            if (this.nextReady.length == 0) return 0;\r\n        }\r\n        const download = this.nextReady.shift();\r\n        if (!download) return 0;\r\n\r\n        //if (!!download.tile.addToScene) download.tile.addToScene();\r\n        return 1;\r\n    }\r\n\r\n    _getNextReady() {\r\n        let smallestDistance = Number.MAX_VALUE;\r\n        let closest = -1;\r\n        for (let i = this.ready.length - 1; i >= 0; i--) {\r\n\r\n            if (!this.ready[i].distanceFunction) {// if no distance function, must be a json, give absolute priority!\r\n                this.nextReady.push(this.ready.splice(i, 1)[0]);\r\n            }\r\n        }\r\n        if (this.nextReady.length > 0) return;\r\n        for (let i = this.ready.length - 1; i >= 0; i--) {\r\n            const dist = this.ready[i].distanceFunction() * this.ready[i].level;\r\n            if (dist < smallestDistance) {\r\n                smallestDistance = dist;\r\n                closest = i\r\n            }\r\n        }\r\n        if (closest >= 0) {\r\n            const closestItem = this.ready.splice(closest, 1).pop();\r\n            this.nextReady.push(closestItem);\r\n            const siblings = closestItem.getSiblings();\r\n            for (let i = this.ready.length - 1; i >= 0; i--) {\r\n                if (siblings.includes(this.ready[i].uuid)) {\r\n                    this.nextready.push(this.ready.splice(i, 1).pop());\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Schedules a tile content to be downloaded\r\n     * \r\n     * @param {AbortController} abortController \r\n     * @param {string} path path or url to tile content \r\n     * @param {string|Number} uuid tile id\r\n     * @param {InstancedOGC3DTile} instancedOGC3DTile \r\n     * @param {Function} distanceFunction \r\n     * @param {Function} getSiblings \r\n     * @param {Number} level \r\n     * @param {Boolean} sceneZupToYup \r\n     * @param {Boolean} meshZupToYup \r\n     * @param {Number} geometricError \r\n     */\r\n    get(abortController, path, uuid, instancedOGC3DTile, distanceFunction, getSiblings, level, sceneZupToYup, meshZupToYup, geometricError) {\r\n        const self = this;\r\n        const key = _simplifyPath(path);\r\n\r\n        if (!path.includes(\".b3dm\") && !path.includes(\".json\") && !path.includes(\".glb\") && !path.includes(\".gltf\")) {\r\n            console.error(\"the 3DTiles cache can only be used to load B3DM, gltf and json data\");\r\n            return;\r\n        }\r\n\r\n        const cachedTile = self.cache.get(key);\r\n        if (!!cachedTile) {\r\n            cachedTile.addInstance(instancedOGC3DTile);\r\n            return;\r\n        } else {\r\n\r\n            if (path.includes(\".b3dm\") || path.includes(\".glb\") || path.includes(\".gltf\")) {\r\n                const tile = new MeshTile(self.scene);\r\n                tile.addInstance(instancedOGC3DTile);\r\n\r\n                self.cache.put(key, tile);\r\n                //self._checkSize();\r\n                const realAbortController = new AbortController();\r\n                abortController.signal.addEventListener(\"abort\", () => {\r\n                    if (tile.getCount() == 0) {\r\n                        realAbortController.abort();\r\n                    }\r\n                })\r\n                this.downloads.push({\r\n                    abortController: realAbortController,\r\n                    tile: tile,\r\n                    key: key,\r\n                    path: path,\r\n                    distanceFunction: distanceFunction,\r\n                    getSiblings: getSiblings,\r\n                    level: level,\r\n                    uuid: uuid,\r\n                    sceneZupToYup: sceneZupToYup,\r\n                    meshZupToYup: meshZupToYup,\r\n                    geometricError: geometricError,\r\n                    shouldDoDownload: () => {\r\n                        return true;\r\n                    },\r\n                })\r\n            } else if (path.includes(\".json\")) {\r\n                const tile = new JsonTile();\r\n                tile.addInstance(instancedOGC3DTile);\r\n                self.cache.put(key, tile);\r\n                //self._checkSize();\r\n                const realAbortController = new AbortController();\r\n                abortController.signal.addEventListener(\"abort\", () => {\r\n                    if (tile.getCount() == 0) {\r\n                        realAbortController.abort();\r\n                    }\r\n                })\r\n                this.downloads.push({\r\n                    abortController: realAbortController,\r\n                    tile: tile,\r\n                    key: key,\r\n                    path: path,\r\n                    distanceFunction: distanceFunction,\r\n                    getSiblings: getSiblings,\r\n                    level: level,\r\n                    shouldDoDownload: () => {\r\n                        return true;\r\n                    },\r\n                })\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n\r\n    _getNextDownloads() {\r\n        let smallestDistance = Number.MAX_VALUE;\r\n        let closest = -1;\r\n        for (let i = this.downloads.length - 1; i >= 0; i--) {\r\n            const download = this.downloads[i];\r\n            if (!download.shouldDoDownload()) {\r\n                this.downloads.splice(i, 1);\r\n                continue;\r\n            }\r\n            if (!download.distanceFunction) { // if no distance function, must be a json, give absolute priority!\r\n                this.nextDownloads.push(this.downloads.splice(i, 1)[0]);\r\n            }\r\n        }\r\n        if (this.nextDownloads.length > 0) return;\r\n        for (let i = this.downloads.length - 1; i >= 0; i--) {\r\n            const download = this.downloads[i];\r\n            const dist = download.distanceFunction() * download.level;\r\n            if (dist < smallestDistance) {\r\n                smallestDistance = dist;\r\n                closest = i;\r\n            }\r\n        }\r\n        if (closest >= 0) {\r\n            const closestItem = this.downloads.splice(closest, 1).pop();\r\n            this.nextDownloads.push(closestItem);\r\n            const siblings = closestItem.getSiblings();\r\n            for (let i = this.downloads.length - 1; i >= 0; i--) {\r\n                if (siblings.includes(this.downloads[i].uuid)) {\r\n                    this.nextDownloads.push(this.downloads.splice(i, 1).pop());\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    _checkSize() {\r\n        const self = this;\r\n\r\n        let i = 0;\r\n\r\n        while (self.cache.size() > self.maxCachedItems && i < self.cache.size()) {\r\n            i++;\r\n            const entry = self.cache.head();\r\n            self.cache.remove(entry.key);\r\n            if (!entry.value.dispose()) {\r\n                self.cache.put(entry.key, entry.value);\r\n            } else {\r\n                //console.log(\"disposed and removed\")\r\n            }\r\n\r\n        }\r\n    }\r\n}\r\n\r\nasync function _checkLoaderInitialized(loader) {\r\n\r\n    const self = this;\r\n    return new Promise((resolve) => {\r\n        const interval = setInterval(() => {\r\n            if ((!loader.hasDracoLoader || loader.dracoLoader) && (!loader.hasKTX2Loader || loader.ktx2Loader)) {\r\n                clearInterval(interval);\r\n                resolve();\r\n            }\r\n        }, 10); // check every 100ms\r\n    });\r\n};\r\n\r\nfunction _simplifyPath(main_path) {\r\n\r\n    var parts = main_path.split('/'),\r\n        new_path = [],\r\n        length = 0;\r\n    for (var i = 0; i < parts.length; i++) {\r\n        var part = parts[i];\r\n        if (part === '.' || part === '' || part === '..') {\r\n            if (part === '..' && length > 0) {\r\n                length--;\r\n            }\r\n            continue;\r\n        }\r\n        new_path[length++] = part;\r\n    }\r\n\r\n    if (length === 0) {\r\n        return '/';\r\n    }\r\n\r\n    var result = '';\r\n    for (var i = 0; i < length; i++) {\r\n        result += '/' + new_path[i];\r\n    }\r\n\r\n    return result;\r\n}\r\n\r\nexport { InstancedTileLoader };"],"names":["OcclusionCullingService","this","cullMap","cullMaterial","THREE","MeshBasicMaterial","vertexColors","side","FrontSide","cullTarget","_createCullTarget","cullPixels","Uint8Array","width","height","target","WebGLRenderTarget","Math","floor","window","innerWidth","innerHeight","texture","format","RGBAFormat","colorSpace","LinearSRGBColorSpace","minFilter","NearestFilter","magFilter","generateMipmaps","stencilBuffer","depthBuffer","depthTexture","DepthTexture","DepthFormat","type","UnsignedShortType","scene","renderer","camera","tempRenderTarget","getRenderTarget","tempOverrideMaterial","overrideMaterial","setRenderTarget","render","readRenderTargetPixels","i","length","c","MathUtils","clamp","id","tempMatrix","Matrix3","tempVector3","Vector3","size","aabb","Box3","matrix","Matrix4","inverse","localRay","Ray","OBB","values","center","e1","e2","e3","halfSize","normalize","rotationMatrix","set","x","y","z","aObb","copy","result","multiplyScalar","e","elements","sx","sy","sz","determinant","setFromMatrix4","invSX","invSY","invSZ","premultiply","applyMatrix4","extractBasis","ray","getSize","setFromCenterAndSize","setFromMatrix3","setPosition","invert","intersectBox","intersectRay","plane","normal","r","abs","dot","distanceToPoint","frustum","planes","insidePlane","point","sub","applyMatrix3","dx","max","dy","dz","sqrt","hs","corners","add","clone","geometry","BufferGeometry","setFromPoints","setIndex","computeBoundingSphere","material","LineBasicMaterial","color","wireframe","LineSegments","dispose","LinkedHashMap","_data","Map","_link","_head","undefined","_tail","key","item","head","has","previous","next","get","value","link","previousKey","prevKey","nextKey","reset","headLink","tailLink","cur","prev","nex","delete","clear","keys","entries","order","linkOrderArr","push","Array","from","map","k","utf8decoder","TextDecoder","FeatureTable","buffer","start","headerLength","binLength","binOffset","header","headerData","JSON","parse","decode","Object","count","defaultComponentType","defaultType","feature","isArray","byteOffset","featureType","featureComponentType","componentType","Error","stride","data","arrayStart","arrayLength","Int8Array","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BYTES_PER_ELEMENT","BatchTable","batchSize","super","getData","mergeAttributes","attributes","TypedArray","itemSize","normalized","gpuType","attribute","array","constructor","console","error","BufferAttribute","offset","isInterleavedBufferAttribute","tupleOffset","j","l","getComponent","setComponent","toTrianglesDrawMode","drawMode","TrianglesDrawMode","warn","TriangleFanDrawMode","TriangleStripDrawMode","index","getIndex","indices","position","getAttribute","numberOfTriangles","newIndices","getX","newGeometry","clearGroups","B3DMDecoder","aGltfLoader","checkLoaderInitialized","async","Promise","resolve","interval","setInterval","gltfLoader","hasDracoLoader","dracoLoader","hasKTX2Loader","ktx2Loader","clearInterval","zUpToYUpMatrix","arrayBuffer","meshCallback","sceneZupToYUp","meshZUpToYUp","self","dataView","DataView","magic","String","fromCharCode","getUint8","assert","byteLength","getUint32","featureTableJSONByteLength","featureTableBinaryByteLength","batchTableJSONByteLength","batchTableBinaryByteLength","featureTable","batchTableStart","glbStart","gltfBuffer","slice","reject","model","rtcCenter","makeTranslation","userData","gltfExtensions","CESIUM_RTC","asset","traverse","o","isMesh","maxCount","meshZupToYup","parseB3DM","then","mesh","instancedMesh","geometries","materials","updateWorldMatrix","child","matrixWorld","mergedGeometry","allAttributes","Set","forEach","attributeSize","fill","setAttribute","useGroups","isIndexed","attributesUsed","morphAttributesUsed","morphAttributes","morphTargetsRelative","attributesCount","name","addGroup","indexOffset","mergedIndex","mergedAttribute","numMorphTargets","morphAttributesToMerge","mergedMorphAttribute","InstancedMesh","baseMatrix","identity","byteToHex","toString","getRandomValues","rnds8","native","randomUUID","crypto","bind","v4","options","buf","rnds","random","rng","arr","toLowerCase","SplatsDecoder","splatsMesh","decoded","children","positions","colors","cov0","cov_0","cov1","cov_1","splatTile","addSplatsTile","GLTFLoader","Loader","manager","meshoptDecoder","pluginCallbacks","register","parser","GLTFMaterialsClearcoatExtension","GLTFMaterialsDispersionExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFTextureAVIFExtension","GLTFMaterialsSheenExtension","GLTFMaterialsTransmissionExtension","GLTFMaterialsVolumeExtension","GLTFMaterialsIorExtension","GLTFMaterialsEmissiveStrengthExtension","GLTFMaterialsSpecularExtension","GLTFMaterialsIridescenceExtension","GLTFMaterialsAnisotropyExtension","GLTFMaterialsBumpExtension","GLTFLightsExtension","GLTFMeshoptCompression","GLTFMeshGpuInstancing","url","onLoad","onProgress","onError","scope","resourcePath","path","relativeUrl","LoaderUtils","extractUrlBase","resolveURL","itemStart","_onError","itemError","itemEnd","loader","FileLoader","setPath","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","load","gltf","callback","indexOf","splice","json","extensions","plugins","textDecoder","ArrayBuffer","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","content","version","GLTFParser","crossOrigin","fileLoader","plugin","extensionsUsed","extensionName","extensionsRequired","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","setExtensions","setPlugins","GLTFRegistry","objects","object","remove","removeAll","KHR_LIGHTS_PUNCTUAL","KHR_MATERIALS_CLEARCOAT","KHR_MATERIALS_DISPERSION","KHR_MATERIALS_IOR","KHR_MATERIALS_SHEEN","KHR_MATERIALS_SPECULAR","KHR_MATERIALS_TRANSMISSION","KHR_MATERIALS_IRIDESCENCE","KHR_MATERIALS_ANISOTROPY","KHR_MATERIALS_VOLUME","KHR_TEXTURE_BASISU","KHR_MATERIALS_EMISSIVE_STRENGTH","EXT_MATERIALS_BUMP","EXT_TEXTURE_WEBP","EXT_TEXTURE_AVIF","EXT_MESHOPT_COMPRESSION","EXT_MESH_GPU_INSTANCING","cache","refs","uses","nodeDefs","nodes","nodeIndex","nodeLength","nodeDef","light","_addNodeRef","lightIndex","cacheKey","dependency","lightDef","lights","lightNode","Color","setRGB","range","DirectionalLight","PointLight","distance","SpotLight","spot","innerConeAngle","outerConeAngle","PI","angle","penumbra","assignExtrasToUserData","intensity","createUniqueName","_loadLight","_getNodeRef","getMaterialType","materialParams","materialDef","pending","opacity","metallicRoughness","pbrMetallicRoughness","baseColorFactor","baseColorTexture","assignTexture","SRGBColorSpace","all","materialIndex","emissiveStrength","emissiveIntensity","MeshPhysicalMaterial","extension","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","scale","clearcoatNormalScale","Vector2","dispersion","iridescenceFactor","iridescence","iridescenceTexture","iridescenceIor","iridescenceIOR","iridescenceThicknessRange","iridescenceThicknessMinimum","iridescenceThicknessMaximum","iridescenceThicknessTexture","sheenColor","sheenRoughness","sheen","sheenColorFactor","colorFactor","sheenRoughnessFactor","sheenColorTexture","sheenRoughnessTexture","transmissionFactor","transmission","transmissionTexture","thickness","thicknessFactor","thicknessTexture","attenuationDistance","Infinity","colorArray","attenuationColor","ior","specularIntensity","specularFactor","specularTexture","specularColorFactor","specularColor","specularColorTexture","bumpScale","bumpFactor","bumpTexture","anisotropyStrength","anisotropy","anisotropyRotation","anisotropyTexture","textureIndex","textureDef","textures","loadTextureImage","source","isSupported","images","textureLoader","uri","handler","getHandler","detectSupport","loadTexture","image","Image","src","onload","onerror","bufferView","bufferViews","extensionDef","getDependency","decoder","supported","res","byteStride","decodeGltfBufferAsync","mode","filter","ready","decodeGltfBuffer","meshDef","meshes","primitive","primitives","WEBGL_CONSTANTS","TRIANGLES","TRIANGLE_STRIP","TRIANGLE_FAN","attributesDef","accessor","createNodeMesh","results","nodeObject","pop","isGroup","instancedMeshes","m","p","q","Quaternion","s","TRANSLATION","fromBufferAttribute","ROTATION","SCALE","setMatrixAt","compose","attributeName","attr","instanceColor","InstancedBufferAttribute","Object3D","prototype","call","assignFinalMaterial","BINARY_EXTENSION_CHUNK_TYPES","body","headerView","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","preload","bufferViewIndex","gltfAttributeMap","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","threeAttributeName","ATTRIBUTES","accessorDef","accessors","WEBGL_COMPONENT_TYPES","decodeDracoFile","transform","texCoord","channel","rotation","fromArray","repeat","needsUpdate","GLTFCubicSplineInterpolant","Interpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","valueSize","i1","t0","t","t1","stride2","stride3","td","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","_q","GLTFCubicSplineQuaternionInterpolant","interpolate_","toArray","POINTS","LINES","LINE_LOOP","LINE_STRIP","WEBGL_FILTERS","LinearFilter","NearestMipmapNearestFilter","LinearMipmapNearestFilter","NearestMipmapLinearFilter","LinearMipmapLinearFilter","WEBGL_WRAPPINGS","ClampToEdgeWrapping","MirroredRepeatWrapping","RepeatWrapping","WEBGL_TYPE_SIZES","SCALAR","VEC2","VEC3","VEC4","MAT2","MAT3","MAT4","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","TEXCOORD_2","TEXCOORD_3","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","LINEAR","InterpolateLinear","STEP","InterpolateDiscrete","ALPHA_MODES","addUnknownExtensionsToUserData","knownExtensions","objectDef","gltfDef","extras","assign","updateMorphTargets","il","morphTargetInfluences","targetNames","morphTargetDictionary","createPrimitiveKey","primitiveDef","geometryKey","dracoExtension","createAttributesKey","targets","attributesKey","sort","getNormalizedComponentScale","_identityMatrix","associations","primitiveCache","nodeCache","meshCache","cameraCache","lightCache","sourceCache","textureCache","nodeNamesUsed","isSafari","safariVersion","isFirefox","firefoxVersion","navigator","userAgent","test","safariMatch","match","parseInt","createImageBitmap","TextureLoader","ImageBitmapLoader","setCrossOrigin","_invokeAll","ext","_markDefs","beforeRoot","getDependencies","dependencies","scenes","animations","cameras","afterRoot","updateMatrixWorld","catch","skinDefs","skins","meshDefs","skinIndex","skinLength","joints","isBone","skin","isSkinnedMesh","ref","updateMappings","original","mappings","func","unshift","loadScene","_invokeOne","loadNode","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","buffers","bufferViewDef","accessorIndex","sparse","pendingBufferViews","elementBytes","itemBytes","bufferAttribute","ibSlice","ibCacheKey","ib","InterleavedBuffer","InterleavedBufferAttribute","itemSizeIndices","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setX","setY","setZ","setW","sourceIndex","sourceDef","sampler","promise","loadImageSource","flipY","startsWith","samplers","wrapS","wrapT","isCompressedTexture","URL","webkitURL","sourceURI","isObjectURL","blob","Blob","mimeType","createObjectURL","isImageBitmapLoader","imageBitmap","Texture","revokeObjectURL","search","mapName","mapDef","gltfReference","extendTexture","useDerivativeTangents","tangent","useVertexColors","useFlatShading","isPoints","uuid","pointsMaterial","PointsMaterial","Material","sizeAttenuation","isLine","lineMaterial","cachedMaterial","flatShading","normalScale","MeshStandardMaterial","materialType","kmuExtension","extendParams","metalness","metallicFactor","roughness","roughnessFactor","metallicRoughnessTexture","extendMaterialParams","doubleSided","DoubleSide","alphaMode","transparent","depthWrite","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","aoMapIntensity","emissiveFactor","emissive","emissiveTexture","originalName","sanitizedName","PropertyBinding","sanitizeNodeName","createDracoPrimitive","decodePrimitive","addPrimitiveAttributes","cached","geometryPromise","meshIndex","depthTest","loadGeometries","SkinnedMesh","Mesh","normalizeSkinWeights","Line","LineLoop","Points","group","Group","cameraIndex","cameraDef","params","PerspectiveCamera","radToDeg","yfov","aspectRatio","znear","zfar","OrthographicCamera","xmag","ymag","skinDef","_loadNodeShallow","inverseBindMatrices","jointNodes","bones","boneInverses","jointNode","mat","Skeleton","animationIndex","animationDef","animationName","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","node","input","parameters","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","updateMatrix","createdTracks","_createAnimationTracks","AnimationClip","nodePending","childPending","childrenDef","skeletonPending","skeleton","nodeName","meshPromise","createNodeAttachment","Bone","quaternion","sceneIndex","sceneDef","nodeIds","reducedAssociations","targetName","TypedKeyframeTrack","NumberKeyframeTrack","QuaternionKeyframeTrack","VectorKeyframeTrack","interpolation","outputArray","_getArrayFromAccessor","jl","track","_createCubicSplineTrackInterpolant","scaled","createInterpolant","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","assignAttributeAccessor","gltfAttributeName","ColorManagement","workingColorSpace","box","min","boxScale","maxDisplacement","vector","expandByVector","boundingBox","sphere","Sphere","getCenter","radius","distanceTo","boundingSphere","hasMorphPosition","hasMorphNormal","hasMorphColor","pendingPositionAccessors","pendingNormalAccessors","pendingColorAccessors","pendingAccessor","morphPositions","morphNormals","morphColors","_taskCache","WeakMap","DRACOLoader","decoderPath","decoderConfig","decoderBinary","decoderPending","workerLimit","workerPool","workerNextTaskID","workerSourceURL","defaultAttributeIDs","uv","defaultAttributeTypes","config","attributeIDs","attributeTypes","vertexColorSpace","taskConfig","useUniqueIDs","decodeGeometry","taskKey","stringify","cachedTask","worker","taskID","taskCost","geometryPending","_getWorker","_worker","_callbacks","postMessage","message","_createGeometry","_releaseTask","geometryData","_assignVertexColorSpace","inputColorSpace","_color","toWorkingColorSpace","setXYZ","g","b","responseType","_initDecoder","useJS","WebAssembly","librariesPending","_loadLibrary","libraries","jsContent","wasmBinary","fn","DRACOWorker","substring","lastIndexOf","join","Worker","_taskCosts","_taskLoad","onmessage","a","log","terminate","decodeAttribute","draco","dracoGeometry","attributeType","numComponents","num_components","numValues","num_points","dataType","DT_FLOAT32","DT_INT8","DT_INT16","DT_INT32","DT_UINT8","DT_UINT16","DT_UINT32","ptr","_malloc","GetAttributeDataArrayForAllPoints","HEAPF32","_free","onModuleLoaded","DracoDecoderModule","module","Decoder","decodingStatus","geometryType","GetEncodedGeometryType","TRIANGULAR_MESH","DecodeArrayToMesh","POINT_CLOUD","PointCloud","DecodeArrayToPointCloud","ok","error_msg","attributeID","GetAttributeByUniqueId","GetAttributeId","GetAttribute","attributeResult","numFaces","num_faces","numIndices","GetTrianglesUInt32Array","destroy","WorkerPool","pool","queue","workers","workersResolve","workerStatus","workerId","workerCreator","addEventListener","_onMessage","_getIdleWorker","msg","transfer","shift","_initWorker","ct","yt","xt","wt","Ft","Ct","te","ae","ge","ue","we","Ae","In","Sn","pi","Ii","vkFormat","typeSize","pixelWidth","pixelHeight","pixelDepth","layerCount","faceCount","supercompressionScheme","levels","dataFormatDescriptor","vendorId","descriptorType","descriptorBlockSize","versionNumber","colorModel","colorPrimaries","transferFunction","flags","texelBlockDimension","bytesPlane","samples","keyValue","globalData","Si","n","_dataView","_littleEndian","_offset","getUint16","_nextUint32","_nextUint64","getInt32","Oi","Ti","A","I","B","env","emscripten_notify_memory_growth","exports","memory","Q","init","fetch","C","instantiate","_init","Buffer","instance","malloc","Number","ZSTD_findDecompressedSize","E","ZSTD_decompress","D","free","_zstd","_activeLoaders","KTX2Loader","transcoderPath","transcoderBinary","transcoderPending","workerConfig","MSC_TRANSCODER","num","setWorkerLimit","astcSupported","hasFeatureAsync","astcHDRSupported","etc1Supported","etc2Supported","dxtSupported","bptcSupported","pvrtcSupported","isWebGPURenderer","hasFeature","getSupportedProfiles","includes","jsLoader","loadAsync","binaryLoader","binaryContent","BasisWorker","EngineFormat","EngineType","TranscoderFormat","BasisFormat","setWorkerCreator","_createTexture","transcodeResult","container","messageType","faces","dfdFlags","CompressedCubeTexture","mipmaps","CompressedArrayTexture","CompressedTexture","parseColorSpace","premultiplyAlpha","f","h","U","levelData","uncompressedByteLength","_","_skip","_nextUint16","_nextUint8","bitOffset","bitLength","channelType","samplePosition","sampleLower","sampleUpper","_nextInt32","_scan","_nextUint8Array","u","d","w","imageFlags","rgbSliceByteOffset","rgbSliceByteLength","alphaSliceByteOffset","alphaSliceByteLength","L","v","V","S","F","endpointCount","selectorCount","imageDescs","endpointsData","selectorsData","tablesData","extendedData","isBasisHDR","VK_FORMAT_ASTC_4x4_SFLOAT_BLOCK_EXT","FORMAT_MAP","zstd","ZSTDDecoder","levelIndex","levelWidth","levelHeight","levelDepth","level","TYPE_MAP","FloatType","HalfFloatType","depth","UNCOMPRESSED_FORMATS","DataTexture","Data3DTexture","texturePending","_createTextureFrom","ETC1S","UASTC","UASTC_HDR","ETC1","ETC2","BC1","BC3","BC4","BC5","BC7_M6_OPAQUE_ONLY","BC7_M5","PVRTC1_4_RGB","PVRTC1_4_RGBA","ASTC_4x4","ATC_RGB","ATC_RGBA_INTERPOLATED_ALPHA","RGBA32","RGB565","BGR565","RGBA4444","BC6H","RGB_HALF","RGBA_HALF","RGBA_ASTC_4x4_Format","RGB_BPTC_UNSIGNED_Format","RGBA_BPTC_Format","RGBA_ETC2_EAC_Format","RGBA_PVRTC_4BPPV1_Format","RGBA_S3TC_DXT5_Format","RGB_ETC1_Format","RGB_ETC2_Format","RGB_PVRTC_4BPPV1_Format","RGBA_S3TC_DXT1_Format","UnsignedByteType","BasisModule","_EngineFormat","_EngineType","_TranscoderFormat","_BasisFormat","onRuntimeInitialized","BASIS","initializeBasis","KTX2File","hasAlpha","ktx2File","cleanup","close","isValid","basisFormat","isUASTC","isETC1S","isHDR","getWidth","getHeight","getLayers","levelCount","getLevels","getFaces","getHasAlpha","getDFDFlags","transcoderFormat","engineFormat","engineType","OPTIONS","opt","if","needsPowerOfTwo","isPowerOfTwo","startTranscoding","face","mip","layerMips","mipWidth","mipHeight","layer","levelInfo","getImageLevelInfo","origWidth","origHeight","dst","getImageTranscodedSizeInBytes","status","transcodeImage","mipData","concat","FORMAT_OPTIONS","priorityETC1S","priorityUASTC","priorityHDR","arrays","totalByteLength","RGFormat","RedFormat","VK_FORMAT_R32G32B32A32_SFLOAT","VK_FORMAT_R16G16B16A16_SFLOAT","VK_FORMAT_R8G8B8A8_UNORM","VK_FORMAT_R8G8B8A8_SRGB","VK_FORMAT_R32G32_SFLOAT","VK_FORMAT_R16G16_SFLOAT","VK_FORMAT_R8G8_UNORM","VK_FORMAT_R8G8_SRGB","VK_FORMAT_R32_SFLOAT","VK_FORMAT_R16_SFLOAT","VK_FORMAT_R8_SRGB","VK_FORMAT_R8_UNORM","VK_FORMAT_ASTC_6x6_SRGB_BLOCK","RGBA_ASTC_6x6_Format","VK_FORMAT_ASTC_6x6_UNORM_BLOCK","dfd","NoColorSpace","fetchAndDecodeSubtree","split","response","statusText","handleJSONSubtree","getDirectoryUrl","baseURL","jsonByteLength","getBigUint64","binaryByteLength","jsonStart","jsonEnd","binaryStart","binaryEnd","jsonBuffer","jsonString","trim","bufferFetchPromises","binaryUrl","href","isAvailable","availability","constant","bitstream","isAvailable2","bitIndex","isTileAvailable","address","computeQuadtreeIndex","computeOctreeIndex","tileAvailability","isContentAvailable","contentAvailability","isChildSubtreeAvailable","childSubtreeAvailability","cleanUrl","part1By1","pow","part1By2","subtreeMap","resolveImplicite","rootTile","root","implicitTiling","contents","isQuad","subdivisionScheme","toUpperCase","subtreeUriTemplate","subtrees","contentURITemplates","rootURL","subtreeUri","replace","globalAddress","localAddress","subtree","contentURI","explicitTileset","geometricError","boundingVolume","refine","getChildren","buildChildren","parent","availableLevels","subtreeLevels","localAddresses","getChildrenAddresses","globalAddresses","boundingVolumes","computeBoundingVolumes","childLocalAddress","childGlobalAddress","newSubtree","newLocalAddress","contentURITemplate","tileAddress","nextLevel","rootBoundingVolume","addresses","computeBoundingVolume","region","rootRegion","west","south","east","north","minHeight","maxHeight","xStep","yStep","zStep","newWest","newSouth","newEast","newNorth","newMinHeight","newMaxHeight","vectors","scaleFactors","newVectors","component","origin","wasmpack","cond","bytes","view","encode","fun","bound","sbrk","tp","sp","heap","subarray","maxindex","index32","bits","insize","ch","charCodeAt","write","__wasm_call_ctors","meshopt_encodeVertexVersion","meshopt_encodeIndexVersion","MeshoptDecoder","detector","wasm","validate","unpack","count4","filters","NONE","OCTAHEDRAL","QUATERNION","EXPONENTIAL","decoders","INDICES","requestId","createWorker","requests","event","action","workerProcess","useWorkers","decodeVertexBuffer","meshopt_decodeVertexBuffer","decodeIndexBuffer","meshopt_decodeIndexBuffer","decodeIndexSequence","meshopt_decodeIndexSequence","simplifyPoints","vertex_positions","vertex_count","vertex_positions_stride","vertex_colors","vertex_colors_stride","color_weight","target_vertex_count","ti","sc","simplifyOptions","LockBorder","Sparse","ErrorAbsolute","Prune","_InternalDebug","extractBounds","boundsp","bounds_floats","BOUNDS_SIZE","centerX","centerY","centerZ","coneApexX","coneApexY","coneApexZ","coneAxisX","coneAxisY","coneAxisZ","coneCutoff","concurrentDownloads","TileLoader","downloadParallelism","timeout","maxCachedItems","proxy","pointsCallback","setDRACOLoader","setDecoderPath","setKTX2Loader","setTranscoderPath","ktx2loader","setMeshoptDecoder","hasMeshOptDecoder","b3dmDecoder","splatsDecoder","downloads","nextReady","nextDownloads","update","_download","_loadBatch","_getNextDownloads","nextDownload","shouldDoDownload","doDownload","distanceFunction","getSiblings","_getNextReady","tile","smallestDistance","POSITIVE_INFINITY","closest","closestItem","highestLevel","lowestLevel","MAX_SAFE_INTEGER","lowestIndex","dist","loadingStrategy","siblings","abortController","tileIdentifier","sceneZupToYup","_simplifyPath","realAbortController","AbortController","signal","abort","_meshReceived","downloadFunction","fetchFunction","method","resultArrayBuffer","put","_checkSize","finally","parseSplats","code","_scheduleDownload","aborted","temp","setTimeout","entry","_disposeEntryContent","reg","isSplatsBatch","main_path","parts","new_path","part","DFSOperation","assertPath","TypeError","normalizeStringPosix","allowAboveRoot","lastSegmentLength","lastSlash","dots","lastSlashIndex","posix","cwd","resolvedPath","resolvedAbsolute","arguments","process","isAbsolute","trailingSeparator","joined","arg","relative","to","fromStart","fromEnd","fromLen","toStart","toLen","lastCommonSep","fromCode","out","_makeLong","dirname","hasRoot","end","matchedSlash","basename","extIdx","firstNonSlashEnd","extname","startDot","startPart","preDotState","pathObject","sep","dir","base","ret","delimiter","win32","pathBrowserify","IterableElementBase","_toElementFn","toElementFn","Symbol","iterator","args","_getIterator","predicate","thisArg","callbackfn","element","ele","initialValue","accumulator","print","toVisual","Heap","_elements","_DEFAULT_COMPARATOR","_comparator","comparator","addMany","_bubbleUp","ans","el","last","_sinkDown","fix","poll","_dfs","left","right","visitedNode","cloned","top","filteredList","current","mappedHeap","parentItem","halfLength","minItem","PriorityQueue","filteredPriorityQueue","mappedPriorityQueue","MinPriorityQueue","tmpVector","tmpVector2","zUpToYUpMatrix3x3","SplatsMesh","isStatic","fragShader","ceil","textureSize","maxSplats","colorRenderTarget","WebGL3DRenderTarget","resolveDepthBuffer","initRenderTarget","positionRenderTarget","cov1RenderTarget","cov2RenderTarget","ShaderMaterial","uniforms","numSlices","cov1Texture","cov2Texture","colorTexture","positionTexture","sizeMultiplier","cropRadius","MAX_VALUE","cameraNear","cameraFar","computeLinearDepth","vertexShader","splatsVertexShader","fragmentShader","splatsFragmentShader","InstancedBufferGeometry","vertices","orderAttribute","setUsage","DynamicDrawUsage","instanceCount","matrixAutoUpdate","numBatches","numVisibleBatches","numTextures","numSplatsRendered","sortID","freeAddresses","WorkerConstructor","sortListeners","newOrder","clearUpdateRanges","addUpdateRange","cameraPosition","rotateOnAxis","frustumCulled","copyMaterial2D","sourceTexture","vertexCopyShader","copyMaterial3D","copyCamera","copyScene","Scene","copyGeometry","PlaneGeometry","copyQuad","scissorBox","prevAutoClear","autoClear","prevRenderTarget","scissorWidth","scissorHeight","viewport","numLayers","xyz","equals","raycaster","intersects","cov2","positionArray","isInterleavedBuffer","textureAddresses","pointManagerAddresses","raycast","positionsOnly","threshold","threshSquared","direction","distanceSqToPoint","growTextures","isNaN","startIndex","addSplatsBatch","insertionIndexes","visible","hide","show","listener","positionsStartIndex","colorsArray","cov1Array","cov2Array","arrayIndexBase4","positionIndex","getY","getZ","getW","destTextureLayer","srcHeight","scissor","batchPositionTexture","initTexture","copyTex2D","batchColorTexture","batchCov1Texture","batchCov2Texture","newNumTextures","copyTex3D","copyrightDiv","tempSphere","tempOBB","tempVec1","tempVec2","upVector","tempRay","inverseWorld","Frustum","transformedCameraPosition","tempIntersects","tempQuaternion","copyright","getOGC3DTilesCopyrightInfo","list","hasOwnProperty","OGC3DTile","properties","contentURL","domWidth","domHeight","rendererSize","distanceBias","drawBoundingVolume","displayErrors","displayCopyright","queryParams","uuidv4","tileLoader","tileLoaderOptions","points","geometricErrorMultiplier","splatsCropRadius","splatsSizeMultiplier","loadOutsideView","cameraOnLoad","parentTile","occlusionCullingService","static","setHex","colorID","matrixWorldAutoUpdate","childrenTiles","meshContent","tileContent","rootPath","materialVisibility","hasMeshContent","hasUnloadedJSONContent","centerModel","onLoadCallback","_setup","props","path.dirname","_showError","setSplatsSizeMultiplier","setSplatsCropRadius","isObject3D","updateMatrices","parentRefine","parentGeometricError","_transformWGS84ToCartesian","lerp","parentBoundingVolume","_checkContent","_load","setFromUnitVectors","applyQuaternion","xAxis","yAxis","zAxis","makeBasis","setFromRotationMatrix","alignmentQuaternion","horizontalRotation","setFromAxisAngle","multiply","isSetup","bbox","Box3Helper","helper","endsWith","rootUrl","rootParts","pathname","relativeParts","protocol","host","urlObj","searchParams","loadJson","deleted","loadContent","promises","contentIndex","urlRegex","_assembleURL","path.isAbsolute","path.sep","_extractQueryParams","_updateCopyrightLabel","layers","disable","Float32BufferAttribute","_calculateDistanceToCamera","_getSiblings","jsonRequested","jsonReceived","mc","splat","invalidate","dispatchEvent","intersection","intersectsRay","intersectsSphere","splatsReady","setFromProjectionMatrix","multiplyMatrices","projectionMatrix","matrixWorldInverse","numTiles","numTilesRendered","maxLOD","percentageLoaded","_updateImmediate","_statsImmediate","_update","_stats","numTilesLoaded","_computeMetricRecursive","_updateNodeVisibilityImmediate","_expandTreeImmediate","shouldBeVisible","metric","_shouldBeVisibleUpdateImmediate","_trimTreeImmediate","_loadMeshImmediate","_disposeChildren","parentDisplaysMesh","_changeContentVisibility","_disposeMeshContent","allChildrenReady","every","_isReadyImmediate","_setShouldNotBeVisibleRecursive","_calculateUpdateMetric","hasID","_loadJsonChildren","visibilityBeforeUpdate","inFrustum","_isReady","_areAllChildrenLoadedAndHidden","childJSON","childTile","allLoadedAndHidden","visibility","enable","near","getMaxScaleOnAxis","getDrawingBufferSize","fov","aspect","tan","tiles","setGeometricErrorMultiplier","setDistanceBias","lon","lat","sfct","N","sin","cosLat","cos","cosLon","sinLat","nPh","errorDiv","document","createElement","textContent","style","padding","backgroundColor","zIndex","appendChild","bottom","textShadow","listString","InstancedTile","master","jsonChildren","refinement","setup","parentRefinement","decompose","matrixWorldNeedsUpdate","transformWGS84ToCartesian","checkContent","absoluteURL","absolutePath","assembleURL","extractQueryParams","calculateDistanceToCamera","updateNodeVisibility","changeContentVisibility","isReady","calculateUpdateMetric","disposeChildren","areAllChildrenLoadedAndHidden","meshesToDisplay","meshesDisplayed","_renderSize","lambda","devicePixelRatio","getWorldMatrix","InstancedOGC3DTile","tileset","MeshTile","instancedTiles","reuseableMatrix","instancedTile","added","listOMesh","addToScene","instanceMatrix","onAfterRender","displayedOnce","JsonTile","instanceTile","getCount","InstancedTileLoader","maxInstances","parseB3DMInstanced","setObject","_checkLoaderInitialized","nextready","instancedOGC3DTile","cachedTile","addInstance","download"],"mappings":"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","x_google_ignoreList":[4,6,7,8,9,11,12,13,14,15,16,17,20,21,22,23,25,26,27,28,29,30]}